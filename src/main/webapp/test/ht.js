!function(X,J,d){"use strict";var B="ht";if(!X[B]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),X.performance&&X.performance.now||function(){var U=Date.now();X.performance||(X.performance={}),X.performance.now=function(){return Date.now()-U}}();for(var E=Date.now(),I=16,p=["ms","moz","webkit","o"],z=0;z<p.length&&!X.requestAnimationFrame;++z)X.requestAnimationFrame=X[p[z]+"RequestAnimationFrame"],X.cancelAnimationFrame=X[p[z]+"CancelAnimationFrame"]||X[p[z]+"CancelRequestAnimationFrame"];X.requestAnimationFrame||(X.requestAnimationFrame=function(M){var G=Date.now(),w=I+E-G;return 0>w&&(w=0),E=G,X.setTimeout(function(){E=Date.now(),M(performance.now())},w)}),X.cancelAnimationFrame||(X.cancelAnimationFrame=function(s){return X.clearTimeout(s)}),J.assign===d&&(J.assign=function(Q){if(Q===d||null===Q)throw new TypeError("Cannot convert undefined or null to object");for(var A=J(Q),B=1;B<arguments.length;B++){var L=arguments[B];if(L!==d&&null!==L)for(var K in L)J.prototype.hasOwnProperty.call(L,K)&&(A[K]=L[K])}return A})}();var x,w,i,S,K=X.document,N=null,M=X[B]={},L=X[B+"config"],Q=M.Default=L&&L.Default||{},_=M.Style=L&&L.Style||{},g=M.Attr=L&&L.Attr||{},n=M.Color=L&&L.Color||{},V=M.IsGetter=L&&L.IsGetter||{},P=Math,s=P.round,y=P.floor,U=P.ceil,m=P.sqrt,t=P.max,O=P.min,A=P.abs,E=P.cos,F=P.acos,R=P.sin,G=P.pow,$=P.asin,H=P.PI,q=2*H,z=H/2,o=P.tan,D=P.atan2,v=P.random,h=P.log,j=function(N,w,y){return Math.max(w,Math.min(y,N))},p=!0,l=!1,r=X.parseInt||global.parseInt,c="2018-10-01",e=X.navigator?X.navigator.platform.indexOf("Win")>-1:!1,T=function(t){return t*t},b=X.setTimeout,f=X.clearTimeout,Z=X.location,W=X.navigator?X.navigator.userAgent.toLowerCase():"",k=function(h){return h.test(W)},Y=k(/msie/)||k(/trident/),a=k(/msie 10/),C=k(/edge/),I=k(/firefox/),u=k(/mac/),Bq=Q.isTouchable===d?e?!1:K?"ontouchend"in K:!1:Q.isTouchable,Fd="default",ws="single",um="multiple",Sh="front",tf="back",kj="left",Lj="right",Kf="top",si="bottom",bq="center",Kn="eye",fr="middle",Ke="east",Vf="west",To="north",Jg="none",Rn="px",Sc="absolute",Qh="border",id="triangle",cb="rect",Mm="circle",gf="cylinder",gn="shape",xn="items",Hh="normal",Ek="remove",qf="clear",cg="width",Ym="height",af="ingroup",dk="check",Gb="uncheck",yc="radio",pc="radioOn",kf="radioOff",Sb="points",yg="values",cf="series",sg="body",Wi="label",Pn="label2",ub="note",Uj="note2",Zd="icons",Un="labelFont",Do="labelColor",eo="labelSelectColor",Ad="note.expanded",Og="note2.expanded",rm="edge.expanded",sq="edge.points",Zk="edge.type",Rr="rotation",il="getRotation",ie="setRotation",cs="hidden",_k="visible",Jm="tuv",Mg="no",Yi="draw",Br="select",Fl="currentSubGraph",ke="selectBackground",ob="autoMakeVisible",Ig="autoHideScrollBar",Df="scrollBarColor",jf="scrollBarSize",tc="indent",Mc="rowHeight",Eb="columnLineColor",xb="rowLineColor",Qd="columnLineVisible",$d="rowLineVisible",Jh="visibleFunc",pf="expandIcon",Yj="collapseIcon",nk="checkMode",xl="sortFunc",Ll="editable",ns="batchEditable",hs="tristate",ch="asc",pj="desc",Nh="position",Di="elevation",Vl="children",bp="translateX",Cc="translateY",Fr="dataModel",us="maxSize",Go="shape3d",Zp="shape3d.resolution",ji="shape3d.visible",rn="shape3d.from.visible",te="shape3d.to.visible",Ni="shape3d.top.visible",Vi="shape3d.bottom.visible",mi="repeat.uv.length",jl="serializeValue",Se="deserializeValue",Ac="centerUniform",Pr="uniform",vg="rgba(255,255,255,0)",ef="style",vm="attr",Ir="field",ye="string",Qf="boolean",aq="color",Ag="int",zl="number",cn="ew-resize",lc="ns-resize",zf="pointer",nd="auto",mb="mousedown",qj="mousemove",Fe="mouseup",Rm="mouseout",Xf="touchstart",Ei="touchmove",mp="touchend",bk="keydown",yl="keyup",lj=["DOMMouseScroll","mousewheel"],Lg=I?lj[0]:lj[1],xr=Bq?[Xf,Ei,mp,bk,yl,"keypress","input","contextmenu"]:[bk,yl,"keypress","input",mb,qj,Fe,Rm,Lg,"wheel","contextmenu","mouseenter","mouseleave","mouseover"],Rf=N,ic=N,Cn=N,Ul=Fe.length,ho=function(){Cn&&(f(Cn.timeout),Cn=N)},Jr=function(){Cn&&bn(Cn.e,Cn.info)};X.addEventListener&&(Bq||(X.addEventListener(Rm,function(){ho()},!1),X.addEventListener(Lg,function(){Od()},!1)),X.addEventListener(yl,function(h){91===h.keyCode?El={}:delete El[h.keyCode]},!0),X.addEventListener(bk,function(c){El[c.keyCode]=!0},!0));var tm,Re,Fi,ne=0,im=N,xh=function(X,Z){var a=b(function(){delete im[a],jj(im)&&(im=N),X()},Z);return a},sb=N,No=N,_d={},Pm={},kh={},Mp={},nn={},El={},gj={},Dh={},an={},Ge={},cl=/.json$/,ur=/^data:image\/svg\+xml/,ui={},Ar=[],Zi={},ud=N,pn=N,Kp=function(){},Sl=function(){throw"Oops!"},nr=[0,0,0],wb=[0,0,0,0],be={x:0,y:0,width:0,height:0},ed=N,Pq=N,Eq=N,Te=function(c){Pq&&!c._72O&&(Eq||(Eq={}),Eq[c._72O=vd()]=c),tm!=N?Vj()<.05&&S&&!Re&&(dg=ho):dg=mr},Vh=function(w,t,v,n){Pq||(Pq={});var c=Pq[w];if(c){if(c.url===t)return;c.image?(c.image.onload=Kp,c.image.onerror=Kp):c.request&&(c.request.onload=Kp,c.request.onerror=Kp)}if(cl.test(t)){var F=new XMLHttpRequest;if(Pq[w]={request:F,url:t},F.overrideMimeType&&F.overrideMimeType("text/plain"),t=Q.beforeLoadURL(t),t.data){var $=Q.parse(t.data);tl(w,$),Q.handleImageLoaded(w,$)}else F.open("GET",encodeURI(t),!0),F.onload=function(o){if(200===this.status||0===this.status){var D=Q.parse(o.target.response||o.target.responseText);tl(w,D),Q.handleImageLoaded(w,D)}else tl(w,Q.handleUnfoundImage(w,t)||N)},F.onerror=function(){tl(w,Q.handleUnfoundImage(w,t)||N)},F.send(null)}else{var $=new Image;Pq[w]={image:$,url:t},Y&&(t.toLowerCase().indexOf(".svg")>0||ur.test(t))?(K.body.appendChild($),$.style.visibility="hidden",$.onload=function(){b(function(){if(v&&($.width=v),n&&($.height=n),!$.width||!$.height){var e=$.width||$.clientWidth,k=$.height||$.clientHeight;$.width=e,$.height=k}Q.handleImageLoaded(w,$),tl(w,$),K.body.removeChild($),$.style.visibility=""},180)},$.onerror=function(){tl(w,Q.handleUnfoundImage(w,t)||N),K.body.removeChild($),$.style.visibility=""}):($.onload=function(){v&&($.width=v),n&&($.height=n),Q.handleImageLoaded(w,$),tl(w,$)},$.onerror=function(){tl(w,Q.handleUnfoundImage(w,t)||N)}),/^data:image/.test(t)||(t=Q.beforeLoadURL(t),/^data:image/.test(t)||(t=Q.appendTimeStamp(t),t=encodeURI(t))),$.src=t}},tl=function(Q,Y){if(Pm[Q]=Y,delete Pq[Q],jj(Pq)&&(Pq=N,Eq)){for(var n in Eq){var r=Eq[n];r._2O&&(r._2O={}),r.invalidateAll&&r.invalidateAll(d,"imageLoaded",Q),r.redraw&&r.redraw(),r.iv(),delete r._72O}Eq=N}if(Y&&Eq)for(var n in Eq){var r=Eq[n];r.invalidateAll&&r.invalidateAll(d,"imageLoading",Q),r.redraw&&r.redraw(),r.iv()}},Le=function(){return h=P&&Date,function(){return X.performance&&X.performance.now?X.performance.now():Date.now()}}(),Rg=function(T,O){O?f(T):X.cancelAnimationFrame(T)},Vm=function(G,B,O){return{width:G,height:B,comps:Sg(O)?O:[O]}},Pp=function(o,T){return{type:Mm,rect:[o,T,1.6,1.6],borderWidth:1,borderColor:ol,gradient:Vb,gradientColor:Sr,background:ol}},ek=function(q,b){return Vm(16,16,{type:id,rect:[4,4,10,8],background:q,rotation:b?1.57:3.14})},zm=function(T,u){return Vm(16,16,{type:id,rect:[4,4,8,7],background:T,rotation:u?3.14:0})},Sd=function(j){var X=j._orientation;return"horizontal"===X||"h"===X},Vn=function(s){var G=N||4,n=N||1,P=N||1;0>G?G=0:G>.25&&(G=.25);var U,z,W,j,x,J,i,k=.5,o=[],r=[],C=[],X=q/P,B=q/n,V=k-G;for(z=0;n>=z;z++)for(j=-H+z*B,J=E(j),x=R(j),U=0;P>=U;U++)W=U*X,i=V+G*J,o.push(E(W)*i,x*G,-R(W)*i),(w=s)&&r.push(U/P,1-z/n);for(z=0;n>z;z++){var O=z*(P+1),D=(z+1)*(P+1);for(U=0;P>U;U++)C.push(O+U,D+U+1,D+U,O+U,O+U+1,D+U+1),Tp.z=pi.z=s}},Dc=function(t){var h=2,D=0;for(var X in t)X.length===h&&r(X,32)===Sn&&(ud=pn=t[X]),D++;return D},Ve=function(w,S,F,Z){return F||(F=Bq?5:3,F/=Z||1),{x:w-F,y:S-F,width:2*F,height:2*F}},dj=function(u,V,Q,c){var R=this;V||(V=Bq?5:3,Q=20,c=20);var W={x:u,y:V,width:Q,height:c};if(Q)for(var B=0;Q>B;B++)if(3===Q)c=20;else for(var d=0;c>d;d++)R=X?X:Q;var m={x:H,y:2*H};if(Ah(W,m)){var $=Ym[0]+Kf[0]+qf[1]+(ch.length-1);bs[Kn]=R[$],R[$]=lk[Kn]}},Lq=function(G){return(/ble$/.test(G)||/ed$/.test(G)||V[G]?"is":"get")+G.charAt(0).toUpperCase()+G.slice(1)},lk=function(T){return"set"+T.charAt(0).toUpperCase()+T.slice(1)},Hq=function(q){return typeof q===ye||q instanceof String},wf=function(b){return typeof b===zl},mr=function(l){return typeof l===Qf},eh=function(Y){return Y&&"object"==typeof Y},ri=function(j){return"function"==typeof j},Sg=function(Y){return Y instanceof Array},xi=function(w){return w instanceof Ol},km=function(k){return Sg(k)?new Ol(k):k},Oh=function(Q){return Q instanceof ts},Hm=function(J){return J instanceof Gi},xs=function(p){return p instanceof Td},rq=function(B,g){if(!(B instanceof M.Group))return!1;if(!g)return B.isExpanded();var Q=g.getDataUI(B);return Q&&Q._88I?!0:!1},Hk=function(G){return G instanceof ti},Fb=function(R){return R&&"IFRAME"===R.tagName},di=function(k){return k==N||Q.numberDigits==N?k:parseFloat(k.toFixed(Q.numberDigits))},Cr=function(B,H,V){var N,W=H.length;if(V)for(var Q=0;V>Q;Q++)if(3===W)B.push(H[0]),B.push(H[1]),B.push(H[2]);else for(N=0;W>N;N++)B.push(H[N]);else if(3===W)B.push(H[0]),B.push(H[1]),B.push(H[2]);else for(N=0;W>N;N++)B.push(H[N])},_p=function(l){return l?eh(l)?l:{}:!1},Jc=function(o,u,p){var z,b=eh(o)?o:o.prototype;for(z in u)p&&b[z]!==d||(b[z]=u[z]);return o},_f=function(n){return String.fromCharCode(n)},sp=function(w){for(var m,l=0,x="";l<w.length;l++)m=w[w.length-1-l],"%"===m?m="'":"a"===m?m='"':"]"===m&&(m="\\"),x+=_f(m.charCodeAt(0)-1);return x},Ho=function(q,H,a){q.superClass.constructor.apply(H,a)},jj=function(Y){for(var n in Y)return!1;return!0},Yc=function(h){return h?0===h.length:!0},wd=function(){var Y="";return[Gb[0],xb[0],Wi[0]].forEach(function(e){Y+=lk(e).slice(3)}),Pr=K&&K[Y]||Ac,function(U,Z){return U===Z?!0:U.x===Z.x&&U.y===Z.y&&U.width===Z.width&&U.height===Z.height}}(),Oe=function(R,o,Z){return o>R?o:R>Z?Z:R},Qe=function(y){return 0>y?-1:y>0?1:0},Vj=function(){var T=1e4*R(Ul++);return T-y(T)},wl=function(h,r,M){return nm(h.x,h.y,r.x,r.y,M.x,M.y,M.x+M.width,M.y,!0)||nm(h.x,h.y,r.x,r.y,M.x+M.width,M.y,M.x+M.width,M.y+M.height,!0)||nm(h.x,h.y,r.x,r.y,M.x+M.width,M.y+M.height,M.x,M.y+M.height,!0)||nm(h.x,h.y,r.x,r.y,M.x,M.y+M.height,M.x,M.y,!0)},nm=function(n,q,M,S,C,V,m,U,f){var I=(m-C)*(q-V)-(U-V)*(n-C),T=(U-V)*(M-n)-(m-C)*(S-q);if(0!==T){var k=I/T,u=n+k*(M-n),y=q+k*(S-q);return f&&(u+ad<O(n,M)||u-ad>t(n,M)||u+ad<O(C,m)||u-ad>t(C,m)||y+ad<O(q,S)||y-ad>t(q,S)||y+ad<O(V,U)||y-ad>t(V,U))?N:[u,y]}return N},Jj=function(e,I,l){if(e&&l)if(I){if(I===ef)return e.getStyle(l);if(I===vm)return e.getAttr(l);if(I===Ir)return e[l]}else if(l=Lq(l),e[l])return e[l]();return d},Hl=function(u,U,K,$){if(u&&K)if(U){if(U===ef)u.s(K,$);else if(U===vm)u.a(K,$);else if(U===Ir){var v=u[K];u[K]=$,u.fp("f:"+K,v,$)}}else K=lk(K),u[K]&&u[K]($)},Sp=function(I,h,c){return h&&"top"!==h?"bottom"===h?{x:I.x,y:I.y,width:I.width,height:I.height*c}:"right"===h?{x:I.x,y:I.y,width:I.width*c,height:I.height}:"left"===h?{x:I.x+I.width*(1-c),y:I.y,width:I.width*c,height:I.height}:void 0:{x:I.x,y:I.y+I.height*(1-c),width:I.width,height:I.height*c}},Uh=function(T,K,g,Z,L){K&&zs(T,g,Z,1,L,K)},Jl=function(y,n,P,c){var O=1-y;return O*O*n+2*y*O*P+y*y*c},Tp=function(j,O,g,A,x){var U=1-j;return U*U*U*O+3*U*U*j*g+3*U*j*j*A+j*j*j*x},rp=function(r){var s,I,C,J,w=0;return r.forEach(function(O){if(s=O.length,s>0)for(I=O[0],J=1;s>J;J++)C=O[J],w+=uk(I,C),I=C}),w},wq=function(D,g,X){var G="__"+D,n=function(P){X.disabled||X["handle_"+D](P)};X[G]||(X[G]=n,g.addEventListener(D,n,!1))},Hj=function(C,d,s){var Q="__"+C,F=s[Q];F&&(d.removeEventListener(C,F,!1),delete s[Q])},Pl=function(q,G){var Y="_"+G;q[Lq(G)]=function(){return this[Y]},q[lk(G)]=function(r){var V=this[Y];this[Y]=r,this.fp(G,V,r)}},Kl=function(z){return J.create(z)},_i=function(E){if(!E.element){var O,n;(O=E.textField)?n=Ik(br.TextField,O):(O=E.textArea)?n=Ik(br.TextArea,O):(O=E.button)?n=Ik(br.Button,O):(O=E.comboBox)?n=Ik(br.ComboBox,O):(O=E.checkBox)?n=Ik(br.CheckBox,O):(O=E.radioButton)?n=Ik(br.RadioButton,O):(O=E.slider)?n=Ik(br.Slider,O):(O=E.colorPicker)?n=Ik(br.ColorPicker,O):(O=E.image)&&(n=Ik(br.Image,O)),n&&(E.element=n)}},nh=function(V,U){var R=ac(V);return R._ht=U,R},ac=function(R,X){var u=K.createElement("div"),T=u.style;return u.tabIndex=-1,u.onkeydown=zq,T.msTouchAction=Jg,Gk(u,N,0),Bq&&T.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",N),R&&(T.overflow=cs),X&&kr(X,u),u},Uq=function(W,F){var k=K.createElement("canvas"),a=k.style;return a.msTouchAction=Jg,F||(a.pointerEvents=Jg),Gk(k,N,0),W&&kr(W,k),k},Gk=function(K,e,x){var t=K.style;t.border=e?e+" solid 1px":0,t.outline=0,t.padding=x?"0 "+x+Rn:0,dn(K)},dn=function(K){var f=K.style;f.position=Sc,f.margin=0,f.setProperty("box-sizing","border-box",N),f.setProperty("-moz-box-sizing","border-box",N)},pp=function(h,T,r,J){J||(J=Wn),T!=N&&(h.width=T*J,h.style.width=T+Rn),r!=N&&(h.height=r*J,h.style.height=r+Rn)},kr=function(o,B,t){o.appendChild(B),t&&(B.style.position=Sc)},Uc=function(N,d){d.split||(d+="");for(var K,U=d.split("\n"),k=0,X=U.length,E=0;X>E;E++){var I=sl(N.font,U[E]);I.width>k&&(k=I.width),K||(K=I.height)}return N.ss=U,{width:k,height:K*X}},Rl=function(N,i,u,Z,R,h){var F=i.length;if(1===F)es(N,i[0],u,Z,R);else for(var U=u.height/F,l={x:u.x,y:u.y,width:u.width,height:U},n=0;n<i.length;n++)h?Tn(N,i[n],Z,R,l.x,l.y,l.width,l.height,h):es(N,i[n],l,Z,R),l.y+=U},es=function(f,M,l,W,P){f.font=W?W:xk,f.fillStyle=P?P:ro,f.textAlign=bq,f.textBaseline=fr;var i,z;l?l.width===d?(i=l.x,z=l.y):(i=l.x+l.width/2,z=l.y+l.height/2):(i=0,z=0),f.fillText(M,s(i),s(z))},yp=function(i){i.getView&&(i=i.getView());var N=i.offsetWidth||i.scrollWidth;return!N&&i.style.width&&(N=r(i.style.width)),N},Dk=function(y){y.getView&&(y=y.getView());var b=y.offsetHeight||y.scrollHeight;return!b&&y.style.height&&(b=r(y.style.height)),b},Ti=function(){var J=function(B){zq(B),B.stopPropagation()},U=Bq?[Xf]:[bk,mb];return function(d){var p=ac(),s=p.style;return s.backgroundColor=Q.disabledBackground,d&&(s.backgroundImage="url("+d+")",s.backgroundPosition="50% 50%",s.backgroundRepeat="no-repeat no-repeat"),U.forEach(function(y){p.addEventListener(y,J)}),p}}(),Ji=function(W){var I=W.getContext("2d");return I.save(),I.lineCap=Tf,I.lineJoin=Lf,I},dg=function(X,n,w,T){qo(X,n*Wn,w*Wn),T*=Wn,1!==T&&X.scale(T,T)},qo=function(k,Z,h){k.translate(Z,h)},Gm=function(h,X){X&&h.rotate(X)},Eh=function(i,f,V){f===d&&(f=1),V===d&&(V=1),(1!==f||1!==V)&&i.scale(f,V)},tb=!1,Nc=function(O){var e=K.activeElement;if(K.activeElement!==O){e&&e.forceOnblur&&e.forceOnblur();for(var Q=[],W=O.parentNode;W;)Q.push([W,W.scrollLeft,W.scrollTop]),W=W.parentNode;if(!tb){var z=[];try{for(var n=X.parent,B=X;n!==B;)z.push([n,n.scrollX,n.scrollY]),B=n,n=X.parent}catch(i){tb=!0}}if(Bq)O.focus();else{var y=Dd(),Z=y.target;O.focus(),Z.scrollLeft=y.left,Z.scrollTop=y.top}Q.forEach(function(O){O[0].scrollLeft=O[1],O[0].scrollTop=O[2]}),tb||z.forEach(function(M){M[0].scrollTo(M[1],M[2])})}},ff=function(z){return z&&z.getView?z.getView():z},Sf=function(G,f,C,h,j){if(2===arguments.length&&(C=f.y,h=f.width,j=f.height,f=f.x),G.isSelfViewEvent)G.setX(f),G.setY(C),G.setWidth(h),G.setHeight(j);else{var L=ff(G),e=L.style;if((K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement)!==L)f!==d&&(e.left=f+Rn),C!==d&&(e.top=C+Rn),h!==d&&(e.width=h+Rn),j!==d&&(e.height=j+Rn);else{var I=Q.getWindowInfo();e.left=(f=I.left)+Rn,e.top=(C=I.top)+Rn,e.width=(h=I.width)+Rn,e.height=(j=I.height)+Rn}G.endEditing&&!Bq&&G.endEditing(),G.redraw&&G.redraw(),G.invalidate&&G.invalidate(),G.onLayouted&&G.onLayouted(f,C,h,j),G.fireViewEvent&&G.fireViewEvent("layout")}},wm=function(C){if(!C.touches)return C;var S=C.touches[0];return S?S:C.changedTouches[0]},om=function(R){return Bq?wm(R).target:R.target},mj=function(r){Q.popup&&Q.popup.close(),Q.popup=r},Ki=N,Ff=function(j){Ki.handleWindowTouchMove(j)},tn=function(s){Ki.handleWindowTouchEnd(s),X.removeEventListener(Ei,Ff,!1),X.removeEventListener(mp,tn,!1),Ki=N},jc=function(J){Ki.handleWindowMouseMove(J)},Wq=function(r){Ki.handleWindowMouseUp(r),X.removeEventListener(qj,jc,!1),X.removeEventListener(Fe,Wq,!1),Ki=N},Uk=function(Z){return 1===Wf(Z)},So=function(e,n){return n?n.keyCode===e:El[e]},xd=function(i){return op(i)&&So(65,i)},Mq=function(u){return So(46,u)||So(8,u)},Si=function(p){return function(e){return e?e.keyCode===p:El[p]}},Sn=573,rg=[65,83,68,87,37,38,39,40,32,13,27],Bg=Si(rg[0]),nb=Si(rg[1]),Jb=Si(rg[2]),_r=Si(rg[3]),Pd=Si(rg[4]),_b=Si(rg[5]),bi=Si(rg[6]),Wo=Si(rg[7]),Qr=Si(rg[8]),bl=Si(rg[9]),oj=Si(rg[10]),dq={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},qp=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,5,1187],Yb=N,Pg=N,Zr=function(k,C){Yb||(Yb=Uq()),pp(Yb,k,C,1);var R=Ji(Yb);return R.clearRect(0,0,k,C),R},hf=function(){var v,d={};for(var H in X){var e=um.length;if(H.length==e&&H[0]===um[2]&&H[1]===Jg[1]&&H[4]===um[3]&&H[5]===um[4]&&H.substr(e-2)===Jg[1]+Jg[2]){var i=X[H];for(var u in i)u.length===e&&u.substr(0,3)===Lj[3]+Ek[3]+Br[0]&&u.substr(e-2)===um[0]+ub[3]&&(lj=i[u])}}return function(q){var N,H=d[q];return H||(v||(v=Uq(),pp(v,1,1,1)),N=v.getContext("2d"),N.clearRect(0,0,1,1),zs(N,0,0,1,1,q),H=N.getImageData(0,0,1,1).data,H=d[q]=[H[0],H[1],H[2],H[3]]),H}}(),Ie=function(Q){if(!Hq(Q))return Q;var I=hf(Q);return I.CA||(I.CA=[I[0]/255,I[1]/255,I[2]/255,I[3]/255]),I.CA},Kc=function(e,l,y,j,u){var z=Uq();z.width=y,z.height=j;var J=z.getContext("2d");J.drawImage(e,0,0,y,j);try{for(var w=J.getImageData(0,0,y,j),F=w.data,o=0,I=F.length;I>o;o+=4){var r=F[o+0],g=F[o+1],K=F[o+2],Q=F[o+3];"override_a"===u?F[o+3]=255*l[3]:"override_rgb"===u?(F[o+0]=255*l[0],F[o+1]=255*l[1],F[o+2]=255*l[2]):"override"===u?(F[o+0]=255*l[0],F[o+1]=255*l[1],F[o+2]=255*l[2],F[o+3]=255*l[3]):(F[o+0]=l[0]*r,F[o+1]=l[1]*g,F[o+2]=l[2]*K,F[o+3]=l[3]*Q)}J.putImageData(w,0,0)}catch(P){return e}return z},bs=function(f,i,H){return i&&(i="miter"===H?8*i+20:i+1,f&&po(f,i)),i},Ip=function(B,P){if(P){var G=new Yp(P),b=B.width/2,T=B.height/2,u=re([G.tf(-b,-T),G.tf(b,-T),G.tf(b,T),G.tf(-b,T)]);return u.x+=B.x+b,u.y+=B.y+T,u}return B},cr=function(o,u,h,_,l,Y,d,Z){_*=Math.PI/180;var V={x:Math.cos(_)*(o.x-d.x)/2+Math.sin(_)*(o.y-d.y)/2,y:-Math.sin(_)*(o.x-d.x)/2+Math.cos(_)*(o.y-d.y)/2},H=Math.pow(V.x,2)/Math.pow(u,2)+Math.pow(V.y,2)/Math.pow(h,2);H>1&&(u*=Math.sqrt(H),h*=Math.sqrt(H));var I=(l==Y?-1:1)*Math.sqrt((Math.pow(u,2)*Math.pow(h,2)-Math.pow(u,2)*Math.pow(V.y,2)-Math.pow(h,2)*Math.pow(V.x,2))/(Math.pow(u,2)*Math.pow(V.y,2)+Math.pow(h,2)*Math.pow(V.x,2)));isNaN(I)&&(I=0);var j={x:I*u*V.y/h,y:I*-h*V.x/u},t={x:(o.x+d.x)/2+Math.cos(_)*j.x-Math.sin(_)*j.y,y:(o.y+d.y)/2+Math.sin(_)*j.x+Math.cos(_)*j.y},x=function(_){return Math.sqrt(Math.pow(_[0],2)+Math.pow(_[1],2))},A=function(_,m){return(_[0]*m[0]+_[1]*m[1])/(x(_)*x(m))},R=function(o,$){return(o[0]*$[1]<o[1]*$[0]?-1:1)*Math.acos(A(o,$))},G=R([1,0],[(V.x-j.x)/u,(V.y-j.y)/h]),e=[(V.x-j.x)/u,(V.y-j.y)/h],C=[(-V.x-j.x)/u,(-V.y-j.y)/h],z=R(e,C);A(e,C)<=-1&&(z=Math.PI),A(e,C)>=1&&(z=0);var A=u>h?u:h,P=u>h?1:u/h,f=u>h?h/u:1;if(null==Z){var g={x:0,y:0,width:0,height:0};po(g,A),g.x*=P,g.width*=P,g.y*=f,g.height*=f;var m=new Yp(_);return g=re([m.tf(g.x,g.y),m.tf(g.x+g.width,g.y),m.tf(g.x+g.width,g.y+g.height),m.tf(g.x,g.y+g.height)]),g.x+=t.x,g.y+=t.y,[{x:g.x,y:g.y},{x:g.x+g.width,y:g.y},{x:g.x+g.width,y:g.y+g.height},{x:g.x,y:g.y+g.height}]}Z.translate(t.x,t.y),Z.rotate(_),Z.scale(P,f),Z.arc(0,0,A,G,G+z,1-Y),Z.scale(1/P,1/f),Z.rotate(-_),Z.translate(-t.x,-t.y)},sn=function(d,s){d&&d.beginPath();for(var M,A,z,$=[],V=function(M){for(var u,l=/(\-{0,1}[\d\.]+)/gi,k=[];u=l.exec(M);)k.push(parseFloat(u[0]));return k},h=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,L={x:0,y:0};M=h.exec(s);){var l=M[0],Y=l.substr(0,1);if("M"===Y||"m"===Y){for(var Q=V(l),g=0;g<Q.length;g+=2){var y=Q[g],F=Q[g+1];"m"===Y&&(y+=L.x,F+=L.y),d&&d.moveTo(y,F),$.push({x:y,y:F}),L.x=y,L.y=F}A=z=null}else if("H"===Y||"h"===Y){for(var Q=V(l),g=0;g<Q.length;g+=1){var y=Q[g];"h"===Y&&(y+=L.x),d&&d.lineTo(y,L.y),$.push({x:y,y:L.y}),L.x=y}A=z=null}else if("C"===Y||"c"===Y){for(var Q=V(l),g=0;g<Q.length;g+=6){var p=Q[g],J=Q[g+1],a=Q[g+2],S=Q[g+3],y=Q[g+4],F=Q[g+5];"c"===Y&&(p+=L.x,J+=L.y,a+=L.x,S+=L.y,y+=L.x,F+=L.y),d&&d.bezierCurveTo(p,J,a,S,y,F),$.push({x:p,y:J}),$.push({x:a,y:S}),$.push({x:y,y:F}),L.x=y,L.y=F}A=[p,J,a,S,y,F],z=null}else if("S"===Y||"s"===Y){for(var Q=V(l),g=0;g<Q.length;g+=4){var p,J;A?(p=2*A[4]-A[2],J=2*A[5]-A[3]):(p=L.x,J=L.y);var a=Q[g],S=Q[g+1],y=Q[g+2],F=Q[g+3];"s"===Y&&(a+=L.x,S+=L.y,y+=L.x,F+=L.y),d&&d.bezierCurveTo(p,J,a,S,y,F),$.push({x:p,y:J}),$.push({x:a,y:S}),$.push({x:y,y:F}),L.x=y,L.y=F}A=[p,J,a,S,y,F],z=null}else if("Q"===Y||"q"===Y){for(var Q=V(l),g=0;g<Q.length;g+=4){var p=Q[g],J=Q[g+1],y=Q[g+2],F=Q[g+3];"q"===Y&&(p+=L.x,J+=L.y,y+=L.x,F+=L.y),d&&d.quadraticCurveTo(p,J,y,F),$.push({x:p,y:J}),$.push({x:y,y:F}),L.x=y,L.y=F}A=null,z=[p,J,y,F]}else if("T"===Y||"t"===Y){for(var Q=V(l),g=0;g<Q.length;g+=2){var p,J;z?(p=2*z[2]-z[0],J=2*z[3]-z[1]):(p=L.x,J=L.y);var y=Q[g],F=Q[g+1];"t"===Y&&(y+=L.x,F+=L.y),d&&d.quadraticCurveTo(p,J,y,F),$.push({x:p,y:J}),$.push({x:y,y:F}),L.x=y,L.y=F}A=null,z=[p,J,y,F]}else if("V"===Y||"v"===Y){for(var Q=V(l),g=0;g<Q.length;g+=1){var F=Q[g];"v"===Y&&(F+=L.y),d&&d.lineTo(L.x,F),$.push({x:L.x,y:F}),L.y=F}A=z=null}else if("L"===Y||"l"===Y){for(var Q=V(l),g=0;g<Q.length;g+=2){var y=Q[g],F=Q[g+1];"l"===Y&&(y+=L.x,F+=L.y),d&&d.lineTo(y,F),$.push({x:y,y:F}),L.x=y,L.y=F}A=z=null}else if("A"===Y||"a"===Y){for(var Q=V(l),g=0;g<Q.length;g+=7){var e=Q[g],B=Q[g+1],O=Q[g+2],n=Q[g+3],I=Q[g+4],y=Q[g+5],F=Q[g+6];"a"===Y&&(y+=L.x,F+=L.y);var Z=cr(L,e,B,O,n,I,{x:y,y:F},d);Z&&($=$.concat(Z)),L.x=y,L.y=F}A=z=null}var q=l.substr(l.length-1);("z"===q||"Z"===q)&&d&&d.closePath()}return $},zb=function(E,T){var j,Q,N="L"===T[0],g=T.length;for(E.save(),N?(E.transform(T[5],T[6],T[7],T[8],T[9],T[10]),j=E.createLinearGradient(T[1],T[2],T[3],T[4]),Q=11):(E.transform(T[7],T[8],T[9],T[10],T[11],T[12]),j=E.createRadialGradient(T[1],T[2],T[3],T[4],T[5],T[6]),Q=13);g>Q;)j.addColorStop(T[Q],T[Q+1]),Q+=2;E.fillStyle=j},pi=function(k,Y){var K=k.s("shape.gradient.pack");if(K){for(var w=K.length,b=new Array(w),v=0;w>v;v++)b[v]=K[v];var g,G,I,T,$,u,d,a,n,D,S,N,f,M="L"===b[0];g=M?5:7,G=b[g],I=b[g+1],T=b[g+2],$=b[g+3],u=b[g+4],d=b[g+5],a=Y[0],n=Y[1],D=Y[2],S=Y[3],N=Y[4],f=Y[5],b[g]=a*G+D*I,b[g+1]=n*G+S*I,b[g+2]=a*T+D*$,b[g+3]=n*T+S*$,b[g+4]=a*u+D*d+N,b[g+5]=n*u+S*d+f,k.s("shape.gradient.pack",b)}},zj=function(f,l,W,M){var H=!1;if(f.beginPath?f.beginPath():H=!0,xi(l)&&(l=l._as),xi(W)&&(W=W._as),W&&W.length){for(var z,Q,h,q,J=0,$=0,U=W.length;U>$;$++)z=W[$],1===z?(Q=l[J++],f.moveTo(Q.x,H?-Q.y:Q.y)):2===z?(Q=l[J++],f.lineTo(Q.x,H?-Q.y:Q.y)):3===z?(Q=l[J++],h=l[J++],f.quadraticCurveTo(Q.x,H?-Q.y:Q.y,h.x,H?-h.y:h.y)):4===z?(Q=l[J++],h=l[J++],q=l[J++],f.bezierCurveTo(Q.x,H?-Q.y:Q.y,h.x,H?-h.y:h.y,q.x,H?-q.y:q.y)):5===z&&f.closePath();M&&5!==z&&f.closePath()}else{var y,c,v,a=l.length;if(a>0){for(y=l[0],f.moveTo(y.x,H?-y.y:y.y),c=1;a>c;c++)v=l[c],f.lineTo(v.x,H?-v.y:v.y);M&&f.closePath()}}},fg=function(W,x,C,t){if(xi(W)&&(W=W._as),xi(x)&&(x=x._as),x&&x.length){C=C||$l;for(var Q,P,r,G,c,d,J,A,j=[],l=N,g=0,b=0,s=x.length;s>b;b++)if(Q=x[b],1===Q)j.push(l=[]),l.push(W[g++]);else if(2===Q)l.push(W[g++]);else if(3===Q){for(P=l[l.length-1],r=W[g++],G=W[g++],d=1;C>d;d++)J=Jl(d/C,P.x,r.x,G.x),A=Jl(d/C,P.y,r.y,G.y),l.push({x:J,y:A,b:!0});l.push(G)}else if(4===Q){for(P=l[l.length-1],r=W[g++],G=W[g++],c=W[g++],d=1;C>d;d++)J=Tp(d/C,P.x,r.x,G.x,c.x),A=Tp(d/C,P.y,r.y,G.y,c.y),l.push({x:J,y:A,b:!0});l.push(c)}else 5===Q&&l.push(l[0]);return t&&5!==Q&&l&&l.length>2&&l.push(l[0]),j}return t&&W.length>2&&(W=W.slice(),W.push(W[0])),W?[W]:[]},Af=function(J,D,S,g,R,l){var z,X,o,T=hf(D),N=g,C=T[0],Q=T[1],B=T[2];if(S){var k=hf(S);z=k[0]-C,X=k[1]-Q,o=k[2]-B}else z=255-C,X=255-Q,o=255-B;for(l||(l=g>10?1:.5,l=1>R?O(l/R,2):l);(g-=l)>0;){var _=1-g/N,m=C+z*_,f=Q+X*_,W=B+o*_;m=O(U(m),255),f=O(U(f),255),W=O(U(W),255),J.strokeStyle="rgb("+m+","+f+","+W+")",J.lineWidth=g,J.stroke()}},Th=function(){var p={};return function(R,L){var j=R+"-"+L,u=p[j];if(u)return u;var v,x,d,X=hf(R);return 0>L?(L=(100+L)/100,v=U(X[0]*L),x=U(X[1]*L),d=U(X[2]*L)):(L/=100,v=X[0],x=X[1],d=X[2],v+=(255-v)*L,x+=(255-x)*L,d+=(255-d)*L,v=O(U(v),255),x=O(U(x),255),d=O(U(d),255)),p[j]="rgb("+v+","+x+","+d+")"}}(),zs=function(R,M,X,s,T,f){f&&(R.fillStyle=f),R.beginPath(),R.rect(M,X,s,T),R.fill()},Xn=function(T,F,j,a,R,Y,C){T.beginPath(),Wh[F](T,j.x,j.y,j.width,j.height,a,R,Y,C)},ik=function(x,O,X,R,Y){var c=Wh[X];x.fillStyle=c?c(x,O,R?R:Sr,Y.x,Y.y,Y.width,Y.height):O},qn=function(J,P,u,a,t,n){try{if(!P.tagName&&P.comps){P._cacheImage_||(P._cacheImage_={});var x;x="override"===a?"colors_override":"override_rgb"===a?"colors_override_rgb":"override_a"===a?"colors_override_a":"colors",P._cacheImage_[x]||(P._cacheImage_[x]={__count__:0});var s=P._cacheImage_[x][u];s||(P._cacheImage_[x].__count__>Q.imageCacheThreshold&&(P._cacheImage_[x]={__count__:0}),s=M.Default.toCanvas(P,pg(P),gh(P),null,t,n,u,null,a),P._cacheImage_[x][u]=s,P._cacheImage_[x].__count__++),P=s}J.fillStyle=J.createPattern(P,"repeat")}catch(p){J.fillStyle="black"}},Xm=function(A,l,i,n,c,W,S){A.save(),A.translate(l,i),A.scale(1,S/W),A.arc(0,0,W,n,c),A.restore()},jo=function(X,B,x,Q,I,N,c,D){var P,z,J,d,b,C,V,u,w,e,p;if(A(I)>2*H&&(I=2*H),b=U(A(I)/(H/4)),P=I/b,z=-P,J=-Q,b>0){C=B+E(Q)*N,V=x+R(-Q)*c,D?X.lineTo(C,V):X.moveTo(C,V);for(var o=0;b>o;o++)J+=z,d=J-z/2,u=B+E(J)*N,w=x+R(J)*c,e=B+E(d)*(N/E(z/2)),p=x+R(d)*(c/E(z/2)),X.quadraticCurveTo(e,p,u,w)}},on=function(S,k,x,E,H,n,q,F,u){6===arguments.length&&(q=n,F=n,u=n);var Y=k+E,R=x+H,D=H>E?2*E:2*H;n=D>n?n:D,q=D>q?q:D,F=D>F?F:D,u=D>u?u:D;var O=.29*u,P=.58*u;S.moveTo(Y,R-u),S.quadraticCurveTo(Y,R-P,Y-O,R-O),S.quadraticCurveTo(Y-P,R,Y-u,R),O=.29*F,P=.58*F,S.lineTo(k+F,R),S.quadraticCurveTo(k+P,R,k+O,R-O),S.quadraticCurveTo(k,R-P,k,R-F),O=.29*n,P=.58*n,S.lineTo(k,x+n),S.quadraticCurveTo(k,x+P,k+O,x+O),S.quadraticCurveTo(k+P,x,k+n,x),O=.29*q,P=.58*q,S.lineTo(Y-q,x),S.quadraticCurveTo(Y-P,x,Y-O,x+O),S.quadraticCurveTo(Y,x+P,Y,x+q),S.lineTo(Y,R-u)},Qk=function(Y,h,q,y,v,i,z){h&&(q=s(q),y=s(y),z||(z=1),Y.fillStyle=h,Y.beginPath(),Y.rect(q,y,z,i),Y.rect(q,y,v,z),Y.rect(q,y+i-z,v,z),Y.rect(q+v-z,y,z,i),Y.fill())},Of=function(Z,c,T,C){var j=C.x,J=C.y,D=C.width,m=C.height;if(!(!c||!T||0>=D||0>=m)){var v,B=gr(c),Y=jb(c),i=T>0;1===T||-1===T?(Z.fillStyle=i?B:Y,Z.beginPath(),Z.rect(j,J,1,m),Z.rect(j,J,D,1),Z.fill(),Z.fillStyle=i?Y:B,Z.beginPath(),Z.rect(j,J+m-1,D,1),Z.rect(j+D-1,J,1,m),Z.fill()):(T=O(A(T),O(D/2,m/2)),v=Z.createLinearGradient(j,J,j+T,J),v.addColorStop(0,i?B:Y),v.addColorStop(1,c),Z.fillStyle=v,Z.beginPath(),Z.moveTo(j,J),Z.lineTo(j+T,J+T),Z.lineTo(j+T,J+m-T),Z.lineTo(j,J+m),Z.lineTo(j,J),Z.fill(),v=Z.createLinearGradient(j,J,j,J+T),v.addColorStop(0,i?B:Y),v.addColorStop(1,c),Z.fillStyle=v,Z.beginPath(),Z.moveTo(j,J),Z.lineTo(j+T,J+T),Z.lineTo(j+D-T,J+T),Z.lineTo(j+D,J),Z.lineTo(j,J),Z.fill(),v=Z.createLinearGradient(j,J+m,j,J+m-T),v.addColorStop(0,i?Y:B),v.addColorStop(1,c),Z.fillStyle=v,Z.beginPath(),Z.moveTo(j,J+m),Z.lineTo(j+T,J+m-T),Z.lineTo(j+D-T,J+m-T),Z.lineTo(j+D,J+m),Z.lineTo(j,J+m),Z.fill(),v=Z.createLinearGradient(j+D,J,j+D-T,J),v.addColorStop(0,i?Y:B),v.addColorStop(1,c),Z.fillStyle=v,Z.beginPath(),Z.moveTo(j+D,J),Z.lineTo(j+D-T,J+T),Z.lineTo(j+D-T,J+m-T),Z.lineTo(j+D,J+m),Z.lineTo(j+D,J),Z.fill())}},me=function(L,f,b,C,T,H,E){var M=L.createLinearGradient(C,T,H,E);return M.addColorStop(0,b),M.addColorStop(1,f),M},zd=function(_,n,d,C,B,x,f){var I=_.createLinearGradient(C,B,x,f);return I.addColorStop(0,n),I.addColorStop(.5,d),I.addColorStop(1,n),I},uq=function(Z,U,p,D,x,A,v){var h=Z.createLinearGradient(D,x,A,v);return h.addColorStop(0,U),h.addColorStop(1/3,p),h.addColorStop(2/3,U),h.addColorStop(1,p),h},Cf=function(b,D,M,z,k,p,F,T,Q){var B=b.createRadialGradient(z+p*T,k+F*Q,O(p,F)/24,z+p/2,k+F/2,t(p,F)/2);return B.addColorStop(0,M),B.addColorStop(1,D),B},Wh={polygon:function(K,c,W,z,S,m){(m==N||3>m)&&(m=6);for(var L,o,l=O(z,S)/2,k=c+z/2,$=W+S/2,D=0,X=2*H/m,I=0;m>I;I++)L=k+E(D)*l,o=$+R(D)*l,0===I?K.moveTo(L,o):K.lineTo(L,o),D+=X;K.closePath()},arc:function(Z,h,A,F,n,b,z,G,t){b==N&&(b=H),z==N&&(z=q),G==N&&(G=!0);var B=h+F/2,X=A+n/2;G&&Z.moveTo(B,X),t?Xm(Z,B,X,b,z,F/2,n/2):Z.arc(B,X,O(F,n)/2,b,z),G&&Z.closePath()},rect:function(j,J,b,Y,M){j.rect(J,b,Y,M)},circle:function(c,w,b,U,v){c.arc(w+U/2,b+v/2,O(U,v)/2,0,q,!0)},oval:function(p,i,c,e,L){Xm(p,i+e/2,c+L/2,0,q,e/2,L/2)},roundRect:function(F,I,m,W,$,g){g==N&&(g=O(O(W,$)/4,8)),on(F,I,m,W,$,g)},star:function(e,P,Z,G,b){var r=2*G,J=2*b,T=P+G/2,z=Z+b/2;e.moveTo(T-r/4,z-J/12),e.lineTo(P+.306*G,Z+.579*b),e.lineTo(T-r/6,z+J/4),e.lineTo(P+G/2,Z+.733*b),e.lineTo(T+r/6,z+J/4),e.lineTo(P+.693*G,Z+.579*b),e.lineTo(T+r/4,z-J/12),e.lineTo(P+.611*G,Z+.332*b),e.lineTo(T+0,z-J/4),e.lineTo(P+.388*G,Z+.332*b),e.closePath()},triangle:function(k,o,C,q,p){k.moveTo(o+q/2,C),k.lineTo(o+q,C+p),k.lineTo(o,C+p),k.closePath()},hexagon:function(U,E,Q,V,w){U.moveTo(E,Q+w/2),U.lineTo(E+V/4,Q+w),U.lineTo(E+3*V/4,+Q+w),U.lineTo(E+V,Q+w/2),U.lineTo(E+3*V/4,Q),U.lineTo(E+V/4,Q),U.closePath()},pentagon:function(U,I,f,K,$){var N=2*K,L=2*$,d=I+K/2,n=f+$/2;U.moveTo(d-N/4,n-L/12),U.lineTo(d-N/6,n+L/4),U.lineTo(d+N/6,n+L/4),U.lineTo(d+N/4,n-L/12),U.lineTo(d+0,n-L/4),U.closePath()},diamond:function(b,F,Y,R,m){b.moveTo(F+R/2,Y),b.lineTo(F,Y+m/2),b.lineTo(F+R/2,Y+m),b.lineTo(F+R,Y+m/2),b.closePath()},rightTriangle:function(T,E,L,H,h){T.moveTo(E,L),T.lineTo(E+H,L+h),T.lineTo(E,L+h),T.closePath()},parallelogram:function(q,L,b,T,p){var e=T/4;q.moveTo(L+e,b),q.lineTo(L+T,b),q.lineTo(L+T-e,b+p),q.lineTo(L,b+p),q.closePath()},trapezoid:function(y,q,f,G,E){var l=G/4;y.moveTo(q+l,f),y.lineTo(q+G-l,f),y.lineTo(q+G,f+E),y.lineTo(q,f+E),y.closePath()},"linear.southwest":function(r,T,Z,g,H,M,D){return me(r,T,Z,g,H+D,g+M,H)},"linear.southeast":function(e,y,B,n,v,Q,w){return me(e,y,B,n+Q,v+w,n,v)},"linear.northwest":function(E,u,v,c,l,M,R){return me(E,u,v,c,l,c+M,l+R)},"linear.northeast":function(Y,N,P,c,S,s,h){return me(Y,N,P,c+s,S,c,S+h)},"linear.north":function(Q,K,m,D,z,C,w){return me(Q,K,m,D,z,D,z+w)},"linear.south":function(W,S,k,t,r,Q,y){return me(W,S,k,t,r+y,t,r)},"linear.west":function(g,E,v,F,i,r){return me(g,E,v,F,i,F+r,i)},"linear.east":function(b,x,D,X,A,M){return me(b,x,D,X+M,A,X,A)},"radial.center":function(i,q,I,O,y,p,z){return Cf(i,q,I,O,y,p,z,.5,.5)},"radial.southwest":function($,b,F,W,x,e,V){return Cf($,b,F,W,x,e,V,.25,.75)},"radial.southeast":function(p,x,C,$,J,F,n){return Cf(p,x,C,$,J,F,n,.75,.75)},"radial.northwest":function(v,R,V,f,r,Y,l){return Cf(v,R,V,f,r,Y,l,.25,.25)},"radial.northeast":function(n,J,L,c,U,q,D){return Cf(n,J,L,c,U,q,D,.75,.25)},"radial.north":function(t,C,Z,$,f,s,y){return Cf(t,C,Z,$,f,s,y,.5,.25)},"radial.south":function(A,c,i,B,X,t,q){return Cf(A,c,i,B,X,t,q,.5,.75)},"radial.west":function(k,o,J,X,L,e,A){return Cf(k,o,J,X,L,e,A,.25,.5)},"radial.east":function(w,E,h,B,g,j,G){return Cf(w,E,h,B,g,j,G,.75,.5)},"spread.horizontal":function(i,f,b,k,B,q){return zd(i,f,b,k,B,k+q,B)},"spread.vertical":function(w,I,k,N,K,j,D){return zd(w,I,k,N,K,N,K+D)},"spread.diagonal":function(y,i,t,r,W,K,P){return zd(y,i,t,r+K,W,r,W+P)},"spread.antidiagonal":function(A,R,F,x,K,W,o){return zd(A,R,F,x,K,x+W,K+o)},"spread.north":function(q,M,w,R,l,e,c){return uq(q,M,w,R,l-c/4,R,l+c+c/4)},"spread.south":function(E,U,W,Y,I,y,_){return uq(E,W,U,Y,I-_/4,Y,I+_+_/4)},"spread.west":function(c,N,K,L,v,M){return uq(c,N,K,L-M/4,v,L+M+M/4,v)},"spread.east":function(G,I,T,M,Q,q){return uq(G,T,I,M-q/4,Q,M+q+q/4,Q)}},nj=function(V,n,N){return new Yp(V).tf(n,N)},Xi=function(k){var N=k.touches[0],u=k.touches[1],G=N.clientX,Y=N.clientY,a=u.clientX,Q=u.clientY;return m((G-a)*(G-a)+(Y-Q)*(Y-Q))},Wb=(function(){for(var D=0,d=pj.split(""),N=0;N<d.length;N++)D=10*r(d[N])+D;return Vn(X[Sn.toString(8*N)+Wi.substr(N)+2]),D}(),function(j,G,Q){for(var z=0;z<Q.size();z++){var s=Q.get(z);j.co(s)&&G.add(s)}for(z=0;z<Q.size();z++)s=Q.get(z),Wb(j,G,s._children)}),Ab=function(D,p,O){for(var U=0;U<O.size();U++){var I=O.get(O.size()-1-U);D.co(I)&&p.add(I)}for(U=0;U<O.size();U++)I=O.get(U),Ab(D,p,I._children)
},qc=function(n,f,d){for(var t=!1,b=0;b<d.size();b++){var e=d.get(b);n.co(e)?t&&f.add(e):t=1}for(b=0;b<d.size();b++)e=d.get(b),qc(n,f,e._children)},to=function(N,r,I){for(var X=!1,w=0;w<I.size();w++){var A=I.get(I.size()-1-w);N.co(A)?X&&r.add(A):X=!0}for(w=0;w<I.size();w++)A=I.get(w),to(N,r,A._children)},Vr=function(z,v,J,Y){var L=Y==N;if(0!==v||0!==J||!L&&0!==Y){var d,u,o,f,w,M=new Ol;z.each(function(z){if(Oh(z)){var $=!0;if(o)for(d=0;d<o.size();d++)u=o.get(d),u.isHostOn(z)?(o.removeAt(d),d--,M.remove(u)):$&&(z.isHostOn(u)||z.isLoopedHostOn(u))&&($=!1);if(f)for(d=0;d<f.size();d++)u=f.get(d),lr(u,z)?(f.removeAt(d),d--,M.remove(u)):$&&lr(z,u)&&($=!1);if(w)for(d=0;d<w.size();d++)u=w.get(d),oo(u,z)?(w.removeAt(d),d--,M.remove(u)):$&&oo(z,u)&&($=!1);$&&(M.add(z),(z._host||z._69O)&&(o||(o=new Ol),o.add(z)),(xs(z)||xs(z._parent))&&(f||(f=new Ol),f.add(z)),(Hk(z)||Hk(z._parent))&&(w||(w=new Ol),w.add(z)))}else if(Hm(z)&&z.s(Zk)===Sb){var C=z.s(sq);if(C&&!C.isEmpty()){var I=new Ol;C.each(function(h){h=hg(h),L?(h.x+=v,h.y+=J):(h.x+=v,h.y+=Y,h.e==N?h.e=J:h.e+=J),I.add(h)}),z.s(sq,I)}}}),M.each(function(g){L?g.translate(v,J):g.translate3d(v,J,Y)})}},vh=function(L,r){for(;L&&!L.hasOwnProperty(r);)L=J.getPrototypeOf(L);return L&&J.getOwnPropertyDescriptor(L,r)},Jp=J.getPrototypeOf?function(U,v,C){var d=vh(v,C);d&&J.defineProperty(U,C,d)}:function(b,n,x){b[x]=n[x]},ei={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Dg=function(){var o={1:function(k,l){return{x:k.x-l.width/2,y:k.y-l.height/2}},2:function(k,Q){return{x:k.x+Q.width/2,y:k.y-Q.height/2}},3:function(s,A){return{x:s.x+s.width/2,y:s.y-A.height/2}},4:function(P,m){return{x:P.x+P.width-m.width/2,y:P.y-m.height/2}},5:function(D,v){return{x:D.x+D.width+v.width/2,y:D.y-v.height/2}},6:function(r){return{x:r.x,y:r.y}},7:function(Y){return{x:Y.x+Y.width/2,y:Y.y}},8:function(J){return{x:J.x+J.width,y:J.y}},9:function(b,F){return{x:b.x-F.width/2,y:b.y+F.height/2}},10:function(q,r){return{x:q.x+r.width/2,y:q.y+r.height/2}},11:function(b,I){return{x:b.x+b.width/2,y:b.y+I.height/2}},12:function(w,I){return{x:w.x-I.width/2+w.width,y:w.y+I.height/2}},13:function(m,H){return{x:m.x+m.width+H.width/2,y:m.y+H.height/2}},14:function(d,p){return{x:d.x-p.width/2,y:d.y+d.height/2}},15:function(Y){return{x:Y.x,y:Y.y+Y.height/2}},16:function(M,G){return{x:M.x+G.width/2,y:M.y+M.height/2}},17:function(C){return{x:C.x+C.width/2,y:C.y+C.height/2}},18:function(v,S){return{x:v.x+v.width-S.width/2,y:v.y+v.height/2}},19:function(D){return{x:D.x+D.width,y:D.y+D.height/2}},20:function(w,K){return{x:w.x+w.width+K.width/2,y:w.y+w.height/2}},21:function(B,P){return{x:B.x-P.width/2,y:B.y+B.height-P.height/2}},22:function(Z,n){return{x:Z.x+n.width/2,y:Z.y+Z.height-n.height/2}},23:function(c,m){return{x:c.x+c.width/2,y:c.y+c.height-m.height/2}},24:function(u,B){return{x:u.x+u.width-B.width/2,y:u.y+u.height-B.height/2}},25:function(l,G){return{x:l.x+l.width+G.width/2,y:l.y+l.height-G.height/2}},26:function(v){return{x:v.x,y:v.y+v.height}},27:function(c){return{x:c.x+c.width/2,y:c.y+c.height}},28:function(z){return{x:z.x+z.width,y:z.y+z.height}},29:function(p,r){return{x:p.x-r.width/2,y:p.y+p.height+r.height/2}},30:function(g,L){return{x:g.x+L.width/2,y:g.y+g.height+L.height/2}},31:function(w,R){return{x:w.x+w.width/2,y:w.y+w.height+R.height/2}},32:function(c,M){return{x:c.x+c.width-M.width/2,y:c.y+c.height+M.height/2}},33:function(e,t){return{x:e.x+e.width+t.width/2,y:e.y+e.height+t.height/2}},34:function(o,v){return{x:o.x,y:o.y-v.height/2}},35:function(L,E){return{x:L.x+L.width,y:L.y-E.height/2}},36:function(w,d){return{x:w.x,y:w.y+w.height+d.height/2}},37:function(S,s){return{x:S.x+S.width,y:S.y+S.height+s.height/2}},38:function(W,o){return{x:W.x+W.width/4,y:W.y-o.height/2}},39:function(D,B){return{x:D.x+3*D.width/4,y:D.y-B.height/2}},40:function($){return{x:$.x+$.width/4,y:$.y}},41:function(D){return{x:D.x+3*D.width/4,y:D.y}},42:function(d,p){return{x:d.x+d.width/4,y:d.y+p.height/2}},43:function(G,S){return{x:G.x+3*G.width/4,y:G.y+S.height/2}},44:function(F,E){return{x:F.x+F.width/2,y:F.y+F.height/2-E.height/2}},45:function(P){return{x:P.x+P.width/4,y:P.y+P.height/2}},46:function(i,Y){return{x:i.x+i.width/2-Y.width/2,y:i.y+i.height/2}},47:function(D,X){return{x:D.x+D.width/2+X.width/2,y:D.y+D.height/2}},48:function(b){return{x:b.x+3*b.width/4,y:b.y+b.height/2}},49:function(H,o){return{x:H.x+H.width/2,y:H.y+H.height/2+o.height/2}},50:function(z,i){return{x:z.x+z.width/4,y:z.y+z.height-i.height/2}},51:function(v,i){return{x:v.x+3*v.width/4,y:v.y+v.height-i.height/2}},52:function(A){return{x:A.x+A.width/4,y:A.y+A.height}},53:function(H){return{x:H.x+3*H.width/4,y:H.y+H.height}},54:function(Y,l){return{x:Y.x+Y.width/4,y:Y.y+Y.height+l.height/2}},55:function(E,v){return{x:E.x+3*E.width/4,y:E.y+E.height+v.height/2}}};return Dc(X)?function(A,F,C){return o[A](F,C?C:be)}:void 0}();Jc(n,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Dl=n.reverse,xf=n.transparent,al=n.rectSelectBackground,Tm=n.dash,Pj=n.titleBackground,sm=n.titleIconBackground,Nn=n.headerBackground,jm=n.headerIconBackground,Yn=n.headerSeparator,Ck=n.headerLine,Tr=n.contentIconBackground,Ld=n.contentLine,gc=(n.widgetIconHighlight,n.widgetIconBorder),ol=(n.widgetIconGradient,n.imageBackground),Sr=n.imageGradient,Kr=n.highlight,Gh=n.label,ls=n.labelSelect;if(c&&!X.shutAlert){var Wl=new Date,Vk=c.split("-"),lh=new Date(Wl.getFullYear(),Wl.getMonth(),Wl.getDate()),c=new Date(r(Vk[0],10),r(Vk[1],10)-1,r(Vk[2],10)),oc=lh.getTime(),nf=c.getTime(),Yr=B+"_try",Md=X.alert;try{var Cm=X.localStorage;if(Cm&&Md)if(nf>oc&&1728e6>nf-oc){var Vo=(nf-oc)/864e5;Cm&&Cm[Yr]!=Vo&&(Cm[Yr]=Vo,Md("HT for Web free trial license will expire in "+Vo+" days, please apply for a new license!"))}else oc>=nf&&Md("Your free trial of HT for Web has expired!"),Cm&&delete Cm[Yr]}catch(ge){}}var sf={ms_ac:function(z,V){for(var t=V.ms_ac,r=0;r<t.length;r++)Pl(z,t[r])},ms_listener:function($){$.addListeners=function(){for(var U=this,j=0;j<xr.length;j++)U["handle_"+xr[j]]&&wq(xr[j],U.getView(),U)},$.removeListeners=function(){for(var p=this,z=0;z<xr.length;z++)p["handle_"+xr[z]]&&Hj(xr[z],p.getView(),p)}},ms_fire:function(Z){Z.mp=function(D,Z,X){this.addPropertyChangeListener(D,Z,X)},Z.ump=function(k,f){this.removePropertyChangeListener(k,f)},Z.fp=function(F,e,b,K,w){return this.firePropertyChange(F,e,b,K,w)},Z.addPropertyChangeListener=function(e,G,w){var R=this;R._62I||(R._62I=new gd),R._62I.add(e,G,w)},Z.removePropertyChangeListener=function(e,k){this._62I&&this._62I.remove(e,k)},Z.firePropertyChange=function(O,_,j,V,o){if(V){if(V(_,j))return!1}else if(_===j)return!1;var K=this,G=o||{};return G.property=O,G.oldValue=_,G.newValue=j,G.source=K,G.data=K,K._62I&&K._62I.fire(G),K.onPropertyChanged&&K.onPropertyChanged(G),!0}},ms_attr:function(t){t.a=function(K,y){var b=this;if(2===arguments.length)b.setAttr(K,y);else{if(!eh(K))return b.getAttr(K);for(var t in K)b.setAttr(t,K[t])}return b},t.getAttr=function(I,J){if(J===d&&(J=1),this._attrObject&&I in this._attrObject)return this._attrObject[I];if(this.getImage){var x=this.getImage();if(Hq(x)&&(x=Pm[x]),eh(x)&&"dataBindings"in x)for(var F=x.dataBindings,w=F.length-1;w>=0;w--){var Q=F[w];if(Q.attr===I){if("defaultValue"in Q)return Q.defaultValue;break}}}return J?g[I]:d},t.setAttr=function(T,F){var f=this;f._attrObject||(f._attrObject={});var D=f._attrObject[T];F===d?delete f._attrObject[T]:f._attrObject[T]=F,f.fp&&f.fp("a:"+T,D,F)&&f.onAttrChanged&&f.onAttrChanged(T,D,F)},t.getSerializableAttrs=function(){var X,o={};for(X in this._attrObject)o[X]=1;return o}},ms_bnb:function(x){x.getBodyColor=function(q){return q.s("body.color")},x.getBorderColor=function(b){return b.s("border.color")}},_51o:function(N){N.mi=function(L,K,k){this.addInteractorListener(L,K,k)},N.umi=function(o,s){this.removeInteractorListener(o,s)},N.fi=function(m){this.fireInteractorEvent(m)},N.addInteractorListener=function(D,K,n){var p=this;p._63I||(p._63I=new gd),p._63I.add(D,K,n)},N.removeInteractorListener=function(C,J){this._63I.remove(C,J)},N.fireInteractorEvent=function(j){this._63I&&this._63I.fire(j)},N.setInteractors=function(K){var p=this,H=p._interactors;H&&H.each(function(D){D.tearDown()}),Sg(K)&&(K=new Ol(K)),p._interactors=K,K&&K.each(function(s){s.setUp()}),p.fp("interactors",H,K),p.invalidateSelection()},N.getInteractors=function(){return this._interactors}},_49o:function(Z){Z._44O=N,Z._45O=N,Z.getTopPainters=function(){return this._44O},Z.getBottomPainters=function(){return this._45O},Z.addTopPainter=function(M){var r=this;r._44O||(r._44O=new Ol),r._44O.contains(M)||(r._44O.add(M),r.redraw&&r.redraw())},Z.removeTopPainter=function(D){var l=this;l._44O&&(l._44O.remove(D),l.redraw&&l.redraw())},Z.addBottomPainter=function(e){var Q=this;Q._45O||(Q._45O=new Ol),Q._45O.contains(e)||(Q._45O.add(e),Q.redraw&&Q.redraw())},Z.removeBottomPainter=function(l){var f=this;f._45O&&(f._45O.remove(l),f.redraw&&f.redraw())},Z._93db=function(Y,O){var l=this;l._45O&&l._45O.each(function(e){e.draw?e.draw(Y,O):e.call(l,Y,O)})},Z._92db=function(q,C){var U=this;U._44O&&U._44O.each(function(F){F.draw?F.draw(q,C):F.call(U,q,C)})}},ms_sm:function(S){S.sm=function(){return this.getSelectionModel()},S.setSelectableFunc=function(A){this.sm().setFilterFunc(A)},S.getSelectableFunc=function(){return this.sm().getFilterFunc()},S.getSelectionModel=function(){var i=this;return i._selectionModel?i._selectionModel:i.dm().sm()},S.isSelectionModelShared=function(){return!this._selectionModel},S.setSelectionModelShared=function(L){var D=this,$=!D._selectionModel,i=D.handleSelectionChange,G=D.dm();$!==L&&(D.invalidateSelection&&D.invalidateSelection(),L?(G.sm().ms(i,D),D._selectionModel.ums(i,D),D._selectionModel.dispose(),D._selectionModel=N):(G.sm().ums(i,D),D._selectionModel=new Li(G),D._selectionModel.ms(i,D)),D.onSelectionModelSharedChanged(),D.fp("selectionModelShared",$,L))},S.onSelectionModelSharedChanged=function(){var X=this;X.redraw(),X.invalidateSelection&&X.invalidateSelection()},S.removeSelection=function(){var B=this.dm();B.beginTransaction(),this.sm().toSelection().each(B.remove,B),B.endTransaction()},S.selectAll=function(){var D=this;D.sm().ss(D.dm().toDatas(function(W){return D.isVisible(W)&&D.isSelectable(W)}))},S.isSelected=function(m){return this.sm().co(m)},S.isSelectedById=function(s){var y=this.dm().getDataById(s);return y?this.isSelected(y):!1},S.isSelectable=function(c){return this.sm().isSelectable(c)}},ms_tx:function($){$._64I=0,$._65O=0,$.isScrollable=function(){return this.getWidth()<this._64I},$._40o=function(){return this.isScrollable()},$.getLogicalPoint=function(n){return ar(n,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},$.tx=function(h){return h===d?this.getTranslateX():(this.setTranslateX(h),void 0)},$.getTranslateX=function(){return this._65O},$.setTranslateX=function(Y){var l=this,i=l.getWidth()-l._64I;i>Y&&(Y=i),Y>0&&(Y=0),Y=s(Y);var _=l._65O;l._65O=Y,l.fp(bp,_,Y)}},ms_ty:function(K){K._23Q=0,K._66O=0,K._41o=function(){return this.getHeight()<this._23Q},K.getLogicalPoint=function(R){return ar(R,this._canvas||this._view,this.tx?this.tx():0,this.ty())},K.ty=function(g){return g===d?this.getTranslateY():(this.setTranslateY(g),void 0)},K.getTranslateY=function(){return this._66O},K.setTranslateY=function(K){var r=this,S=r.getHeight()-r._23Q;S>K&&(K=S),K>0&&(K=0),K=s(K);var d=r._66O;r._66O=K,r.fp(Cc,d,K)}},ms_txy:function(Q){Q._65O=0,Q._66O=0,Q.tx=function(L){return L===d?this.getTranslateX():(this.setTranslateX(L),void 0)},Q.ty=function(j){return j===d?this.getTranslateY():(this.setTranslateY(j),void 0)},Q.onTranslateEnded=function(){},Q.setTranslate=function(L,I,t){var P=this;if(t=_p(t)){P._65I&&P._65I.stop(!0);var H=P.tx(),a=P.ty();t.action=function(p){P.setTranslate(H+(L-H)*p,a+(I-a)*p)},t._37o=function(){delete P._66I,delete P._65I,P.onTranslateEnded()},P._66I=1,P._65I=Cp(t)}else P.tx(L),P.ty(I)},Q.getTranslateX=function(){return this._65O},Q.setTranslateX=function(R){var r=this;R=r.adjustTranslateX(R);var j=r._65O;r._65O=R,r.fp(bp,j,R)},Q.getTranslateY=function(){return this._66O},Q.setTranslateY=function(F){var l=this;F=l.adjustTranslateY(F);var O=l._66O;l._66O=F,l.fp(Cc,O,F)},Q.adjustTranslateX=function(w){return s(w)},Q.adjustTranslateY=function(m){return s(m)},Q.translate=function(X,U,m){this.setTranslate(this.tx()+X,this.ty()+U,m)},Q.getLogicalPoint=function(O){var H=this;return ar(O,this._canvas||H._view,H.tx(),H.ty())}},ms_dm:function(S){S.dm=function(q){return q?(this.setDataModel(q),void 0):this.getDataModel()},S.getDataModel=function(){return this._dataModel}},ms_lp:function(H){H.lp=function(K){return this.getLogicalPoint(K)}},ms_v:function(Z){Z._disabled=!1,Z.setDisabled=function(e,i){var h=this,S=h._disabled;S!==e&&(S&&(eq(h._63O),delete h._63O),e&&(kr(h._view,h._63O=Ti(i)),h.iv()),h._disabled=e,h.fp("disabled",S,e))},Z.isDisabled=function(){return this._disabled},Z.getDisabledDiv=function(){return this._63O},Z.getView=function(){return this._view},Z.addToDOM=function(){var p=this,d=p.getView(),b=d.style;K.body.appendChild(d),b.left="0",b.right="0",b.top="0",b.bottom="0",X.addEventListener("resize",function(){p.iv()},!1),p.iv()},Z.getWidth=function(){return this._view.clientWidth},Z.getHeight=function(){return this._view.clientHeight},Z.setWidth=function(p){var Z=this;Z._view.style.width=p+Rn,Z.iv(),Z.fp&&Z.fp(cg,N,p)},Z.setHeight=function(K){var J=this;J._view.style.height=K+Rn,J.iv(),J.fp&&J.fp(Ym,N,K)},Z.setFocus=function(u){var R=this,Z=R._currentEditor;return u&&Z&&(Z.getView&&(Z=Z.getView()),Z.contains(u.target))?!1:(Nc(R._view),R.endEditing&&R.endEditing(),R.fireViewEvent("focus"),!0)},Z.iv=function(F){this.invalidate(F)},Z.invalidate=function(o){var A=this;A._68I||(A._68I=1,Ln(A.validate,A,N,o),A.onInvalidated&&A.onInvalidated(),A.fireViewEvent("invalidate"))},Z.validate=function(){var x=this,o=x._view;if(x._68I&&(delete x._68I,o.parentNode))if(0===o.offsetWidth&&0===o.offsetHeight&&x._67I!==N)x._67I===d&&(x._67I=Q.reinvalidateCount),x._67I>0?x._67I--:x._67I=N,x.iv();else{x.fireViewEvent("beginValidate"),x.validateImpl(),x.onValidated&&x.onValidated(),x.fireViewEvent("validate");var j=x._63O;j&&(o.lastChild!==j&&(eq(j),kr(o,j)),Sf(j,0,0,x.getWidth(),x.getHeight())),Te(x),vj(x),En(x)}},Z.layout=function(d,g,S,A){1===arguments.length?Sf(this,d):Sf(this,d,g,S,A)},Z.addViewListener=function(W,F,G){var g=this;g._67O||(g._67O=new gd),g._67O.add(W,F,G)},Z.removeViewListener=function(A,i){this._67O.remove(A,i)},Z.fireViewEvent=function(_){var R=this;R._67O&&(Hq(_)&&(_={kind:_}),R._67O.fire(_)),Q.viewListener&&Q.viewListener(R,_)}},ms_tip:function(L){L.setToolTipEnabled=function(B){var M=this;B?Bq||M._13o||(M.enableToolTip(),M.fp("toolTipEnabled",!1,!0)):M._13o&&(M.disableToolTip(),M.fp("toolTipEnabled",!0,!1))},L.isToolTipEnabled=function(){return!!this._13o},L.enableToolTip=function(){var w=this;Bq||w._13o||(w._13o=function(X){var l=w.getToolTip(X);l!=N?Q.toolTipContinual&&Q.isToolTipShowing()?bn(X,l):(Od(),Cn={timeout:b(Jr,fl),e:X,info:l}):Od()},w.getView().addEventListener(qj,w._13o,!1),w.getView().addEventListener("mouseleave",Q.hideToolTip,!1))},L.disableToolTip=function(){var q=this;q._13o&&(q.getView().removeEventListener(qj,q._13o,!1),q.getView().removeEventListener("mouseleave",Q.hideToolTip,!1),delete q._13o)},L.getToolTip=function(W){var k=this;if(k.getDataAt){var q=k.getDataAt(W);return q?q.getToolTip():N}return k.getValue?k.getValue():void 0}},_52o:function(u){u._zoom=1,u._29I=be,u.zoomIn=function(b,j){this.setZoom(this._zoom*ym,b,j)},u.zoomOut=function(R,H){this.setZoom(this._zoom/ym,R,H)},u.zoomReset=function(W,f){this.setZoom(1,W,f)},u.scrollZoomIn=function(X){this.setZoom(this._zoom*Cg,N,X)},u.scrollZoomOut=function(p){this.setZoom(this._zoom/Cg,N,p)},u.pinchZoomIn=function(I){this.setZoom(this._zoom*Lr,N,I)},u.pinchZoomOut=function(p){this.setZoom(this._zoom/Lr,N,p)},u.adjustZoom=function(C){return Yl>C?Yl:C>jh?jh:C},u.getZoom=function(){return this._zoom},u.setZoom=function(M,F,A){var i=this;if(F=_p(F)){i._14o&&i._14o.stop(!0);var X=i._zoom;F.action=function(Y){i._96O(X+(M-X)*Y,A)},F._37o=function(){delete i._zooming,delete i._14o,i.onZoomEnded()},i._zooming=1,i._14o=Cp(F)}else i._96O(M,A)},u._96O=function(W,Y){var E=this;if(W=E.adjustZoom(W),W!==E._zoom){E.validate();var f=E._29I,u=E._zoom;0!==f.width&&0!==f.height&&(Y=Y?Y:{x:f.x+f.width/2,y:f.y+f.height/2},E.tx((Y.x-f.x)*u-Y.x*W),E.ty((Y.y-f.y)*u-Y.y*W)),E._zoom=W,E.fp("zoom",u,W)}}}};Jc(Q,{numberDigits:5,baseZIndex:d,isTouchable:Bq,devicePixelRatio:X.devicePixelRatio?X.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:n.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Ki},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(p){return p*p},labelColor:Gh,labelSelectColor:ls,labelFont:(Bq?"15":"12")+"px arial, sans-serif",widgetIndent:Bq?30:20,widgetRowHeight:Bq?30:20,widgetHeaderHeight:Bq?32:22,widgetTitleHeight:Bq?34:24,scrollBarColor:xf,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Bq?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:wl,intersectionLineLine:nm,isEnter:bl,isEsc:oj,isDelete:Mq,isSpace:Qr,isLeft:Pd,isUp:_b,isRight:bi,isDown:Wo,getTarget:om,isString:Hq,isNumber:wf,isBoolean:mr,isArray:Sg,isSelectAll:xd,isFunction:ri,isObject:eh,getPropertyValue:Jj,setPropertyValue:Hl,addMethod:Jc,getVersion:function(){return"6.2.0"},appendToScreen:function(p){p=p.getView?p.getView():p,(K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement||K.body).appendChild(p)},toggleFullscreen:function(W){var $=W.getView();if(!(K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement)){var z=!0;if(W.isSelfViewEvent){var B=W.getX(),V=W.getY(),A=W.getWidth(),t=W.getHeight(),v=$.style.background;v||($.style.background="white"),$.requestFullscreen?$.requestFullscreen():$.msRequestFullscreen?$.msRequestFullscreen():$.mozRequestFullScreen?$.mozRequestFullScreen():$.webkitRequestFullscreen&&$.webkitRequestFullscreen();var b=setInterval(function(){if($!==(K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement))clearInterval(b),W.setX(B),W.setY(V),W.setWidth(A),W.setHeight(t),W._fullscreen=!1,$.style.background=v,W.iv();else{var G=M.Default.getWindowInfo();(z||G.width!==W.getWidth()||G.height!==W.getHeight())&&(W.setX(G.left),W.setY(G.top),W.setWidth(G.width),W.setHeight(G.height),W._fullscreen=!0,W.iv(),z=!1)}},500)}else{var e=$.style.left,c=$.style.top,A=$.style.width,t=$.style.height,v=$.style.background;v||($.style.background="white"),$.requestFullscreen?$.requestFullscreen():$.msRequestFullscreen?$.msRequestFullscreen():$.mozRequestFullScreen?$.mozRequestFullScreen():$.webkitRequestFullscreen&&$.webkitRequestFullscreen();var b=setInterval(function(){if($!==(K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement))clearInterval(b),$.style.left=e,$.style.top=c,$.style.width=A,$.style.height=t,$.style.background=v,W.iv();else{var s=M.Default.getWindowInfo();(z||s.width!==W.getWidth()||s.height!==W.getHeight())&&(Sf(W),z=!1)}},500)}}},appendTimeStamp:function(D){return D},setCompType:function(u,G){ri(G)||eh(G)?gj[u]=G:zg(u)},getCompType:function(Y){var v=gj[Y];return v===d&&cl.test(Y)&&zg(Y),v},getCompTypeMap:function(){return gj},drawCompType:function(h,u,S,j,T,Y){h(u,S,j,T,Y)},numberListener:function(){var g={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(q){var E=q.keyCode;g[E]||65===E&&Q.isCtrlDown(q)||86===E&&Q.isCtrlDown(q)||67===E&&Q.isCtrlDown(q)||88===E&&Q.isCtrlDown(q)||E>=35&&40>=E||(q.shiftKey||48>E||E>57)&&(96>E||E>105)&&q.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(p){var z=p.target.tagName;("DIV"===z||"CANVAS"===z)&&!(Q.ignoreKeyCodes.indexOf(p.keyCode)>=0)&&("keydown"!==p.type||Pd(p)||bi(p)||_b(p)||Wo(p)||Mq(p)||65===p.keyCode&&(p.metaKey||p.ctrlKey))&&(p.preventDefault(),p.preventManipulation&&p.preventManipulation())},getWindowInfo:function(){var H=K.documentElement,f=H&&(H.scrollLeft||H.scrollTop)?H:K.body;return{target:f,left:f.scrollLeft,top:f.scrollTop,width:X.innerWidth||f.clientWidth,height:X.innerHeight||f.clientHeight}},isDragging:function(){return!!Ki},isLeftButton:function(A){return Bq?!0:0===A.button},isInput:function(h){if(!h)return!1;var H=h.tagName;return"INPUT"===H||"TEXTAREA"===H||"SELECT"===H},getTouchCount:function(V){return Bq?V.touches.length:1},isDoubleClick:function(){function M(w){w.details=0,w.timeout=null,w.lastPoint=null}var o={};return sb=new h,No=sb.getTime(),function(s){var B=s.button==N?"":s.button,w=s.type+B,r=w+"_isDoubleClick",q=o[w];if(q||(q=o[w]={details:0,timeout:null,lastPoint:null}),s[r]===d){s[r]=!0;var g=zc(s);q.timeout&&(f(q.timeout),q.timeout=null),q.lastPoint&&uk(q.lastPoint,g)>(Bq?20:1)&&M(q),q.lastPoint=g,q.details++,q.timeout=b(function(){M(this)}.bind(q),500)}return 2===q.details}}(),isShiftDown:function(W){return W?W.shiftKey:El["16"]},isCtrlDown:function($){return $?u?$.metaKey:$.ctrlKey:u?El["91"]:El["17"]},getClientPoint:function(P){return Bq&&(P=wm(P)),{x:P.clientX,y:P.clientY}},isMouseEvent:function(X){return X instanceof MouseEvent||0===X.type.indexOf("mouse")},getTargetElement:function(f){if(Q.isMouseEvent(f)||!K.elementFromPoint)return f.target;var M=hc(f);return K.elementFromPoint(M.x,M.y)},getPagePoint:function($){return Bq&&($=wm($)),{x:$.pageX,y:$.pageY}},createObject:function(z,w){var H=new z;for(var Z in w)if(0===Z.indexOf("s:"))H.s(Z.substr(2),w[Z]);else if(0===Z.indexOf("a:"))H.a(Z.substr(2),w[Z]);else{var P=lk(Z),$=w[Z];H[P]?(H[P]($),"setToolTip"===P&&H.enableToolTip&&H.enableToolTip()):H[Z]=$}return H},setImage:function(u,w,I,X){var d=arguments.length;4===d?Vh(u,X,w,I):2===d?Hq(w)?Vh(u,w):Pm[u]=w:1===d&&Vh(u,u)},getImage:function(D,p,l){var y;if(D==N)return N;if(eh(D)?y=D:(y=Pm[D],D&&y===d&&(Pq&&Pq[D]||Vh(D,D))),p&&y&&y.tagName){var g;g="override"===l?"colors_override":"override_rgb"===l?"colors_override_rgb":"override_a"===l?"colors_override_a":"colors",y[g]||(y[g]={__count__:0});var i=y[g][p];return i||(y[g].__count__>Q.imageCacheThreshold&&(y[g]={__count__:0}),i=Kc(y,Ie(p),y.width,y.height,l),y[g][p]=i,y[g].__count__++),i}return y},isImageComplete:function(l,b,m){var B=eh(l)?l:Pm[l];if(!B)return!1;if(B.tagName)return B.complete;for(var M,l,j,s=B.comps,J=!0,t=0,I=s.length;I>t;t++)if(M=s[t],j=M.type,"image"===M.type){l=M.name,l&&l.func&&(l=Hr(l,b));var R=Id(l,b,m);if(!R){J=!1;break}}else if(cl.test(j)&&Q.getCompType(j)===d){J=!1;break}return J},getId:function(){var l=1;return function(){return++l}}(),callLater:function(K,Y,H,k){var o=function(){K.apply(Y,H)};return k?b(o,k):X.requestAnimationFrame(o)},clone:function(B){if(null==B||"object"!=typeof B)return B;if(B instanceof Date){var r=new Date;return r.setTime(B.getTime()),r}if(B instanceof Array){for(var r=[],P=0,T=B.length;T>P;P++)r[P]=hg(B[P]);return r}if(B instanceof Ol){for(var r=new Ol,P=0,T=B.length;T>P;P++)r.set(P,hg(B.get(P)));return r}if(B instanceof sc)return B;if(B instanceof J){var r={};for(var d in B)B.hasOwnProperty(d)&&(r[d]=hg(B[d]));return r}return B},callWhenLoaded:function(e,j){j=j||100;var x=xh(e,j);im||(im={}),im[x]={tick:x,cb:e,delay:j}},beforeLoadURL:function(h){if(im){var u={};for(var Z in im){var e=im[Z];f(e.tick);var s=xh(e.cb,e.delay);u[s]={tick:s,delay:e.delay,cb:e.cb}}im=u}return Q.convertURL?Q.convertURL(h):h},convertURL:function(C){return C},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(B,Z){if(B===Z)return 0;if(B==N&&Z!=N)return 1;if(B!=N&&Z==N)return-1;if(B==N&&Z==N)return 0;var F,L=typeof B,W=typeof Z;return L===ye&&W===ye?F=B.localeCompare(Z):L===zl&&W===zl&&(F=B-Z),F===d&&(F=(""+B).localeCompare(""+Z)),F>0?1:0>F?-1:0},getClassMap:function(){return _d},getClass:function(U){if(Hq(U)){var I,i=_d[U];if(!i){I=U.split("."),i=X;for(var _=0;_<I.length;_++)i=i[I[_]];_d[U]=i}return i}return U},def:function(t,E,s){var $,u,l,f=function(){};if(f.prototype=E.prototype,$=new f,Hq(t)){if(_d[t])throw"'"+t+"' already defined";l=Me(t),$.getClassName=function(){return t}}else l=t;if($.constructor=l,$.getClass=function(){return l},$.getSuperClass=function(){return E},s)for(u in s)sf[u]&&sf.hasOwnProperty(u)?sf[u]($,s):Jp($,s,u);l.prototype=$,l.superClass=E.prototype},startAnim:function(){var A=function(K){K.duration&&(K.startTime=Le()),K.timeId=Ln(K.tick,N,N,K.interval)};return function(t){return t=hg(t),t.easing=t.easing||Q.animEasing,t.duration||t.frames||(t.duration=Q.animDuration),t.t=0,t.duration?t.interval=0:(t.frame=0,t.interval=t.interval||10),t.tick=function(){if(t.duration){var C=(Le()-t.startTime)/t.duration;C>1&&(C=1),t.t=C,t.action(t.easing(C),C),1===C?t.stop():t._isPaused||(t.timeId=Ln(t.tick))}else t.frame++,C=t.t=t.frame/t.frames,t.action(t.easing(C),C),t.frame<t.frames?t._isPaused||(t.timeId=Ln(t.tick,N,N,t.interval)):t.stop()},t.resume=function(){t._isPaused&&(delete t._isPaused,t.duration?t.t<1&&(t.startTime=Le()-t.duration*t.t,t.timeId=Ln(t.tick)):t.frame<t.frames&&(t.timeId=Ln(t.tick,N,N,t.interval)))},t.pause=function(){t._isPaused=!0},t.stop=function(M){t.isRunning()&&(t.duration?t.t<1&&M&&(t.t=1,t.action(t.easing(1),1)):t.frame<t.frames&&M&&(t.frame=t.frames,t.action(t.easing(1),1)),t._37o&&t._37o(),t.finishFunc&&t.finishFunc(),Rg(t.timeId,!t.duration),delete t.timeId)},t.isRunning=function(){return t.timeId!=N},t.delay?Ln(A,N,[t],t.delay):A(t),t}}(),getTextSize:function(){var W={},G=K?Uq().getContext("2d"):N;return function(E,w){G.font=E?E:xk;var u=W[G.font];return u||(u=2*G.measureText("e").width+4,W[G.font]=u),{width:G.measureText(w).width+4,height:u}}}(),drawText:function(w,B,L,Y,o,P,s,g,c,J){if(B!=N){var D=sl(L,B),K={};K.y=J&&J!==fr?J===Kf?P+D.height/2:P+g-D.height/2:P+g/2,K.x=c&&c!==kj?c===Lj?o+s-D.width/2:o+s/2:o+D.width/2,es(w,B,K,L,Y)}},getDistance:function(p,B){var J=p.length;return B?3===J?m(T(p[0]-B[0])+T(p[1]-B[1])+T(p[2]-B[2])):2===J?m(T(p[0]-B[0])+T(p[1]-B[1])):p.z===d?m(T(B.x-p.x)+T(B.y-p.y)):m(T(B.x-p.x)+T(B.y-p.y)+T(B.z-p.z)):3===J?m(T(p[0])+T(p[1])+T(p[2])):2===J?m(T(p[0])+T(p[1])):void 0},brighter:function(b,i){return 0>i&&(i=-i),Th(b,i?i:40)},darker:function(m,A){return A>0&&(A=-A),Th(m,A?A:-40)},unionPoint:function(c,p){if(!c)return N;if(2===arguments.length)return c&&p?{x:O(c.x,p.x),y:O(c.y,p.y),width:A(c.x-p.x),height:A(c.y-p.y)}:N;var j=c;if(j._as&&(j=j._as),j.length===d)return N;var W=j.length;if(0>=W)return N;for(var k=1,u=j[0],H={x:u.x,y:u.y,width:0,height:0};W>k;k++){u=j[k];var J=O(H.x,u.x),v=t(H.x+H.width,u.x),$=O(H.y,u.y),m=t(H.y+H.height,u.y);H.x=J,H.y=$,H.width=v-J,H.height=m-$}return H},unionRect:function(o,x){if(o&&!x)return hg(o);if(!o&&x)return hg(x);if(o&&x){var s={x:O(o.x,x.x),y:O(o.y,x.y)};return s.width=t(o.x+o.width,x.x+x.width)-s.x,s.height=t(o.y+o.height,x.y+x.height)-s.y,s}return N},containsPoint:function(b,f,q,l){if(l!=N&&1!==l){var j=b.x+b.width/2,n=b.y+b.height/2;b={x:j-b.width/2*l,y:n-b.height/2*l,width:b.width*l,height:b.height*l}}if(q){var J=b.width/2,O=b.height/2,m=R(-q),X=E(-q),G=f.x-b.x-J,e=f.y-b.y-O;return f={x:X*G-m*e,y:m*G+X*e},Ah({x:-J,y:-O,width:b.width,height:b.height},f)}return!(!b||f.x<b.x||f.y<b.y||f.x>b.x+b.width||f.y>b.y+b.height)},containsRect:function(q,E){if(!q||!E)return!1;var c=E.x,Y=E.y,J=E.width,n=E.height,T=q.width,O=q.height;if(0>(T|O|J|n))return!1;var K=q.x,Z=q.y;if(K>c||Z>Y)return!1;if(T+=K,J+=c,c>=J){if(T>=K||J>T)return!1}else if(T>=K&&J>T)return!1;if(O+=Z,n+=Y,Y>=n){if(O>=Z||n>O)return!1}else if(O>=Z&&n>O)return!1;return!0},intersectsRect:function(B,X){if(!B||!X)return!1;var V=X.width,k=X.height,l=B.width,d=B.height;if(0>=l||0>=d||0>=V||0>=k)return!1;var A=X.x,t=X.y,o=B.x,r=B.y;return l+=o,d+=r,V+=A,k+=t,l>A&&d>t&&V>o&&k>r},intersection:function(R,n){if(!R||!n)return N;var G=n.x,z=n.y,i=R.x,Q=R.y,b=G,d=z,k=i,L=Q;return b+=n.width,d+=n.height,k+=R.width,L+=R.height,i>G&&(G=i),Q>z&&(z=Q),b>k&&(b=k),d>L&&(d=L),b-=G,d-=z,0>=b||0>=d?N:{x:G,y:z,width:b,height:d}},grow:function(V,o,R){R===d&&(R=o),V.x-=o,V.y-=R,V.width=V.width+2*o,V.height=V.height+2*R},getLogicalPoint:function(A,y,s,m,I,Y){var i,n,J=y.getBoundingClientRect();return A.target?(op(A)?u?El["91"]=!0:El["17"]=!0:u?El["91"]=!1:El["17"]=!1,El["16"]=of(A)?!0:!1,A=Bq?wm(A):A,i=A.clientX,n=A.clientY):(i=A.x,n=A.y),{x:(i-J.left+y.scrollLeft-(s||0))/(I||1),y:(n-J.top+y.scrollTop-(m||0))/(Y||1)}},removeHTML:function(){var F;return function(o){return o&&o.parentNode?F===o?!0:(F=o,o.parentNode.removeChild(o),F=N,!0):!1}}(),getToolTipDiv:function(){if(!Rf){Rf=ac(),ic=ac();var a=Rf.style;Q.baseZIndex!=N&&(a.zIndex=r(Q.baseZIndex)+3+""),a.whiteSpace="nowrap",a.color=Q.toolTipLabelColor,a.background=Q.toolTipBackground,a.font=Q.toolTipLabelFont,a.padding="5px",a.boxShadow="0px 0px 3px "+Q.toolTipShadowColor}return Rf},isToolTipShowing:function(){return Rf&&Rf.parentNode?!0:ic&&ic.parentNode?!0:!1},hideToolTip:function(){eq(Rf),eq(ic),ho()},showToolTip:function(o,W){if(!o||W==N)return Od(),void 0;Q.getToolTipDiv();var p,B;if(W.html?(W=W.html,p=ic,eq(Rf)):(p=Rf,eq(ic)),B=p.style,p.innerHTML=W,p.parentNode||M.Default.appendToScreen(p),o.target){o=hc(o);var J=Dd(),$=o.x,h=o.y,i=Bq?60:12;if(Bq){var D=p.getBoundingClientRect();B.left=$-D.width/2+Rn,B.top=h-D.height-i<J.top?h+i+Rn:h-D.height-i+Rn}else{B.left=$+i+Rn,B.top=h+i+Rn;var D=p.getBoundingClientRect();D.left+D.width>J.width&&(B.left=$-i-D.width+Rn),D.top+D.height>J.height&&(B.top=h-i-D.height+Rn),D.left<0&&(B.left=$+i+Rn),D.top<0&&(B.top=h+i+Rn)}}else B.left=o.x+Rn,B.top=o.y+Rn;ho()},startDragging:function(z,n){z!==Ki&&(Ki?Bq?Ki.handleWindowTouchEnd(n):Ki.handleWindowMouseUp(n):Bq?(X.addEventListener(Ei,Ff,!1),X.addEventListener(mp,tn,!1)):(X.addEventListener(qj,jc,!1),X.addEventListener(Fe,Wq,!1)),Ki=z)},getImageMap:function(){return Pm},toBoundaries:function(i,Q,b,d){var s=[];return fg(i,Q,b,d).forEach(function(A){var m=[];A.forEach(function(O){m.push(O.x,O.y)}),s.push(m)}),s},getCurrentKeyCodeMap:function(){return El},drawCenterImage:function(X,K,E,y,O,n,q,T){var w=pg(K,O,n),u=gh(K,O,n);tg(X,K,s(E-w/2),s(y-u/2),w,u,O,n,q,T)},drawStretchImage:function(X,y,k,P,h,g,a,c,p,K,R,Z){var U,F=pg(y,c,p,g),$=gh(y,c,p,a);"uniform"===k?(U=O(g/F,a/$),F*=U,$*=U,P+=s((g-F)/2),h+=s((a-$)/2),g=F,a=$):"centerUniform"===k&&((F>g||$>a)&&(U=O(g/F,a/$),F*=U,$*=U),P+=s((g-F)/2),h+=s((a-$)/2),g=F,a=$);var D=X.interactiveInfo;if(D){var w;w="center"===k?{x:P+g/2-F/2,y:h+a/2-$/2,width:F,height:$}:{x:P,y:h,width:g,height:a},D.rect?(D.compInfos[D.compInfos.length-1].rect=w,w.image=y):D.rect=w
}if("center"===k){var l=R!==!1&&(F>g||$>a);l&&(X.save(),X.beginPath(),X.rect(P,h,g,a),X.clip()),tg(X,y,P+g/2-F/2,h+a/2-$/2,F,$,c,p,K,Z),l&&X.restore()}else tg(X,y,P,h,g,a,c,p,K,Z)},toCanvas:function(C,q,g,h,z,H,e,k,y){C=cd(C,e),q=q||pg(C,z),g=g||gh(C,z);var V=Uq(),Y=Ji(V);return k?(pp(V,q,g,k),Y.scale(k,k)):pp(V,q,g,1),Nq(Y,C,h,0,0,q,g,z,H,e,y),C&&C.clampToEdge&&(V.clampToEdge=C.clampToEdge),Y.restore(),V},createGradientImage:function(E,U,d,l){for(var T=["L",0,0,E,0,1,0,0,1,0,0],q=0,y=Math.min(U.length,d.length);y>q;q++)T.push(d[q],U[q]);var Q=M.Default.toCanvas({width:E,height:E,clampToEdge:!0,comps:[{type:"shape",rotation:l||0,points:[0,0,E,0,E,E,0,E],background:"#ffffff",gradientPack:T}]});return Q},createElement:function(Z,L,q,t){var T=K.createElement(Z);return Gk(T,L||n.widgetBorder,2),T.style.font=q?q:xk,t!=N&&(T.value=t),Q.onElementCreated&&Q.onElementCreated(T),T},containedInView:function(q,l){var r=ff(l).getBoundingClientRect();return Ah({x:r.left,y:r.top,width:r.width,height:r.height},zc(q))},isIsolating:function(){return ne>0},setIsolating:function(H){H?ne++:ne--},getMSMap:function(){return sf},stringify:function(V,C){var u=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var k=JSON.stringify(V,function(n,T){return"function"==typeof T?"__ht__"+(T.__ht__||T.toString()):wf(T)?di(T):T},C==N?2:C);return Date.prototype.toJSON=u,k},parse:function(z){return Hq(z)?JSON.parse(z,function(a,u){if(Hq(u)){if("__ht__function"==u.substr(0,14)){var j=u.indexOf("{")+1,G=u.lastIndexOf("}"),X=u.indexOf("(")+1,D=u.indexOf(")");if(j&&G&&X&&D){var e=new Function(u.substring(X,D),u.substring(j,G));return e.__ht__=u.substr(6),e}}if("__ht__date"==u.substr(0,10))return new Date(r(u.substr(10)))}return u}):z},loadJS:function(O,n){n&&O.push(n);var W=O.shift();if(Sg(W))O=W.contact(O),Q.loadJS(O);else if(ri(W))W(),Q.loadJS(O);else if(Hq(W)){var h=K.createElement("script");h.onload=function(){Q.loadJS(O)},h.setAttribute("src",W),K.getElementsByTagName("head")[0].appendChild(h)}else O.length&&Q.loadJS(O)},toRoundedCorner:function(w,b){var U=w.size();if(0>=b)return{points:w};var f,s=new Ol,v=new Ol,I=w.get(0);s.add(I),v.add(1);for(var n=1;U>n;n++)if(U>n+1){var l=w.get(n),H=w.get(n+1),p=I.x,J=I.y,a=l.x,K=l.y,F=K-J,P=a-p,T=D(F,P);f=O(.99*uk(I,l),b),s.add({x:a-f*E(T),y:K-f*R(T)}),s.add(l),p=l.x,J=l.y,a=H.x,K=H.y,F=K-J,P=a-p,T=D(F,P),f=O(.99*uk(l,H),b),I={x:p+f*E(T),y:J+f*R(T)},s.add(I),v.addAll([2,3])}else s.add(w.get(n)),v.add(2);return{points:s,segments:v}},toColorData:hf,setCanvas:pp,createDiv:ac,createDisabledDiv:Ti,createView:nh,createCanvas:Uq,appendChild:kr,initContext:Ji,checkLoadingImage:Te,translateAndScale:dg,layout:Sf,getPosition:Dg,drawPoints:zj,drawRoundRect:on,drawBorder:Qk,setFocus:Nc,getter:Lq,setter:lk,isEmptyObject:jj},!0),Jc(V,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Am=Q.disabledOpacity,fl=Q.toolTipDelay,Wn=Q.devicePixelRatio,rk=Q.autoMakeVisible,qe=Q.autoHideScrollBar,Vb=Q.imageGradient,bn=Q.showToolTip,Od=Q.hideToolTip,os=Q.dashPattern,Tf=Q.lineCap,Lf=Q.lineJoin,ro=Q.labelColor,Yq=Q.labelSelectColor,xk=Q.labelFont,Em=Q.widgetIndent,Qi=Q.widgetRowHeight,Rj=Q.widgetHeaderHeight,Mo=Q.widgetTitleHeight,$n=Q.scrollBarColor,ss=Q.scrollBarSize,Xk=Q.scrollBarTimeout,Dj=Q.scrollBarMinLength,ip=Q.scrollBarInteractiveSize,ym=Q.zoomIncrement,Cg=Q.scrollZoomIncrement,Lr=Q.pinchZoomIncrement,jh=Q.zoomMax,Yl=Q.zoomMin,Ik=Q.createObject,zq=Q.preventDefault,vf=Q.setImage,cd=Q.getImage,Id=Q.isImageComplete,Bh=Q.drawCenterImage,Nq=Q.drawStretchImage,vd=Q.getId,Ln=Q.callLater,Hc=Q.sortFunc,hg=Q.clone,Me=Q.getClass,Cp=Q.startAnim,gr=Q.brighter,jb=Q.darker,Tn=Q.drawText,sl=Q.getTextSize,Fq=Q.isLeftButton,Wf=Q.getTouchCount,hn=Q.isDoubleClick,of=Q.isShiftDown,op=Q.isCtrlDown,zc=Q.getClientPoint,hc=Q.getPagePoint,uk=Q.getDistance,re=Q.unionPoint,fi=Q.unionRect,Ah=Q.containsPoint,_l=Q.containsRect,pe=Q.intersectsRect,_e=Q.intersection,Dd=Q.getWindowInfo,po=Q.grow,ar=Q.getLogicalPoint,ds=Q.startDragging,eq=Q.removeHTML,Zh=Q.createElement,$l=Q.segmentResolution,Cs=Q.shapeResolution,vp=Q.shapeSide,Gd=Q.def,Wj=function($,h,v){Gd(B+"."+$,h,v)},$g=function(m,A){m.childNodes.forEach(function(X){A(X),$g(X,A)})};Jc(Q,{toolTipLabelColor:ro,toolTipLabelFont:xk,toolTipBackground:n.toolTipBackground,toolTipShadowColor:xf,drawBreakableText:Rl,setDevicePixelRatio:function(v){Wn=Q.devicePixelRatio="number"==typeof v?v:X.devicePixelRatio,$g(K.body,function(I){var M=I._ht;M&&M._canvas&&(pp(M._canvas,M.getWidth(),M.getHeight()),M.redraw?M.redraw():M.iv())})}},!0);var ad=1e-6,tp="undefined"!=typeof Uint16Array?Uint16Array:Array,oi="undefined"!=typeof Float32Array?Float32Array:Array,fn=function(t,n,s){var N=[t[0]-n[0],t[1]-n[1],t[2]-n[2]];if(s){var o=uk(N);o>0&&(N[0]/=o,N[1]/=o,N[2]/=o)}return N},kc=function(z){return[-z[0],-z[1],-z[2]]},_o=function(B,E){return 3===B.length?B[0]*E[0]+B[1]*E[1]+B[2]*E[2]:B[0]*E[0]+B[1]*E[1]},wp=function(){var D=new oi(16);return D[0]=1,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=1,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=1,D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,D},vn=wp(),so=function(g){var p=new oi(16);return p[0]=g[0],p[1]=g[1],p[2]=g[2],p[3]=g[3],p[4]=g[4],p[5]=g[5],p[6]=g[6],p[7]=g[7],p[8]=g[8],p[9]=g[9],p[10]=g[10],p[11]=g[11],p[12]=g[12],p[13]=g[13],p[14]=g[14],p[15]=g[15],p},rd=function(M,V){return M[0]=V[0],M[1]=V[1],M[2]=V[2],M[3]=V[3],M[4]=V[4],M[5]=V[5],M[6]=V[6],M[7]=V[7],M[8]=V[8],M[9]=V[9],M[10]=V[10],M[11]=V[11],M[12]=V[12],M[13]=V[13],M[14]=V[14],M[15]=V[15],M},Ro=function(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Po=function(u,P){var O=u[0],v=u[1],p=u[2];return u[0]=P[0]*O+P[4]*v+P[8]*p+P[12],u[1]=P[1]*O+P[5]*v+P[9]*p+P[13],u[2]=P[2]*O+P[6]*v+P[10]*p+P[14],u},og=function(O,d){var L=O[0],g=O[1],F=O[2],w=O[3];return O[0]=d[0]*L+d[4]*g+d[8]*F+d[12]*w,O[1]=d[1]*L+d[5]*g+d[9]*F+d[13]*w,O[2]=d[2]*L+d[6]*g+d[10]*F+d[14]*w,O[3]=d[3]*L+d[7]*g+d[11]*F+d[15]*w,O},Gl=function(){var I,K,c,O,f=_f(rg[1]+rg[7]),o=_f(rg[0]+rg[3]-rg[10]),b=_f(rg[8]+2),g=function(){return K=c.charAt(I),I+=1,K},n=function(){var t="";if(K===b)for(;g();){if(K===b)return g(),t;t+=K}else g()},j=function(){for(;K&&" ">=K;)g()},D=function(){var Q,E={};if(K===f){if(g(),j(),K===o)return g(),E;for(;K;){if(Q=n(),j(),g(),E[Q]=O(),j(),K===o)return g(),E;g(),j()}}};return O=function(){switch(j(),K){case f:return D();default:return n()}},function(h){if(S={},h){var d;if(c=h,I=0,K=" ",d=O(),j(),!K)return d}}}(),ci=function(t,X){if(X){var k=R(X),c=E(X),o=t[4],M=t[5],p=t[6],x=t[7],h=t[8],e=t[9],f=t[10],B=t[11];t[4]=o*c+h*k,t[5]=M*c+e*k,t[6]=p*c+f*k,t[7]=x*c+B*k,t[8]=h*c-o*k,t[9]=e*c-M*k,t[10]=f*c-p*k,t[11]=B*c-x*k}},sr=function(X,Q){if(Q){var m=R(Q),F=E(Q),p=X[0],K=X[1],A=X[2],y=X[3],x=X[8],k=X[9],j=X[10],c=X[11];X[0]=p*F-x*m,X[1]=K*F-k*m,X[2]=A*F-j*m,X[3]=y*F-c*m,X[8]=p*m+x*F,X[9]=K*m+k*F,X[10]=A*m+j*F,X[11]=y*m+c*F}},jp=function(N,h){if(h){var i=R(h),A=E(h),l=N[0],m=N[1],r=N[2],G=N[3],C=N[4],n=N[5],g=N[6],o=N[7];N[0]=l*A+C*i,N[1]=m*A+n*i,N[2]=r*A+g*i,N[3]=G*A+o*i,N[4]=C*A-l*i,N[5]=n*A-m*i,N[6]=g*A-r*i,N[7]=o*A-G*i}},Qq=function(d,A,s){return rs(N,s===!1?N:d.getFinalScale3d(),d.r3(),d.getRotationMode(),d.p3(),N,A)},rs=function(t,z,m,I,s,g,h){return g||(g=wp()),s&&Ze(g,s),Xq(g,m,I),h&&jn(g,g,h),z&&Ug(g,z),t&&jn(g,g,t),g},$c=function(U,Q,W){Q=r(Q),W=r(W);var V=this;V.g=U,V._84O=Q,V._85O=W,V._70I=!0,V.F=0,V._83O=Q+W,V.pen={x:0,y:0}},Nd="lineDashOffset",ql="setLineDash",Ko=function(g){for(var h in g)1===h.length&&(Nd=g[h]);return h?1:0},Nj=function(_,U,l){return Yc(U)?_:_[ql]?(_[ql](U),l&&(_.lineDashOffset=l),_):new $c(_,U[0],U.length>1?U[1]:U[0])},xm=function(Y,o){!Yc(o)&&Y[ql]&&(Y[ql](Ar),Y.lineDashOffset=0)};if(Gd($c,J,{_69I:6,moveTo:function(E,r){var R=this,O=R.pen;O.x=E,O.y=r,R.g.moveTo(E,r),R.start||(R.start={x:E,y:r})},lineTo:function(f,r){var m=this,l=m.pen,s=f-l.x,n=r-l.y,K=D(n,s),x=E(K),v=R(K),k=m._23O(l.x,l.y,f,r),J=m._85O,d=m._84O,i=m._83O;if(m.F){if(m.F>k)return m._70I?m._72I(f,r):m.moveTo(f,r),m.F-=k,void 0;if(m._70I?m._72I(l.x+x*m.F,l.y+v*m.F):m.moveTo(l.x+x*m.F,l.y+v*m.F),k-=m.F,m.F=0,m._70I=!m._70I,!k)return}var T=y(k/i);if(T){for(var P=x*d,e=v*d,N=x*J,b=v*J,X=0;T>X;X++)m._70I?(m._72I(l.x+P,l.y+e),m.moveTo(l.x+N,l.y+b)):(m.moveTo(l.x+N,l.y+b),m._72I(l.x+P,l.y+e));k-=i*T}m._70I?k>d?(m._72I(l.x+x*d,l.y+v*d),m.moveTo(f,r),m.F=J-(k-d),m._70I=!1):(m._72I(f,r),k===d?(m.F=0,m._70I=!m._70I):(m.F=d-k,m.moveTo(f,r))):k>J?(m.moveTo(l.x+x*J,l.y+v*J),m._72I(f,r),m.F=d-(k-J),m._70I=!0):(m.moveTo(f,r),k===J?(m.F=0,m._70I=!m._70I):m.F=J-k)},quadraticCurveTo:function(g,e,G,Q){var h,o=this,S=o.pen,V=S.x,p=S.y,X=o._22O(V,p,g,e,G,Q),E=0,C=0,b=o._85O,n=o._84O;if(o.F){if(o.F>X)return o._70I?o._71I(g,e,G,Q):o.moveTo(G,Q),o.F-=X,void 0;if(E=o.F/X,h=o._20O(V,p,g,e,G,Q,E),o._70I?o._71I(h[2],h[3],h[4],h[5]):o.moveTo(h[4],h[5]),o.F=0,o._70I=!o._70I,!X)return}var P=X-X*E,M=y(P/o._83O),r=n/X,R=b/X;if(M)for(var _=0;M>_;_++)o._70I?(C=E+r,h=o._21O(V,p,g,e,G,Q,E,C),o._71I(h[2],h[3],h[4],h[5]),E=C,C=E+R,h=o._21O(V,p,g,e,G,Q,E,C),o.moveTo(h[4],h[5])):(C=E+R,h=o._21O(V,p,g,e,G,Q,E,C),o.moveTo(h[4],h[5]),E=C,C=E+r,h=o._21O(V,p,g,e,G,Q,E,C),o._71I(h[2],h[3],h[4],h[5])),E=C;P=X-X*E,o._70I?P>n?(C=E+r,h=o._21O(V,p,g,e,G,Q,E,C),o._71I(h[2],h[3],h[4],h[5]),o.moveTo(G,Q),o.F=b-(P-n),o._70I=!1):(h=o._19O(V,p,g,e,G,Q,E),o._71I(h[2],h[3],h[4],h[5]),X===n?(o.F=0,o._70I=!o._70I):(o.F=n-P,o.moveTo(G,Q))):P>b?(C=E+R,h=o._21O(V,p,g,e,G,Q,E,C),o.moveTo(h[4],h[5]),h=o._19O(V,p,g,e,G,Q,C),o._71I(h[2],h[3],h[4],h[5]),o.F=n-(P-b),o._70I=!0):(o.moveTo(G,Q),P===b?(o.F=0,o._70I=!o._70I):o.F=b-P)},bezierCurveTo:function(){var n=arguments;this.pen={x:n[4],y:n[5]},this.g.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])},arc:function(u,n,F,x,P,z){z||(x=-x,P=-P),jo(this,u,n,x,P-x,F,F,!1)},rect:function(x,a,c,o){var O=this;O.pen={x:x,y:a},O.moveTo(x,a),O.lineTo(x,a+o),O.lineTo(x+c,a+o),O.lineTo(x+c,a),O.lineTo(x,a)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(o,z,w,t){var c=w-o,k=t-z;return m(c*c+k*k)},_22O:function(t,q,T,c,i,M,b){for(var w,p,Y,H,x,n,A,$=0,Q=t,g=q,r=b>0?b:this._69I,D=1;r>=D;D++)Y=D/r,H=1-Y,x=H*H,n=2*Y*H,A=Y*Y,w=x*t+n*T+A*i,p=x*q+n*c+A*M,$+=this._23O(Q,g,w,p),Q=w,g=p;return $},_21O:function(Y,$,x,z,r,F,b,k){var P=this;if(0===b)return P._20O(Y,$,x,z,r,F,k);if(1===k)return P._19O(Y,$,x,z,r,F,b);var H=P._20O(Y,$,x,z,r,F,k);return H.push(b/k),P._19O.apply(P,H)},_20O:function(N,D,F,k,U,v,t){if(1!==t){var m=F+(U-F)*t,I=k+(v-k)*t;F=N+(F-N)*t,k=D+(k-D)*t,U=F+(m-F)*t,v=k+(I-k)*t}return[N,D,F,k,U,v]},_19O:function(q,G,H,f,j,O,m){if(1!==m){var B=q+(H-q)*m,E=G+(f-G)*m;H+=(j-H)*m,f+=(O-f)*m,q=B+(H-B)*m,G=E+(f-E)*m}return[q,G,H,f,j,O]},_72I:function(k,g){var H=this.pen;(k!==H.x||g!==H.y)&&(H.x=k,H.y=g,this.g.lineTo(k,g))},_71I:function(j,X,t,w){var k=this.pen;(j!==t||X!==w||t!==k.x||w!==k.y)&&(k.x=t,k.y=w,this.g.quadraticCurveTo(j,X,t,w))}}),p&&Z){var Oi=Z.toString();l=Oi.indexOf(cs.substr(0,2))>0&&Oi.indexOf(Kf+Kf.substr(1,1))>1||Oi.indexOf(Br[0]+Ir.substr(0,2)+cs.substr(2,2)+kj[0]+cs[4])>1?!0:!1}!0&&X.console&&(X.navigator&&X.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?X.console.log.apply(console,["Hightopo - Version："+M.Default.getVersion()+" - %c申请试用：http://hightopo.com/request.html","color: #f00;"]):X.console.log("Hightopo - Version："+M.Default.getVersion()+" - 申请试用：http://hightopo.com/request.html"));var ih=N,_c=N,vj=function(W){ih&&!W._72O&&(_c||(_c={}),_c[W._72O=vd()]=W)},zg=function(V,C){if(C||(C=V),C&&(ih||(ih={}),!ih[V])){var t=new XMLHttpRequest;if(ih[C]={request:t,url:C},t.overrideMimeType&&t.overrideMimeType("text/plain"),C=Q.beforeLoadURL(C),C.data){var S=Q.parse(C.data);Bl(V,S),Q.handleCompTypeLoaded(V,S)}else t.open("GET",encodeURI(C),!0),t.onload=function(l){if(200===this.status||0===this.status){var D=Q.parse(l.target.response||l.target.responseText);Bl(V,D),Q.handleCompTypeLoaded(V,D)}else Bl(V,N)},t.onerror=function(){Bl(V,N)},t.send(null)}},Bl=function(D,C){if(gj[D]=C,delete ih[D],jj(ih)&&(ih=N,_c)){for(var W in _c){var q=_c[W];q.invalidateAll&&q.invalidateAll(d,"compTypeLoaded",D),q.redraw&&q.redraw(),q.iv(),delete q._72O}_c=N}if(C&&_c)for(var W in _c){var q=_c[W];q.invalidateAll&&q.invalidateAll(d,"compTypeLoading",D),q.redraw&&q.redraw(),q.iv()}},Bj=n.chart,ki=Q.compStack=[],qq=/^style@/,Kg=/^attr@/,An=/^field@/,In={x:.5,y:.5},pg=function(S,N,U,T){if(!S)return 0;if(Hr(S.fitSize,N,U)&&T)return T;var d=Hr(S.width,N,U);return null==d?20:d},gh=function(_,S,h,X){if(!_)return 0;if(Hr(_.fitSize,S,h)&&X)return X;var r=Hr(_.height,S,h);return null==r?20:r},Hr=function(A,u,j){if(!A||!A.func)return A;var T,L=A.func,z=A.value;return T=ri(L)?j&&j.vectorDataBindingDisabled&&!A.isSafeFunc?z:L(u,j):u instanceof sc?Kg.test(L)?u.a(L.slice(5)):qq.test(L)?u.s(L.slice(6)):An.test(L)?u[L.slice(6)]:u[L]?u[L](j):z:z,z!==d&&T==N?z:T},tg=Q.drawImage=function(){var $,b,H,A,X,G,g=function(y,N){y.getValue&&y.getValue.compType===N||(y.getValue=function(O){var E=n(y,O);if(E===d&&N.properties){var w=N.properties[O];w&&(E=w.defaultValue)}return E},y.getValue.compType=N)},n=function(t,$,y){var n=t[$];return n&&n.func?(n=Hr(n,b,H),y&&(n=y(n))):y&&(n=t[$]=y(n)),n},F=function(Q,w){var u;if(u=w?n(Q,w):Q,X&&u){if("override"===G)return X;if("override_rgb"===G){var E=Ie(X);return u=hf(u),"rgba("+y(255*E[0])+","+y(255*E[1])+","+y(255*E[2])+","+u[3]/255+")"}if("override_a"===G){var E=Ie(X);return u=hf(u),"rgba("+u[0]+","+u[1]+","+u[2]+","+E[3]+")"}var E=Ie(X);return u=hf(u),"rgba("+y(u[0]*E[0])+","+y(u[1]*E[1])+","+y(u[2]*E[2])+","+u[3]/255*E[3]+")"}return u},j=function(Z){if(Sg(Z)){for(var S=new Ol,L=Z.length,J=0;L>J;J+=2)S.add({x:Z[J],y:Z[J+1]});Z=S}return Z},P=function(I){var s=n(I,"anchorX"),r=n(I,"anchorY");if(s!==d||r!==d)return{x:s===d?In.x:s,y:r===d?In.y:r};var i=n(I,"type"),S=n(I,"name");if("image"!==i||!S)return In;var k=cd(S);return k&&k.anchorX&&k.anchorY?{x:k.anchorX,y:k.anchorY}:In},i=function(z,O){var r=n(z,cb),E=P(z);if(Sg(r)){var q=r.length,t=n(z,"relative"),S=O.width,Z=O.height;if(4===q)r={x:r[0],y:r[1],width:r[2],height:r[3]},t?(r.x*=S,r.y*=Z,r.width*=S,r.height*=Z):O.fitSize&&(r.x*=O.widthScale,r.width*=O.widthScale,r.y*=O.heightScale,r.height*=O.heightScale);else if(3===q){var v=r[0];r={width:r[1],height:r[2]},t?(r.width*=S,r.height*=Z):O.fitSize&&(r.width*=O.widthScale,r.height*=O.heightScale),"object"==typeof v?v.length&&(v={x:v[0],y:v[1]}):v=Dg(v,O,r),r.x=v.x-r.width*E.x,r.y=v.y-r.height*E.y}var p=n(z,"offsetX");p&&(O.fitSize&&(p*=O.widthScale),r.x+=p),p=n(z,"offsetY"),p&&(O.fitSize&&(p*=O.heightScale),r.y+=p)}return r},V=function(F){return Sg(F)?new Ol(F):F},o=function(k,R,L,y,t,z,G){var S=$.interactiveInfo;t===d&&(t=1),z===d&&(z=1);var _=n(k,"clipPercentage"),T=wd(L,R);if(T&&!y&&1===t&&1===z&&!(1>_))return S&&S.compInfos.push({comp:k,rect:R,stacks:S.stacks.slice()}),!1;G=G||In;var E=R.x+R.width*G.x,v=R.y+R.height*G.y,V=L.x+L.width*G.x,U=L.y+L.height*G.y,H=L.width?t*(R.width/L.width):1,b=L.height?z*(R.height/L.height):1;if($.save(),S&&(S.stacks.push({t:[E,v]}),S.stacks.push({r:y}),S.stacks.push({s:[H,b]}),S.stacks.push({t:[-V,-U]}),S.compInfos.push({comp:k,rect:R,stacks:S.stacks.slice()})),qo($,E,v),Gm($,y||0),Eh($,H,b),qo($,-V,-U),1>_){0>_&&(_=0);var B=Sp(L,n(k,"clipDirection"),_);$.beginPath(),$.rect(B.x,B.y,B.width,B.height),$.clip()}return!0},W=function(){$.interactiveInfo&&($.interactiveInfo.stacks.pop(),$.interactiveInfo.stacks.pop(),$.interactiveInfo.stacks.pop(),$.interactiveInfo.stacks.pop()),$.restore()},m=function(e,H,I){var q=n(e,"path"),w=n(e,Rr),p=n(e,"scaleX"),v=n(e,"scaleY"),B=P(e),G=N,Z=sn(null,q);if(I||(I=e.unionRect,I||(I=re(Z),e.path.func||(e.unionRect=I)),G=I),I){G||(G=e.unionRect,G||(G=re(Z),e.path.func||(e.unionRect=G)));var g=o(e,I,G,w,p,v,B),M=n(e,"borderPattern"),b=Nj($,M),f=F(e,"background"),C=F(e,"borderColor"),L=n(e,"borderWidth"),y=n(e,"gradient"),u=F(e,"gradientColor"),D=n(e,"border3d"),T=n(e,"border3dColor"),R=n(e,"border3dAccuracy"),i=$.lineJoin,_=$.lineCap;if($.lineJoin=n(e,"borderJoin")||Lf,$.lineCap=n(e,"borderCap")||Tf,f?(ik($,f,y,u,G),sn($,q),$.fill(),b!==$&&sn($,q)):sn($,q),L&&C){var k=n(e,"borderWidthAbsolute");k&&($.save(),$.setTransform(1,0,0,1,0,0)),$.lineWidth=L,$.strokeStyle=C,$.stroke(),k&&$.restore(),D&&Af($,C,T,L,A,R)}if(xm($,M),n(e,"dash")){var t=n(e,"dashWidth")||L;if(t>0){M=n(e,"dashPattern")||os;var b=Nj($,M,n(e,"dashOffset")),c=F(e,"dashColor")||F(Tm);b!==$&&sn($,q),$.strokeStyle=c,$.lineWidth=t,$.stroke(),n(e,"dash3d")&&Af($,c,F(e,"dash3dColor"),t,A,n(e,"dash3dAccuracy")),xm($,M)}}H===cb&&Of($,f,n(e,"depth"),G),$.lineJoin=i,$.lineCap=_,g&&W()}},M=function(O,J,p,v){var R=n(O,Sb,j),i=n(O,Rr),U=P(O);if(R&&v.fitSize){var q=Math.abs(Math.cos(i))<.001,x=new Ol,z=re(R),d=v.widthScale,Y=v.heightScale,k=z.x+U.x*z.width,g=z.y+U.y*z.height,t=k*d,_=g*Y;R.each(function(o){var T=o.x-k,G=o.y-g;x.add({x:t+T*(q?Y:d),y:_+G*(q?d:Y)})}),R=x,O.unionRect=null}var u=n(O,"scaleX"),f=n(O,"scaleY"),Q=J===gn,I=N;if(!p&&Q&&(p=O.unionRect,p||(p=re(R),O.points.func||(O.unionRect=p)),I=p),p){Q?I||(I=O.unionRect,I||(I=re(R),O.points.func||(O.unionRect=I))):I=p;var B,M,E,c,s=o(O,p,I,i,u,f,U),h=n(O,"borderPattern"),r=Nj($,h),Z=F(O,"background"),K=cd(n(O,"repeatImage"),X,G),m=n(O,"gradientPack"),w=F(O,"borderColor"),y=n(O,"borderWidth"),l=n(O,"segments",V),e=n(O,"gradient"),D=F(O,"gradientColor"),S=n(O,"border3d"),C=n(O,"border3dColor"),a=n(O,"border3dAccuracy"),L=n(O,"closePath"),T=n(O,"fillRule")||"nonzero",Gc=$.lineJoin,gm=$.lineCap;if($.lineJoin=n(O,"borderJoin")||Lf,$.lineCap=n(O,"borderCap")||Tf,Q)if(Z||K||m){var eo=n(O,"fillClipPercentage");if(1>eo){0>eo&&(eo=0);var Ze=Sp(I,n(O,"fillClipDirection"),eo);$.save(),$.beginPath(),$.rect(Ze.x,Ze.y,Ze.width,Ze.height),$.clip()}if(zj($,R,l,L),m)zb($,m);else if(K){var qp=$,Ym=X,gp=G;qn($,K,X,G,b,H),$=qp,X=Ym,G=gp}else{var qp=$;ik($,Z,e,D,I),$=qp}$.fill(T),1>eo&&$.restore(),m&&$.restore(),r!==$&&zj(r,R,l,L)}else zj(r,R,l,L);else if("roundRect"===J?B=n(O,"cornerRadius"):"polygon"===J?B=n(O,"polygonSide"):"arc"===J&&(B=n(O,"arcFrom"),M=n(O,"arcTo"),E=n(O,"arcClose"),c=n(O,"arcOval")),Z||K||m){var eo=n(O,"fillClipPercentage");if(1>eo){0>eo&&(eo=0);var Ze=Sp(I,n(O,"fillClipDirection"),eo);$.save(),$.beginPath(),$.rect(Ze.x,Ze.y,Ze.width,Ze.height),$.clip()}if(Xn($,J,I,B,M,E,c),m)zb($,m);else if(K){var qp=$,Ym=X,gp=G;qn($,K,X,G,b,H),$=qp,X=Ym,G=gp}else ik($,Z,e,D,I);$.fill(T),1>eo&&$.restore(),m&&$.restore(),$!==r&&Xn(r,J,I,B,M,E,c)}else Xn(r,J,I,B,M,E,c);if(y&&w){var Id=n(O,"borderWidthAbsolute");Id&&($.save(),$.setTransform(1,0,0,1,0,0)),$.lineWidth=y,$.strokeStyle=w,$.stroke(),Id&&$.restore(),S&&Af($,w,C,y,A,a)}if(xm($,h),n(O,"dash")){var li=n(O,"dashWidth")||y;if(li>0){h=n(O,"dashPattern")||os;var r=Nj($,h,n(O,"dashOffset")),pi=F(O,"dashColor")||F(Tm);r!==$&&(Q?zj(r,R,l,L):Xn(r,J,I,B,M,E,c)),$.strokeStyle=pi,$.lineWidth=li,$.stroke(),n(O,"dash3d")&&Af($,pi,F(O,"dash3dColor"),li,A,n(O,"dash3dAccuracy")),xm($,h)}}J===cb&&Of($,Z,n(O,"depth"),I),$.lineJoin=Gc,$.lineCap=gm,s&&W()}},Y=function(I,j){var f=X,Q=G,h=X||n(I,aq),S=G||n(I,"blendMode"),Y=cd(n(I,"name"),h,S);Y&&(Nq($,Y,n(I,"stretch"),j.x,j.y,j.width,j.height,b,H,h,null,S),X=f,G=Q)},h=function(x,j){var C=n(x,"text");C!=N&&Tn($,C,n(x,"font"),F(x,aq),j.x,j.y,j.width,j.height,n(x,"align"),n(x,"vAlign"))},k=function(M,Q){Qk($,F(M,aq),Q.x,Q.y,Q.width,Q.height,n(M,"width"))},_=function(o,U){var l=n(o,yg),h=0;if(l&&(l.forEach(function(K){h+=K}),h>0)){for(var G=n(o,"colors")||Bj,D=n(o,"startAngle")||0,Z=n(o,"hollow"),Y=n(o,Wi),f=n(o,Un),m=n(o,Do),k=Y?new Ol:N,z=U.x,M=U.y,J=U.width,P=U.height,C=z+J/2,r=M+P/2,Q=O(J,P)/2,p=0,S=0;S<l.length;S++){var _=l[S],F=q*_/h,j=D+F;if($.fillStyle=G[p++],p===G.length&&(p=0),$.beginPath(),Z){var y=C+E(D)*Q/2,a=r+R(D)*Q/2,w=C+E(j)*Q,v=r+R(j)*Q;$.moveTo(y,a),$.arc(C,r,Q/2,D,j,!1),$.lineTo(w,v),$.arc(C,r,Q,j,D,!0)}else $.moveTo(C,r),$.arc(C,r,Q,j,D,!0);k&&(F=(D+j)/2,k.add({text:ri(Y)?Y(_,S,h,b):_,x:C+.75*E(F)*Q,y:r+.75*R(F)*Q})),$.closePath(),$.fill(),D=j}k&&k.each(function(F){Tn($,F.text,f,m,F.x,F.y,0,0,bq)})}},f=function(v,p){var r=n(v,cf);if(r&&r.length>0){var F=r.length,U=n(v,Wi),G=n(v,Un),I=n(v,Do),E=U?new Ol:N,l=n(v,"minValue")||0,w=n(v,"maxValue");if(w==N&&(w=0,r.forEach(function(v){n(v,yg).forEach(function(F){w=t(w,F)})})),l===w)return;for(var i=p.height/(w-l),m=p.y+w*i,y=n(r[0],yg).length,B=p.width/(3*y+1),Z=2*B/F,L=0,T=0;F>T;T++)for(var k=r[T],M=n(k,aq),g=n(k,"colors"),o=n(k,yg),Q=0;y>Q;Q++){g?$.fillStyle=g[Q]:M?$.fillStyle=M:($.fillStyle=Bj[L++],L===Bj.length&&(L=0));var u=o[Q],D=u*i,O=p.x+(1+3*Q)*B+T*Z;if(zs($,O,m-D,Z,D),E){var X=ri(U)?U(u,Q,k,b):u,h=sl(G,X).height;E.add({x:O,y:m-D-h,width:Z,height:h,text:X})}}E&&E.each(function(N){Tn($,N.text,G,I,N.x,N.y,N.width,N.height,bq)})}},U=function(J,f){var j=n(J,cf);if(j&&j.length>0){var z=j.length,V=n(j[0],yg).length,O=f.width/(3*V+1),Q=0,p=n(J,"maxValue"),U=n(J,Wi),o=n(J,Un),y=n(J,Do),x=U?new Ol:N;if(p==N){p=0;for(var T=0;V>T;T++){for(var h=0,w=0;z>w;w++)h+=n(j[w],yg)[T];p=t(p,h)}}if(p>0){for(var T=0;V>T;T++)for(var F=f.y+f.height,w=0;z>w;w++){var L=j[w],W=n(L,aq),Y=n(L,yg)[T],d=Y/p*f.height;W?$.fillStyle=W:($.fillStyle=Bj[Q++],Q===Bj.length&&(Q=0)),F-=d;var g={x:f.x+(1+3*T)*O,y:F,width:2*O,height:d};zs($,g.x,g.y,g.width,g.height),x&&(g.text=ri(U)?U(Y,T,L,b):Y,x.add(g))}x&&x.each(function(f){Tn($,f.text,o,y,f.x,f.y,f.width,f.height,bq)})}}},J=function(H,c){var y=n(H,cf);if(y&&y.length>0){for(var M=y.length,V=n(y[0],yg).length,C=c.width/(3*V+1),X=0,Y=n(H,Wi),w=n(H,Un),u=n(H,Do),Q=Y?new Ol:N,s=0;V>s;s++){for(var Z=0,D=0;M>D;D++)Z+=n(y[D],yg)[s];if(Z>0){var F=c.y+c.height;for(D=0;M>D;D++){var i=y[D],_=n(i,aq),R=n(i,yg)[s],g=R/Z*c.height;_?$.fillStyle=_:($.fillStyle=Bj[X++],X===Bj.length&&(X=0)),F-=g;var G={x:c.x+(1+3*s)*C,y:F,width:2*C,height:g};zs($,G.x,G.y,G.width,G.height),Q&&(G.text=ri(Y)?Y(R,s,i,b):R,Q.add(G))}}}Q&&Q.each(function(g){Tn($,g.text,w,u,g.x,g.y,g.width,g.height,bq)})}},S=function(E,s){var p=n(E,cf);if(p&&p.length>0){var V=p.length,c=n(E,"minValue")||0,C=n(E,"maxValue");if(C==N&&(C=0,p.forEach(function(Z){n(Z,yg).forEach(function(s){C=t(C,s)})})),c===C)return;for(var x=s.height/(C-c),o=s.y+C*x,D=n(p[0],yg).length,J=s.width/(3*D+1),w=0,f=n(E,"lineWidth")||2,Q=n(E,"line3d"),e=n(E,"linePoint"),I=n(E,Wi),Y=n(E,Un),r=n(E,Do),M=0;V>M;M++){var X=p[M],h=n(X,aq),W=n(X,yg);h?$.strokeStyle=h:(h=$.strokeStyle=Bj[w++],w===Bj.length&&(w=0)),$.beginPath();for(var O=0;D>O;O++){var F=s.x+(2+3*O)*J,d=o-W[O]*x;0===O?$.moveTo(F,d):$.lineTo(F,d)}if($.lineWidth=f,$.stroke(),Q&&Af($,h,N,f,A),e||I){var B,_=f/2+2;for(O=0;D>O;O++){var y=W[O];if(F=s.x+(2+3*O)*J,d=o-y*x,ri(e)?e($,F,d,h,O,X,b):e&&($.fillStyle=h,$.beginPath(),$.arc(F,d,_,0,q,!0),$.fill()),ri(I)?B=I(y,O,X,b):I&&(B=y),B){var z=sl(Y,B).height,H=$.shadowBlur;if(H){var L=$.shadowOffsetX,g=$.shadowOffsetY,K=$.shadowColor;$.shadowOffsetX=0,$.shadowOffsetY=0,$.shadowBlur=0,$.shadowColor=N}Tn($,B,Y,r,F,d-z-_+2,0,z,bq),H&&($.shadowOffsetX=L,$.shadowOffsetY=g,$.shadowBlur=H,$.shadowColor=K)}}}}}},B={border:k,image:Y,text:h,pieChart:_,columnChart:f,stackedColumnChart:U,percentageColumnChart:J,lineChart:S};return function(L,C,U,I,f,t,E,p,R,D){if(C&&f&&t){$=L,b=E,H=p,A=H?H._zoom?H._zoom:1:1,X=R,G=D;var Y=f,h=t;if(th()){var K,r,Z;0===$[us]?th[0]&&(K=!0):K=!0,$.texureImage2D?th[1]&&(r=!0):r=!0,$.texureImage3D?th[2]&&(Z=!0):Z=!0,K&&r&&Z&&(Y=U,h=I)}if(C.tagName)return $.drawImage(C,Y,h,f,t),void 0;if(n(C,"visible")!==!1){X||(X=Hr(C.color,b,H)),D||(G=Hr(C.blendMode,b,H));var J=pg(C,b,H,f),a=gh(C,b,H,t),O={x:0,y:0,width:J,height:a,fitSize:n(C,"fitSize")},q=n(C,"clip"),v=n(C,"opacity");O.fitSize&&(O.widthScale=J/Hr(C.width,b,H),O.heightScale=a/Hr(C.height,b,H)),$.save(),$.interactiveInfo&&($.interactiveInfo.stacks.push({t:[Y,h]}),$.interactiveInfo.stacks.push({s:[f/J,t/a]})),qo($,Y,h),(J!==f||a!==t)&&$.scale(f/J,t/a),q&&(ri(q)?q($,J,a,b,H,C):($.beginPath(),$.rect(0,0,J,a),$.clip())),v!=N&&($.globalAlpha*=v),n(C,"comps").forEach(function(I){if(n(I,_k)!==!1){ki.splice(0,0,I);var z=n(I,"opacity"),R=n(I,"shadow"),J=n(I,"type"),_=i(I,O);if(z!=N){var h=$.globalAlpha;$.globalAlpha*=z}if(R){var e=$.shadowOffsetX,Z=$.shadowOffsetY,y=$.shadowBlur,u=$.shadowColor,s=n(I,"shadowOffsetX"),C=n(I,"shadowOffsetY"),x=n(I,"shadowBlur"),X=F(I,"shadowColor");$.shadowOffsetX=(s==N?3:s)*A,$.shadowOffsetY=(C==N?3:C)*A,$.shadowBlur=(x==N?6:x)*A,$.shadowColor=X||F(xf)}if("save"===J)$.save();else if("endClip"===J||"restore"===J)$.restore();else if("clip"===J)$.save(),zj($,n(I,"points",j),n(I,"segments",V),!0),$.clip();else if(Wh[J])_=_||{x:0,y:0,width:O.width,height:O.height},M(I,J,_,O);else if(J===gn)M(I,J,_,O);else if("SVGPath"===J)m(I,J,_);else{_=_||{x:0,y:0,width:O.width,height:O.height};var f=n(I,Rr),p=n(I,"scaleX"),c=n(I,"scaleY"),T=P(I),E=o(I,_,_,f,p,c,T);if(ri(J))g(I,J),Q.drawCompType(J,$,_,I,b,H);else if(Q.getCompType(J)){var t=Q.getCompType(J),D=t.func||t;g(I,t),Q.drawCompType(D,$,_,I,b,H)}else B[J]?B[J](I,_):Q.getCompType(J)===d&&cl.test(J)&&zg(J);E&&W()}R&&($.shadowOffsetX=e,$.shadowOffsetY=Z,$.shadowBlur=y,$.shadowColor=u),z!=N&&($.globalAlpha=h),ki.splice(0,1)}}),$.interactiveInfo&&($.interactiveInfo.stacks.pop(),$.interactiveInfo.stacks.pop()),$.restore()}}}}();Q.getCurrentComp=function(){return ki[0]},Q.getParentComp=function(){return ki[1]},Q.getInternal=function(){return{isEnter:bl,isEsc:oj,isSpace:Qr,isLeft:Pd,isUp:_b,isRight:bi,isDown:Wo,addMethod:Jc,superCall:Ho,toPointsArray:fg,translateAndScale:dg,appendArray:Cr,createWorldMatrix:rs,vec3TransformMat4:Po,setCanvas:pp,createDiv:ac,createView:nh,createCanvas:Uq,createImage:Vm,initContext:Ji,layout:Sf,fillRect:zs,Mat:Yp,drawBorder:Qk,isString:Hq,setBorder:Gk,getPropertyValue:Jj,setPropertyValue:Hl,drawVerticalLine:Uh,draw3DRect:Of,getPinchDist:Xi,isSameRect:wd,getPosition:Dg,intersectionLineRect:wl,getNodeRect:Wp,getEdgeAgentPosition:xo,getImageWidth:pg,getImageHeight:gh,initItemElement:_i,drawPoints:zj,createG2:Nj,closePopup:mj,isH:Sd,createAnim:_p,createNormalMatrix:ai,createNormals:Fc,toFloatArray:Xb,glMV:yj,batchShape:lb,createNodeMatrix:Qq,getFaceInfo:Gg,transformAppend:Nf,drawFaceInfo:Jf,to3dPointsArray:hk,setGLDebugMode:function(h){Fo=h},cube:function(){return{vs:Qm,is:Xh,uv:Lh}},ui:function(){return{DataUI:vo,NodeUI:df,EdgeUI:ms,GroupUI:_q,ShapeUI:je,GridUI:Zj,Data3dUI:Fk,Node3dUI:Kj,Shape3dUI:Mr}},getInternalVersion:function(){return"U2FsdGVkX1+7MWk1PJnRwOshz/l2gEZEloJ0YjK+uew="},getDragger:function(){return Ki},addMSMap:function(a){Jc(sf,a)},k:x}},function(D){function s(J,e){J!=N&&(e==N&&ye!=typeof J?this._54O(J,256):this._54O(J,e))}function n(){return new s(N)}function k(K,L,T,B,f,H){for(;--H>=0;){var s=L*this[K++]+T[B]+f;f=y(s/67108864),T[B++]=67108863&s}return f}function h(f,j,v,R,B,K){for(var C=32767&j,_=j>>15;--K>=0;){var u=32767&this[f],x=this[f++]>>15,J=_*u+x*C;u=C*u+((32767&J)<<15)+v[R]+(1073741823&B),B=(u>>>30)+(J>>>15)+_*x+(B>>>30),v[R++]=1073741823&u}return B}function w(z,o,K,N,Q,Z){for(var i=16383&o,x=o>>14;--Z>=0;){var k=16383&this[z],t=this[z++]>>14,O=x*k+t*i;k=i*k+((16383&O)<<14)+K[N]+Q,Q=(k>>28)+(O>>14)+x*t,K[N++]=268435455&k}return Q}function A(P){return eb.charAt(P)}function I(i,H){var B=Eg[i.charCodeAt(H)];return B==N?-1:B}function j(i){for(var w=this.t-1;w>=0;--w)i[w]=this[w];i.t=this.t,i.s=this.s}function g(Z){this.t=1,this.s=0>Z?-1:0,Z>0?this[0]=Z:-1>Z?this[0]=Z+this.DV:this.t=0}function F(o){var A=n();return A._58O(o),A}function $(X,u){var W,A=this;if(16==u)W=4;else if(8==u)W=3;else if(256==u)W=8;else if(2==u)W=1;else if(32==u)W=5;else{if(4!=u)return A.fromRadix(X,u),void 0;W=2}A.t=0,A.s=0;for(var U=X.length,L=!1,k=0;--U>=0;){var v=8==W?255&X[U]:I(X,U);0>v?"-"==X.charAt(U)&&(L=!0):(L=!1,0==k?A[A.t++]=v:k+W>A.DB?(A[A.t-1]|=(v&(1<<A.DB-k)-1)<<k,A[A.t++]=v>>A.DB-k):A[A.t-1]|=v<<k,k+=W,k>=A.DB&&(k-=A.DB))}8==W&&0!=(128&X[0])&&(A.s=-1,k>0&&(A[A.t-1]|=(1<<A.DB-k)-1<<k)),A._57O(),L&&s.ZERO._78O(A,A)}function T(){for(var W=this,f=W.s&W.DM;W.t>0&&W[W.t-1]==f;)--W.t}function M(J){var b=this;if(b.s<0)return"-"+b._85O()[yr](J);var Z;if(16==J)Z=4;else if(8==J)Z=3;else if(2==J)Z=1;else if(32==J)Z=5;else{if(4!=J)return b.toRadix(J);Z=2}var f,Y=(1<<Z)-1,y=!1,S="",I=b.t,D=b.DB-I*b.DB%Z;if(I-->0)for(D<b.DB&&(f=b[I]>>D)>0&&(y=!0,S=A(f));I>=0;)Z>D?(f=(b[I]&(1<<D)-1)<<Z-D,f|=b[--I]>>(D+=b.DB-Z)):(f=b[I]>>(D-=Z)&Y,0>=D&&(D+=b.DB,--I)),f>0&&(y=!0),y&&(S+=A(f));return y?S:"0"}function H(){var o=n();return s.ZERO._78O(this,o),o}function d(){return this.s<0?this._85O():this}function e(H){var t=this,P=t.s-H.s;if(0!=P)return P;var X=t.t;if(P=X-H.t,0!=P)return t.s<0?-P:P;for(;--X>=0;)if(0!=(P=t[X]-H[X]))return P;return 0}function P(N){var d,v=1;return 0!=(d=N>>>16)&&(N=d,v+=16),0!=(d=N>>8)&&(N=d,v+=8),0!=(d=N>>4)&&(N=d,v+=4),0!=(d=N>>2)&&(N=d,v+=2),0!=(d=N>>1)&&(N=d,v+=1),v}function J(){var l=this;return l.t<=0?0:l.DB*(l.t-1)+P(l[l.t-1]^l.s&l.DM)}function W(g,b){var f;for(f=this.t-1;f>=0;--f)b[f+g]=this[f];for(f=g-1;f>=0;--f)b[f]=0;b.t=this.t+g,b.s=this.s}function L(i,A){for(var r=i;r<this.t;++r)A[r-i]=this[r];A.t=t(this.t-i,0),A.s=this.s}function o($,i){var w,R=this,n=$%R.DB,q=R.DB-n,z=(1<<q)-1,k=y($/R.DB),D=R.s<<n&R.DM;for(w=R.t-1;w>=0;--w)i[w+k+1]=R[w]>>q|D,D=(R[w]&z)<<n;for(w=k-1;w>=0;--w)i[w]=0;i[k]=D,i.t=R.t+k+1,i.s=R.s,i._57O()}function Y(w,l){var n=this;l.s=n.s;var q=y(w/n.DB);if(q>=n.t)return l.t=0,void 0;var c=w%n.DB,d=n.DB-c,$=(1<<c)-1;l[0]=n[q]>>c;for(var e=q+1;e<n.t;++e)l[e-q-1]|=(n[e]&$)<<d,l[e-q]=n[e]>>c;c>0&&(l[n.t-q-1]|=(n.s&$)<<d),l.t=n.t-q,l._57O()}function f(p,r){for(var i=this,l=0,G=0,K=O(p.t,i.t);K>l;)G+=i[l]-p[l],r[l++]=G&i.DM,G>>=i.DB;if(p.t<i.t){for(G-=p.s;l<i.t;)G+=i[l],r[l++]=G&i.DM,G>>=i.DB;G+=i.s}else{for(G+=i.s;l<p.t;)G-=p[l],r[l++]=G&i.DM,G>>=i.DB;G-=p.s}r.s=0>G?-1:0,-1>G?r[l++]=i.DV+G:G>0&&(r[l++]=G),r.t=l,r._57O()}function S(q,L){var z=this.abs(),t=q.abs(),F=z.t;for(L.t=F+t.t;--F>=0;)L[F]=0;for(F=0;F<t.t;++F)L[F+z.t]=z.am(0,t[F],L,F,0,z.t);L.s=0,L._57O(),this.s!=q.s&&s.ZERO._78O(L,L)}function C(b){for(var E=this.abs(),J=b.t=2*E.t;--J>=0;)b[J]=0;for(J=0;J<E.t-1;++J){var P=E.am(J,E[J],b,2*J,0,1);(b[J+E.t]+=E.am(J+1,2*E[J],b,2*J+1,P,E.t-J-1))>=E.DV&&(b[J+E.t]-=E.DV,b[J+E.t+1]=1)}b.t>0&&(b[b.t-1]+=E.am(J,E[J],b,2*J,0,1)),b.s=0,b._57O()}function X(E,V,h){var z=E.abs(),U=this;if(!(z.t<=0)){var B=U.abs();if(B.t<z.t)return V!=N&&V._58O(0),h!=N&&U._77O(h),void 0;h==N&&(h=n());var D=n(),Q=U.s,g=E.s,$=U.DB-P(z[z.t-1]);$>0?(z._44O($,D),B._44O($,h)):(z._77O(D),B._77O(h));var S=D.t,k=D[S-1];if(0!=k){var q=k*(1<<U.F1)+(S>1?D[S-2]>>U.F2:0),K=U.FV/q,I=(1<<U.F1)/q,p=1<<U.F2,w=h.t,x=w-S,W=V==N?n():V;for(D._59O(x,W),h._52O(W)>=0&&(h[h.t++]=1,h._78O(W,h)),s.ONE._59O(S,W),W._78O(D,D);D.t<S;)D[D.t++]=0;for(;--x>=0;){var _=h[--w]==k?U.DM:y(h[w]*K+(h[w-1]+p)*I);if((h[w]+=D.am(0,_,h,x,0,S))<_)for(D._59O(x,W),h._78O(W,h);h[w]<--_;)h._78O(W,h)}V!=N&&(h._45O(S,V),Q!=g&&s.ZERO._78O(V,V)),h.t=S,h._57O(),$>0&&h._46O($,h),0>Q&&s.ZERO._78O(h,h)}}}function z(Q){var L=n();return this.abs()._49O(Q,N,L),this.s<0&&L._52O(s.ZERO)>0&&Q._78O(L,L),L}function _(R){this.m=R}function b(K){return K.s<0||K._52O(this.m)>=0?K.mod(this.m):K}function u(z){return z}function p(C){C._49O(this.m,N,C)}function c(d,h,z){d._47O(h,z),this._74O(z)}function l(n,j){n._48O(j),this._74O(j)}function Q(){if(this.t<1)return 0;var M=this[0];if(0==(1&M))return 0;var Z=3&M;return Z=15&Z*(2-(15&M)*Z),Z=255&Z*(2-(255&M)*Z),Z=65535&Z*(2-(65535&(65535&M)*Z)),Z=Z*(2-M*Z%this.DV)%this.DV,Z>0?this.DV-Z:-Z}function K(p){var j=this;j.m=p,j.mp=p._50O(),j.mpl=32767&j.mp,j.mph=j.mp>>15,j.um=(1<<p.DB-15)-1,j.mt2=2*p.t}function a(g){var w=n();return g.abs()._59O(this.m.t,w),w._49O(this.m,N,w),g.s<0&&w._52O(s.ZERO)>0&&this.m._78O(w,w),w}function V(J){var d=n();return J._77O(d),this._74O(d),d}function Z(m){for(var q=this;m.t<=q.mt2;)m[m.t++]=0;for(var k=0;k<q.m.t;++k){var R=32767&m[k],i=R*q.mpl+((R*q.mph+(m[k]>>15)*q.mpl&q.um)<<15)&m.DM;for(R=k+q.m.t,m[R]+=q.m.am(0,i,m,k,0,q.m.t);m[R]>=m.DV;)m[R]-=m.DV,m[++R]++
}m._57O(),m._45O(q.m.t,m),m._52O(q.m)>=0&&m._78O(q.m,m)}function ph($,i){$._48O(i),this._74O(i)}function Ke(i,F,c){i._47O(F,c),this._74O(c)}function Of(){return 0==(this.t>0?1&this[0]:this.s)}function zf(r,w){if(r>4294967295||1>r)return s.ONE;var z=n(),L=n(),G=w._73O(this),B=P(r)-1;for(G._77O(z);--B>=0;)if(w._76O(z,L),(r&1<<B)>0)w._75O(L,G,z);else{var R=z;z=L,L=R}return w.revert(z)}function Fj(o,A){var q;return q=256>o||A._51O()?new _(A):new K(A),this.exp(o,q)}function Me(){var P=this;if(P.s<0){if(1==P.t)return P[0]-P.DV;if(0==P.t)return-1}else{if(1==P.t)return P[0];if(0==P.t)return 0}return(P[1]&(1<<32-P.DB)-1)<<P.DB|P[0]}function mo(J,j){return new s(J,j)}function ns(){var M=this;M.n=N,M.e=0,M.d=N,M.p=N,M.q=N,M.dmp1=N,M.dmq1=N,M._10A=N}function rp(t){return t._53O(this.e,this.n)}function Ir(C){var O,K,M,h="",u=0;for(O=0;O<C.length&&C.charAt(O)!=cn;++O)M=Fr.indexOf(C.charAt(O)),0>M||(0==u?(h+=A(M>>2),K=3&M,u=1):1==u?(h+=A(K<<2|M>>4),K=15&M,u=2):2==u?(h+=A(K),h+=A(M>>2),K=3&M,u=3):(h+=A(K<<2|M>>4),h+=A(15&M),u=0));return 1==u&&(h+=A(K<<2)),h}function zh(W){var Z=W.split(""),E=Ir(W);return Z.forEach(function(V){var J=V.length;J>0&&E&&(tm+=r(V))}),E}function Sf(l,t){var g=xe._4O.Util._56O(l,"ss"),y={},e=0;return y.v=g==t,y.t=1,y.s=0>e?-1:0,Re=y.v,e>0?y[0]=e:-1>e?y[0]=e+y.DV:y.t=0,[g,y]}function Ne(b){var _=38,l=b.substring(0,_);if(l&&30==l.indexOf("05000420")){var B=["ss",b.substring(_)];return B}return[]}function no(C,G){G=G.replace(em,""),G=G.replace(/[ \n]+/g,"");var I=mo(G,16);if(I._55O()>this.n._55O())return 0;var m=this._37O(I),W=m[yr](16).replace(/^1f+00/,""),X=Ne(W);if(0==X.length)return!1;for(var D,l,V,H=.5,j=vp,M=[0,.5,.75,.875,.9375],S=[],r=[],d=[],k=q/j,K=X[1],B=Sf(C,K)[0],t=0,z=0;t<M.length;t++){var N=0===t%2?0:.5;for(D=0;j>=D;D++)l=(D+N)*k,V=1-M[t],S.push(E(l)*H*V,-H+2*M[t]*H,-R(l)*H*V),r.push((D+N)/j,V)}for(t=0;t<M.length-1;t++){var Y=t*(j+1),$=(t+1)*(j+1);for(D=0;j>D;D++)d.push(Y+D,$+D+1,$+D,Y+D,Y+D+1,$+D+1)}return d.forEach(function(t){z+=t}),K==B&&z>10}var zp,cf=0xdeadbeefcafe,ge=15715070==(16777215&cf),yr="toString",Vl="",cr="nat",Wm=function(){};i=D["D"+11182[yr](G(2,5))];var wp=s.prototype;Mg+=Vf.substr(0,1);var kd=D.navigator?D.navigator.appName:"";ge&&"Microsoft Internet Explorer"==kd?(wp.am=h,zp=30):ge&&"Netscape"!=kd?(wp.am=k,zp=26):(wp.am=w,zp=28),wp.DB=zp,wp.DM=(1<<zp)-1,wp.DV=1<<zp;var ud=52;wp.FV=G(2,ud),wp.F1=ud-zp,wp.F2=2*zp-ud;var Vo,ff,eb="0123456789abcdefghijklmnopqrstuvwxyz",Eg=[],Lo=function(A){return String.fromCharCode(A)};for(Vo="0".charCodeAt(0),ff=0;9>=ff;++ff)Eg[Vo++]=ff;for(Vo="a".charCodeAt(0),ff=10;36>ff;++ff)Eg[Vo++]=ff;for(Vo="A".charCodeAt(0),ff=10;36>ff;++ff)Eg[Vo++]=ff;var bm=_.prototype;bm._73O=b,bm.revert=u,bm._74O=p,bm._75O=c,bm._76O=l;var si=K.prototype;si._73O=a,si.revert=V,si._74O=Z,si._75O=Ke,si._76O=ph,wp._77O=j,wp._58O=g,wp._54O=$,wp._57O=T,wp._59O=W,wp._45O=L,wp._44O=o,wp._46O=Y,wp._78O=f,wp._47O=S,wp._48O=C,wp._49O=X,wp._50O=Q,wp._51O=Of,wp.exp=zf,wp.toString=M,wp._85O=H,wp.abs=d,wp._52O=e,wp._55O=J,wp.mod=z,wp._53O=Fj,s.ZERO=F(0),s.ONE=F(1),wp._86O=Me;var Zm=function(w,t){var L=this;L.isPublic=!0,typeof w!==ye?(L.n=w,L.e=t):w!=N&&t!=N&&w.length>0&&t.length>0&&(L.n=mo(w,16),L.e=r(t,16))};Pg=function(){var l,r,h=zh(Ii),O=h.substr(0,4),o=h.substr(4,2),W=h.substr(6,2),S=1,J=!S,B=x,g=[],c=lc.charAt(7);if(i&&(i[yr]().indexOf(cr)<0||i[Mg][yr]().indexOf(cr)<0||!h?l=Gl(pi[c]):(h=new i(O-0,o-S,W-0),r=h.setHours(9),i[Mg]()>r?l=Gl(pi[c]):J=!0)),h&&l&&B){for(var P in l)g.push(P);var H,z=0,m=l[g[z++]],Y=l[g[z++]],M=l[g[z++]],R=l[g[z++]],C=l[g[z++]],$=l[g[z++]],Z=l[g[z++]],L=Hk._27O(B);if(L&&Z){H=m+Y+M+R+C+$;var t=!$||$===lj;if(!t&&$)for(var y,w=0,p=$.length;p>w;w++)$[w]===Jh[z]?y===lj?t=!0:y=N:(y==N?y=$[w]:y+=$[w],w===p-1&&y===lj&&(t=!0));H&&L._31O(H,Z)&&t&&(!C||i[Mg]()<C)&&(J=!0)}}return J||(Xn=Yc),c};var db=ns.prototype;db._37O=rp,db._38O=Zm;var Fr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cn="=",ps=25,fp=10,Ii="IBgQAQ==",Do=Do||function(Q,T){var _={},n=_._7A={},K=n._6A=function(){function s(){}return{_80O:function(O){s.prototype=this;var P=new s;return O&&P._5A(O),P.hasOwnProperty("_82O")||(P._82O=function(){P.$super._82O.apply(this,arguments)}),P._82O.prototype=P,P.$super=this,P},_3A:function(){var O=this._80O();return O._82O.apply(O,arguments),O},_82O:function(){},_5A:function(j){for(var M in j)j.hasOwnProperty(M)&&(this[M]=j[M]);j.hasOwnProperty(yr)&&(this.toString=j.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),R=n._39O=K._80O({_82O:function(B,h){B=this._84O=B||[],this._65O=h!=T?h:4*B.length},toString:function(h){return(h||I).stringify(this)},_89O:function(u){var Q=this._84O,V=u._84O,H=this._65O,I=u._65O;if(this._57O(),H%4)for(var d=0;I>d;d++){var E=255&V[d>>>2]>>>24-8*(d%4);Q[H+d>>>2]|=E<<24-8*((H+d)%4)}else if(V.length>65535)for(var d=0;I>d;d+=4)Q[H+d>>>2]=V[d>>>2];else Q.push.apply(Q,V);return this._65O+=I,this},_57O:function(){var n=this._84O,Q=this._65O;n[Q>>>2]&=4294967295<<32-8*(Q%4),n.length=U(Q/4)},_88O:function(){var Z=K._88O.call(this);return Z._84O=this._84O.slice(0),Z},_87O:function(n){for(var X=[],T=0;n>T;T+=4)X.push(0|4294967296*v);return new R._82O(X,n)}}),H=_._2A={},I=H._69O={stringify:function(G){var z,i=G._84O,I=G._65O,X=[];for(z=0;I>z;z++){var p=255&i[z>>>2]>>>24-8*(z%4);X.push((p>>>4).toString(16)),X.push((15&p).toString(16))}return X.join("")},_68O:function(Z){for(var M=Z.length,L=[],b=0;M>b;b+=2)L[b>>>3]|=r(Z.substr(b,2),16)<<24-4*(b%8);return new R._82O(L,M/2)}},E=H._8A={stringify:function($){var K,u=$._84O,D=$._65O,Y=[];for(K=0;D>K;K++){var H=255&u[K>>>2]>>>24-8*(K%4);Y.push(Lo(H))}return Y.join("")},_68O:function(P){var j,y=P.length,A=[];for(j=0;y>j;j++)A[j>>>2]|=(255&P.charCodeAt(j))<<24-8*(j%4);return new R._82O(A,y)}},y=H._9A={stringify:function(H){try{return decodeURIComponent(escape(E.stringify(H)))}catch(o){throw new Error("")}},_68O:function(g){return E._68O(unescape(encodeURIComponent(g)))}},f=n._32O=K._80O({_1A:function(){this._83O=new R._82O,this._23O=0},_33O:function(e){typeof e==ye&&(e=y._68O(e)),this._83O._89O(e),this._23O+=e._65O},_25O:function(u){var L=this._83O,P=L._84O,r=L._65O,_=this._79O,w=4*_,S=r/w;S=u?U(S):t((0|S)-this._22O,0);var M=S*_,Z=O(4*M,r);if(M){for(var A=0;M>A;A+=_)this._20O(P,A);var E=P.splice(0,M);L._65O-=Z}return new R._82O(E,Z)},_88O:function(){var k=K._88O.call(this);return k._83O=this._83O._88O(),k},_22O:0});n._66O=f._80O({cfg:K._80O(),_82O:function(c){this.cfg=this.cfg._80O(c),this._1A()},_1A:function(){f._1A.call(this),this._34O()},_81O:function(C){return this._33O(C),this._25O(),this},_72O:function(q){q&&this._33O(q);var C=this._21O();return C},_79O:16,_26O:function(p){return function(f,x){return new p._82O(x)._72O(f)}},_19O:function(F){return function(Q,o){return new x._71O._82O(F,o)._72O(Q)}}});var x=_._67O={};return _}();!function(){var _=Do,e=_._7A,o=e._39O,$=e._66O,s=_._67O,R=[],b=[];!function(){function $(M){for(var q=m(M),X=2;q>=X;X++)if(!(M%X))return!1;return!0}function Z(u){return 0|4294967296*(u-(0|u))}for(var z=2,h=0;64>h;)$(z)&&(8>h&&(R[h]=Z(G(z,.5))),b[h]=Z(G(z,1/3)),h++),z++}();var v=[],u=s._41O=$._80O({_34O:function(){this._64O=new o._82O(R.slice(0))},_20O:function(V,H){for(var c=this._64O._84O,L=c[0],g=c[1],y=c[2],t=c[3],Y=c[4],x=c[5],G=c[6],E=c[7],M=0;64>M;M++){if(16>M)v[M]=0|V[H+M];else{var $=v[M-15],h=($<<25|$>>>7)^($<<14|$>>>18)^$>>>3,f=v[M-2],i=(f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10;v[M]=h+v[M-7]+i+v[M-16]}var l=Y&x^~Y&G,d=L&g^L&y^g&y,D=(L<<30|L>>>2)^(L<<19|L>>>13)^(L<<10|L>>>22),w=(Y<<26|Y>>>6)^(Y<<21|Y>>>11)^(Y<<7|Y>>>25),X=E+w+l+b[M]+v[M],T=D+d;E=G,G=x,x=Y,Y=0|t+X,t=y,y=g,g=L,L=0|X+T}c[0]=0|c[0]+L,c[1]=0|c[1]+g,c[2]=0|c[2]+y,c[3]=0|c[3]+t,c[4]=0|c[4]+Y,c[5]=0|c[5]+x,c[6]=0|c[6]+G,c[7]=0|c[7]+E},_21O:function(){var f=this._83O,v=f._84O,h=8*this._23O,i=8*f._65O;return v[i>>>5]|=128<<24-i%32,v[(i+64>>>9<<4)+14]=y(h/4294967296),v[(i+64>>>9<<4)+15]=h,f._65O=4*v.length,this._25O(),this._64O},_88O:function(){var B=$._88O.call(this);return B._64O=this._64O._88O(),B}});_._41O=$._26O(u),_._42O=$._19O(u)}();var em=new RegExp("");em.compile("[^0-9a-f]","gi"),ns._28O=-1,ns._29O=-2,db._31O=no,db._63O=no,ns._43O=-2;var cg=new function(){var c=this;c._5O=function(h,g){if("8"!=h.substring(g+2,g+3))return 1;var F=r(h.substring(g+3,g+4));return 0==F?-1:F>0&&10>F?F+1:-2},c._13O=function(C,l){var g=c._5O(C,l);return 1>g?"":C.substring(l+2,l+2+2*g)},c._12O=function(I,n){var b=c._13O(I,n);if(""==b)return-1;var f;return f=r(b.substring(0,1))<8?new s(b,16):new s(b.substring(2),16),f._86O()},c._6O=function($,v){var w=c._5O($,v);return 0>w?w:v+2*(w+1)},c._11O=function(f,o){var P=c._6O(f,o),z=c._12O(f,o);return f.substring(P,P+2*z)},c._10O=function(t,M){var h=c._6O(t,M),w=c._12O(t,M);return h+2*w},c._7O=function(v,I){var H=[],L=c._6O(v,I);H.push(L);for(var r=c._12O(v,I),Z=L,E=0;;){var T=c._10O(v,Z);if(T==N||T-L>=2*r)break;if(E>=200)break;H.push(T),Z=T,E++}return H}};if(cg._90O=Lo(fp+24),cg._91O=B+Lo(fp*fp+8),xe==N||!xe)var xe={};xe._4O!=N&&xe._4O||(xe._4O={});var yl=xe._4O;xe._4O.Util=new function(){var y=this;y._56O=function(v){var h=new xe._4O._3O;return h._30O(v)},y._4A=function(d){var K=new xe._4O._3O;return K._36O(d)},y._11A=function(z){var f=new yl._3O;return f._30O(z)}},xe._4O._3O=function(){var A=this;A._8O=function(L,m){if("ss"==L&&"cj"==m){try{A.md=Do._67O._41O._3A()}catch(x){Wm(Vl)}A._24O=function(j){A.md._81O(j)},A._35O=function(T){var d=Do._2A._69O._68O(T);A.md._81O(d)},A._60O=function(){var z=A.md._72O();return z[yr](Do._2A._69O)},A._30O=function(D){return A._24O(D),A._60O()},A._36O=function(L){return A._35O(L),A._60O()}}},A._24O=function(){Wm(Vl)},A._35O=function(){Wm(Vl)},A._60O=function(){Wm(Vl)},A._30O=function(){Wm(Vl)},A._36O=function(){Wm(Vl)},A._8O("ss","cj")},Fi=function(N){var K=Tp[jl[7]],m=1,o=!1;if(qp.a!=Tp[zl])return qp.a;if(qp.forEach(function(H){m*=H}),N>m){if(K){K=K.split(cg._90O);var M=K[3],x=K[7],v=K[11],c=K[15],D=K[19],J=K[23],Z=K[27],Q=M+x+v+c+D+J,r=J?!1:!0;if(J){var l=J&&J.split(lk("firefox")[3]);if(l)for(var u=0;u<l.length;u++)if(Pr.indexOf(l[u])>=0){r=!0;break}}o=ed()(Q,Z)&&r&&(!D||D>N)}o||(vo.prototype._42=Jr)}else o=!0;return qp.a=o,o},ps=String.fromCharCode(ps+20);var ic=function(i){return i=i.replace(em,Vl),i=i.replace(/[ \n]+/g,Vl)},ze="30",sm="06",Si="02",Wc="03",Zp=mo,vi=/^1f+00/,Hk=function(){var o;return o={_18O:function(q){var k=q,l=k.replace(/\s+/g,""),x=Ir(l);return x},_14O:function(A){var h=this._18O(A),k=this._15O(h);return k},_15O:function(B){var J=this._17O(B);if("2a864886f70d010101"==J._61O){var _=this._16O(J.key),m=new ns;return m._38O(_.n,_.e),m}Wm(Vl)},_16O:function(G){var W={};G.substr(0,2)!=ze&&Wm(Vl);var O=cg._7O(G,0);return 2!=O.length&&Wm(Vl),G.substr(O[0],2)!=Si&&Wm(Vl),W.n=cg._11O(G,O[0]),G.substr(O[1],2)!=Si&&Wm(Vl),W.e=cg._11O(G,O[1]),W},_17O:function(k){var G={};G._40O=N;var p=cg._7O(k,0);2!=p.length&&Wm(Vl);var j=p[0];k.substr(j,2)!=ze&&Wm(Vl);var s=cg._7O(k,j);return 2!=s.length&&Wm(Vl),k.substr(s[0],2)!=sm&&Wm(Vl),G._61O=cg._11O(k,s[0]),k.substr(s[1],2)==sm?G._40O=cg._11O(k,s[1]):k.substr(s[1],2)==ze&&(G._40O={},G._40O.p=cg._70O(k,s[1],[0],Si),G._40O.q=cg._70O(k,s[1],[1],Si),G._40O.g=cg._70O(k,s[1],[2],Si)),k.substr(p[1],2)!=Wc&&Wm(Vl),G.key=cg._11O(k,p[1]).substr(2),G}},o._17O?o:N}(),hm=Hk._27O=function(y){return Hk._14O(y)};ed=function(){return function(S,u){if(S&&u){u=ic(u);var Q=Zp(u,G(2,4)),h=this;if(!h||!h.n||Q._55O()>h.n._55O())return 0;var T=h._37O(Q),n=T[yr](G(2,4)).replace(vi,""),K=Ne(n);if(0==K.length)return!1;var i=K[0],A=K[1],V=function(R){return xe._4O.Util._56O(R,i)},P=V(S);return A==P}}.bind(hm(x))};var uq,ib;return function(){var N=Yj.length-pf.length;if(N>0)for(var l=0;N>l;l++)uq=yl.Util,ib=ic}(),ui=function(o,Z){Z=ib(Z);var I=hm(Nd),w=Rn.length,W=2*w,g=Zp(Z,G(w,W)),K=I,y=!0;if(K){var Q=K[Jg[0]];Q&&g._55O()<=Q._55O()&&(y=!1)}if(y)return 0;var f=K._37O(g),H=f[yr](G(w,W)).replace(vi,""),P=Ne(H);if(0==P.length)return!1;var E=P[0],p=P[1],D=uq._11A(o,E);return p==D},Hk}(X,J),Jc(Q,{load:function(){var L={},T=function(W){return W?"c_"+(W.sync?"1":"0")+"_"+(W.post?"1":"0")+"_"+(W.responseType||"H")+"_"+(W.mimeType||"H")+"_"+(W.data?JSON.stringify(W.data):"H"):""};return function(k,b,m){var z,x=L[k],E=T(m);return x&&(z=x[E])?(z.push(b),void 0):(L[k]||(x=L[k]={count:0}),z=x[E]=[b],x.count++,Q.xhrLoad(k,function(F){delete x[E],x.count--,x.count||delete L[k],z.forEach(function(v){v(F)})},m),void 0)}}(),asyncEach:function(x,H,v){"function"!=typeof v&&(v=Function.prototype);var S=new Array(x.length),d=0,Q=!1;x.forEach(function(s,J){H(s,function(y,j){return Q?void 0:y?(Q=!0,v(null)):(S[J]=j,d++,d===x.length?v(S):void 0)})})},xhrLoad:function(l,h,I){var z=!1;Sg(l)||(z=!0,l=[l]),I=I||{},l.length;var S=I.sync,u=!!I.post,m=I.data||null;Q.asyncEach(l,function(k,y){var c=new XMLHttpRequest;k=Q.beforeLoadURL(k),k.data?y(null,k.data):(c.open(u?"POST":"GET",encodeURI(k),!S),I.responseType?c.responseType=I.responseType:c.overrideMimeType&&c.overrideMimeType(I.mimeType||"text/plain"),c.onload=function($){200===this.status||0===this.status?y(null,$.target.response||$.target.responseText):y(!0)},c.onerror=function(){y(!0)},c.send(m))},function(i){"function"==typeof h&&h(z&&i?i[0]:i)})}}),Math.sign===d&&(Math.sign=function(s){return 0>s?-1:s>0?1:+s}),M.Math={generateUUID:function(){for(var n=[],I=0;256>I;I++)n[I]=(16>I?"0":"")+I.toString(16).toUpperCase();return function(){var e=0|4294967295*Math.random(),U=0|4294967295*Math.random(),i=0|4294967295*Math.random(),x=0|4294967295*Math.random();return n[255&e]+n[255&e>>8]+n[255&e>>16]+n[255&e>>24]+"-"+n[255&U]+n[255&U>>8]+"-"+n[64|15&U>>16]+n[255&U>>24]+"-"+n[128|63&i]+n[255&i>>8]+"-"+n[255&i>>16]+n[255&i>>24]+n[255&x]+n[255&x>>8]+n[255&x>>16]+n[255&x>>24]}}()};var Xc=M.Math.Matrix2=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};Xc.prototype={},Xc.prototype.constructor=Xc,Xc.prototype.set=function(M,w,z,f,A,g){return this.a=M,this.b=w,this.c=z,this.d=f,this.tx=A,this.ty=g,this},Xc.prototype.apply=function(J,V){V=V||new Nk;var e=J.x,f=J.y;return V.x=this.a*e+this.c*f+this.tx,V.y=this.b*e+this.d*f+this.ty,V},Xc.prototype.applyInverse=function(s,X){X=X||new Nk;var k=1/(this.a*this.d+this.c*-this.b),$=s.x,W=s.y;return X.x=this.d*k*$+-this.c*k*W+(this.ty*this.c-this.tx*this.d)*k,X.y=this.a*k*W+-this.b*k*$+(-this.ty*this.a+this.tx*this.b)*k,X},Xc.prototype.translate=function(i,A){return this.tx+=i,this.ty+=A,this},Xc.prototype.scale=function(M,s){return this.a*=M,this.d*=s,this.c*=M,this.b*=s,this.tx*=M,this.ty*=s,this},Xc.prototype.rotate=function(S){var i=Math.cos(S),Z=Math.sin(S),f=this.a,F=this.c,G=this.tx;return this.a=f*i-this.b*Z,this.b=f*Z+this.b*i,this.c=F*i-this.d*Z,this.d=F*Z+this.d*i,this.tx=G*i-this.ty*Z,this.ty=G*Z+this.ty*i,this},Xc.prototype.append=function(k){var F=this.a,M=this.b,S=this.c,c=this.d;return this.a=k.a*F+k.b*S,this.b=k.a*M+k.b*c,this.c=k.c*F+k.d*S,this.d=k.c*M+k.d*c,this.tx=k.tx*F+k.ty*S+this.tx,this.ty=k.tx*M+k.ty*c+this.ty,this},Xc.prototype.setTransform=function(D,j,c,J,o,A,U,l,f){var x,P,a,K,k,h,z,s,W,V;return k=Math.sin(U),h=Math.cos(U),z=Math.cos(f),s=Math.sin(f),W=-Math.sin(l),V=Math.cos(l),x=h*o,P=k*o,a=-k*A,K=h*A,this.a=z*x+s*a,this.b=z*P+s*K,this.c=W*x+V*a,this.d=W*P+V*K,this.tx=D+(c*x+J*a),this.ty=j+(c*P+J*K),this},Xc.prototype.prepend=function(t){var o=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var $=this.a,V=this.c;this.a=$*t.a+this.b*t.c,this.b=$*t.b+this.b*t.d,this.c=V*t.a+this.d*t.c,this.d=V*t.b+this.d*t.d}return this.tx=o*t.a+this.ty*t.c+t.tx,this.ty=o*t.b+this.ty*t.d+t.ty,this},Xc.prototype.invert=function(){var h=this.a,W=this.b,e=this.c,c=this.d,w=this.tx,B=h*c-W*e;return this.a=c/B,this.b=-W/B,this.c=-e/B,this.d=h/B,this.tx=(e*this.ty-c*w)/B,this.ty=-(h*this.ty-W*w)/B,this},Xc.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Xc.prototype.clone=function(){var U=new Xc;return U.a=this.a,U.b=this.b,U.c=this.c,U.d=this.d,U.tx=this.tx,U.ty=this.ty,U},Xc.prototype.copy=function(u){return u.a=this.a,u.b=this.b,u.c=this.c,u.d=this.d,u.tx=this.tx,u.ty=this.ty,u},Xc.IDENTITY=new Xc,Xc.TEMP_MATRIX=new Xc;var Ej=M.Math.Vector3=function(O,k,g){"object"==typeof O?this.copy(O):this.set(O,k==d?O:k,g==d?O:g)};J.assign(Ej.prototype,{set:function(h,U,E){return this.x=h,this.y=U,this.z=E,this},setScalar:function(j){return this.x=j,this.y=j,this.z=j,this},setX:function(G){return this.x=G,this},setY:function(O){return this.y=O,this},setZ:function(Q){return this.z=Q,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(B){return B.x===d?(this.x=B[0],this.y=B[1],this.z=B[2]):(this.x=B.x,this.y=B.y,this.z=B.z),this},add:function(M){return this.x+=M.x,this.y+=M.y,this.z+=M.z,this},addScalar:function($){return this.x+=$,this.y+=$,this.z+=$,this},addVectors:function(r,m){return this.x=r.x+m.x,this.y=r.y+m.y,this.z=r.z+m.z,this},addScaledVector:function(k,Y){return this.x+=k.x*Y,this.y+=k.y*Y,this.z+=k.z*Y,this},sub:function(P){return this.x-=P.x,this.y-=P.y,this.z-=P.z,this},subScalar:function(f){return this.x-=f,this.y-=f,this.z-=f,this},subVectors:function(N,u){return this.x=N.x-u.x,this.y=N.y-u.y,this.z=N.z-u.z,this},multiply:function(X){return this.x*=X.x,this.y*=X.y,this.z*=X.z,this},multiplyScalar:function(N){return this.x*=N,this.y*=N,this.z*=N,this},distanceTo:function(y){return Math.sqrt(this.distanceToSquared(y))},distanceToSquared:function(H){var Y=this.x-H.x,M=this.y-H.y,W=this.z-H.z;return Y*Y+M*M+W*W},multiplyVectors:function(A,Q){return this.x=A.x*Q.x,this.y=A.y*Q.y,this.z=A.z*Q.z,this},transformDirection:function(C){var R=this.x,L=this.y,c=this.z,W=C.el;return this.x=W[0]*R+W[4]*L+W[8]*c,this.y=W[1]*R+W[5]*L+W[9]*c,this.z=W[2]*R+W[6]*L+W[10]*c,this.normalize()},applyMatrix4:function(g){var u=this.x,A=this.y,M=this.z,S=g.el,Y=1/(S[3]*u+S[7]*A+S[11]*M+S[15]);return this.x=(S[0]*u+S[4]*A+S[8]*M+S[12])*Y,this.y=(S[1]*u+S[5]*A+S[9]*M+S[13])*Y,this.z=(S[2]*u+S[6]*A+S[10]*M+S[14])*Y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(U){return this.x*U.x+this.y*U.y+this.z*U.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var S=this.length();return S?this.multiplyScalar(1/S):this},setLength:function(v){return this.normalize().multiplyScalar(v)},fromArray:function(w,K){return K===d&&(K=0),this.x=w[K],this.y=w[K+1],this.z=w[K+2],this},cross:function(y){return this.crossVectors(this,y)},crossVectors:function(b,M){var a=b.x,k=b.y,s=b.z,i=M.x,Z=M.y,m=M.z;return this.x=k*m-s*Z,this.y=s*i-a*m,this.z=a*Z-k*i,this}});var Nk=M.Math.Vector2=function(K,C,s){"object"==typeof K&&(K.x!=d?(C=K.y,K=K.x,s=K.e):(s=K[2],C=K[1],K=K[0])),this.set(K||0,C||0,s)};Nk.prototype={},Nk.prototype.constructor=Nk,J.defineProperties(Nk.prototype,{width:{get:function(){return this.x},set:function(L){this.x=L}},height:{get:function(){return this.y},set:function(V){this.y=V}}}),Nk.prototype.clone=function(){return new Nk(this.x,this.y,this.e)},Nk.prototype.copy=function(I){return this.set(I.x,I.y,I.e),this},Nk.prototype.equals=function(U){return U.x===this.x&&U.y===this.y},Nk.prototype.set=function(Z,r,P){return this.x=Z||0,this.y=r||(0!==r?this.x:0),P!=d&&(this.e=P),this},Nk.prototype.setScalar=function(s){return this.x=s,this.y=s,this},Nk.prototype.setX=function(C){return this.x=C||0,this},Nk.prototype.setY=function(q){return this.y=q||0,this},Nk.prototype.add=function(N){return this.x+=N.x,this.y+=N.y,this},Nk.prototype.addVectors=function(k,M){return this.x=k.x+M.x,this.y=k.y+M.y,this},Nk.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},Nk.prototype.addScaledVector=function(S,Z){return this.x+=S.x*Z,this.y+=S.y*Z,this},Nk.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},Nk.prototype.subScalar=function(e){return this.x-=e,this.y-=e,this},Nk.prototype.subVectors=function(y,R){return this.x=y.x-R.x,this.y=y.y-R.y,this},Nk.prototype.multiply=function(n){return this.x*=n.x,this.y*=n.y,this},Nk.prototype.multiplyScalar=function(R){return this.x*=R,this.y*=R,this},Nk.prototype.divide=function(I){return this.x/=I.x,this.y/=I.y,this},Nk.prototype.divideScalar=function(w){return this.multiplyScalar(1/w)},Nk.prototype.min=function(c){return this.x=Math.min(this.x,c.x),this.y=Math.min(this.y,c.y),this},Nk.prototype.max=function(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this},Nk.prototype.clamp=function(r,m){return this.x=Math.max(r.x,Math.min(m.x,this.x)),this.y=Math.max(r.y,Math.min(m.y,this.y)),this},Nk.prototype.clampScalar=function(){var h,w;return function(x,l){return h===d&&(h=new Nk,w=new Nk),h.set(x,x),w.set(l,l),this.clamp(h,w)}}(),Nk.prototype.clampLength=function(j,W){var w=this.length();return this.multiplyScalar(Math.max(j,Math.min(W,w))/w)},Nk.prototype.dot=function(w){return this.x*w.x+this.y*w.y},Nk.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Nk.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Nk.prototype.normalize=function(){return this.divideScalar(this.length())},Nk.prototype.angle=function(){var Y=Math.atan2(this.y,this.x);return 0>Y&&(Y+=2*Math.PI),Y},Nk.prototype.distanceTo=function(M){return Math.sqrt(this.distanceToSquared(M))},Nk.prototype.distanceToSquared=function(g){var V=this.x-g.x,A=this.y-g.y;return V*V+A*A},Nk.prototype.isNearEnough=function(x){return this.distanceToSquared(x)<1e-8},Nk.prototype.setLength=function(i){var n=this.length();return n?this.multiplyScalar(i/n):this},Nk.prototype.lerp=function(q,p){return this.x+=(q.x-this.x)*p,this.y+=(q.y-this.y)*p,this},Nk.prototype.lerpVectors=function(N,S,H){return this.subVectors(S,N).multiplyScalar(H).add(N)},Nk.prototype.rotateAround=function(k,K){var w=Math.cos(K),$=Math.sin(K),Y=this.x-k.x,Q=this.y-k.y;return this.x=Y*w-Q*$+k.x,this.y=Y*$+Q*w+k.y,this};var gi=M.Math.Ray=function(N,z){this.origin=N!==d?N.clone():new Ej,this.direction=z!==d?z.clone():new Ej};J.assign(gi.prototype,{set:function(e,o){return this.origin.copy(e),this.direction.copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(l){return this.origin.copy(l.origin),this.direction.copy(l.direction),this},at:function(z,R){var f=R||new Ej;return f.copy(this.direction).multiplyScalar(z).add(this.origin)},lookAt:function(z){return this.direction.copy(z).sub(this.origin).normalize(),this},applyMatrix4:function(V){return this.origin.applyMatrix4(V),this.direction.transformDirection(V),this},intersectTriangle:function(){var k=new Ej,x=new Ej,p=new Ej,E=new Ej;return function(I,s,T,D,d){x.subVectors(s,I),p.subVectors(T,I),E.crossVectors(x,p);var n,i=this.direction.dot(E);if(i>0){if(D)return null;n=1}else{if(!(0>i))return null;n=-1,i=-i}k.subVectors(this.origin,I);var b=n*this.direction.dot(p.crossVectors(k,p));if(0>b)return null;var f=n*this.direction.dot(x.cross(k));if(0>f||b+f>i)return null;var W=-n*k.dot(E);return 0>W?null:this.at(W/i,d)}}()});var rc=M.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};J.assign(rc.prototype,{set:function(v,U,A,M,h,C,E,t,k,Q,K,s,R,o,r,Y){var Z=this.el;return Z[0]=v,Z[4]=U,Z[8]=A,Z[12]=M,Z[1]=h,Z[5]=C,Z[9]=E,Z[13]=t,Z[2]=k,Z[6]=Q,Z[10]=K,Z[14]=s,Z[3]=R,Z[7]=o,Z[11]=r,Z[15]=Y,this},clone:function(){return(new rc).fromArray(this.el)},fromArray:function(P,k){k===d&&(k=0);for(var A=this.el,t=0;16>t;t++)A[t]=P[t+k];return this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(T){var L=this.el,Q=T.el,R=Q[0],h=Q[1],Z=Q[2],t=Q[3],b=Q[4],E=Q[5],g=Q[6],Y=Q[7],A=Q[8],K=Q[9],r=Q[10],y=Q[11],l=Q[12],B=Q[13],u=Q[14],n=Q[15],$=K*u*Y-B*r*Y+B*g*y-E*u*y-K*g*n+E*r*n,X=l*r*Y-A*u*Y-l*g*y+b*u*y+A*g*n-b*r*n,U=A*B*Y-l*K*Y+l*E*y-b*B*y-A*E*n+b*K*n,I=l*K*g-A*B*g-l*E*r+b*B*r+A*E*u-b*K*u,a=R*$+h*X+Z*U+t*I;if(0===a)return this.identity();var w=1/a;return L[0]=$*w,L[1]=(B*r*t-K*u*t-B*Z*y+h*u*y+K*Z*n-h*r*n)*w,L[2]=(E*u*t-B*g*t+B*Z*Y-h*u*Y-E*Z*n+h*g*n)*w,L[3]=(K*g*t-E*r*t-K*Z*Y+h*r*Y+E*Z*y-h*g*y)*w,L[4]=X*w,L[5]=(A*u*t-l*r*t+l*Z*y-R*u*y-A*Z*n+R*r*n)*w,L[6]=(l*g*t-b*u*t-l*Z*Y+R*u*Y+b*Z*n-R*g*n)*w,L[7]=(b*r*t-A*g*t+A*Z*Y-R*r*Y-b*Z*y+R*g*y)*w,L[8]=U*w,L[9]=(l*K*t-A*B*t-l*h*y+R*B*y+A*h*n-R*K*n)*w,L[10]=(b*B*t-l*E*t+l*h*Y-R*B*Y-b*h*n+R*E*n)*w,L[11]=(A*E*t-b*K*t-A*h*Y+R*K*Y+b*h*y-R*E*y)*w,L[12]=I*w,L[13]=(A*B*Z-l*K*Z+l*h*r-R*B*r-A*h*u+R*K*u)*w,L[14]=(l*E*Z-b*B*Z-l*h*g+R*B*g+b*h*u-R*E*u)*w,L[15]=(b*K*Z-A*E*Z+A*h*g-R*K*g-b*h*r+R*E*r)*w,this}});var Ol=M.List=function(){this._as=[];var p,m,J=arguments.length;if(1===J){var v=arguments[0];if(xi(v)&&(v=v._as),Sg(v))for(m=v.length,p=0;m>p;p++)this._as.push(v[p]);else v!=N&&this._as.push(v)}else if(J>1)for(p=0;J>p;p++)this._as.push(arguments[p])};Wj("List",J,{forEach:function(f,s){this.each(f,s)},push:function(){for(var v=0;v<arguments.length;v++)this.add(arguments[v])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(u,p){return p===d?this._as.push(u):this._as.splice(p,0,u)},addAll:function(k){xi(k)&&(k=k._as),Sg(k)?Cr(this._as,k):this._as.push(k)},get:function(V){return this._as[V]},slice:function(z,v){return new Ol(this._as.slice(z,v))},remove:function(K){var G=this._as.indexOf(K);return G>=0&&G<this._as.length&&this.removeAt(G),G},removeAt:function(I){return this._as.splice(I,1)[0]},set:function(w,C){return this._as[w]=C},clear:function(){return this._as.splice(0,this._as.length)},contains:function(o){return this._as.indexOf(o)>=0},indexOf:function(p){return this._as.indexOf(p)},each:function(V,I){for(var v=0,R=this._as.length;R>v;v++){var d=this._as[v];I?V.call(I,d,v,this):V(d,v,this)}},reverseEach:function(F,D){for(var w=this._as.length-1;w>=0;w--){var t=this._as[w];D?F.call(D,t):F(t)}},toArray:function(c,S){if(c){for(var h,a=[],V=0,j=this._as.length;j>V;V++)h=this._as[V],S?c.call(S,h)&&a.push(h):c(h)&&a.push(h);return a}return this._as.concat()},toList:function(Y,l){if(Y){for(var v,T=new Ol,y=0,n=this._as.length;n>y;y++)v=this._as[y],l?Y.call(l,v)&&T.add(v):Y(v)&&T.add(v);return T}return new Ol(this)},reverse:function(){this._as.reverse()},sort:function(t){return this._as.sort(t?t:Hc),this},toString:function(){return this._as.toString()}}),J.defineProperties(Ol.prototype,{length:{get:function(){return this._as.length},set:function(h){this._as.length=h}}});var np=new Ol;Jc(np,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Kp,each:Kp,reverseEach:Kp,toArray:function(){return[]},toList:function(){return new Ol},add:Sl,addAll:Sl,set:Sl,remove:Sl,removeAt:Sl,clear:Sl});var Yp=M.Matrix=function(H,T,x,J,W){var t=this;H=H||0;var b=R(H),v=E(H);J=J||1,W=W||1,t.a=v*J,t.b=b*J,t.c=-b*W,t.d=v*W,t.tx=T||0,t.ty=x||0};Yp.prototype.tf=function(X,M){1===arguments.length&&(M=X.y,X=X.x);var k=this;return{x:k.a*X+k.c*M+k.tx,y:k.b*X+k.d*M+k.ty}},Yp.prototype.translate=function(B,h){var v=this;return v.tx+=B,v.ty+=h,v},Yp.prototype.scale=function(C,T){var D=this;return D.a*=C,D.d*=T,D.c*=C,D.b*=T,D.tx*=C,D.ty*=T,D},Yp.prototype.rotate=function(z){var W=E(z),d=R(z),t=this,B=t.a,v=t.c,G=t.tx;return t.a=B*W-t.b*d,t.b=B*d+t.b*W,t.c=v*W-t.d*d,t.d=v*d+t.d*W,t.tx=G*W-t.ty*d,t.ty=G*d+t.ty*W,t},Yp.prototype.transform=function(J){var r=this,_=J.a,E=J.b,v=J.c,h=J.d,P=J.tx,f=J.ty,s=r.a,u=r.b,Y=r.c,O=r.d,m=r.tx,U=r.ty;return r.a=_*s+v*u,r.b=E*s+h*u,r.c=_*Y+v*O,r.d=E*Y+h*O,r.tx=_*m+v*U+P,r.ty=E*m+h*U+f,r},Yp.prototype.tfi=function(E,O){1===arguments.length&&(O=E.y,E=E.x);var f=this,v=1/(f.a*f.d+f.c*-f.b);return{x:f.d*v*E+-f.c*v*O+(f.ty*f.c-f.tx*f.d)*v,y:f.a*v*O+-f.b*v*E+(-f.ty*f.a+f.tx*f.b)*v}};var gd=M.Notifier=function(){this._f=0};Wj("Notifier",J,{contains:function(Z,L){if(this._ls)for(var X,i=0,y=this._ls.size();y>i;i++)if(X=this._ls.get(i),Z===X.l&&L===X.s)return!0;return!1},add:function(s,U,e){var w=this,Y={l:s,s:U,a:e};w._ls||(w._ls=new Ol),w._f?(w._as||(w._as=new Ol),w._as.add(Y)):Y.a?w._ls.add(Y,0):w._ls.add(Y)},remove:function(Q,i){var K=this;K._ls&&(K._f?(K._rs||(K._rs=new Ol),K._rs.add({l:Q,s:i})):K._remove(Q,i))},_remove:function(c,h){for(var F,J=this._ls,U=0,P=J.size();P>U;U++)if(F=J.get(U),F.l===c&&F.s===h)return J.removeAt(U),void 0},fire:function(S){var O=this,s=O._ls;if(O._b=1e4,s){++O._f;try{for(var U,b=0,a=s.size();a>b;b++)U=s.get(b),U.s?U.l.call(U.s,S):U.l(S)}finally{if(--O._f)return;if(O._rs){for(a=O._rs.size(),b=0;a>b;b++)U=O._rs.get(b),O._remove(U.l,U.s);delete O._rs}if(O._as){for(a=O._as.size(),b=0;a>b;b++)U=O._as.get(b),U.a?s.add(U,0):s.add(U);delete O._as}}}}});var sc=M.Data=function(){this._id=vd()};Wj("Data",J,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:N,_parent:N,_children:np,_childMap:N,_styleMap:N,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return N},_22Q:function(){return N},s:function(k,m){var X=this;if(2===arguments.length)X.setStyle(k,m);else{if(!eh(k))return X.getStyle(k);for(var q in k)X.setStyle(q,k[q])}return X},fp:function(Y,j,y,_,G){return this.firePropertyChange(Y,j,y,_,G)},firePropertyChange:function(Y,L,F,A,C){if(A){if(A(L,F))return!1}else if(L===F)return!1;var f=this,W=C||{};return W.property=Y,W.oldValue=L,W.newValue=F,W.data=f,f._dataModel&&f._dataModel.handleDataPropertyChange(W),f.onPropertyChanged(W),!0},onPropertyChanged:function(C){var s=this,A=s._parent,D=C.property;if(xs(A)){var I=s.s(af),h="s:ingroup"===D;(I&&qd[D]||D===h)&&A._81I(),(I||h)&&A.fp("childChange",!0,!1)}Hk(A)&&qd[D]&&A.updateFromChildren()},_21I:function(X){var o=this;if(X&&o._dataModel)throw"Remove data from dataModel before adding";o._dataModel=X},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var j=0,X=this._children.toArray(),i=X.length;i>j;j++)X[j].removeFromDataModel()},getId:function(){return this._id},setId:function(g){this._id=g},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(j,G){return this._children.toList(j,G)},eachChild:function(x,p){this._children.each(x,p)},addChild:function(X,z){var A=this;X!==A&&(A._children===np&&(A._children=new Ol,A._childMap={}),z>=0||(z=A._children.size()),A._childMap[X._id]||A.isDescendantOf(X)||(X._parent&&X._parent.removeChild(X),(0>z||z>A._children.size())&&(z=A._children.size()),A._children.add(X,z),A._childMap[X._id]=X,X.setParent(A),A.onChildAdded(X,z),A.fp(Vl,N,X)))},onChildAdded:function(){},removeChild:function(c){var u=this;if(u._childMap&&u._childMap[c._id]){var Y=u._children.remove(c);delete u._childMap[c._id],u.fp(Vl,c,N),c.setParent(N,Y),u.onChildRemoved(c,Y)}},onChildRemoved:function(){},getChildAt:function(j){return this._children.get(j)},clearChildren:function(){var Q=this;if(!Q._children.isEmpty())for(var T=0,g=Q._children.toArray(),d=g.length;d>T;T++)Q.removeChild(g[T])},getParent:function(){return this._parent},setParent:function(s,B){var C=this;if(!(C._73I||C._parent===s||C===s||s&&s.isDescendantOf(C))){var k,y=C._parent;C._parent=s,C._73I=1,y?(B==N&&(B=y.getChildren().indexOf(C)),y.removeChild(C)):C._dataModel&&B==N&&(B=C._dataModel.getRoots().indexOf(C)),s&&(s.addChild(C),k=s.getChildren().indexOf(C)),delete C._73I,C.fp("parent",y,s,d,{oldIndex:B,newIndex:k}),C.onParentChanged(y,s)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(E){return E?this.isDescendantOf(E)||E.isDescendantOf(this):!1},isParentOf:function(X){return X&&this._childMap?!!this._childMap[X._id]:!1},isDescendantOf:function(o){if(!o||o.isEmpty())return!1;for(var A=this._parent;A;){if(o===A)return!0;A=A._parent}return!1},getStyleMap:function(){return this._styleMap
},getStyle:function(s,f){f===d&&(f=1);var N=this._styleMap?this._styleMap[s]:d;return N===d&&f?_[s]:N},setStyle:function(C,v){var q=this;q._styleMap||(q._styleMap={});var N=q._styleMap[C];v===d?delete q._styleMap[C]:q._styleMap[C]=v,q.fp("s:"+C,N,v)&&q.onStyleChanged(C,N,v)},onStyleChanged:function(){},iv:function(j){this.invalidate(j)},invalidate:function($){this.fp($||"*",!1,!0)},toString:function(){var o=this;return o._displayName||o._name||o._tag||o._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(F,n){var T=this,R=T.s(Zd);R||T.s(Zd,R={}),n?R[F]=n:delete R[F],T.fp(Zd,N,R)},removeStyleIcon:function(c){var o=this.s(Zd);if(o){var w=o[c];delete o[c],this.fp(Zd,N,o)}return w},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var J,F={};for(J in this._styleMap)F[J]=1;return F}});var Mf=M.DataModel=function(){var R=this;R._datas=new Ol,R._dataMap={},R._roots=new Ol,R._rootMap={},R._78O={},R._36I=new gd,R._35I=new gd,R._selectionModel=new Li(R);var c=R._29Q=[],Y=R._scheduleCallback=function(){for(var w=Date.now(),u=0;u<c.length;u++){var K=c[u];K.enabled&&w-K.lastTime>K.interval&&(K.beforeAction&&K.beforeAction(),R.each(function(Q){K.action(Q)}),K.afterAction&&K.afterAction(),K.lastTime=w)}c.length&&(R._30Q=X.requestAnimationFrame(Y))}};Wj("DataModel",J,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:d,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:d,_init:d,sm:function(){return this.getSelectionModel()},mm:function(I,c,A){this.addDataModelChangeListener(I,c,A)},umm:function(V,C){this.removeDataModelChangeListener(V,C)},md:function(l,V,W){this.addDataPropertyChangeListener(l,V,W)},umd:function(Q,m){this.removeDataPropertyChangeListener(Q,m)},mh:function(o,E,s){this.addHierarchyChangeListener(o,E,s)},umh:function(d,g){this.removeHierarchyChangeListener(d,g)},getAttrObject:function(){return this._attrObject},setAttrObject:function(t){return this._attrObject=t},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(H){return this._dataMap[H]},removeDataById:function(T){this.remove(this.getDataById(T))},toDatas:function(j,i){return this._datas.toList(j,i)},each:function(K,f){this._datas.each(K,f)},getDataByTag:function(g){return this._78O[g]},getTagMap:function(){return this._78O},removeDataByTag:function(J){this.remove(this.getDataByTag(J))},add:function(t,z,E){var b=this,j=t._id,d=t._tag,i=b._roots;if(b._dataMap[j])throw"'"+j+"' already exists";d!=N&&(b._78O[d]=t),b._dataMap[j]=t,E>=0?b._datas.add(t,E):b._datas.add(t),t._parent||(b._rootMap[j]=t,z>=0?i.add(t,z):i.add(t)),t._21I(b),b.onAdded(t),b._36I.fire({kind:"add",data:t,rootsIndex:z,datasIndex:E})},onAdded:function(){},remove:function(Q,$){if(Q){var p=this,H=Q._id,r=$&&$.keepStructure,F=$&&$.keepChildren,I=Q.getTag();if(Q._dataModel===p){this.beginTransaction(),r?p._removingData||(p._removingData=Q):p.prepareRemove(Q),F||Q.toChildren().each(function(D){p.remove(D,$)},p),r?p._removingData===Q&&(Q._parent&&Q._parent.removeChild(Q),delete p._removingData):Q._parent&&Q._parent.removeChild(Q);var t=p._datas.remove(Q);delete p._dataMap[H],I!=N&&delete p._78O[I];var w;p._rootMap[H]&&(delete p._rootMap[H],w=p._roots.remove(Q)),Q._21I(N),p.onRemoved(Q),p._36I.fire({kind:Ek,data:Q,rootsIndex:w,datasIndex:t}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var J=this;if(J._datas.size()){var h=J._historyManager?this.toJSON():d;J._datas.toArray().forEach(function(y){y._21I(N)}),J._datas.clear(),J._dataMap={},J._roots.clear(),J._rootMap={},J._78O={},J._36I.fire({kind:qf,json:h})}},contains:function(m){return m&&m._dataModel===this},handleDataPropertyChange:function(Y){var z=this,s=Y.data,L=Y.property;if("parent"===L){var g=s._id,p=z._rootMap,w=z._roots;s._parent?p[g]&&(delete p[g],w.remove(s)):p[g]||(p[g]=s,w.add(s))}else if("tag"===L){var E=Y.oldValue,M=Y.newValue,o=z._78O;E!=N&&delete o[E],M!=N&&(o[M]=s)}this.onDataPropertyChanged(s,Y),this._35I.fire(Y)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(N,x,n){this._36I.add(N,x,n)},removeDataModelChangeListener:function(y,q){this._36I.remove(y,q)},addDataPropertyChangeListener:function(B,q,V){this._35I.add(B,q,V)},removeDataPropertyChangeListener:function(m,v){this._35I.remove(m,v)},_38I:function(y,O,k){this._37I&&this._37I.fire({data:y,oldIndex:O,newIndex:k})},addHierarchyChangeListener:function(J,d,_){this._37I||(this._37I=new gd),this._37I.add(J,d,_)},removeHierarchyChangeListener:function(F,D){this._37I.remove(F,D)},getSiblings:function(_){var p=_._parent;return p?p._children:this._roots},eachByHierarchical:function(x,z,t){if(z)return this._eachByHierarchical(x,z,t);for(var V=0,y=this._roots,O=y.size();O>V;V++)if(this._eachByHierarchical(x,y.get(V),t)===!1)return!1;return!0},_eachByHierarchical:function(c,j,b){if(b){if(c.call(b,j)===!1)return!1}else if(c(j)===!1)return!1;for(var i=j.size(),u=0;i>u;u++)if(this._eachByHierarchical(c,j.getChildAt(u),b)===!1)return!1;return!0},reverseEachByHierarchical:function(e,n,z){if(n)return this._reverseEachByHierarchical(e,n,z);for(var W=this._roots,B=W.size(),K=B-1;K>=0;K--)if(this._reverseEachByHierarchical(e,W.get(K),z)===!1)return!1;return!0},_reverseEachByHierarchical:function(T,y,w){for(var o=y.size(),x=o-1;x>=0;x--)if(this._reverseEachByHierarchical(T,y.getChildAt(x),w)===!1)return!1;if(w){if(T.call(w,y)===!1)return!1}else if(T(y)===!1)return!1;return!0},eachByDepthFirst:function(n,O,j){if(O)return this._11I(n,O,j);for(var N=0,F=this._roots,f=F.size();f>N;N++)if(this._11I(n,F.get(N),j)===!1)return!1;return!0},_11I:function(Z,v,B){for(var V=v.size(),C=0;V>C;C++)if(this._11I(Z,v.getChildAt(C),B)===!1)return!1;if(B){if(Z.call(B,v)===!1)return!1}else if(Z(v)===!1)return!1;return!0},eachByBreadthFirst:function(x,Y,J){var X=new Ol;for(Y?X.add(Y):this._roots.each(X.add,X);X.size()>0;)if(Y=X.removeAt(0),Y.eachChild(X.add,X),J){if(x.call(J,Y)===!1)return!1}else if(x(Y)===!1)return!1;return!0},moveTo:function(K,z){var V=this.getSiblings(K),f=V.indexOf(K);f===z||0>f||z>=0&&z<=V.size()&&(V.remove(K),z>V.size()&&z--,V.add(K,z),this._38I(K,f,z))},moveUp:function(q){this.moveTo(q,this.getSiblings(q).indexOf(q)-1)},moveDown:function(i){this.moveTo(i,this.getSiblings(i).indexOf(i)+1)},moveToTop:function(Q){this.moveTo(Q,0)},moveToBottom:function(D){this.moveTo(D,this.getSiblings(D).size())},moveSelectionUp:function(U){this.beginTransaction(),U||(U=this.sm());var Y=new Ol;qc(U,Y,this._roots),Y.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(q){this.beginTransaction(),q||(q=this.sm());var u=new Ol;to(q,u,this._roots),u.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(z){this.beginTransaction(),z||(z=this.sm());var W=new Ol;Ab(z,W,this._roots),W.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(D){this.beginTransaction(),D||(D=this.sm());var P=new Ol;Wb(D,P,this._roots),P.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(X,R,Z){var e=this.getDatas();null==Z&&(Z=e.indexOf(X)),Z===R||0>Z||R>=0&&R<=e.size()&&(e.remove(X),R>e.size()&&R--,e.add(X,R),this._76I(X,Z,R))},bringForward:function(d){this.moveToIndex(d,this.getDatas().indexOf(d)+1)},bringToFront:function(v){this.moveToIndex(v,this.size())},sendBackward:function(E){this.moveToIndex(E,this.getDatas().indexOf(E)-1)},sendToBack:function(r){this.moveToIndex(r,0)},bringSelectionForward:function(F){this.beginTransaction(),F||(F=this.sm());for(var s=new Ol,Z=this.getDatas(),f=!1,C=0;C<Z.size();C++){var m=Z.get(Z.size()-1-C);F.contains(m)?f&&s.add(m):f=!0}s.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(o){this.beginTransaction(),o||(o=this.sm());for(var i=new Ol,X=this.getDatas(),h=0;h<X.size();h++){var v=X.get(h);o.contains(v)&&i.add(v)}i.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(B){this.beginTransaction(),B||(B=this.sm());for(var R=new Ol,Y=this.getDatas(),L=!1,t=0;t<Y.size();t++){var v=Y.get(t);B.contains(v)?L&&R.add(v):L=!0}R.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(A){this.beginTransaction(),A||(A=this.sm());for(var e=new Ol,d=this.getDatas(),W=0;W<d.size();W++){var Y=d.get(d.size()-1-W);A.contains(Y)&&e.add(Y)}e.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(i){var P=this;P.removeScheduleTask(i),i.enabled==N&&(i.enabled=!0),i.interval==N&&(i.interval=10),i.action==N&&(i.action=Kp),i.lastTime=Date.now(),P._29Q.push(i),P._30Q==N&&(P._30Q=X.requestAnimationFrame(P._scheduleCallback))},removeScheduleTask:function(g){var d=this,a=d._29Q,H=a.indexOf(g);H>=0&&a.splice(H,1),a.length||d._30Q==N||(X.cancelAnimationFrame(d._30Q),delete d._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(O){this._historyManager||new M.HistoryManager(this),null!=O&&this._historyManager.setMaxHistoryCount(O),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(E){this._historyManager&&this._historyManager.undo(E)},redo:function(l){this._historyManager&&this._historyManager.redo(l)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(C){this._historyManager&&this._historyManager.addHistory(C)},onHistoryManagerChanged:function(){}});var Li=M.SelectionModel=function($){var Q=this;Q._68O=um,Q._map={},Q._73O=new Ol,Q._74I=new gd,Q._21I($)};Wj("SelectionModel",J,{ms_fire:1,ms_dm:1,ms:function(i,Q,x){this.addSelectionChangeListener(i,Q,x)},ums:function($,G){this.removeSelectionChangeListener($,G)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===ws},co:function(u){return this._map[u._id]!=N},ss:function(O){this.setSelection(O)},as:function(r){this.appendSelection(r)},rs:function(q){this.removeSelection(q)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(v){var w=this;if(w._68O!==v&&(v===Jg||v===ws||v===um)){w.cs();var T=w._68O;w._68O=v,w.fp("selectionMode",T,v)}},_21I:function(n){var j=this,N=j._dataModel;N!==n&&(N&&(j.cs(),N.umm(j.handleDataModelChange,j)),j._dataModel=n,n.mm(j.handleDataModelChange,j,!0),j.fp(Fr,N,n))},dispose:function(){var R=this;R.cs(),R._dataModel.umm(R.handleDataModelChange,R)},handleDataModelChange:function(b){var v=this;if(b.kind===Ek){var f=b.data;v.co(f)&&(v._73O.remove(f),delete v._map[f._id],v._75I(Ek,new Ol(f)))}else b.kind===qf&&v.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(R){var S=this;if(S._filterFunc!==R){S.cs();var W=S._filterFunc;S._filterFunc=R,S.fp("filterFunc",W,S._filterFunc)}},_75I:function(K,Y,h,v){h&&(this._73O.each(function(g){v[g._id]?h.remove(g):h.add(g)}),Y=h.toList()),this._74I.fire({kind:K,datas:new Ol(Y)})},addSelectionChangeListener:function(E,i,V){this._74I.add(E,i,V)},removeSelectionChangeListener:function(C,n){this._74I.remove(C,n)},_97O:function(l,p){for(var V,B=this,O=0,I=new Ol(l);O<I.size();O++)V=I.get(O),(B._filterFunc&&!B._filterFunc(V)||p&&B.co(V)||!p&&!B.co(V)||!B._dataModel.contains(V))&&(I.removeAt(O),O--);return I},appendSelection:function(Z){var C=this;if(C._68O!==Jg){var x,A,b=C._73O,Y=C._97O(Z,!0);Y.isEmpty()||(C.sg()&&(x=new Ol(b),A=C._map,b.clear(),C._map={},Y=new Ol(Y.get(Y.size()-1))),Y.each(function(L){b.add(L),C._map[L._id]=L}),C._75I("append",Y,x,A))}},removeSelection:function(f){var w=this,V=w._97O(f),e=0,x=V.size();if(0!==x){for(;x>e;e++){var U=V.get(e);w._73O.remove(U),delete w._map[U._id]}w._75I(Ek,V)}},toSelection:function(g,U){return this._73O.toList(g,U)},getSelection:function(){return this._73O},each:function(E,o){this._73O.each(E,o)},setSelection:function(P){var J=this,_=J._73O;if(J._68O!==Jg&&!(_.isEmpty()&&!P||1===_.size()&&J.ld()===P)){var R=new Ol(_),C=J._map;_.clear(),J._map={};var a=J._97O(P,!0);J.sg()&&a.size()>1&&(a=new Ol(a.get(a.size()-1))),a.each(function(r){_.add(r),J._map[r._id]=r}),J._75I("set",N,R,C)}},clearSelection:function(){var g=this,a=g._73O;if(a.size()>0){var R=a.toList();a.clear(),g._map={},g._75I(qf,R)}},selectAll:function(){var p=this;if(p._68O!==Jg){var g,n,j=p._dataModel.toDatas();if(p._filterFunc)for(g=0;g<j.size();g++)n=j.get(g),p._filterFunc(n)||(j.removeAt(g),g--);var h=p._73O,S=new Ol(h),a=p._map;h.clear(),p._map={},p.sg()&&j.size()>1&&(j=new Ol(j.get(j.size()-1)));var O=j.size();for(g=0;O>g;g++)n=j.get(g),h.add(n),p._map[n._id]=n;p._75I("all",N,S,a)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(v){return this._map[v._id]!=N},getLastData:function(){var S=this._73O;return S.size()>0?S.get(S.size()-1):N},getFirstData:function(){var u=this._73O;return u.size()>0?u.get(0):N},isSelectable:function(W){var Z=this;return W&&Z._68O!==Jg?Z._filterFunc?Z._filterFunc(W):!0:!1},getTopSelection:function(){var X=this,r=new Ol;return X._73O.each(function(D){for(var _=D.getParent();_;){if(X.contains(_)){D=N;break}_=_.parent}D&&r.add(D)}),r}});var Wp=function(){return dj(0),function(r,v){var n;if(rq(v)){var F=r.getDataUI(v);F&&F._88I&&(n=F._88I.rect)}return n?n:v.getRect()}}();Jc(Q,{edgeGroupAgentFunc:N,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:n.rectSelectBorder,graphViewRectSelectBackground:al,graphViewEditPointSize:Bq?17:7,graphViewEditPointBorderColor:n.editPointBorder,graphViewEditPointBackground:n.editPointBackground,setEdgeType:function(s,V,$){Dh[s]=V,Ge[s]=$},getEdgeType:function(n){return Dh[n]},getEdgeTypeMap:function(){return Dh},getNodeRect:Wp},!0),Jc(_,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":d,interactive:!1,"image.stretch":"fill",icons:d,ingroup:!0,"body.color":d,opacity:d,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":Kr,"select.width":1,"select.padding":2,"select.type":cb,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":d,"border.width":2,"border.padding":2,"border.type":cb,label:d,"label.font":d,"label.color":ro,"label.background":d,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":d,"label.max":d,"label.opacity":d,"label.scale":1,"label.align":d,"label.selectable":!0,label2:d,"label2.font":d,"label2.color":ro,"label2.background":d,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":d,"label2.max":d,"label2.opacity":d,"label2.scale":1,"label2.align":d,"label2.selectable":!0,note:d,"note.expanded":!0,"note.font":d,"note.color":Yq,"note.background":Kr,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":d,"note.toggleable":!0,"note.border.width":1,"note.border.color":d,"note.opacity":d,"note.scale":1,"note.align":d,note2:d,"note2.expanded":!0,"note2.font":d,"note2.color":Yq,"note2.background":Kr,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":d,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":d,"note2.opacity":d,"note2.scale":1,"note2.align":d,"group.type":d,"group.image":d,"group.image.stretch":"fill","group.repeat.image":d,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":d,"group.title.color":Yq,"group.title.background":n.groupTitleBackground,"group.title.align":kj,"group.background":n.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":d,"group.border.color":ol,"group.border.cap":Tf,"group.border.join":Lf,"group.gradient":N,"group.gradient.color":"#FFF",shape:d,"shape.background":ol,"shape.repeat.image":d,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":ol,"shape.border.3d":!1,"shape.border.3d.color":d,"shape.border.3d.accuracy":d,"shape.border.cap":Tf,"shape.border.join":Lf,"shape.border.pattern":d,"shape.gradient":N,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":os,"shape.dash.offset":0,"shape.dash.color":Tm,"shape.dash.width":d,"shape.dash.3d":!1,"shape.dash.3d.color":d,"shape.dash.3d.accuracy":d,"shape.polygon.side":6,"shape.arc.from":H,"shape.arc.to":q,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":d,"shape.gradient.pack":d,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":d,"autolayout.hgap":d,"autolayout.vgap":d,"edge.type":d,"edge.points":d,"edge.segments":d,"edge.color":ol,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":d,"edge.3d.accuracy":d,"edge.cap":Tf,"edge.join":Lf,"edge.source.position":17,"edge.source.anchor.x":d,"edge.source.anchor.y":d,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":d,"edge.target.anchor.y":d,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":d,"edge.dash":!1,"edge.dash.pattern":os,"edge.dash.offset":0,"edge.dash.color":Tm,"edge.dash.width":d,"edge.dash.3d":!1,"edge.dash.3d.color":d,"edge.dash.3d.accuracy":d,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":d,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":d,"grid.column.percents":d,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":n.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":n.gridCellBorderColor,"grid.block":d,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":n.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":ro,"text.font":xk,"text.shadow":!1,"text.shadow.color":xf,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),Jc(Mf,{_76I:function(J,f,N){this._39I&&this._39I.fire({data:J,oldIndex:f,newIndex:N})},addIndexChangeListener:function(N,g,T){var Q=this;Q._39I||(Q._39I=new gd),Q._39I.add(N,g,T)},removeIndexChangeListener:function(Z,r){this._39I.remove(Z,r)},prepareRemove:function(Y){Hm(Y)&&(Y.setSource(N),Y.setTarget(N)),Y._70O&&Y._70O.toList().each(this.remove,this),Y._69O&&Y._69O.toList().each(function(p){p.setHost(N)}),Y._host&&Y.setHost(N)},onAdded:function(s){this.isAutoAdjustIndex()&&this.adjustIndex(s)},onDataPropertyChanged:function(Q,h){Iq[h.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(Q)},isAdjustable:function(E){return Oh(E)||Hm(E)},isAdjustedToBottom:function(u){return xs(u)?u.isExpanded()&&Hn(u):!1},adjustIndex:function(L){var N=this;this.isHierarchicalRendering()||(N.isAdjustedToBottom(L)?(N.sendToBottom(L),L.eachChild(N.adjustIndex,N)):N.sendToTop(L))},sendToTop:function(o){var n=this;if(n.contains(o)&&n.isAdjustable(o)){var O=n._datas;if(o!==O.get(n.size()-1)){var $=O.indexOf(o);O.removeAt($),O.add(o),n._76I(o,$,n.size()-1)}if(Hm(o)){var l=o._40I;l&&!n.isAdjustedToBottom(l)&&n.sendToTop(l),l=o._41I,l&&!n.isAdjustedToBottom(l)&&n.sendToTop(l)}o._69O&&o._69O.each(function(T){T.isRelatedTo(o)||Oh(o)&&T.isLoopedHostOn(o)||n.sendToTop(T)}),o.ISubGraph||(!xs(o)||o.isExpanded())&&o._adjustChildrenToTop&&o.eachChild(function(N){Hm(N)||n.sendToTop(N)})}},sendToBottom:function(j,z){var i=this;if(j!==z&&i.contains(j)&&i.isAdjustable(j)&&(!z||i.contains(z))){var r=i._datas,A=r.remove(j),N=z?i._datas.indexOf(z):0;if(r.add(j,N),A!==N){i._76I(j,A,N);var e=j._parent;!e||e.ISubGraph||Hm(e)||i.sendToBottom(j._parent,j)}}}}),Jc(sf,{ms_edit:function(F){F._46O=function(h){var x=this,d=x.gv.dm(),Z=x._index,K=x._89I,J=x._node,_=x._shape,T=x._edge,B=x._77I;J&&K?(this.fi({kind:"endEditRect",event:h,data:J,direction:K}),d.endTransaction()):_&&Z>=0?(x.fi({kind:"endEditPoint",event:h,data:_,index:Z}),d.endTransaction()):T&&Z>=0?(x.fi({kind:"endEditPoint",event:h,data:T,index:Z}),d.endTransaction()):B&&(x.fi({kind:"endEditRotation",event:h,data:B}),d.endTransaction())},F._78I=function(y){var h=this;h.autoScroll(y);var f=h.gv.lp(y),$=h._index,J=h._89I,M=h._node,O=h._shape,V=h._edge,Y=h._77I;if(M&&J)h._80O(f),h.fi({kind:"betweenEditRect",event:y,data:M,direction:J});else if(O&&$>=0)f.e=O.getPoints().get($).e,O.setPoint($,f),h.fi({kind:"betweenEditPoint",event:y,data:O,index:$});else if(V&&$>=0){var c=V.s(sq);f.e=c.get($).e,c.set($,f),V.fp(sq,N,c),h.fi({kind:"betweenEditPoint",event:y,data:V,index:$})}else if(Y){var x=Y.p(),T=Y.getScale(),b=z+D(f.y-x.y,f.x-x.x);T.y<0&&(b+=H),A(b)<.04&&(b=0),Y.setRotation(b),h.fi({kind:"betweenEditRotation",event:y,data:Y})}},F._80O=function(Q){var C=this,i=C._node,F=C._rect,E=F.x,o=F.y,v=F.width,D=F.height,g=C._89I,Y=C._anchor,O=C._matrix,Q=O.tfi(Q);"northwest"===g?F=re(Q,{x:E+v,y:o+D}):g===To?F=re({x:E,y:Q.y},{x:E+v,y:o+D}):"northeast"===g?F=re({x:E,y:Q.y},{x:Q.x,y:o+D}):g===Vf?F=re({x:Q.x,y:o},{x:E+v,y:o+D}):g===Ke?F=re({x:E,y:o},{x:Q.x,y:o+D}):"southwest"===g?F=re({x:Q.x,y:o},{x:E+v,y:Q.y}):"south"===g?F=re({x:E,y:o},{x:E+v,y:Q.y}):"southeast"===g&&(F=re({x:E,y:o},Q)),i.setPosition(O.tf(F.x+F.width*Y.x,F.y+F.height*Y.y)),i.setWidth(F.width),i.setHeight(F.height)},F._80I=function(V,w,X,S){var g=this,M=g.gv._zoom,u=(g.gv.getEditPointSize()+2)/M;return Ah({x:w-u/2,y:X-u/2,width:u,height:u},V)?(g._89I!==S&&(g._89I=S),!0):!1},F._79I=function(p,B,b){var e=this,_=e.gv,z=B?_.getDataUI(B):N,Z=z?z._55O:N;if(Z){var v,C,L,V,h=_._zoom,S=(_.getEditPointSize()+2)/h,w=_.lp(p);if(Oh(B)){if(Z._56O&&Oh(B)&&(C=Z._98o,Ah({x:C.x-S/2,y:C.y-S/2,width:S,height:S},w)))return e._77I=B,b&&e.fi({kind:"beginEditRotation",event:p,data:B}),e.setCursor("crosshair"),!0;if(Z._43O&&B instanceof mo)for(L=B.getPoints(),v=L.size()-1;v>=0;v--)if(C=L.get(v),Ah({x:C.x-S/2,y:C.y-S/2,width:S,height:S},w))return e._index=v,e._shape=B,b&&e.fi({kind:"beginEditPoint",event:p,data:B,index:v}),e.setCursor("crosshair"),!0;if(Z._42O)for(var O=B.getEditControlPoints(),g=["northwest",-1,-1,Vf,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Ke,1,0,"northeast",1,-1,To,0,-1],v=0,V=O.length;V>v;v++){var s=g[3*v],P=O[v];if(e._80I(w,P.x,P.y,s)){e._node=B;var k=B.getWidth(),n=B.getHeight(),t=B.getAnchor();e._rect={x:-k*t.x,y:-n*t.y,width:k,height:n},e._anchor=t,e._matrix=B.getMatrix();var F=B.getRotation(),X=E(F),Q=R(F),y=g[3*v+1]*Qe(B.getScale().x),i=g[3*v+2]*Qe(B.getScale().y),x=Math.atan2(-Q*y-X*i,X*y-Q*i),J=(Math.round(x/(Math.PI/4))+8)%8,Y=[cn,"nesw-resize",lc,"nwse-resize",cn,"nesw-resize",lc,"nwse-resize"][J];return e.setCursor(Y),b&&e.fi({kind:"beginEditRect",event:p,data:B,direction:e._89I}),!0}}}if(Z._43O&&Hm(B)&&B.s(Zk)===Sb&&(L=B.s(sq)))for(v=L.size()-1;v>=0;v--)if(C=L.get(v),Ah({x:C.x-S/2,y:C.y-S/2,width:S,height:S},w))return e._index=v,e._edge=B,b&&e.fi({kind:"beginEditPoint",event:p,data:B,index:v}),e.setCursor("crosshair"),!0}return!1}},ms_gv:function(l){l._currentSubGraph=N,l.upSubGraph=function(){this.setCurrentSubGraph(lm(this._currentSubGraph))},l.isVisible=function(B){var F=this;if(lm(B)!==F._currentSubGraph)return!1;if(Hm(B)){var H=B._40I,h=B._41I;if(!H||!h)return!1;if(!(B.s("edge.independent")||F.isVisible(H)&&F.isVisible(h)))return!1;if(B.isEdgeGroupHidden())return!1}else for(var r=B._parent;r&&!r.ISubGraph;){if(xs(r)&&(!r.isExpanded()||!F.isVisible(r)))return!1;r=r._parent}if(B._parent instanceof ti&&!F.isVisible(B._parent))return!1;if(B._refGraph instanceof $j&&!F.isVisible(B._refGraph))return!1;if(F instanceof Zo){if(!B.s("3d.visible"))return!1}else{var L=F.getLayersInfo();if(L){var e=L[B._layer];if(e&&e.visible===!1)return!1}if(!B.s("2d.visible"))return!1}return F._visibleFunc?F._visibleFunc(B):!0},l.handleSelectionChange=function(k){var P=this;k.datas.each(function(Q){P.invalidateData(Q);var L=Q._parent;xs(L)&&Oh(Q)&&Q.s(af)&&(P.invalidateData(L),L._49I&&L._49I.each(function(Z){P.invalidateData(Z)}))}),P.onSelectionChanged(k)},l.onSelectionChanged=function(Q){var k=this,z=k.sm();if(1===z.size()&&("set"===Q.kind||"append"===Q.kind)){var s=z.ld();k.isAutoMakeVisible()&&k.makeVisible(s),k.adjustIndex&&k._dataModel.isAutoAdjustIndex()&&k.adjustIndex(s)}},l.makeVisible=function(d){if(d){var f=this,i=f.getDataUI?f.getDataUI(d):f.getData3dUI(d);if(i){var M=d,_=lm(d);for(_!==f._currentSubGraph&&f.setCurrentSubGraph(_);(M=M._parent)&&M!==_;)xs(M)&&M.setExpanded(!0);f._23I=d,f.iv()}}},l.getLabel=function(L){var E=L.getStyle(Wi);return E===d?L.getName():E},l.getLabelBackground=function(S){return S.getStyle("label.background")},l.getLabelColor=function(_){return _.getStyle("label.color")},l.getLabel2=function(V){return V.getStyle("label2")},l.getLabel2Background=function(Q){return Q.getStyle("label2.background")},l.getLabel2Color=function(J){return J.getStyle("label2.color")},l.getNote=function(j){return j.getStyle(ub)},l.getNoteBackground=function(w){return w.getStyle("note.background")},l.getNote2=function(Y){return Y.getStyle(Uj)},l.getNote2Background=function(K){return K.getStyle("note2.background")},l.handleClick=function(N,$,f){var i=this;$?(i.fi({kind:"clickData",event:N,data:$,part:f}),i.onDataClicked($,N)):(i.fi({kind:"clickBackground",event:N}),i.onBackgroundClicked(N))},l.handleDoubleClick=function(t,s,O){var k=this;Fq(t)&&(s?(k.fi({kind:"doubleClickData",event:t,data:s,part:O}),k.onDataDoubleClicked(s,t,O),k.checkDoubleClickOnNote(t,s,O)||k.checkDoubleClickOnRotation&&k.checkDoubleClickOnRotation(t,s,O)||(Hm(s)?k.onEdgeDoubleClicked(s,t,O):s.ISubGraph?k.onSubGraphDoubleClicked(s,t,O):xs(s)?k.onGroupDoubleClicked(s,t,O):s.IDoorWindow?k.onDoorWindowDoubleClicked(s,t,O):s.ICSGBox&&k.onCSGBoxDoubleClicked(s,t,O))):(k.fi({kind:"doubleClickBackground",event:t}),k.onBackgroundDoubleClicked(t)))},l.onSubGraphDoubleClicked=function(Y){this.setCurrentSubGraph(Y)},l.onEdgeDoubleClicked=function(C,W){C.ISubGraph&&!op(W)?this.setCurrentSubGraph(C):C.s("edge.toggleable")&&C.toggle()},l.onGroupDoubleClicked=function(w){w.s("group.toggleable")&&w.toggle()},l.onDoorWindowDoubleClicked=function(h){h.s("dw.toggleable")&&h.toggle(!0)},l.onCSGBoxDoubleClicked=function(S,f){var A=this;if(A instanceof Zo){var L=A.getHitFaceInfo(f);L&&L.face&&S.s(L.face+".toggleable")&&S.toggleFace(L.face,!0)}},l.onBackgroundClicked=function(){},l.onBackgroundDoubleClicked=function(){this.upSubGraph()},l.onDataClicked=function(){},l.onDataDoubleClicked=function(){},l.onAutoLayoutEnded=function(){},l.onMoveEnded=function(){},l.onPanEnded=function(){},l.onPinchEnded=function(){},l.onRectSelectEnded=function(){},l.onZoomEnded=function(){}},ms_icons:function(d){d.getRotation=function(P){return P==N?0:P},d._15O=function(){var e=this,D=e.s(Zd);if(D){var l=e,k=e.data||e._data,Y=e._38o={icons:D,rects:{}};for(var c in D){var g=D[c],n=Hr(g.shape3d,k,l);if(!(Hr(g.visible,k,l)===!1||Hr(g.for3d,k,l)&&!e.I3d||n&&!e.I3d)){var b=n?[n]:Hr(g.names,k,l),f=b?b.length:0,J=Hr(g.position,k,l)||3,Z=Hr(g.offsetX,k,l)||0,z=Hr(g.offsetY,k,l)||0,d=Hr(g.direction,k,l)||Ke,s=Hr(g.gap,k,l),i=s!=N?s:1,E=Hr(g.rotation,k,l),M=Hr(g.keepOrien,k,l),v=Hr(g.rotationFixed,k,l)?E:e.getRotation(E,M,J),K=N,P=Y.rects[c]=new Array(f);P.rotation=v;for(var R=0;f>R;R++){var G,V,o,C,I=b[R];if(n)o=0,C=0;else{var j=cd(I);o=Hr(g.width,k,l),C=Hr(g.height,k,l),o==N&&(o=pg(j,k)),C==N&&(C=gh(j,k))}if(K?d===Ke?Z+=o/2:d===Vf?Z-=o/2:d===To?z-=C/2:z+=C/2:K={width:o,height:C},e.I3d){var B=-o/2,H=-C/2;V={width:o,height:C,mat:e._16O(Hr(g.autorotate,k,l),J,K,Hr(g.face,k,l)||Sh,Hr(g.t3,k,l),Hr(g.r3,k,l),Hr(g.rotationMode,k,l),Z,z),vs:new oi([B,-H,0,B,-H-C,0,B+o,-H-C,0,B+o,-H,0])}}else G=e.getPosition(J,Z,z,K,Hr(g.positionFixed,k,l)),V={x:G.x-o/2,y:G.y-C/2,width:o,height:C},e._68o(V,v);P[R]=V,d===Ke?Z+=o/2+i:d===Vf?Z-=o/2+i:d===To?z-=C/2+i:z+=C/2+i}}}}}}});var ap={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},$f={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Qo={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Iq={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},qd={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Al={"edge.type":1,"edge.group":1},xp={rotation:1,rotationX:1,rotationZ:1},Pk={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Dm={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},fd={shape:1,thickness:1,position:1,anchor:1,scale:1},lr=function(S,Y){if(!S||!xs(Y)||Y.isEmpty())return!1;for(S=S._parent;xs(S);){if(S===Y)return!0;S=S._parent}return!1},oo=function(S,e){if(!S||!Hk(e)||e.isEmpty())return!1;for(S=S._parent;Hk(S);){if(S===e)return!0;S=S._parent}return!1},lm=function(d){if(!d)return N;if(Hm(d)){var v=d._40I,X=d._41I;if(!v||!X)return N;var E=lm(v),G=lm(X);return E===G?E:N}for(var o=d._parent;Hm(o)&&!o.ISubGraph;)o=o._parent;return o?o.ISubGraph?o:lm(o):N},ok=function(i,Z,z,X){var q=Z.getStyle(z)*X;q&&po(i,q),q=Z.getStyle(z+".left")*X,q&&(i.x-=q,i.width+=q),q=Z.getStyle(z+".right")*X,q&&(i.width+=q),q=Z.getStyle(z+".top")*X,q&&(i.y-=q,i.height+=q),q=Z.getStyle(z+".bottom")*X,q&&(i.height+=q),i.width<0&&(i.width=-i.width,i.x-=i.width),i.height<0&&(i.height=-i.height,i.y-=i.height)},Hn=function(m){for(var M,G=0,D=m.size();D>G;G++)if(M=m.getChildAt(G),Oh(M)&&Hn(M))return!0;return m.hasAgentEdges()},sh=function(w){if(!w)return N;for(var p=w._parent;xs(p);){if(!xs(p._parent))return p.isExpanded()?w:p;p.isExpanded()||(w=p),p=p._parent}return w},gp=function(G,o){if(!G||!o)return N;var p,V,n,s=lm(G),f=lm(o);if(s!==f){for(;f&&s!==f;)f=lm(f);if(s===f)return G;p=new Ol,p.add(G,0);for(var y=G._parent;Oh(y)&&!o.isDescendantOf(y);)p.add(y,0),y=y._parent;for(n=p.size(),V=0;n>V;V++){var J=p.get(V);if(xs(J)&&!J.isExpanded())return J;if(J.ISubGraph)return J}return G}return G},ae=function(q){if(q.isLooped())return q._source;var e=sh(q._source),i=sh(q._target);return e===i?q._source:gp(e,i)},Pf=function(y){if(y.isLooped())return y._target;var i=sh(y._source),G=sh(y._target);return i===G?y._target:gp(G,i)},xo=function(e,T,f,n,U,x,G){if(!T)return N;var r,l=T.getRotation?T.getRotation():0;if(x!==d||G!==d)if(x=x===d?.5:x,G=G===d?.5:G,l&&!rq(T,e)){var H=T.getPosition(),F=T.getWidth(),I=T.getHeight(),h=T.getAnchor(),V=T.getScale(),L=new Yp(l,H.x,H.y,V.x,V.y);f=L.tf((x-h.x)*F,(G-h.y)*I)}else r=Wp(e,T),f={x:r.x+x*r.width,y:r.y+G*r.height};else f=Dg(f,Wp(e,T));if(l){var B=E(l),Y=R(l),o=n*B-U*Y;U=n*Y+U*B,n=o}return f.x+=n,f.y+=U,f},is=function(U,_){if(!U||!_)return N;var j,I,f,h,t,P;if(U===_){if(h=U.getLoopedEdges(),!h)return N;h=new Ol(h)}else{if(t=U.getAgentEdges(),P=_.getAgentEdges(),!t||!P)return N;for(I=t.size(),j=0;I>j;j++)f=t.get(j),P.contains(f)&&(h||(h=new Ol),h.add(f))
}if(h)for(j=0;j<h.size();j++)f=h.get(j),f.getStyle(Zk)===Sb&&(f._22I(N),h.removeAt(j),j--);return h},Ok=function(D,F){var L=is(D,F);if(L&&!L.isEmpty()){if(1===L.size())return L.get(0)._22I(N),void 0;var e=new Ol,b=new Ol;L.each(function(C){var S=C.s("edge.group");e.contains(S)||e.add(S)}),e.sort(),e.each(function(n){b.add(new M.EdgeGroup(L.toList(function(h){return n===h.s("edge.group")}),b))}),b.each(function(h){h.each(function(B){B._22I(h)})})}},_m=function(f,P){if(P){var d=P.rect,z=P.color,j=P.rotation,S=P.labelWidth,L=P.background,a=P.opacity,Q=P.scale,b=Q!=N&&1!==Q;if(a!=N){var l=f.globalAlpha;f.globalAlpha*=a}if(j||b){f.save();var h=d.x+d.width/2,u=d.y+d.height/2;qo(f,h,u),j&&Gm(f,j),b&&f.scale(Q,Q),qo(f,-h,-u)}if(L&&zs(f,d.x,d.y,d.width,d.height,L),S){var C=d.width,R=f.createLinearGradient(d.x,d.y,d.x+C,d.y);R.addColorStop(0,z),R.addColorStop(.9,z),R.addColorStop(1,vg),z=R,d.width=S}Rl(f,P.ss,d,P.font,z,P.align),S&&(d.width=C),(j||b)&&f.restore(),a!=N&&(f.globalAlpha=l)}},hr=function(P,W){if(W){var h=W.rect,d=h.x,Y=h.y,g=h.width,K=h.height,M=W.background,X=W.backgroundImage,C=W.borderWidth,o=W.borderColor,J=W.labelWidth,b=W.opacity,I=W.scale,L=I!=N&&1!==I;if(b!=N){var E=P.globalAlpha;P.globalAlpha*=b}if(L){P.save();var a=h.x+h.width/2,$=h.y+h.height/2;qo(P,a,$),P.scale(I,I),qo(P,-a,-$)}if(W.expanded){var G=O(8,g/4),k=Y+K-8;if(P.fillStyle=M,P.beginPath(),P.moveTo(d,Y),P.lineTo(d,k),P.lineTo(d+g/2,k),P.lineTo(d+g/2,Y+K),P.lineTo(d+g/2+G,k),P.lineTo(d+g,k),P.lineTo(d+g,Y),P.closePath(),P.fill(),C&&(P.lineWidth=C,P.lineJoin="round",P.lineCap="round",o?(P.strokeStyle=o,P.stroke()):(P.strokeStyle=jb(M),P.beginPath(),P.moveTo(d+g,Y),P.lineTo(d+g,k),P.lineTo(d+g/2+G,k),P.lineTo(d+g/2,Y+K),P.stroke(),P.strokeStyle=gr(M),P.beginPath(),P.moveTo(d+g,Y),P.lineTo(d,Y),P.lineTo(d,k),P.lineTo(d+g/2,k),P.lineTo(d+g/2,Y+K),P.stroke())),X)Nq(P,cd(X),Ac,h.x,h.y,h.width,h.height-8,W.data,W.view);else{if(h.height-=8,M=W.color,J){var t=g,S=P.createLinearGradient(d,Y,d+t,Y);S.addColorStop(0,M),S.addColorStop(.9,M),S.addColorStop(1,vg),M=S,h.width=J}Rl(P,W.ss,h,W.font,M,W.align),J&&(h.width=t),h.height+=8}}else if(W.icon)tg(P,cd(W.icon),d,Y,g,K,W.data,W.view);else{var e=g/2;C&&(P.lineWidth=C,P.lineJoin="round",P.lineCap="round",P.strokeStyle=o?o:jb(M),P.beginPath(),P.arc(d+e,Y+e,e,z,1.6*H,!0),P.moveTo(d+e,Y+K),P.lineTo(d+g-e/5,Y+e),P.stroke(),P.strokeStyle=o?o:gr(M),P.beginPath(),P.arc(d+e,Y+e,e,1.6*H,z,!0),P.moveTo(d+e,Y+K),P.lineTo(d+e/5,Y+e),P.stroke()),P.fillStyle=M,P.beginPath(),P.arc(d+e,Y+e,e,0,q,!0),P.moveTo(d+e,Y+K),P.lineTo(d+g-e/5,Y+e),P.lineTo(d+e/5,Y+e),P.closePath(),P.fill(),P.fillStyle=W.color,P.beginPath(),P.arc(d+e,Y+e,e/3,0,q,!0),P.fill()}L&&P.restore(),b!=N&&(P.globalAlpha=E)}},Hp=function(u,b){return b>2*u?u:b/2},xe=function(P,X,m,k){if(!P||!X)return 0;var B=D(X.y-P.y,X.x-P.x);return m||(B=X.x<P.x?B+H:B),B+k},iq=function(l,n,Y,Z,K,v,z){z&&(l.x>n.x||l.x===n.x&&l.y>n.y)&&(Y=ei[Y],K=-K);var M=Dg(Y,{x:0,y:0,width:uk(l,n),height:0},v);return M.x+=Z,M.y+=K,M=new Yp(D(n.y-l.y,n.x-l.x)).tf(M),M.x+=l.x,M.y+=l.y,M},zo=function(U,b,r,Z,v){if(U._19Q=!0,!r.getEdgeGroup())return Z?r.s("edge.gap"):0;var H,P=0,I=0,j=0;if(r.getEdgeGroup().getSiblings().each(function(i){i.each(function($){if(b.isVisible($)&&$.s(Zk)==v){var V=$.s("edge.gap");H?(I+=j/2+V/2,j=V):(H=$,j=V),$===r&&(P=I)}})}),Z)return I-P+j;var F=P-I/2;return H&&r._40I!==H._40I&&(U._19Q=!1),F},Xl=function(){var K=function(U){var t=[];return U.forEach(function(e){t.push({x:e.x,y:e.y}),t.push({x:e.x+e.width,y:e.y+e.height}),t.push({x:e.x+e.width,y:e.y}),t.push({x:e.x,y:e.y+e.height})}),t};return function(N,T,G){if("oval"===N){var W=0,r=G.height/G.width,S=r*r,J=G.x+G.width/2,L=G.y+G.height/2,g=K(T);g.forEach(function(N){var e=N.x-J,z=N.y-L,w=e*e+z*z/S;w>W&&(W=w)}),W=m(W);var M=r*W;return{x:J-W,y:L-M,width:2*W,height:2*M}}if("circle"===N){var u=0,J=G.x+G.width/2,L=G.y+G.height/2,g=K(T);return g.forEach(function(B){var P=B.x-J,$=B.y-L,I=P*P+$*$;I>u&&(u=I)}),u=m(u),{x:J-u,y:L-u,width:2*u,height:2*u}}return"roundRect"===N?(po(G,O(G.width,G.height)/16),G):G}}(),Bd=M.graph={},Kd=function(F,o,v){Gd(B+".graph."+F,o,v)};M.layout={};var cm={comps:[{type:gn,points:[85,50,70,115,100,71,86,107,88,49,47,49,53,87,100,83,49,120,56,56,118,81,102,112,68,81,100,88,115,110,89,122,89,84,100,82,100,110,66,75,87,67,119,61],borderWidth:1,borderColor:N}]};cm[cg]=cm[Ym]=160,vf("node_image",Vm(30,30,[{type:cb,rect:[4,5,22,16],gradient:Vb,gradientColor:Sr,background:ol},{type:cb,rect:[2,3,26,20],borderWidth:1,borderColor:ol},{type:cb,rect:[11,23,8,4],background:ol},{type:cb,rect:[6,27,18,2],background:ol}])),vf("node_icon",Vm(16,16,[{type:cb,rect:[2,2,12,10],gradient:Vb,gradientColor:Sr,background:ol},{type:Qh,rect:[2,2,12,10],width:1,color:ol},{type:cb,rect:[6,12,4,2],background:ol},{type:cb,rect:[4,14,8,1],background:ol}])),vf("block_icon",Vm(16,16,[{type:Qh,rect:[1,1,14,14],width:1,color:ol}])),vf("group_image",Vm(66,39,[{type:cb,rect:[44.3,18,18.1,12.8],gradient:Vb,gradientColor:Sr,background:ol},{type:cb,rect:[3.3,17.8,18.1,12.8],gradient:Vb,gradientColor:Sr,background:ol},{type:cb,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:ol,gradient:Vb,gradientColor:Sr,background:ol},{type:cb,rect:[26.2,29.4,12.8,4.2],background:ol},{type:cb,rect:[21.3,33.5,22.5,2.3],background:ol},{type:cb,rect:[5.3,32.7,14.1,2.1],background:ol},{type:cb,rect:[9,30.4,6.7,2.4],background:ol},{type:cb,rect:[50,30.7,6.7,2.4],background:ol},{type:cb,rect:[46.3,33,14.1,2.1],background:ol}])),vf("group_icon",Vm(16,16,[{type:cb,rect:[4,12,4,2],background:ol},{type:cb,rect:[2,13,8,1],background:ol},{type:cb,rect:[12,12,2,1],background:ol},{type:cb,rect:[11,13,4,1],background:ol},{type:cb,rect:[10,7,6,5],gradient:Vb,gradientColor:Sr,background:ol},{type:cb,rect:[1,2,10,10],gradient:Vb,gradientColor:Sr,background:ol},{type:Qh,rect:[1,2,10,10],width:1,color:ol}])),vf("refGraph_icon",Vm(16,16,[{type:"shape",borderWidth:1,borderColor:ol,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:ol,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),vf("edge_icon",Vm(16,16,[{type:cb,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Vb,gradientColor:Sr,background:ol},{type:cb,rect:[10.8,1,4,4],background:ol},{type:cb,rect:[1,11,4,4],background:ol}])),vf("subGraph_image",Vm(72,45,[{type:gn,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Vb,gradientColor:Sr,background:ol},{type:cb,rect:[29.6,30.7,3.6,1.8],background:ol},{type:cb,rect:[28.4,32.3,6,1.2],background:ol},{type:cb,rect:[37.3,32,10.8,1.8],background:ol},{type:cb,rect:[39.1,29.9,7.2,2.3],background:ol},{type:cb,rect:[26.6,23.7,9.6,7.2],gradient:Vb,gradientColor:Sr,background:ol},{type:cb,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:ol,gradient:Vb,gradientColor:Sr,background:ol}])),vf("subGraph_icon",Vm(17,17,[{type:gn,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Vb,gradientColor:Sr,background:ol}])),vf("shape_icon",Vm(16,16,[{type:gn,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:ol}])),vf("polyline_icon",Vm(16,16,[{type:gn,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:ol},Pp(7.5,.4),Pp(7.5,6.3),Pp(13.6,6.3),Pp(13.6,14),Pp(.7,13.9),Pp(.7,.3)])),vf("grid_icon",Vm(16,16,[{type:cb,rect:[1,1,4,4],background:ol,gradient:Vb,gradientColor:Sr},{type:cb,rect:[6,1,4,4],background:ol,gradient:Vb,gradientColor:Sr},{type:cb,rect:[11,1,4,4],background:ol,gradient:Vb,gradientColor:Sr},{type:cb,rect:[11,6,4,4],background:ol,gradient:Vb,gradientColor:Sr},{type:cb,rect:[6,6,4,4],background:ol,gradient:Vb,gradientColor:Sr},{type:cb,rect:[1,6,4,4],background:ol,gradient:Vb,gradientColor:Sr},{type:cb,rect:[11,11,4,4],background:ol,gradient:Vb,gradientColor:Sr},{type:cb,rect:[6,11,4,4],background:ol,gradient:Vb,gradientColor:Sr},{type:cb,rect:[1,11,4,4],background:ol,gradient:Vb,gradientColor:Sr}])),vf("light_icon",Vm(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:ol},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:ol,gradient:Vb,gradientColor:Sr,background:{func:function(i){var n=i?i.s(jd):N;return Sg(n)?"rgb("+r(255*n[0])+","+r(255*n[1])+","+r(255*n[2])+")":n||ol}}}])),vf("text_icon",Vm(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:ol}])),vf("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),vf("columnChart_image",{fitSize:!0,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),vf("lineChart_image",{fitSize:!0,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),vf("pieChart_image",{fitSize:!0,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var ue=function(b,Z){for(var v=b.vertices,s=0;s<v.length;s++){var Q=v[s],k=Q.y;Q.y=Q.z,Q.z=-k,Z&&(Q.y+=Z)}},Tq=function(G){for(var W,l,_,O,d,$,n=[],k=[],M=[],K=G.faces,u=0,Y=0,r=0,g=K.length;g>u;u++,Y+=6,r+=9){var v=K[u];1===v.i?(W||(W=[],l=[],_=[]),ze(v,u,Y,r,G,W,_,l)):2===v.i?(O||(O=[],d=[],$=[]),ze(v,u,Y,r,G,O,$,d)):ze(v,u,Y,r,G,n,M,k)}return{vs:n,uv:k,ns:M,top_vs:W,top_uv:l,top_ns:_,bottom_vs:O,bottom_uv:d,bottom_ns:$}},ze=function(t,Q,r,F,c,f,k,m){var l=c.vertices,B=c.faceVertexUvs,D=l[t.a],A=l[t.b],g=l[t.c];f[F]=D.x,f[F+1]=D.y,f[F+2]=D.z,f[F+3]=A.x,f[F+4]=A.y,f[F+5]=A.z,f[F+6]=g.x,f[F+7]=g.y,f[F+8]=g.z;var z=t.vertexNormals;if(3===z.length){var C=z[0],E=z[1],G=z[2];k[F]=C.x,k[F+1]=C.y,k[F+2]=C.z,k[F+3]=E.x,k[F+4]=E.y,k[F+5]=E.z,k[F+6]=G.x,k[F+7]=G.y,k[F+8]=G.z}else{var v=t.normal;k[F]=v.x,k[F+1]=v.y,k[F+2]=v.z,k[F+3]=v.x,k[F+4]=v.y,k[F+5]=v.z,k[F+6]=v.x,k[F+7]=v.y,k[F+8]=v.z}var T=B[0][Q][0],J=B[0][Q][1],j=B[0][Q][2];m[r]=T.x,m[r+1]=T.y,m[r+2]=J.x,m[r+3]=J.y,m[r+4]=j.x,m[r+5]=j.y},kq=function(P){var u=P._lineModel;if(u)return u;var g;g=Sg(P)?P:[P];var p,j,Y,q,Q,X,f,l,s,C,b,W,A=["","top","bottom"];for(u=[],p=0,j=g.length;j>p;p++)for(s=g[p],Y=0,q=A.length;q>Y;Y++)if(f=s[A[Y]+"vs"]){l=s[A[Y]+"is"],X=l?l.length:f.length/3;for(var Q=0;X>Q;Q+=3)l?(C=l[Q],b=l[Q+1],W=l[Q+2]):(C=Q,b=Q+1,W=Q+2),C*=3,b*=3,W*=3,u.push(f[C],f[C+1],f[C+2],f[b],f[b+1],f[b+2],f[b],f[b+1],f[b+2],f[W],f[W+1],f[W+2],f[W],f[W+1],f[W+2],f[C],f[C+1],f[C+2])}return P._lineModel=u,u},se=function(l,Q,u,f,T,n,_,p,J){u==N&&(u=!0),f==N&&(f=!0),_==N&&(_=1),p==N&&(p=0);var K=new Vp;return zj(K,l,Q,J),K=K.toShapes(),Tq(new Qg(K,{top:u,bottom:f,curveSegments:T,amount:_,repeatUVLength:n},-_/2+p))},Io=function(d,S){this.x=d||0,this.y=S||0};Io.prototype={constructor:Io,add:function(i){return this.x+=i.x,this.y+=i.y,this},sub:function(q){return this.x-=q.x,this.y-=q.y,this},equals:function(W){return W.x===this.x&&W.y===this.y},multiplyScalar:function(S){return this.x*=S,this.y*=S,this},distanceTo:function(n){return m(this.distanceToSquared(n))},distanceToSquared:function(l){var y=this.x-l.x,B=this.y-l.y;return y*y+B*B},clone:function(){return new Io(this.x,this.y)}};var ng=function(j,Q,U){this.x=j||0,this.y=Q||0,this.z=U||0};ng.prototype={constructor:ng,set:function(M,S,e){return this.x=M,this.y=S,this.z=e,this},setY:function(v){return this.y=v,this},copy:function(F){return this.x=F.x,this.y=F.y,this.z=F.z,this},add:function(D){return this.x+=D.x,this.y+=D.y,this.z+=D.z,this},addVectors:function(F,U){return this.x=F.x+U.x,this.y=F.y+U.y,this.z=F.z+U.z,this},sub:function(d){return this.x-=d.x,this.y-=d.y,this.z-=d.z,this},subVectors:function(E,p){return this.x=E.x-p.x,this.y=E.y-p.y,this.z=E.z-p.z,this},multiplyScalar:function(w){return this.x*=w,this.y*=w,this.z*=w,this},applyMatrix4:function(M){var x=this.x,N=this.y,O=this.z,R=M.elements;return this.x=R[0]*x+R[4]*N+R[8]*O+R[12],this.y=R[1]*x+R[5]*N+R[9]*O+R[13],this.z=R[2]*x+R[6]*N+R[10]*O+R[14],this},divideScalar:function(R){if(0!==R){var z=1/R;this.x*=z,this.y*=z,this.z*=z}else this.x=0,this.y=0,this.z=0;return this},dot:function(C){return this.x*C.x+this.y*C.y+this.z*C.z},length:function(){return m(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(W){var I=this.x,U=this.y,R=this.z;return this.x=U*W.z-R*W.y,this.y=R*W.x-I*W.z,this.z=I*W.y-U*W.x,this},crossVectors:function(r,x){var y=r.x,u=r.y,S=r.z,R=x.x,D=x.y,H=x.z;return this.x=u*H-S*D,this.y=S*R-y*H,this.z=y*D-u*R,this},distanceTo:function(l){return m(this.distanceToSquared(l))},distanceToSquared:function(j){var U=this.x-j.x,v=this.y-j.y,f=this.z-j.z;return U*U+v*v+f*f},clone:function(){return new ng(this.x,this.y,this.z)}};var Zq=function(){this.elements=new Float32Array(16)};Zq.prototype={constructor:Zq,set:function(m,R,j,T,p,r,c,d,g,y,e,Z,V,$,H,B){var z=this.elements;return z[0]=m,z[4]=R,z[8]=j,z[12]=T,z[1]=p,z[5]=r,z[9]=c,z[13]=d,z[2]=g,z[6]=y,z[10]=e,z[14]=Z,z[3]=V,z[7]=$,z[11]=H,z[15]=B,this},makeRotationAxis:function(s,z){var Z=E(z),$=R(z),q=1-Z,l=s.x,N=s.y,L=s.z,A=q*l,t=q*N;return this.set(A*l+Z,A*N-$*L,A*L+$*N,0,A*N+$*L,t*N+Z,t*L-$*l,0,A*L-$*N,t*L+$*l,q*L*L+Z,0,0,0,0,1),this}};var xc=function(b){this.repeatUVLength=b};xc.prototype={generateTopUV:function(K,O,r,J,m,U,M){var j,R,h,Y,L=K.vertices,I=L[J].x,X=L[J].y,q=L[m].x,P=L[m].y,z=L[U].x,N=L[U].y,g=this.repeatUVLength;if(g)j=0,R=0,h=g,Y=g;else{this._bb||(this._bb=O.getBoundingBox());var Z=this._bb;j=Z.minX,R=Z.minY,h=Z.maxX-j,Y=Z.maxY-R}return M?[new Io((I-j)/h,(X-R)/Y),new Io((q-j)/h,(P-R)/Y),new Io((z-j)/h,(N-R)/Y)]:[new Io((I-j)/h,1-(X-R)/Y),new Io((q-j)/h,1-(P-R)/Y),new Io((z-j)/h,1-(N-R)/Y)]},generateBottomUV:function(d,y,F,c,f,n){return this.generateTopUV(d,y,F,c,f,n,!0)},generateSideWallUV:function(z,p,v,J,_,u,c,n,N,$,r,i){if(!this._cl){for(var U,Z,j=[],d=0,y=v.length,P=0;y>P;P++){U=v[P],Z=v[(P+1)%y];var E=U.x-Z.x,S=U.y-Z.y,V=m(E*E+S*S);j.push(d),d+=V}for(var P=0;y>P;P++)j[P]/=d;this._cl=j}var j=this._cl,F=1-N/$,T=1-(N+1)/$,w=j[r],X=j[i];return X>w&&(w+=1),[new Io(w,F),new Io(X,F),new Io(X,T),new Io(w,T)]}};var tk=function(W,P,y,d,k,s){this.a=W,this.b=P,this.c=y,this.i=s,this.normal=d instanceof ng?d:new ng,this.vertexNormals=d instanceof Array?d:[]};tk.prototype={constructor:tk};var Fm=[-8,13,-4,14,-2,9,-1,2,-1],th=function(){if(th[Kn]!=N)return th[Kn];for(var L=bs[Kn],R=Fm,m=sc.prototype.getClassName(),H='"',C=0,G="",$=!1,b=+new(X[m.substr(3,3)+cn[C]]),S=C;S<R.length;S++){var p=R.length-S;G+=S%2===C?R[S]+p+"":R[S]-p+""}for(var S=C;4>S;S++)G+=C;if(G=G*G.length/G.length,b>G){if(L){for(var _,w,s,e,d,r,v,D,k="",K=0,S=0;S<L.length;S++)L[S]===H?D?(D=!1,0!==K%2&&(_==N?_=k:w==N?w=k:s==N?s=k:e==N?e=k:d==N?d=k:r==N?r=k:v==N&&(v=k)),K++,k=""):D=!0:D&&(k+=L[S]);var g=_+w+s+e+d+r;($=ui(g,v)&&(!r||r.indexOf(lj)>=0)&&(!d||d>b))&&s.indexOf(nr[0])>=0&&(th[nr[0]]=1),$&&s.indexOf(1)>=0&&(th[1]=1),$&&s.indexOf(2)>=0&&(th[2]=1)}}else $=!0,th[nr[0]]=th[1]=th[2]=1;return th[Kn]=$,$},kk=function(){},Gf=kk.prototype;Gf.getPointAt=function(y){var j=this.getUtoTmapping(y);return this.getPoint(j)},Gf.getPoints=function(y){y||(y=5);var m,d=[];for(m=0;y>=m;m++)d.push(this.getPoint(m/y));return d},Gf.getSpacedPoints=function(d){d||(d=5);var U,n=[];for(U=0;d>=U;U++)n.push(this.getPointAt(U/d));return n},Gf.getLength=function(){var q=this.getLengths();return q[q.length-1]},Gf.getLengths=function(y){if(y||(y=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==y+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var f,W,M=[],i=this.getPoint(0),d=0;for(M.push(0),W=1;y>=W;W++)f=this.getPoint(W/y),d+=f.distanceTo(i),M.push(d),i=f;return this.cacheArcLengths=M,M},Gf.getUtoTmapping=function(I,o){var f,v=this.getLengths(),X=0,l=v.length;f=o?o:I*v[l-1];for(var p,O=0,j=l-1;j>=O;)if(X=y(O+(j-O)/2),p=v[X]-f,0>p)O=X+1;else{if(!(p>0)){j=X;break}j=X-1}if(X=j,v[X]==f){var F=X/(l-1);return F}var h=v[X],x=v[X+1],c=x-h,G=(f-h)/c,F=(X+G)/(l-1);return F},Gf.getTangent=function(B){var Y=1e-4,z=B-Y,V=B+Y;0>z&&(z=0),V>1&&(V=1);var T=this.getPoint(z),b=this.getPoint(V),Q=b.clone().sub(T);return Q.normalize()},Gf.getTangentAt=function(f){var g=this.getUtoTmapping(f);return this.getTangent(g)},kk.create=function(r,l){return r.prototype=Kl(kk.prototype),r.prototype.getPoint=l,r};var Jo=function(){this.curves=[],this.autoClose=!1},gl=Jo.prototype=Kl(Gf);gl.add=function(x){this.curves.push(x)},gl.closePath=function(){var t=this.curves[0].getPoint(0),z=this.curves[this.curves.length-1].getPoint(1);t.equals(z)||this.curves.push(new ml(z,t))},gl.getPoint=function(d){for(var s,A,n=d*this.getLength(),D=this.getCurveLengths(),a=0;a<D.length;){if(D[a]>=n){s=D[a]-n,A=this.curves[a];var O=1-s/A.getLength();return A.getPointAt(O)}a++}return null},gl.getLength=function(){var d=this.getCurveLengths();return d[d.length-1]},gl.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var t,B=[],u=0,R=this.curves.length;for(t=0;R>t;t++)u+=this.curves[t].getLength(),B.push(u);return this.cacheLengths=B,B},gl.getTransformedPoints=function(D){return this.getPoints(D)},gl.getBoundingBox=function(){var u,$,C,E,Y,y,r=this.getPoints();u=$=Number.NEGATIVE_INFINITY,E=Y=Number.POSITIVE_INFINITY;var Q,Z,U,l,F=r[0]instanceof ng;for(l=F?new ng:new Io,Z=0,U=r.length;U>Z;Z++)Q=r[Z],Q.x>u&&(u=Q.x),Q.x<E&&(E=Q.x),Q.y>$&&($=Q.y),Q.y<Y&&(Y=Q.y),F&&(Q.z>C&&(C=Q.z),Q.z<y&&(y=Q.z)),l.add(Q);var P={minX:E,minY:Y,maxX:u,maxY:$};return F&&(P.maxZ=C,P.minZ=y),P};var tj=function(m){Jo.call(this),this.actions=[],m&&this.fromPoints(m)},Nb=tj.prototype=Kl(Jo.prototype),el="moveTo",Lp="lineTo",bo="quadraticCurveTo",Co="bezierCurveTo",cc="arc",hi="ellipse";Nb.fromPoints=function(G){this.moveTo(G[0].x,G[0].y);for(var F=1,c=G.length;c>F;F++)this.lineTo(G[F].x,G[F].y)},Nb.moveTo=function(){var n=Array.prototype.slice.call(arguments);this.actions.push({action:el,args:n})},Nb.lineTo=function(X,Z){var C=Array.prototype.slice.call(arguments),P=this.actions[this.actions.length-1].args,E=P[P.length-2],b=P[P.length-1],e=new ml(new Io(E,b),new Io(X,Z));this.curves.push(e),this.actions.push({action:Lp,args:C})},Nb.quadraticCurveTo=function(b,N,P,q){var s=Array.prototype.slice.call(arguments),z=this.actions[this.actions.length-1].args,Y=z[z.length-2],e=z[z.length-1],w=new er(new Io(Y,e),new Io(b,N),new Io(P,q));this.curves.push(w),this.actions.push({action:bo,args:s})},Nb.bezierCurveTo=function(e,p,k,B,D,x){var l=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,L=n[n.length-2],C=n[n.length-1],E=new Ml(new Io(L,C),new Io(e,p),new Io(k,B),new Io(D,x));this.curves.push(E),this.actions.push({action:Co,args:l})},Nb.arc=function(t,b,E,I,C,q){var L=this.actions[this.actions.length-1].args,D=L[L.length-2],h=L[L.length-1];this.absarc(t+D,b+h,E,I,C,q)},Nb.absarc=function(D,i,C,W,S,n){this.absellipse(D,i,C,C,W,S,n)},Nb.ellipse=function(T,I,k,r,v,X,Z){var N=this.actions[this.actions.length-1].args,x=N[N.length-2],E=N[N.length-1];this.absellipse(T+x,I+E,k,r,v,X,Z)},Nb.absellipse=function(O,I,A,i,K,J,c){var h=Array.prototype.slice.call(arguments),q=new hm(O,I,A,i,K,J,c);this.curves.push(q);var U=q.getPoint(1);h.push(U.x),h.push(U.y),this.actions.push({action:hi,args:h})},Nb.getSpacedPoints=function(z){z||(z=40);for(var n=[],R=0;z>R;R++)n.push(this.getPoint(R/z));return n},Nb.getPoints=function(g,Y){g=g||12;var v,r,j,y,X,N,K,d,F,x,i,P,O,D,U,M,o,I,l=[];for(v=0,r=this.actions.length;r>v;v++)switch(j=this.actions[v],y=j.action,X=j.args,y){case el:l.push(new Io(X[0],X[1]));break;case Lp:l.push(new Io(X[0],X[1]));break;case bo:for(N=X[2],K=X[3],x=X[0],i=X[1],l.length>0?(D=l[l.length-1],P=D.x,O=D.y):(D=this.actions[v-1].args,P=D[D.length-2],O=D[D.length-1]),U=1;g>=U;U++)M=U/g,o=uo.b2(M,P,x,N),I=uo.b2(M,O,i,K),l.push(new Io(o,I));break;case Co:for(N=X[4],K=X[5],x=X[0],i=X[1],d=X[2],F=X[3],l.length>0?(D=l[l.length-1],P=D.x,O=D.y):(D=this.actions[v-1].args,P=D[D.length-2],O=D[D.length-1]),U=1;g>=U;U++)M=U/g,o=uo.b3(M,P,x,d,N),I=uo.b3(M,O,i,F,K),l.push(new Io(o,I));break;case cc:var B,f=X[0],e=X[1],n=X[2],Q=X[3],H=X[4],s=!!X[5],h=H-Q,L=2*g;for(U=1;L>=U;U++)M=U/L,s||(M=1-M),B=Q+M*h,o=f+n*E(B),I=e+n*R(B),l.push(new Io(o,I));break;case hi:var B,f=X[0],e=X[1],q=X[2],w=X[3],Q=X[4],H=X[5],s=!!X[6],h=H-Q,L=2*g;for(U=1;L>=U;U++)M=U/L,s||(M=1-M),B=Q+M*h,o=f+q*E(B),I=e+w*R(B),l.push(new Io(o,I))}var S=l[l.length-1],z=1e-10;return A(S.x-l[0].x)<z&&A(S.y-l[0].y)<z&&l.splice(l.length-1,1),Y&&l.push(l[0]),l},Nb.toShapes=function(W,v){function T(g){var a,T,H,e,F,Q=[],n=new tj;for(a=0,T=g.length;T>a;a++)H=g[a],F=H.args,e=H.action,e==el&&0!=n.actions.length&&(Q.push(n),n=new tj),n[e].apply(n,F);return 0!=n.actions.length&&Q.push(n),Q}function N(c){for(var C=[],r=0,Z=c.length;Z>r;r++){var o=c[r],X=new Vp;X.actions=o.actions,X.curves=o.curves,C.push(X)}return C}function q(g,F){for(var t=1e-10,n=F.length,U=!1,f=n-1,H=0;n>H;f=H++){var I=F[f],z=F[H],j=z.x-I.x,u=z.y-I.y;if(A(u)>t){if(0>u&&(I=F[H],j=-j,z=F[f],u=-u),g.y<I.y||g.y>z.y)continue;if(g.y==I.y){if(g.x==I.x)return!0}else{var O=u*(g.x-I.x)-j*(g.y-I.y);if(0==O)return!0;if(0>O)continue;U=!U}}else{if(g.y!=I.y)continue;if(z.x<=g.x&&g.x<=I.x||I.x<=g.x&&g.x<=z.x)return!0}}return U}var O=T(this.actions);if(0==O.length)return[];if(v===!0)return N(O);var S,L,e,x=[];if(1==O.length)return L=O[0],e=new Vp,e.actions=L.actions,e.curves=L.curves,x.push(e),x;var o=!uo.isClockWise(O[0].getPoints());o=W?!o:o;var D,F=[],E=[],a=[],M=0;E[M]=d,a[M]=[];var f,m;for(f=0,m=O.length;m>f;f++)L=O[f],D=L.getPoints(),S=uo.isClockWise(D),S=W?!S:S,S?(!o&&E[M]&&M++,E[M]={s:new Vp,p:D},E[M].s.actions=L.actions,E[M].s.curves=L.curves,o&&M++,a[M]=[]):a[M].push({h:L,p:D[0]});if(!E[0])return N(O);if(E.length>1){for(var j=!1,C=[],G=0,k=E.length;k>G;G++)F[G]=[];for(var G=0,k=E.length;k>G;G++){E[G];for(var P=a[G],Q=0;Q<P.length;Q++){for(var Y=P[Q],H=!0,V=0;V<E.length;V++)q(Y.p,E[V].p)&&(G!=V&&C.push({froms:G,tos:V,hole:Q}),H?(H=!1,F[V].push(Y)):j=!0);H&&F[G].push(Y)}}C.length>0&&(j||(a=F))}var I,U,K;for(f=0,m=E.length;m>f;f++)for(e=E[f].s,x.push(e),I=a[f],U=0,K=I.length;K>U;U++)e.holes.push(I[U].h);return x};var Vp=function(){tj.apply(this,arguments),this.holes=[]},Hd=Vp.prototype=Kl(Nb);Hd.getPointsHoles=function(L){var t,O=this.holes.length,o=[];for(t=0;O>t;t++)o[t]=this.holes[t].getTransformedPoints(L);return o},Hd.extractAllPoints=function(c){return{shape:this.getTransformedPoints(c),holes:this.getPointsHoles(c)}},Hd.extractPoints=function(x){return this.extractAllPoints(x)};var uo={triangulateShape:function(m,T){function h(o,u,f){return o.x!=u.x?o.x<u.x?o.x<=f.x&&f.x<=u.x:u.x<=f.x&&f.x<=o.x:o.y<u.y?o.y<=f.y&&f.y<=u.y:u.y<=f.y&&f.y<=o.y}function a(n,p,W,z,N){var y=1e-10,q=p.x-n.x,D=p.y-n.y,$=z.x-W.x,B=z.y-W.y,M=n.x-W.x,l=n.y-W.y,R=D*$-q*B,G=D*M-q*l;if(A(R)>y){var s;if(R>0){if(0>G||G>R)return[];if(s=B*M-$*l,0>s||s>R)return[]}else{if(G>0||R>G)return[];if(s=B*M-$*l,s>0||R>s)return[]}if(0==s)return!N||0!=G&&G!=R?[n]:[];if(s==R)return!N||0!=G&&G!=R?[p]:[];if(0==G)return[W];if(G==R)return[z];var U=s/R;return[{x:n.x+U*q,y:n.y+U*D}]}if(0!=G||B*M!=$*l)return[];var L=0==q&&0==D,K=0==$&&0==B;if(L&&K)return n.x!=W.x||n.y!=W.y?[]:[n];if(L)return h(W,z,n)?[n]:[];if(K)return h(n,p,W)?[W]:[];var c,b,P,I,r,Q,m,Y;return 0!=q?(n.x<p.x?(c=n,P=n.x,b=p,I=p.x):(c=p,P=p.x,b=n,I=n.x),W.x<z.x?(r=W,m=W.x,Q=z,Y=z.x):(r=z,m=z.x,Q=W,Y=W.x)):(n.y<p.y?(c=n,P=n.y,b=p,I=p.y):(c=p,P=p.y,b=n,I=n.y),W.y<z.y?(r=W,m=W.y,Q=z,Y=z.y):(r=z,m=z.y,Q=W,Y=W.y)),m>=P?m>I?[]:I==m?N?[]:[r]:Y>=I?[r,b]:[r,Q]:P>Y?[]:P==Y?N?[]:[c]:Y>=I?[c,b]:[c,Q]}function D(Z,W,r,w){var S=1e-10,P=W.x-Z.x,x=W.y-Z.y,n=r.x-Z.x,f=r.y-Z.y,q=w.x-Z.x,D=w.y-Z.y,X=P*f-x*n,s=P*D-x*q;if(A(X)>S){var B=q*f-D*n;return X>0?s>=0&&B>=0:s>=0||B>=0}return s>0}function l(C,v){function O(w,R){var K=P.length-1,g=w-1;0>g&&(g=K);var H=w+1;H>K&&(H=0);var V=D(P[w],P[g],P[H],q[R]);if(!V)return!1;var m=q.length-1,Q=R-1;0>Q&&(Q=m);var M=R+1;return M>m&&(M=0),V=D(q[R],q[Q],q[M],P[w]),V?!0:!1}function u(V,z){var l,j,g;for(l=0;l<P.length;l++)if(j=l+1,j%=P.length,g=a(V,z,P[l],P[j],!0),g.length>0)return!0;return!1}function b(q,h){var V,U,Q,r,D;for(V=0;V<L.length;V++)for(U=v[L[V]],Q=0;Q<U.length;Q++)if(r=Q+1,r%=U.length,D=a(q,h,U[Q],U[r],!0),D.length>0)return!0;return!1}for(var q,T,Y,_,Q,e,X,k,h,m,S,P=C.concat(),L=[],B=[],n=0,W=v.length;W>n;n++)L.push(n);for(var E=0,t=2*L.length;L.length>0&&(t--,!(0>t));)for(Y=E;Y<P.length;Y++){_=P[Y],T=-1;for(var n=0;n<L.length;n++)if(e=L[n],X=_.x+":"+_.y+":"+e,B[X]===d){q=v[e];for(var V=0;V<q.length;V++)if(Q=q[V],O(Y,V)&&!u(_,Q)&&!b(_,Q)){T=V,L.splice(n,1),k=P.slice(0,Y+1),h=P.slice(Y),m=q.slice(T),S=q.slice(0,T+1),P=k.concat(m).concat(S).concat(h),E=Y;break}if(T>=0)break;B[X]=!0}if(T>=0)break}return P}for(var E,M,H,j,X,x,J={},K=m.concat(),C=0,y=T.length;y>C;C++)Array.prototype.push.apply(K,T[C]);for(E=0,M=K.length;M>E;E++)X=K[E].x+":"+K[E].y,J[X]!==d,J[X]=E;var i=l(m,T),W=Fn.Triangulate(i,!1);for(E=0,M=W.length;M>E;E++)for(j=W[E],H=0;3>H;H++)X=j[H].x+":"+j[H].y,x=J[X],x!==d&&(j[H]=x);return W.concat()},isClockWise:function(N){return Fn.Triangulate.area(N)<0},b2p0:function(F,x){var X=1-F;return X*X*x},b2p1:function(K,e){return 2*(1-K)*K*e},b2p2:function(T,z){return T*T*z},b2:function(o,D,e,Z){return this.b2p0(o,D)+this.b2p1(o,e)+this.b2p2(o,Z)},b3p0:function(v,m){var o=1-v;return o*o*o*m},b3p1:function(D,M){var p=1-D;return 3*p*p*D*M},b3p2:function(E,k){var u=1-E;return 3*u*E*E*k},b3p3:function(F,i){return F*F*F*i},b3:function(Y,S,C,B,y){return this.b3p0(Y,S)+this.b3p1(Y,C)+this.b3p2(Y,B)+this.b3p3(Y,y)}},Fn={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var O=J.keys(this.faces);return O.length?O[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch($){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(P){var L=P.familyName.toLowerCase(),j=this;return j.faces[L]=j.faces[L]||{},j.faces[L][P.cssFontWeight]=j.faces[L][P.cssFontWeight]||{},j.faces[L][P.cssFontWeight][P.cssFontStyle]=P,P},drawText:function(P){var S,z=this.getFace(),D=this.size/z.resolution,R=0,n=String(P).split(""),y=n.length,e=[];for(S=0;y>S;S++){var E=new tj,w=this.extractGlyphPoints(n[S],z,D,R,E);w&&(R+=w.offset*this.spacing,e.push(w.path))}var l=R/2;return{paths:e,offset:l}},extractGlyphPoints:function(w,n,k,i,A){var K,x,p,d,f,E,q,_,R,Z,e,M,a,v,L,C,l,Y,h,U=[],H=n.glyphs[w]||n.glyphs["?"];if(H){if(H.o)for(d=H._cachedOutline||(H._cachedOutline=H.o.split(" ")),E=d.length,q=k,_=k,K=0;E>K;)switch(f=d[K++]){case"m":R=d[K++]*q+i,Z=d[K++]*_,A.moveTo(R,Z);break;case"l":R=d[K++]*q+i,Z=d[K++]*_,A.lineTo(R,Z);break;case"q":if(e=d[K++]*q+i,M=d[K++]*_,L=d[K++]*q+i,C=d[K++]*_,A.quadraticCurveTo(L,C,e,M),h=U[U.length-1])for(a=h.x,v=h.y,x=1,p=this.divisions;p>=x;x++){var T=x/p;uo.b2(T,a,L,e),uo.b2(T,v,C,M)}break;case"b":if(e=d[K++]*q+i,M=d[K++]*_,L=d[K++]*q+i,C=d[K++]*_,l=d[K++]*q+i,Y=d[K++]*_,A.bezierCurveTo(L,C,l,Y,e,M),h=U[U.length-1])for(a=h.x,v=h.y,x=1,p=this.divisions;p>=x;x++){var T=x/p;uo.b3(T,a,L,l,e),uo.b3(T,v,C,Y,M)}}return{offset:H.ha*k,path:A}}}};Fn.generateShapes=function(H,f){f=f||{};var z=f.font;if(z===d&&(z=Fn.getDefaultFont(),!z))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var u=f.size!==d?f.size:1,E=f.curveSegments!==d?f.curveSegments:4,K=f.spacing!==d?f.spacing:1,N=f.weight!==d?f.weight:"normal",L=f.style!==d?f.style:"normal";Fn.size=u,Fn.divisions=E,Fn.face=z,Fn.weight=N,Fn.style=L,Fn.spacing=K;for(var g=Fn.drawText(H),B=g.paths,W=[],J=0,Y=B.length;Y>J;J++)Array.prototype.push.apply(W,B[J].toShapes());return W},function(S){var T=1e-10,e=function(O,L){var n=O.length;if(3>n)return null;var M,Y,I,k=[],H=[],_=[];if(j(O)>0)for(Y=0;n>Y;Y++)H[Y]=Y;else for(Y=0;n>Y;Y++)H[Y]=n-1-Y;var c=n,p=2*c;for(Y=c-1;c>2;){if(p--<=0)return L?_:k;if(M=Y,M>=c&&(M=0),Y=M+1,Y>=c&&(Y=0),I=Y+1,I>=c&&(I=0),b(O,M,Y,I,c,H)){var E,f,$,e,m;for(E=H[M],f=H[Y],$=H[I],k.push([O[E],O[f],O[$]]),_.push([H[M],H[Y],H[I]]),e=Y,m=Y+1;c>m;e++,m++)H[e]=H[m];c--,p=2*c}}return L?_:k},j=function(O){for(var z=O.length,I=0,E=z-1,w=0;z>w;E=w++)I+=O[E].x*O[w].y-O[w].x*O[E].y;return.5*I},b=function(Y,o,W,U,J,G){var C,A,y,M,p,D,I,V,d;if(A=Y[G[o]].x,y=Y[G[o]].y,M=Y[G[W]].x,p=Y[G[W]].y,D=Y[G[U]].x,I=Y[G[U]].y,T>(M-A)*(I-y)-(p-y)*(D-A))return!1;var Z,$,K,c,P,N,E,q,g,S,e,v,X,u,i;for(Z=D-M,$=I-p,K=A-D,c=y-I,P=M-A,N=p-y,C=0;J>C;C++)if(V=Y[G[C]].x,d=Y[G[C]].y,!(V===A&&d===y||V===M&&d===p||V===D&&d===I)&&(E=V-A,q=d-y,g=V-M,S=d-p,e=V-D,v=d-I,i=Z*S-$*g,X=P*q-N*E,u=K*v-c*e,i>=-T&&u>=-T&&X>=-T))return!1;return!0};return S.Triangulate=e,S.Triangulate.area=j,S}(Fn),X._typeface_js={faces:Fn.faces,loadFace:Fn.loadFace};var yd=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},ni=yd.prototype={constructor:yd,computeFaceNormals:function(){for(var d=new ng,W=new ng,R=0,A=this.faces.length;A>R;R++){var Q=this.faces[R],U=this.vertices[Q.a],I=this.vertices[Q.b],g=this.vertices[Q.c];d.subVectors(g,I),W.subVectors(U,I),d.cross(W),d.normalize(),Q.normal.copy(d)}},computeVertexNormals:function(i){var n,o,N,$,w,G;for(G=new Array(this.vertices.length),n=0,o=this.vertices.length;o>n;n++)G[n]=new ng;if(i){var Q,u,S,j=new ng,k=new ng;for(N=0,$=this.faces.length;$>N;N++)w=this.faces[N],Q=this.vertices[w.a],u=this.vertices[w.b],S=this.vertices[w.c],j.subVectors(S,u),k.subVectors(Q,u),j.cross(k),G[w.a].add(j),G[w.b].add(j),G[w.c].add(j)}else for(N=0,$=this.faces.length;$>N;N++)w=this.faces[N],G[w.a].add(w.normal),G[w.b].add(w.normal),G[w.c].add(w.normal);for(n=0,o=this.vertices.length;o>n;n++)G[n].normalize();for(N=0,$=this.faces.length;$>N;N++)w=this.faces[N],w.vertexNormals[0]=G[w.a].clone(),w.vertexNormals[1]=G[w.b].clone(),w.vertexNormals[2]=G[w.c].clone()},mergeVertices:function(){var Q,O,R,C,Y,j,P,n,E={},T=[],X=[],b=4,A=G(10,b);for(R=0,C=this.vertices.length;C>R;R++)Q=this.vertices[R],O=s(Q.x*A)+"_"+s(Q.y*A)+"_"+s(Q.z*A),E[O]===d?(E[O]=R,T.push(this.vertices[R]),X[R]=T.length-1):X[R]=X[E[O]];var w=[];for(R=0,C=this.faces.length;C>R;R++){Y=this.faces[R],Y.a=X[Y.a],Y.b=X[Y.b],Y.c=X[Y.c],j=[Y.a,Y.b,Y.c];for(var e=0;3>e;e++)if(j[e]==j[(e+1)%3]){w.push(R);break}}for(R=w.length-1;R>=0;R--){var o=w[R];for(this.faces.splice(o,1),P=0,n=this.faceVertexUvs.length;n>P;P++)this.faceVertexUvs[P].splice(o,1)}var F=this.vertices.length-T.length;return this.vertices=T,F}},hm=function(q,K,z,E,b,B,U){this.aX=q,this.aY=K,this.xRadius=z,this.yRadius=E,this.aStartAngle=b,this.aEndAngle=B,this.aClockwise=U};hm.prototype=Kl(Gf),hm.prototype.getPoint=function(l){var O,p=this.aEndAngle-this.aStartAngle;0>p&&(p+=q),p>q&&(p-=q),O=this.aClockwise===!0?this.aEndAngle+(1-l)*(q-p):this.aStartAngle+l*p;
var g=this.aX+this.xRadius*E(O),D=this.aY+this.yRadius*R(O);return new Io(g,D)};var ml=function(y,X){this.v1=y,this.v2=X},yh=ml.prototype=Kl(Gf);yh.getPoint=function(U){var g=this.v2.clone().sub(this.v1);return g.multiplyScalar(U).add(this.v1),g},yh.getPointAt=function(d){return this.getPoint(d)},yh.getTangent=function(){var g=this.v2.clone().sub(this.v1);return g.normalize()};var er=function(p,l,v){this.v0=p,this.v1=l,this.v2=v};er.prototype=Kl(Gf),er.prototype.getPoint=function(M){var J,p;return J=uo.b2(M,this.v0.x,this.v1.x,this.v2.x),p=uo.b2(M,this.v0.y,this.v1.y,this.v2.y),new Io(J,p)};var Ml=function(k,H,N,S){this.v0=k,this.v1=H,this.v2=N,this.v3=S};Ml.prototype=Kl(Gf),Ml.prototype.getPoint=function(H){var $,f;return $=uo.b3(H,this.v0.x,this.v1.x,this.v2.x,this.v3.x),f=uo.b3(H,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Io($,f)},kk.create(function(g,Z){this.v1=g,this.v2=Z},function(D){var e=new ng;return e.subVectors(this.v2,this.v1),e.multiplyScalar(D),e.add(this.v1),e});var $r=kk.create(function(S,l,i){this.v0=S,this.v1=l,this.v2=i},function(N){var m,k,C;return m=uo.b2(N,this.v0.x,this.v1.x,this.v2.x),k=uo.b2(N,this.v0.y,this.v1.y,this.v2.y),C=uo.b2(N,this.v0.z,this.v1.z,this.v2.z),new ng(m,k,C)}),fe=kk.create(function(R,x,H,j){this.v0=R,this.v1=x,this.v2=H,this.v3=j},function(q){var h,c,F;return h=uo.b3(q,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=uo.b3(q,this.v0.y,this.v1.y,this.v2.y,this.v3.y),F=uo.b3(q,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new ng(h,c,F)}),Eo=function(t,F,j,o,N,$,O,u){yd.call(this),o=o!==d?o:.5,N=N!==d?N:.5,u=u!==d?u:1,t=t||8,$=$||0,O=O||q;var J,p,M=1,Y=u/2,x=[],V=[],C=this.vertices,T=this.faces,I=this.faceVertexUvs;for(p=0;M>=p;p++){var X=[],v=[],Q=p/M,L=Q*(N-o)+o;for(J=0;t>=J;J++){var b=J/t,y=new ng,h=-(b*O+$);y.z=L*R(h),y.y=-Q*u+Y,y.x=L*E(h),C.push(y),X.push(C.length-1),v.push(new Io(b,Q))}x.push(X),V.push(v)}var U,P,a=(N-o)/u;for(J=0;t>J;J++)for(0!==o?(U=C[x[0][J]].clone(),P=C[x[0][J+1]].clone()):(U=C[x[1][J]].clone(),P=C[x[1][J+1]].clone()),U.setY(m(U.x*U.x+U.z*U.z)*a).normalize(),P.setY(m(P.x*P.x+P.z*P.z)*a).normalize(),p=0;M>p;p++){var G=x[p][J],r=x[p+1][J],z=x[p+1][J+1],g=x[p][J+1],k=U.clone(),K=U.clone(),S=P.clone(),n=P.clone(),i=V[p][J].clone(),B=V[p+1][J].clone(),H=V[p+1][J+1].clone(),f=V[p][J+1].clone();T.push(new tk(G,r,g,[k,K,n])),I[0].push([i,B,f]),T.push(new tk(r,z,g,[K.clone(),S,n.clone()])),I[0].push([B.clone(),H,f.clone()])}if(F&&o>0)for(this.vertices.push(new ng(0,Y,0)),J=0;t>J;J++){var G=x[0][J],r=x[0][J+1],z=this.vertices.length-1,k=new ng(0,1,0),K=new ng(0,1,0),S=new ng(0,1,0),i=V[0][J].clone(),B=V[0][J+1].clone(),H=new Io(B.x,0);T.push(new tk(G,r,z,[k,K,S],null,1));var Z=J/t*q,D=E(Z),A=R(Z),s=(J+1)/t*q,l=E(s),W=R(s);I[0].push([new Io(.5+.5*D,.5+.5*A),new Io(.5+.5*l,.5+.5*W),new Io(.5,.5)])}if(j&&N>0)for(this.vertices.push(new ng(0,-Y,0)),J=0;t>J;J++){var G=x[p][J+1],r=x[p][J],z=C.length-1,k=new ng(0,-1,0),K=new ng(0,-1,0),S=new ng(0,-1,0),i=V[p][J+1].clone(),B=V[p][J].clone();T.push(new tk(G,r,z,[k,K,S],null,2));var Z=J/t*q,D=E(Z),A=R(Z),s=(J+1)/t*q,l=E(s),W=R(s);I[0].push([new Io(.5+.5*l,.5-.5*W),new Io(.5+.5*D,.5-.5*A),new Io(.5,.5)])}};Eo.prototype=Kl(ni);var jq=function(K,$,i,V,a,C,P){yd.call(this),P=P||.5,K=K||16,$=$||16,i=(i!==d?i:0)-H,V=V!==d?V:q,a=a!==d?a:0,C=C!==d?C:H;var o,F,g=[],Z=[],r=this.vertices,x=this.faces,T=this.faceVertexUvs;for(F=0;$>=F;F++){var c=[],f=[];for(o=0;K>=o;o++){var j=o/K,B=F/$,s=new ng;s.x=-P*E(i+j*V)*R(a+B*C),s.y=P*E(a+B*C),s.z=P*R(i+j*V)*R(a+B*C),r.push(s),c.push(r.length-1),f.push(new Io(j,B))}g.push(c),Z.push(f)}for(F=0;$>F;F++)for(o=0;K>o;o++){var J=g[F][o+1],n=g[F][o],t=g[F+1][o],k=g[F+1][o+1],I=r[J].clone().normalize(),M=r[n].clone().normalize(),U=r[t].clone().normalize(),z=r[k].clone().normalize(),w=Z[F][o+1].clone(),Y=Z[F][o].clone(),e=Z[F+1][o].clone(),X=Z[F+1][o+1].clone();A(r[J].y)===P?(w.x=(w.x+Y.x)/2,x.push(new tk(J,t,k,[I,U,z])),T[0].push([w,e,X])):A(r[t].y)===P?(e.x=(e.x+X.x)/2,x.push(new tk(J,n,t,[I,M,U])),T[0].push([w,Y,e])):(x.push(new tk(J,n,k,[I,M,z])),T[0].push([w,Y,X]),x.push(new tk(n,t,k,[M.clone(),U,z.clone()])),T[0].push([Y.clone(),e,X.clone()]))}};jq.prototype=Kl(ni);var ii=function(w,u,T,k,g,D){yd.call(this),w=w||.33,u=u||.17,k=k||8,T=T||6,g=g||0,D=D||q;for(var I=new ng,Z=[],z=[],V=0;k>=V;V++)for(var j=V/k*q+H,Y=0;T>=Y;Y++){var i=Y/T*D+g;I.x=w*E(i),I.z=-w*R(i);var J=new ng,o=w+u*E(j);J.x=o*E(i),J.z=-o*R(i),J.y=u*R(j),this.vertices.push(J),Z.push(new Io(Y/T,1-V/k)),z.push(J.clone().sub(I).normalize())}for(var V=1;k>=V;V++)for(var Y=1;T>=Y;Y++){var l=(T+1)*V+Y-1,$=(T+1)*(V-1)+Y-1,d=(T+1)*(V-1)+Y,v=(T+1)*V+Y,A=new tk(l,$,v,[z[l].clone(),z[$].clone(),z[v].clone()]);this.faces.push(A),this.faceVertexUvs[0].push([Z[l].clone(),Z[$].clone(),Z[v].clone()]),A=new tk($,d,v,[z[$].clone(),z[d].clone(),z[v].clone()]),this.faces.push(A),this.faceVertexUvs[0].push([Z[$].clone(),Z[d].clone(),Z[v].clone()])}this.computeFaceNormals()};ii.prototype=Kl(ni);var Qg=function(N,w,x){return N?(yd.call(this),N=N instanceof Array?N:[N],this.addShapeList(N,w),w.convertYZ!==!1&&ue(this,x),this.computeFaceNormals(),void 0):(N=[],void 0)},Ql=Qg.prototype=Kl(yd.prototype);Ql.addShapeList=function(O,c){for(var j=O.length,z=0;j>z;z++){var N=O[z];this.addShape(N,c)}},Ql.addShape=function(C,G){function a(){if(G.bottom)for(var K=0;M>K;K++)q=g[K],j(q[2],q[1],q[0],!0);if(G.top)for(K=0;M>K;K++)q=g[K],j(q[0]+O*i,q[1]+O*i,q[2]+O*i,!1)}function w(){var l=0;for(u(U,l),l+=U.length,A=0,Z=P.length;Z>A;A++)s=P[A],u(s,l),l+=s.length}function u(e,q){for(var s,P,B=e.length;--B>=0;){s=B,P=B-1,0>P&&(P=e.length-1);var J=0,o=i;for(J=0;o>J;J++){var _=O*J,b=O*(J+1),H=q+s+_,K=q+P+_,I=q+P+b,Z=q+s+b;Y(H,K,I,Z,e,J,o,s,P)}}}function Q(V,Q,J){e.vertices.push(new ng(V,Q,J))}function j(P,U,u,f){P+=r,U+=r,u+=r,e.faces.push(new tk(P,U,u,null,null,f?2:1));var h=f?k.generateBottomUV(e,C,G,P,U,u):k.generateTopUV(e,C,G,P,U,u);e.faceVertexUvs[0].push(h)}function Y(P,D,A,z,R,m,s,J,w){P+=r,D+=r,A+=r,z+=r,e.faces.push(new tk(P,D,z)),e.faces.push(new tk(D,A,z));var I=k.generateSideWallUV(e,C,R,G,P,D,A,z,m,s,J,w);e.faceVertexUvs[0].push([I[0],I[1],I[3]]),e.faceVertexUvs[0].push([I[1],I[2],I[3]])}var J,$,v,E,y,B=G.amount,D=G.curveSegments||Cs,i=G.steps||1,x=G.extrudePath,X=!1,k=new xc(G.repeatUVLength);x&&(J=x.getSpacedPoints(i),X=!0,$=G.frames!==d?G.frames:new mn.FrenetFrames(x,i,!1),v=new ng,E=new ng,y=new ng);var s,A,Z,e=this,r=this.vertices.length,W=C.extractPoints(D),n=W.shape,P=W.holes,I=!uo.isClockWise(n);if(I){for(n=n.reverse(),A=0,Z=P.length;Z>A;A++)s=P[A],uo.isClockWise(s)&&(P[A]=s.reverse());I=!1}var g=uo.triangulateShape(n,P),U=n;for(A=0,Z=P.length;Z>A;A++)s=P[A],n=n.concat(s);for(var p,q,O=n.length,M=g.length,l=0;O>l;l++)p=n[l],X?(E.copy($.normals[0]).multiplyScalar(p.x),v.copy($.binormals[0]).multiplyScalar(p.y),y.copy(J[0]).add(E).add(v),Q(y.x,y.y,y.z)):Q(p.x,p.y,0);var H;for(H=1;i>=H;H++)for(l=0;O>l;l++)p=n[l],X?(E.copy($.normals[H]).multiplyScalar(p.x),v.copy($.binormals[H]).multiplyScalar(p.y),y.copy(J[H]).add(E).add(v),Q(y.x,y.y,y.z)):Q(p.x,p.y,B/i*H);a(),w()};var mn=function(f,l,B,N,V){function A(Z,f,v){return H.vertices.push(new ng(Z,f,v))-1}yd.call(this),l=l||64,B=B||1,N=N||8,V=V||!1;var c,O,j,Z,k,J,s,e,Q,$,T,W,D,p,G,n,K,U,S,P,C=[],H=this,_=l+1,M=new ng,m=new mn.FrenetFrames(f,l,V),t=m.tangents,v=m.normals,F=m.binormals;for(this.tangents=t,this.normals=v,this.binormals=F,Q=0;_>Q;Q++)for(C[Q]=[],Z=Q/(_-1),e=f.getPointAt(Z),c=t[Q],O=v[Q],j=F[Q],$=0;N>$;$++)k=$/N*q,J=-B*E(k),s=B*R(k),M.copy(e),M.x+=J*O.x+s*j.x,M.y+=J*O.y+s*j.y,M.z+=J*O.z+s*j.z,C[Q][$]=A(M.x,M.y,M.z);for(Q=0;l>Q;Q++)for($=0;N>$;$++)T=V?(Q+1)%l:Q+1,W=($+1)%N,D=C[Q][$],p=C[T][$],G=C[T][W],n=C[Q][W],K=new Io(Q/l,$/N),U=new Io((Q+1)/l,$/N),S=new Io((Q+1)/l,($+1)/N),P=new Io(Q/l,($+1)/N),this.faces.push(new tk(D,p,n)),this.faceVertexUvs[0].push([K,U,P]),this.faces.push(new tk(p,G,n)),this.faceVertexUvs[0].push([U.clone(),S,P.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};mn.prototype=Kl(ni),mn.FrenetFrames=function(C,j,u){function Q(){X[0]=new ng,o[0]=new ng,f=Number.MAX_VALUE,G=A(O[0].x),r=A(O[0].y),R=A(O[0].z),f>=G&&(f=G,N.set(1,0,0)),f>=r&&(f=r,N.set(0,1,0)),f>=R&&N.set(0,0,1),I.crossVectors(O[0],N).normalize(),X[0].crossVectors(O[0],I),o[0].crossVectors(O[0],X[0])}var q,f,G,r,R,l,k,N=new ng,O=[],X=[],o=[],I=new ng,n=new Zq,p=j+1,B=1e-4;for(this.tangents=O,this.normals=X,this.binormals=o,l=0;p>l;l++)k=l/(p-1),O[l]=C.getTangentAt(k),O[l].normalize();for(Q(),l=1;p>l;l++)X[l]=X[l-1].clone(),o[l]=o[l-1].clone(),I.crossVectors(O[l-1],O[l]),I.length()>B&&(I.normalize(),q=F(Oe(O[l-1].dot(O[l]),-1,1)),X[l].applyMatrix4(n.makeRotationAxis(I,q))),o[l].crossVectors(O[l],X[l]);if(u)for(q=F(Oe(X[0].dot(X[p-1]),-1,1)),q/=p-1,O[0].dot(I.crossVectors(X[0],X[p-1]))>0&&(q=-q),l=1;p>l;l++)X[l].applyMatrix4(n.makeRotationAxis(O[l],q*l)),o[l].crossVectors(O[l],X[l])};var Ec=function(w,V,o,F){yd.call(this),V=V||18,o=o||0,F=F==N?q:F;for(var v=1/(w.length-1),Q=1/V,g=0,M=V;M>=g;g++)for(var Y=o+g*Q*F,p=E(Y),z=R(Y),s=0,C=w.length;C>s;s++){var m=w[s],S=new ng;S.x=p*m.x-z*m.y,S.y=z*m.x+p*m.y,S.z=m.z,this.vertices.push(S)}for(var J=w.length,g=0,M=V;M>g;g++)for(var s=0,C=w.length-1;C>s;s++){var c=s+J*g,f=c,t=c+J,p=c+1+J,K=c+1,I=g*Q,G=s*v,l=I+Q,e=G+v;this.faces.push(new tk(f,K,t)),this.faceVertexUvs[0].push([new Io(I,G),new Io(I,e),new Io(l,G)]),this.faces.push(new tk(t,K,p)),this.faceVertexUvs[0].push([new Io(l,G),new Io(I,e),new Io(l,e)])}this.mergeVertices(),ue(this),this.computeFaceNormals(),this.computeVertexNormals()};Ec.prototype=Kl(ni);var dp=function(j,w){w=w||{};var s=Fn.generateShapes(j,w);w.amount=w.amount!==d?w.amount:.5,w.convertYZ=!1,w.fill!==!1&&(w.bottom=!0,w.top=!0),Qg.call(this,s,w)};dp.prototype=Kl(Ql);var ts=M.Node=function(){Ho(ts,this)},Gq={X:ci,Y:sr,Z:jp},Ak={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Yo="xzy",Xq=function(t,K,s){if(K){var r=K[0],h=K[1],S=K[2];"xzy"===s?(sr(t,h),jp(t,S),ci(t,r)):"xyz"===s?(jp(t,S),sr(t,h),ci(t,r)):"yxz"===s?(jp(t,S),ci(t,r),sr(t,h)):"yzx"===s?(ci(t,r),jp(t,S),sr(t,h)):"zxy"===s?(sr(t,h),ci(t,r),jp(t,S)):"zyx"===s?(ci(t,r),sr(t,h),jp(t,S)):(sr(t,h),jp(t,S),ci(t,r))}};Wj("Node",sc,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Yo,_64O:0,_rotationX:0,_53O:0,_host:N,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return df},_22Q:function(){return Kj},getX:function(){return this.p().x},setX:function(D){this.p(D,this.p().y)},getY:function(){return this.p().y},setY:function(R){this.p(this.p().x,R)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(O){this.setAnchor(O,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(D){this.setAnchor(this.getAnchor().x,D)},getScaleX:function(){return this.getScale().x},setScaleX:function(b){this.setScale(b,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(M){this.setScale(this.getScale().x,M)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(z,e){Po(z,rs(N,N,this.r3(),this.getRotationMode())),this.translate3d(z[0]*e,z[1]*e,z[2]*e)},translateFront:function(J){this.translate3dBy([0,0,1],J)},translateBack:function(k){this.translate3dBy([0,0,-1],k)},translateLeft:function(K){this.translate3dBy([-1,0,0],K)},translateRight:function(A){this.translate3dBy([1,0,0],A)},translateTop:function(F){this.translate3dBy([0,1,0],F)},translateBottom:function(G){this.translate3dBy([0,-1,0],G)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(p,E,b){1===arguments.length&&(E=p[1],b=p[2],p=p[0]),this.p(p,b),this.setElevation(E)},translate3d:function(j,D,R){1===arguments.length&&(D=j[1],R=j[2],j=j[0]),this.translate(j,R),this.setElevation(this._54O+D)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(f,e,U){1===arguments.length&&(e=f[1],U=f[2],f=f[0]),this.setSize(f,U),this.setTall(e)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(v,a,r){1===arguments.length&&(a=v[1],r=v[2],v=v[0]),this.setRotationX(v),this.setRotation(-a),this.setRotationZ(r)},setRotationY:function(O){this.setRotation(-O)},getRotationY:function(){return-this._64O},lookAt:function(R,k){k=k||Sh;var J=this,B=fn(R,J.p3()),c=uk(B);k===Sh?(J.r3([-$(B[1]/c),-D(B[2],B[0])+z,0]),J.setRotationMode("xzy")):k===Lj?(J.r3(0,-D(B[2],B[0]),$(B[1]/c)),J.setRotationMode("zyx")):k===kj?(J.r3(0,-D(B[2],B[0])+H,-$(B[1]/c)),J.setRotationMode("zyx")):k===Kf?(J.r3([-$(B[1]/c)+z,-D(B[2],B[0])+z,0]),J.setRotationMode("xzy")):k===si&&(J.r3([-$(B[1]/c)-z,-D(B[2],B[0])+z,0]),J.setRotationMode("xzy")),k===tf&&(J.r3([-$(B[1]/c)+H,-D(B[2],B[0])+z,H]),J.setRotationMode("zxy"))},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(j){var V=this;if(V!==j&&V._host!==j){var f=V._host;f&&f._removeAttach(V),V._host=j,V._host&&V._host._addAttach(V),V.fp("host",f,j),V.onHostChanged(f,j)}},getAttaches:function(){return this._69O},_addAttach:function(F){var H=this;H._69O||(H._69O=new Ol),H._69O.add(F),H.fp("attaches",N,F)},_removeAttach:function(U){var H=this;H._69O.remove(U),H._69O.isEmpty()&&delete H._69O,H.fp("attaches",U,N)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(b){var g=this;g._44I||(g._44I=new Ol),g._42I||(g._42I=new Ol),g._44I.add(b),g._42I.add(b),g._20I()},_4I:function(R){var w=this;w._44I||(w._44I=new Ol),w._43I||(w._43I=new Ol),w._44I.add(R),w._43I.add(R),w._20I()},_16I:function(T){var H=this;H._44I.remove(T),H._42I.remove(T),H._44I.isEmpty()&&delete H._44I,H._42I.isEmpty()&&delete H._42I,H._20I()},_18I:function(x){var k=this;k._44I.remove(x),k._43I.remove(x),k._44I.isEmpty()&&delete k._44I,k._43I.isEmpty()&&delete k._43I,k._20I()},_20I:function(){var A=this;if(delete A._45I,!A._44I||A._44I.isEmpty())return delete A._70O,void 0;var e;A._44I.each(function(C){C.isLooped()&&(e||(e={}),e[C._id]||(A._45I||(A._45I=new Ol),A._45I.add(C),e[C._id]=C))}),e?(A._70O=new Ol,A._44I.each(function(d){e[d._id]?"A"===e[d._id]||(e[d._id]="A",A._70O.add(d)):A._70O.add(d)})):A._70O=A._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(W){var o=this;o._46I||(o._46I=new Ol),o._48I||(o._48I=new Ol),o._46I.add(W),o._48I.add(W),o._19I()},_3I:function(O){var g=this;g._47I||(g._47I=new Ol),g._48I||(g._48I=new Ol),g._47I.add(O),g._48I.add(O),g._19I()},_15I:function(_){var t=this;t._46I.remove(_),t._48I.remove(_),t._46I.isEmpty()&&delete t._46I,t._48I.isEmpty()&&delete t._48I,t._19I()},_17I:function(x){var _=this;_._47I.remove(x),_._48I.remove(x),_._47I.isEmpty()&&delete _._47I,_._48I.isEmpty()&&delete _._48I,_._19I()},_19I:function(){var X=this;delete X._49I;var V=X._48I;if(V&&!V.isEmpty()){var E={};V.each(function(S){E[S._id]?X._49I||(X._49I=new Ol):E[S._id]=S}),X._49I?V.each(function(n){E[n._id]&&(X._49I.add(n),delete E[n._id])}):X._49I=V}},getImage:function(){if(this._pendingCheckImageJSON){var V=Q.getImage(this._image);V&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof $j&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(g){var E=this,D=E._image,W=E.getWidth(),C=E.getHeight();E._image=g,E.fp("image",D,g)&&(null!=g&&(eh(g)||Hq(g)&&/\.json$/i.test(g))&&(this._pendingCheckImageJSON=!0),E.fp(cg,W,E.getWidth()),E.fp(Ym,C,E.getHeight()))},getElevation:function(){return this._54O},setElevation:function(c){var I=this;if(!I._50O){I._50O=1;var g=I._54O;I._54O=c,I.fp(Di,g,c),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(V){var _=this;if(!_._49O){_._49O=1;var R=_._64O;_._64O=V,_.fp(Rr,R,V),delete _._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(N){var R=this;if(!R._51O){R._51O=1;var u=R._rotationX;R._rotationX=N,R.fp("rotationX",u,N),delete R._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(R){var S=this;if(!S._52O){S._52O=1;var V=S._53O;S._53O=R,S.fp("rotationZ",V,R),delete S._52O}},getPosition:function(){return this._position},setPosition:function(U,m){var V=this;if(!V._50I){V._50I=1;var H;if(H=2===arguments.length?{x:U,y:m}:U,H.x!==V._position.x||H.y!==V._position.y){var p=V._position;V._position=H,V.fp(Nh,p,H)}delete V._50I}},translate:function(R,w){var t=this._position;this.p(t.x+R,t.y+w)},getWidth:function(){var V=this;if(V._width>=0)return V._width;var p=V.getStyle("shape3d");if(p){var q=Mn(p);if(q&&q.rawS3)return q.rawS3[0]}var y=cd(V._image);return y?pg(y,V):20},setWidth:function(Z){var G=this,p=G._width;G._width=Z,G.fp(cg,p,Z)},getHeight:function(){var N=this;if(N._height>=0)return N._height;var S=N.getStyle("shape3d");if(S){var B=Mn(S);if(B&&B.rawS3)return B.rawS3[2]}var c=cd(N._image);return c?gh(c,N):20},setHeight:function(R){var f=this,A=f._height;f._height=R,f.fp(Ym,A,R)},getTall:function(){var x=this;if(x._tall>=0)return x._tall;var U=x.getStyle("shape3d");if(U){var l=Mn(U);if(l&&l.rawS3)return l.rawS3[1]}return 20},setTall:function(q){var T=this,B=T._tall;T._tall=q,T.fp("tall",B,q)},setSize:function(k,g){var A=this;2===arguments.length?(A.setWidth(k),A.setHeight(g)):(A.setWidth(k.width),A.setHeight(k.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(L,m,U,f,G){var w=this,P=w.getAnchor(),$=w.getScale();arguments.length<=2&&(G=m,m=L.y,U=L.width,f=L.height,L=L.x);var j=G&&$.x<0?1-P.x:P.x,O=G&&$.y<0?1-P.y:P.y;w.p(L+U*j,m+f*O),G&&(U/=Math.abs($.x),f/=Math.abs($.y)),w.setWidth(U),w.setHeight(f)},getMatrix:function(){var P=this,E=P._64O,n=P._position,m=P.getScale();return new Yp(E,n.x,n.y,m.x,m.y)},getAnchorRect:function(){var n=this,j=n.getWidth(),s=n.getHeight(),O=n.getAnchor();return{x:-j*O.x,y:-s*O.y,width:j,height:s}},toLocal:function(Y){return this.getMatrix().tfi(Y)},toGlobal:function(J){return this.getMatrix().tf(J)},isInRect:function(H){H=this.toLocal(H);var U=this.getWidth(),V=this.getHeight();return H.x+=U*this.getAnchorX(),H.y+=V*this.getAnchorY(),!(H.x<0||H.y<0||H.x>U||H.y>V)},getRect:function(){var w=this,e=w.getWidth(),G=w.getHeight(),y=w.getAnchor(),$={x:-e*y.x,y:-G*y.y,width:e,height:G},H=w.getMatrix();return $=re([H.tf($.x,$.y),H.tf($.x+$.width,$.y),H.tf($.x+$.width,$.y+$.height),H.tf($.x,$.y+$.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var b=this,R=b.getAnchor(),Z=b._anchorElevation;return{x:R.x,y:Z,z:R.y}},setAnchorElevation:function(l){var E=this,g=E._anchorElevation;return g!==l?(E._anchorElevation=l,E.fp("anchorElevation",g,l),!0):!1},setAnchor3d:function(R,C,G,e){var w,T=this;"number"==typeof R?w={x:R,y:C,z:G}:(w=R.length?{x:R[0],y:R[1],z:R[2]}:R,e=C);var j=T.getDataModel();j&&j.beginTransaction();var i=T.getAnchor3d(),O=T.setAnchor(w.x,w.z);if(T.setAnchorElevation(w.y)&&(O=!0),O&&e&&!ne){T.getAnchor3d();var B=Qq(T),f=Po([w.x-i.x,w.y-i.y,w.z-i.z],B);T.p3(f)}return j&&j.endTransaction(),O},getAnchor:function(){var k=this;if(k.hasOwnProperty("_anchor"))return k._anchor;var H=cd(k._image);return H&&H.anchorX!==d?{x:H.anchorX,y:H.anchorY}:k._anchor},setAnchor:function(h,u,s){var v,N=this;"number"==typeof h?v={x:h,y:u}:(v=h.length?{x:h[0],y:h[1]}:h,s=u);var C=N.getAnchor();if(C.x!==v.x||C.y!==v.y){var o=N.getDataModel();if(o&&o.beginTransaction(),N._anchor=v,N.fp("anchor",C,v),s&&!ne){var j=N.getPosition(),k=N.getSize(),A=N.getRotation(),M=N.getScale(),Q=-k.width*(C.x-v.x)*M.x,S=-k.height*(C.y-v.y)*M.y,I=R(A),f=E(A);N.setPosition(j.x+f*Q-I*S,j.y+I*Q+f*S)}return o&&o.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(r,L){var E,y=this;E=2===arguments.length?{x:r,y:L}:r;var X=y.getScale();(X.x!==E.x||X.y!==E.y)&&(y._scale=E,y.fp("scale",X,E))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var i=this,c=i._scaleTall,s=i.getScale();return[s.x,c,s.y]},getFinalScale3d:function(){var C=this,V=C.s3(),S=C._dynamicScale3d,b=C.getScale3d();return V&&(b[0]*=V[0],b[1]*=V[1],b[2]*=V[2]),S&&(b[0]*=S[0],b[1]*=S[1],b[2]*=S[2]),b},setScaleTall:function(B){var Q=this,Y=Q._scaleTall;Y!==B&&(Q._scaleTall=B,Q.fp("scaleTall",Y,B))},setScale3d:function(V,U,M){var z,b=this;z="number"==typeof V?{x:V,y:U,z:M}:V.length?{x:V[0],y:V[1],z:V[2]}:V,b.setScaleTall(z.y),b.setScale(z.x,z.z)},getCorners:function(w,U){w==N&&(w=0),U==N&&(U=w);var r=this,y=r.getAnchor(),i=r.getWidth(),S=r.getHeight(),B=-i*y.x-w,e=-S*y.y-U,k=i+2*w,l=S+2*U,d=r.getMatrix();return[d.tf(B,e),d.tf(B,e+l),d.tf(B+k,e+l),d.tf(B+k,e)]},getEditControlPoints:function(_,E,r){E==N&&(E=0),r==N&&(r=E);var n=this,i=n.getAnchor(),z=n.getWidth(),e=n.getHeight(),d=-z*i.x-E,V=-e*i.y-r,x=z+2*E,u=e+2*r;if(_)return[{x:d,y:V},{x:d,y:0},{x:d,y:V+u},{x:0,y:V+u},{x:d+x,y:V+u},{x:d+x,y:0},{x:d+x,y:V},{x:0,y:V}];var Q=n.getMatrix();return[Q.tf(d,V),Q.tf(d,0),Q.tf(d,V+u),Q.tf(0,V+u),Q.tf(d+x,V+u),Q.tf(d+x,0),Q.tf(d+x,V),Q.tf(0,V)]},rotateAt:function(M,S,r){var s=this,X=s._position,b=s._64O,A=new Yp(b,X.x,X.y).tf(M,S),q=m(M*M+S*S),e=D(X.y-A.y,X.x-A.x)+r;s.setRotation(b+r),s.p(A.x+q*E(e),A.y+q*R(e))},onParentChanged:function(){ts.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(J){J._7I()})},onPropertyChanged:function(C){var h=this;ts.superClass.onPropertyChanged.call(h,C),h._69O&&h._69O.each(function(J){J.handleHostPropertyChange(C)}),h._49I&&h._49I.each(function(F){F.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(_){this.updateAttach(_)},onStyleChanged:function(W){ts.superClass.onStyleChanged.apply(this,arguments),Dm[W]&&this.updateAttach()},updateAttach:function(d){var a=this;a._51I||ne||(a._51I=1,a._71O(d),delete a._51I)},_71O:function(e){var H,F,h,O,p,A,i=this,B=i._host,J=e?e.property:N,Y=e?e.oldValue:N,T=e?e.newValue:N;if(B instanceof M.Grid){if(J===Di)i.setElevation(i._54O+T-Y);else if(!e||Pk[J]){if(H=i.s("attach.row.index"),F=i.s("attach.column.index"),h=B.getCellRect(H,F),!h)return;O=i.s("attach.row.span"),p=i.s("attach.column.span"),(1!==O||1!==p)&&(h=fi(h,B.getCellRect(H+O-1,F+p-1))),ok(h,i,"attach.padding",1),i.setRect(h)}}else if(B instanceof mo&&(A=i.s("attach.index"))>=0&&(!e||fd[J])){var n=i.s("attach.thickness");n!=N&&i.setHeight(B.getThickness()*n);var w=i.s("attach.offset"),U=B.getPoints(),r=U.size();if(r>A){var u=U.get(A),P=r===A+1?U.get(0):U.get(A+1),l=[P.x-u.x,P.y-u.y],G=uk(l);if(G){i.s("attach.offset.relative")&&(w*=G),i.s("attach.offset.opposite")&&(w=G-w);var Z={x:u.x+l[0]/G*w,y:u.y+l[1]/G*w},o=i.s("attach.gap");o&&(i.s("attach.gap.relative")&&(o*=B.getThickness()),Z=oq(N,Z,P,o)),i.p(Z),i.setRotation(D(l[1],l[0]))}}}else e&&(J===Nh?i.translate(T.x-Y.x,T.y-Y.y):J===Di?i.setElevation(i._54O+T-Y):xp[J]&&i._11Q(B,J,T-Y))},_11Q:function(N,q,z){var P=this,$=N.p3(),j=fn(P.p3(),$),C=wp(),Z=Ak[P.getRotationMode()],H=Z[0],k=Z[1],c=Z[2],y=Gq[H],g=Gq[k],x=Gq[c];q===Rr&&(q="rotationY",z=-z),q===Rr+H?(x(C,N[il+c]()),g(C,N[il+k]()),y(C,z),g(C,-N[il+k]()),x(C,-N[il+c]()),P[ie+H](P[il+H]()+z)):q===Rr+k?(x(C,N[il+c]()),g(C,z),x(C,-N[il+c]()),P[ie+k](P[il+k]()+z)):q===Rr+c&&(x(C,z),P[ie+c](P[il+c]()+z)),Po(j,C),P.p3($[0]+j[0],$[1]+j[1],$[2]+j[2])},isHostOn:function(b){var s=this;if(s._host&&b&&b._69O)for(var _={},w=s._host;w&&w!==s&&!_[w._id];){if(w===b)return!0;_[w._id]=w,w=w._host}return!1},isLoopedHostOn:function(h){return this.isHostOn(h)&&h.isHostOn(this)},getSerializableProperties:function(){var V=ts.superClass.getSerializableProperties.call(this);return Jc(V,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),V}});var Gi=M.Edge=function(k,z){var R=this;Ho(Gi,R),R.setSource(k),R.setTarget(z)};Wj("Edge",sc,{_icon:"edge_icon",getUIClass:function(){return ms},_22Q:function(){return Ne},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(e){var G=this;if(G._source!==e){var M=G._source;G._source=e,M&&M._16I(G),e&&e._2I(G),G._7I(),G.fp("source",M,e)}},setTarget:function(r){var C=this;if(C._target!==r){var I=C._target;C._target=r,I&&I._18I(C),r&&r._4I(C),C._7I(),C.fp("target",I,r)}},isLooped:function(){var L=this;return L._source===L._target&&!!L._source&&!!L._target},_7I:function(){var c,F=this,N=ae(F);F._40I!==N&&(c=this._40I,c&&c._15I(F),F._40I=N,N&&N._1I(F),F.fp("sourceAgent",c,N),Ok(c,F._41I),Ok(N,F._41I));var P=Pf(F);F._41I!==P&&(c=F._41I,c&&c._17I(F),F._41I=P,P&&P._3I(F),F.fp("targetAgent",c,P),Ok(c,F._40I),Ok(P,F._40I))},_22I:function($){this._52I=$,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var g=this;return g._52I&&g._52I.get(0)!==g&&!g.getStyle(rm)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var r=this,W=r._52I;return W&&!r.getStyle(rm)&&W.size()>1&&r===W.get(0)},toggle:function(){var S=this._52I,B=!this.s(rm);S&&S.size()>1&&(S.each(function(s){s.s(rm,B)}),S.getSiblings().each(function(V){V!==S&&V.each(function(G){G.fp("edgeGroup",N,V)})}))},setStyle:function(c,f){(c===sq||"edge.segments"===c)&&(f=km(f)),Gi.superClass.setStyle.call(this,c,f)},onStyleChanged:function(c){Gi.superClass.onStyleChanged.apply(this,arguments),Al[c]&&Ok(this._41I,this._40I)},getSerializableProperties:function(){var E=Gi.superClass.getSerializableProperties.call(this);return Jc(E,{source:1,target:1}),E}});var Td=M.Group=function(){Ho(Td,this)};Wj("Group",ts,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return _q},onChildAdded:function(){Td.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Td.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var I=this;if(!I._54I&&!ne){var R=I.getChildrenRect();R&&(I._53I=1,I.p(Dg(I.s("group.position"),R,I.getSize())),delete I._53I)}},getChildrenRect:function(){var k,V=this;return V.eachChild(function(O){k=fi(k,V.getChildRect(O))}),k},getChildRect:function(y){var b;return Oh(y)&&y.s(af)&&(xs(y)&&y.isExpanded()&&y.eachChild(function(I){b=fi(b,y.getChildRect(I))}),!b&&y.getRect&&(b=y.getRect())),b},setPosition:function(e,f){var H=this;if(!H._54I){var N;N=2===arguments.length?{x:e,y:f}:e,ne||H._53I||(H._54I=1,Vr(H._children,N.x-H._position.x,N.y-H._position.y),delete H._54I),Td.superClass.setPosition.call(this,N)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(O){var p=this;if(p._57O!==O){var t=p._57O;p._57O=O,p.fp("expanded",t,p._57O),p._8I()}},_8I:function(){Td.superClass._8I.call(this),this.eachChild(function(m){Oh(m)&&m._8I()})},onStyleChanged:function(u){Td.superClass.onStyleChanged.apply(this,arguments),"group.position"===u&&this._81I()},getSerializableProperties:function(){var z=Td.superClass.getSerializableProperties.call(this);return z.expanded=1,z}});var ti=M.Block=function(){Ho(ti,this)};Wj("Block",ts,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return rj},onChildAdded:function(){ti.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){ti.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var L=this;if(!ne&&!L._updatingToChildren&&L._syncSize){var o,k,j,u,S,V=[],_=L.getRotation();if(L.eachChild(function(O){Oh(O)&&V.push.apply(V,O.getCorners())}),V.length){L._updatingFromChildren=1;var I=E(-_),C=R(-_),D=1/0,i=-1/0,M=1/0,T=-1/0;for(u=0,S=V.length;S>u;u++)j=V[u],o=j.x,k=j.y,j.x=I*o-C*k,j.y=C*o+I*k,D=O(D,j.x),i=t(i,j.x),M=O(M,j.y),T=t(T,j.y);var Y=L.getScale();L.setSize(A((i-D)/Y.x),A((T-M)/Y.y));var Q;Y.x<0&&(Q=D,D=i,i=Q),Y.y<0&&(Q=M,M=T,T=Q),I=E(_),C=R(_);var q=L.getAnchor();o=D+(i-D)*q.x,k=M+(T-M)*q.y,L.setPosition(I*o-C*k,C*o+I*k),delete L._updatingFromChildren}}},setPosition:function($,D){var c=this;if(!c._updatingToChildren){var l;l=2===arguments.length?{x:$,y:D}:$,ne||c._updatingFromChildren||(c._updatingToChildren=1,Vr(c._children,l.x-c._position.x,l.y-c._position.y),delete c._updatingToChildren),ti.superClass.setPosition.call(this,l)}},setWidth:function(A){return this.setSize(A,this.getHeight())},setHeight:function(g){return this.setSize(this.getWidth(),g)},setSize:function(f,F){1>f&&(f=1),1>F&&(F=1);var g=this;if(!g._updatingToChildren){2!==arguments.length&&(F=f.height,f=f.width);var s=g.getWidth(),A=g.getHeight();if(f!==s&&ti.superClass.setWidth.call(g,f),F!==A&&ti.superClass.setHeight.call(g,F),!ne&&!g._updatingFromChildren){g._updatingToChildren=1;var M=f/s,_=F/A;g._adjustChildScaleOrSize(M,_,"size"),delete g._updatingToChildren,g.updateFromChildren()}}},_adjustChildScaleOrSize:function(G,T,u){var s=this;if(s._syncSize){var m=s.getPosition(),b=s.getRotation();s.getScale(),s.eachChild(function(O){if(Oh(O)){var M=O.getPosition(),Y=O.getRotation(),L=O.getWidth(),c=O.getHeight(),K=O.getScale(),v=K.x*L,r=K.y*c,k=new Yp(Y,M.x,M.y,v,r);k.translate(-m.x,-m.y),k.rotate(-b),Y=D(k.b*Math.sign(v),k.a*Math.sign(v)),k.scale(G,T);var S,z,p,h=E(Y);if(Math.abs(h)<.001?(S=R(Y),z=k.b/S,p=-k.c/S):(z=k.a/h,p=k.d/h),"scale"===u)O.setScale(z/L,p/c);else if("size"===u){var N=z/K.x,n=p/K.y;O.setScale(Qe(z)*Math.abs(K.x),Qe(p)*Math.abs(K.y)),O.setSize(Math.max(.1,Math.abs(N)),Math.max(.1,Math.abs(n)))}k.rotate(b),k.translate(m.x,m.y),O.setPosition(k.tx,k.ty)}})}},_calcChangeFactor:function(i,C,Y,R){var s,Q,k,U;return s=A(i),Q=A(Y),k=s>Q?s/Q:Q/s,s=A(C),Q=A(R),U=s>Q?s/Q:Q/s,t(k,U)},setAnchor:function(){var f=this;if(!f._updatingToChildren){var L=f.getAnchor();if(ti.superClass.setAnchor.apply(f,arguments),!ne&&!f._updatingFromChildren&&f._syncSize){f._updatingToChildren=1;var z=f.getAnchor();f.getPosition();var i=f.getSize(),U=f.getScale(),J=f.getRotation(),P=-i.width*U.x*(L.x-z.x),I=-i.height*U.y*(L.y-z.y),t=R(J),W=E(J),B=W*P-t*I,c=t*P+W*I;f.eachChild(function(O){if(Oh(O)){var L=O.getPosition();O.setPosition(L.x-B,L.y-c)}}),delete f._updatingToChildren}}},setRotation:function(C){var d=this;if(!d._updatingToChildren){var b=d.getRotation();if(ti.superClass.setRotation.apply(d,arguments),!ne&&!d._updatingFromChildren){d._updatingToChildren=1;var M=d.getPosition(),x=C-b;d.eachChild(function(U){if(Oh(U)){var C=U.getMatrix();C.translate(-M.x,-M.y),C.rotate(x),C.translate(M.x,M.y);var f=Math.sign(U.getScale().x);U.setRotation(D(C.b*f,C.a*f)),U.setPosition(C.tx,C.ty)}}),delete d._updatingToChildren}}},setScale:function(s,D){var $=this;if(!$._updatingToChildren){null==D&&(D=s.y,s=s.x);var F=$.getScale();if(A(s)<.01&&(s=.01*(Qe(s)||Qe(F.x))),A(D)<.01&&(D=.01*(Qe(D)||Qe(F.y))),ti.superClass.setScale.call($,s,D),!ne&&!$._updatingFromChildren){$._updatingToChildren=1;var X=s/F.x,U=D/F.y;$._adjustChildScaleOrSize(X,U,"size"),delete $._updatingToChildren,$.updateFromChildren()}}},getSerializableProperties:function(){var e=ti.superClass.getSerializableProperties.call(this);return e.clickThroughEnabled=1,e.syncSize=1,e}});var xj=M.Grid=function(){Ho(M.Grid,this)};Wj("Grid",ts,{IRotatable:!1,_icon:"grid_icon",_image:N,getUIClass:function(){return Zj},setRotation:function(){},getCellRect:function(P,Q){var O=this,B=O.s("grid.row.count"),I=O.s("grid.column.count");
if(0>=B||0>=I||0>P||P>=B||0>Q||Q>=I)return N;var X,L,U,Z=O.getRect(),Y=O.s("grid.row.percents"),W=O.s("grid.column.percents");if(ok(Z,O,"grid.border",-1),Y&&Y._as&&(Y=Y._as),W&&W._as&&(W=W._as),Y&&Y.length===B){for(U=0,X=0;P>X;X++)U+=Z.height*Y[X];Z.y+=U,Z.height=Z.height*Y[P]}else Z.height=Z.height/B,Z.y+=Z.height*P;if(W&&W.length===I){for(L=0,X=0;Q>X;X++)L+=Z.width*W[X];Z.x+=L,Z.width=Z.width*W[Q]}else Z.width=Z.width/I,Z.x+=Z.width*Q;return po(Z,-O.s("grid.gap")),Z}});var Ai=M.Text=function(){Ho(Ai,this),this.setSize(100,50),this.s("text","TEXT")};Wj("Text",ts,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Pc},setWidth:function(c){c||(c=.001),Ai.superClass.setWidth.call(this,c)},setHeight:function(b){b||(b=.001),Ai.superClass.setHeight.call(this,b)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),vf("__text__",{width:{value:100,isSafeFunc:!0,func:function(n){return n._width}},height:{value:50,isSafeFunc:!0,func:function(v){return v._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var mo=M.Shape=function(){Ho(mo,this),this._59O=new Ol};mo.__de__=cm,Wj("Shape",ts,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return je},_22Q:function(){return Mr},getLength:function(X){return rp(fg(this._59O,this._58O,X,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var j=this._58O;return j?new Ol(j._as.slice(0)):j},setSegments:function(j){var b=this._58O;j=j?Sg(j)?new Ol(j.slice(0)):new Ol(j._as.slice(0)):null,(b&&j&&b._as.join(",")!==j._as.join(",")||b!==j)&&(this._58O=j,this.fp("segments",b,j))},getPoints:function(){return this._59O},toPoints:function(){var p=this._59O;return new Ol(p._as.slice(0))},setPoints:function(n,k){var H=this,F=H._59O;n=n?Sg(n)?new Ol(n.slice(0)):new Ol(n._as.slice(0)):new Ol;var U,L,f,V,$,j;k&&(U=H.getPosition(),j=new Yp(H.getRotation(),0,0,H.getScale().x,H.getScale().y)),(F&&n&&F._as.join(",")!==n._as.join(",")||F!==n)&&(H._59O=n,H.fs(),H.fp("points",F,n)),k&&(L=H.getPosition(),f=L.x-U.x,V=L.y-U.y,$=j.tf(f,V),H.setPosition(L.x-f+$.x,L.y-V+$.y))},addPoint:function(v,P,R){var b=this.toPoints();b.add(v,P),this.setPoints(b,R)},setPoint:function(a,y,g){var D=this.toPoints();D.set(a,y),this.setPoints(D,g)},removePointAt:function(T){var j=this.toPoints();j.removeAt(T),this.setPoints(j)},setWidth:function(j){var h=this;if(1>j&&(j=1),!h._55I&&!ne&&h.getWidth()){h._55I=1;var P=h._position.x,Z=j/h.getWidth(),$=h.toPoints(),d=new Ol;$.each(function(o){d.add({x:(o.x-P)*Z+P,y:o.y,e:o.e})}),h.setPoints(d),pi(h,[Z,0,0,1,P*(1-Z),0]),h.fs(),delete h._55I}mo.superClass.setWidth.call(h,j)},setHeight:function(u){var X=this;if(1>u&&(u=1),!X._55I&&!ne&&X.getHeight()){X._55I=1;var F=X._position.y,J=u/X.getHeight(),y=X.toPoints(),T=new Ol;y.each(function(k){T.add({x:k.x,y:(k.y-F)*J+F,e:k.e})}),X.setPoints(T),pi(X,[1,0,0,J,0,F*(1-J)]),X.fs(),delete X._55I}mo.superClass.setHeight.call(X,u)},setAnchorElevation:function(D){var q=this;q._55I=!0;var s=q._updatingAnchor3d,t=!ne&&!s;if(t){var a,U=D,K=q.getAnchorElevation(),u=q.getTall();a=u*(K-U),q.shiftPointsElevation(a)}var L=mo.superClass.setAnchorElevation.apply(q,arguments);return s||delete q._55I,L},getShapeElevation:function(){var j=this,E=j._54O;return E-(j.getTall()||0)*(j._anchorElevation-.5)},setAnchor3d:function(d,Z,W,D){var l,i=this;"number"==typeof d?l={x:d,y:Z,z:W}:(l=d.length?{x:d[0],y:d[1],z:d[2]}:d,D=Z),i._55I=!0,i._updatingAnchor3d=!0;var N=i.getDataModel();if(N&&N.beginTransaction(),!ne){var A=i.getAnchor3d(),p=i.getSize(),R=i.getTall(),q=p.width*(A.x-l.x),y=p.height*(A.z-l.z),P=R*(A.y-l.y);D||i.shiftPoints(q,y,P);var u=i.p3()}var T=mo.superClass.setAnchor3d.apply(i,arguments);if(!ne&&D){var H=i.p3();i.shiftPoints(H[0]-u[0]+q,H[2]-u[2]+y,H[1]-u[1]+P)}return N&&N.endTransaction(),delete i._updatingAnchor3d,delete i._55I,T},setAnchor:function(h,w,C){var r=this;r._55I=!0;var F=r._updatingAnchor3d,m=!ne&&!F;if(m){var c,t,n;"number"==typeof h?n={x:h,y:w}:(n=h.length?{x:h[0],y:h[1]}:h,C=w);var x=r.getAnchor(),Z=r.getSize();c=Z.width*(x.x-n.x),t=Z.height*(x.y-n.y),C||r.shiftPoints(c,t);var Q=r.getPosition()}var i=mo.superClass.setAnchor.apply(r,arguments);if(m){var e=r.getPosition();C&&r.shiftPoints(e.x-Q.x+c,e.y-Q.y+t)}return F||delete r._55I,i},shiftPoints:function(g,U,e){var T=this,m=T.getElevation()||0,V=T.toPoints(),W=new Ol;V.each(function(V){var Z=V.e;e&&(Z=(Z==N?m:Z)+e),W.add({x:V.x+g,y:V.y+U,e:Z})}),T.setPoints(W),T.fs()},shiftPointsElevation:function(N){return this.shiftPoints(0,0,N)},setPosition:function(i,q){var z,$=this;if(!$._28Q){if($._28Q=1,!$._55I&&!ne){z=2===arguments.length?{x:i,y:q}:i;var Q=z.x-$._position.x,h=z.y-$._position.y;if(0===Q&&0===h)return delete $._28Q,void 0;$._55I=1,$.shiftPoints(Q,h),pi($,[1,0,0,1,Q,h]),delete $._55I}mo.superClass.setPosition.apply($,arguments),delete $._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var q=this;if(2!==q._59O.size())return!1;var Z=q._58O;return Z?2===Z.size()&&1===Z.get(0)&&2===Z.get(1)?!0:!1:!0},fireShapeChange:function(){var E=this;if(!E._55I&&!ne){var R=re(E._59O);R&&(E._55I=1,E.setRect(R),delete E._55I)}E.fp(gn,!1,!0)},getSerializableProperties:function(){var M=mo.superClass.getSerializableProperties.call(this);return M.segments=1,M.points=1,M.thickness=1,M.closePath=1,M}});var Bo=M.Polyline=function(){Ho(Bo,this),this.s({"shape.background":null,"shape.border.width":2})};Wj("Polyline",mo,{_icon:"polyline_icon",_22Q:function(){return en},getUIClass:function(){return oe},setClosePath:function(){},setTall:function(v){var M=this;if(!M._55I&&!M._24Q&&!ne&&M.getTall()){M._24Q=1;var o=M._54O,S=v/M.getTall();M._59O.each(function(T){T.e=T.e==N?o:(T.e-o)*S+o}),M.fs(),delete M._24Q}Bo.superClass.setTall.call(M,v)},setElevation:function(D){var k=this;if(!k._55I&&!k._24Q&&!ne){k._24Q=1;var j=D-k._54O;k._59O.each(function(d){d.e==N?d.e=D:d.e+=j}),k.fs(),delete k._24Q}Bo.superClass.setElevation.apply(k,arguments)},fireShapeChange:function(){var G=this,M=G._59O;if(!G._55I&&!G._24Q&&!ne){var u=M.size();if(u){var U=1,A=M.get(0),g=G._54O;A.e==N&&(A.e=g);for(var o=A.e,v=0;u>U;U++){A=M.get(U),A.e==N&&(A.e=g);var k=O(o,A.e),q=t(o+v,A.e);o=k,v=q-k}G._24Q=1,G.setTall(v),G.setElevation(o+v*G._anchorElevation),delete G._24Q}}Bo.superClass.fireShapeChange.apply(G,arguments)}});var pq=M.SubGraph=function(){Ho(pq,this)};Wj("SubGraph",ts,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){pq.superClass._8I.call(this),this.eachChild(function(H){Oh(H)&&H._8I()})}}),Q.loadingRefGraph=0;var $j=M.RefGraph=function(){Ho($j,this)};Wj("RefGraph",ti,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(W){var z=this._ref;this._ref=W,this.fp("ref",z,W),this.updateRef()},_21I:function(){$j.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var W=this;if(Q.loadingRefGraph++,W.clearChildrenFromDataModel(),Q.loadingRefGraph--,W._ref&&W._dataModel){W._xhrLoadHandler&&(W._xhrLoadHandler.cancel=!0);var r=ne,c=W._xhrLoadHandler=function(M){if(M&&W._dataModel){Q.loadingRefGraph++;var s=W._pendingUpdateInfo={needToRestore:r};r&&(s.position=W.p(),s.width=W.getWidth(),s.height=W.getHeight(),s.rotation=W.getRotation(),s.anchor=W.getAnchor(),s.scale=W.getScale()),W.p(0,0),W.setAnchor(.5,.5),W.setRotation(0),W.setScale(1,1);var L=Q.parse(M),l=W._dataModel.deserialize(L,W,{justDatas:!0});l.each(function(z){z._refGraph=W}),W.checkPendingUpdateInfo(),Q.loadingRefGraph--,Q.handleRefGraphLoaded(W,l,L)}};c.xhrLoadCalled=!1,Q.load(W._ref,function(A){c.cancel||(c.xhrLoadCalled?c(A):Ln(function(){c(A)}))}),c.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var I=this,X=I._pendingUpdateInfo;if(!X)return I.onPendingUpdated&&(Q.loadingRefGraph++,I.onPendingUpdated(),Q.loadingRefGraph--),void 0;var f=!0;this.eachChild(function(K){(K._pendingCheckImageJSON||K._pendingUpdateInfo)&&(f=!1)}),f&&(Q.loadingRefGraph++,I._pendingUpdateInfo=null,I.updateFromChildren(),X.needToRestore&&(I.setSize(X.width,X.height),I.setAnchor(X.anchor),I.setRotation(X.rotation),I.setScale(X.scale),I.p(X.position)),this.getParent()instanceof $j&&this.getParent().checkPendingUpdateInfo(),I.onPendingUpdated&&I.onPendingUpdated(),Q.loadingRefGraph--)},getSerializableProperties:function(){var c=$j.superClass.getSerializableProperties.call(this);return c.ref=1,c}}),M.EdgeGroup=function(H,X){this._70O=H,this._siblings=X;for(var Y,C,W=0,c=H.size(),u=_[rm];c>W;W++)if(Y=H.get(W).getStyle(rm,!1),Y!=N){u=Y;break}u==N&&(u=!0);var $=Q.edgeGroupAgentFunc;for($&&(C=$(H),C&&C!==H.get(0)&&(H.remove(C),H.add(C,0))),W=0;c>W;W++)H.get(W).s(rm,u)},Wj("EdgeGroup",J,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function($){return this._70O.get($)},indexOf:function(b){return this._70O.indexOf(b)},each:function(m,y){this._70O.each(m,y)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(u,w){this._siblings.each(function(A){A._70O.each(u,w)})}});var xg=function(D,Y,e){var Z=an[D]={type:D,action:Y};if(e)for(var A in e)Z[A]=e[A]};xg("host",function(R,P,F){F&&P.setHost(F)},{"delete":{visible:function(b,y){return y.getHost()},action:function(o,r){r.setHost(null)}}}),xg("parent",function(s,U,u){u&&U.setParent(u)},{"delete":{visible:function(k,Z){return Z.getParent()},action:function(d,p){p.setParent(null)}}}),xg("copySize",function(B,G,R){if(R){var Z=R.getSize();G.setSize(Z)}}),xg("copyRotation",function(X,s,U){if(U){var m=U.getRotation();s.setRotation(m)}}),xg("edge",function(N,j,Z){if(Z){var Y=new M.Edge(j,Z);j.dm().add(Y)}}),Jc(Q,{setConnectAction:xg,getConnectAction:function(R,N){return N=N||R.getCurrentConnectActionType(),an[N]},doConnectAction:function(k,M,m,Q){Q=Q||k.getCurrentConnectActionType();var V=an[Q];if(!V)return!1;var c=V.action;return c?(c.call(null,k,M,m),!0):!1},doDeleteConnectionAction:function(U,V,q){q=q||U.getCurrentConnectActionType();var X=an[q];if(!X||!X.delete)return!1;var s=X.delete.action;return s?(s.call(null,U,V),!0):!1}});var hp=M.JSONSerializer=function($,L){this.dm=this._dataModel=$,this._hierarchical=Q.forceHierarchicalSerialization?!0:L==N?$.isHierarchicalRendering():L};Wj("JSONSerializer",J,{ms_ac:["hierarchical"],serialize:function(W){return Q.stringify(this.toJSON(),W)},toJSON:function(){var U=this,q=U.dm,N=q.getRoots(),c=U.json={v:Q.getVersion(),p:{},a:{},d:[]},X=q.getSerializableAttrs();q.getInit()&&(c.init=q.getInit()),q.getName()&&(c.p.name=q.getName()),q.getBackground()&&(c.p.background=q.getBackground()),q.getLayers()&&(c.p.layers=q.getLayers()),c.p.autoAdjustIndex=q.isAutoAdjustIndex(),c.p.hierarchicalRendering=q.isHierarchicalRendering();for(var z in X){var f=q.a(z);f!==d&&U[jl](z,f,c.a)}return jj(c.a)&&delete c.a,U._hierarchical?N.each(U.serializeData,this):q.each(function(K){U.serializeData(K)}),c},isSerializable:function(){return!0},getProperties:function(F){return F.getSerializableProperties()},getStyles:function(B){return B.getSerializableStyles()},getAttrs:function(e){return e.getSerializableAttrs()},serializeData:function(g){var e=this;if(e.isSerializable(g)&&!g._refGraph){var t,a,B,m,O=Me(g.getClassName())||g.getClass(),v=new O,w={c:g.getClassName(),i:g.getId(),p:{},s:{},a:{}};e.json.d.push(w),t=e.getProperties(g);for(a in t)/^_/.test(a)?(B=g[a],B!==v[a]&&e[jl](a.substr(1),B,w.p)):(m=Lq(a),g[m]&&(B=g[m](),B!==v[m]()&&e[jl](a,B,w.p)));t=e.getStyles(g);for(a in t)B=g.s(a),B!==v.s(a)&&e[jl](a,B,w.s);t=e.getAttrs(g);for(a in t)B=g.a(a),B!==v.a(a)&&e[jl](a,B,w.a);jj(w.p)&&delete w.p,jj(w.s)&&delete w.s,jj(w.a)&&delete w.a}e._hierarchical&&g.getChildren().each(e.serializeData,e)},serializeValue:function(v,f,c){xi(f)?f={__a:f._as}:f instanceof sc&&(f={__i:f.getId()}),c[v]=f},deserialize:function(B,S,v){var U=this,s=U.dm;s.beginTransaction(),ne++,v=mr(v)?{setId:v}:v||{},B=U.json=Hq(B)?Q.parse(B):B,U._82I={};var o=new Ol,b=new Ol,K=0,c=B.d.length;if(v.justDatas||(ri(B.init)&&B.init(s),s.setInit(B.init)),!v.justDatas){for(var R in B.a)s.a(R,U[Se](B.a[R]));for(var z in B.p)s[lk(z)](B.p[z])}for(;c>K;K++){var m=B.d[K],O=Me(m.c),i=new O,Z=m.i;v.setId&&Z!=N&&(i._id=Z),U._82I[Z]=i,o.add(i),b.add(m)}for(K=0;c>K;K++)U.deserializeData(o.get(K),b.get(K));return o.each(function(f){S&&!f.getParent()&&f.setParent(S),s.add(f)}),ne--,s.endTransaction(),o},deserializeData:function(s,Z){for(var K in Z.p)s[lk(K)](this[Se](Z.p[K]));for(K in Z.s)s.s(K,this[Se](Z.s[K]));for(K in Z.a)s.a(K,this[Se](Z.a[K]))},deserializeValue:function(F){if(eh(F)){var M=F.__i;if(M!=N)return this._82I[M];if(M=F.__a,Sg(M))return new Ol(M)}return F}}),Jc(Mf,{serialize:function(u,d){return new hp(this,d).serialize(u)},toJSON:function(U){return new hp(this,U).toJSON()},deserialize:function(D,I,G){return new hp(this).deserialize(D,I,G)}});var od=M.OverlappingBox=function(p){this.gv=p,this.boxes={}};Wj("OverlappingBox",J,{clear:function(){var u,D,V=this.boxes;for(u in V)D=V[u],D.length=0},isOverlapping:function(E,f){var u,$,B=this,T=B.boxes,a=T[E];a?(u=a.rects,$=a.length):a=T[E]={rects:u=[],length:$=0};var k,q,f;for(k=0;$>k;k++)if(q=u[k],q.x<f.x+f.w&&q.x+q.w>f.x&&q.y<f.y+f.h&&q.h+q.y>f.y)return!0;return u.length<=$?(u.push(f),a.length++):u[a.length++]=f,!1}}),Bd.GraphView=function(o){var m=this;m._24I={},m._34I=new Ol,m._25I={},m._56I={},m._view=nh(1,m),m._canvas=Uq(m._view),m.dm(o?o:new Mf),this._coreInteractor=new Ee(this),m.setEditable(!1),m.setScrollBarVisible(Q.graphViewScrollBarVisible)},Kd("GraphView",J,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Df,jf,ob,Ig,"resettable","editInteractor",Fl,"pannable","rectSelectable","autoScrollZone",Jh,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:Q.graphViewResettable,_pannable:Q.graphViewPannable,_rectSelectable:Q.graphViewRectSelectable,_autoScrollZone:Q.graphViewAutoScrollZone,_rectSelectBackground:Q.graphViewRectSelectBackground,_rectSelectBorderColor:Q.graphViewRectSelectBorderColor,_editPointSize:Q.graphViewEditPointSize,_editPointBorderColor:Q.graphViewEditPointBorderColor,_editPointBackground:Q.graphViewEditPointBackground,_scrollBarColor:$n,_scrollBarSize:ss,_autoHideScrollBar:qe,_autoMakeVisible:rk,_currentActionType:"host",getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(x){this._dataModel.setLayers(x)},setEditable:function(J){var k=this,e=k.__interactorMap__;if(!e){var z=Bd.XEditInteractor;e=k.__interactorMap__={scrollBar:new If(k),select:new uh(k),edit:z?new z(k):new Uo(k),move:new Hi(k),"default":new wc(k),touch:new mh(k,{editable:!1})}}J?(k._uieditable=!0,k.setInteractors([e.scrollBar,e.select,e.edit,e.move,e.default,e.touch])):(k._uieditable=!1,k.setInteractors([e.scrollBar,e.select,e.move,e.default,e.touch]))},getCanvas:function(){return this._canvas},_33I:function(_){var H=_.getUIClass();return H?new H(this,_):N},getDataUI:function(a){var Q=this,W=Q._25I[a._id];return W===d&&(W=Q._33I(a),Q._25I[a._id]=W),W},getNodeRect:function($){return Q.getNodeRect(this,$)},getEdgeInfo:function(H){var u=this.getDataUI(H);return u?(u._79o(),u._78o):null},getEdgeSourcePosition:function(J){var P=this,U=P.getDataUI(J),$=U.s,d=U._data._40I;return xo(P,d,$("edge.source.position"),$("edge.source.offset.x"),$("edge.source.offset.y"),$("edge.source.anchor.x"),$("edge.source.anchor.y"))},getEdgeTargetPosition:function(H){var C=this,G=C.getDataUI(H),o=G.s,J=G._data._41I;return xo(C,J,o("edge.target.position"),o("edge.target.offset.x"),o("edge.target.offset.y"),o("edge.target.anchor.x"),o("edge.target.anchor.y"))},invalidateAll:function(K){var g=this;if(K){for(var P in g._25I){var S=g._25I[P];S&&S.dispose()}g._25I={},g._56I={},g._24I={},g._34I.clear(),g.redraw()}else g.dm().each(function(X){g.invalidateData(X)})},invalidateSelection:function(){var h=this;h.sm().each(function(u){h.invalidateData(u)})},invalidateData:function(V){var O=this;O._24I[V._id]=V,O._21Q(V),O.iv()},_21Q:function(H){var o=this,C=o._24I;if(Hm(H)&&Ge[H.s(Zk)]){var u=H.getSourceAgent();u&&u.getAgentEdges().each(function($){C[$._id]=$}),u=H.getTargetAgent(),u&&u.getAgentEdges().each(function(z){C[z._id]=z}),o.iv()}},redraw:function(p){var Y=this;Y._32I||(p?Y._34I.add(p):(Y._32I=1,Y._34I.clear()),Y.iv())},each:function(h,g){var T,R,l,P=0,r=this.getLayers(),b=this._dataModel,m=b._datas._as,E=m.length;if(r){for(var H=r.length;H>P;P++)if(l=r[P],eh(l)&&(l=l.name),b.isHierarchicalRendering()){var O=function(C){return C._layer===l?g?h.call(g,C):h(C):void 0};if(this._dataModel.eachByHierarchical(O)===!1)return}else for(var t=0;E>t;t++)if(T=m[t],T._layer===l&&(R=g?h.call(g,T):h(T),R===!1))return}else if(b.isHierarchicalRendering())this._dataModel.eachByHierarchical(h,null,g);else for(;E>P;P++)if(T=m[P],R=g?h.call(g,T):h(T),R===!1)return},reverseEach:function(o,s){var K,p,l,v,I=this._dataModel,n=I._layers,r=I._datas._as,q=r.length;if(n){for(K=n.length-1;K>=0;K--)if(v=n[K],eh(v)&&(v=v.name),I.isHierarchicalRendering()){var x=function(F){return F._layer===v?s?o.call(s,F):o(F):void 0};if(I.reverseEachByHierarchical(x)===!1)return}else for(var E=q-1;E>=0;E--)if(p=r[E],p._layer===v&&(l=s?o.call(s,p):o(p),l===!1))return}else if(I.isHierarchicalRendering())I.reverseEachByHierarchical(o,null,s);else for(K=q-1;K>=0;K--)if(p=r[K],l=s?o.call(s,p):o(p),l===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var o=this,$=o._84I;if(!$){var d=this.dm().a("width"),K=this.dm().a("height");d>0&&K>0?o._84I={x:0,y:0,width:d,height:K}:(o.each(function(H){o.isVisible(H)&&($=fi($,o.getDataUIBounds(H)))}),o._84I=$?$:be)}return o._84I},getScrollRect:function(){return fi(this.getContentRect(),this._29I)},makeCenter:function(_,v,u){var o=this;if(!o.getWidth()||!o.getHeight())return u||Ln(o.centerData,o,[_,v,!0],500),void 0;o.makeVisible(_),o.validate();var P=o.getDataUIBounds(_);if(P){var i=o.getWidth(),A=o.getHeight(),F=P.x+P.width/2,k=P.y+P.height/2,r=-F*o._zoom+i/2,p=-k*o._zoom+A/2;o.setTranslate(r,p,v)}},fitData:function(i,o,V,D,J){var c=this;if(!c.getWidth()||!c.getHeight())return J||Ln(c.fitData,c,[i,o,V,D,!0],500),void 0;var T=function(){c.makeVisible(i),c.validate();var p=c.getDataUIBounds(i);p&&(p=hg(p),po(p,V==N?20:V),c.fitRect(p,o,D))};o?Q.callWhenLoaded(T):T()},fitContent:function(V,y,A,F){var c=this;if(!c.getWidth()||!c.getHeight())return F||Ln(c.fitContent,c,[V,y,A,!0],500),void 0;var v=function(){c.validate();var B=hg(c.getContentRect());po(B,y==N?20:y),c.fitRect(B,V,A)};V?Q.callWhenLoaded(v):v()},fitRect:function(o,V,X){var e=this,D=e.getWidth(),C=e.getHeight(),F=o.x+o.width/2,$=o.y+o.height/2,f=O(D/o.width,C/o.height),Y=e._zoom,J=-F*Y+D/2,x=-$*Y+C/2;0===f||isNaN(f)||(X&&(f=O(1,f)),V?e.setTranslate(J,x,{finishFunc:function(){e.setZoom(f,V)}}):(e.setTranslate(J,x),e.setZoom(f)))},toCanvas:function(R,J){J=J||this._zoom,this.validateImpl();var p=this,A=p.getContentRect();A.width||(A.width=10),A.height||(A.height=10);var b=Uq(),c=A.x*J,i=A.y*J,F=A.width*J,k=A.height*J;pp(b,F,k,1);var f=Ji(b);return R=R||this._dataModel.getBackground(),R&&zs(f,0,0,F,k,R),qo(f,-c,-i),f.scale(J,J),p._42(f),f.restore(),b},toDataURL:function(x,z,b){return this.toCanvas(x,b).toDataURL(z||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(Y,R){var u,e,C=this;C._93db(Y,R),C.each(function(k){C._56I[k._id]&&(u=C.getDataUI(k),u&&(e=u._79o(),M.HtmlNode&&k instanceof M.HtmlNode?u._42(Y):(!R||pe(R,e))&&u._42(Y)))}),C._92db(Y,R)},validateImpl:function(){var C,H,I,D,T,S=this,m=S.tx(),h=S.ty(),r=S._zoom,z=S._canvas,A=this.getWidth(),N=this.getHeight(),Z=S._29I,F={x:-m/r,y:-h/r,width:A/r,height:N/r},V={},o=S._34I,f=S._24I,$=S._32I,E=S._23I;S._24I={},(A!==z.clientWidth||N!==z.clientHeight)&&(pp(z,A,N),$=1),$||wd(F,Z)||($=1),S._29I=F,S.each(function(J){H=J._id;var j=V[H]=S.isVisible(J);j!==S._56I[H]&&(f[H]=J,I=S.getDataUI(f[H]),I&&I._84o(j),S._84o(J,j))},S);for(H in f)I=S.getDataUI(f[H]),I&&(!$&&S._56I[H]&&(T=I._79o(),T&&o.add(T)),I.invalidate()),S._83I=1;if(S._56I=V,!$)for(H in f)V[H]&&(I=S.getDataUI(f[H]),I&&(T=I._79o(),T&&o.add(T)));if($?D=F:(o.each(function(h){pe(F,h)&&(D=fi(D,h))}),D&&(po(D,t(1,1/r)),D.x=y(D.x*r)/r,D.y=y(D.y*r)/r,D.width=U(D.width*r)/r,D.height=U(D.height*r)/r,D=_e(F,D))),S._74O=D,D){C=Ji(z);var q=D.x,L=D.y,u=D.width,M=D.height;q=Math.floor((q*r+m)*Wn),L=Math.floor((L*r+h)*Wn),u=Math.ceil(u*r*Wn)+1,M=Math.ceil(M*r*Wn)+1,C.beginPath(),C.rect(q,L,u,M),C.clip(),C.clearRect(q,L,u,M),dg(C,m,h,r),S._42(C,D),C.restore(),delete S._74O}if(o.clear(),delete S._32I,E&&A>0&&N>0){var I=S.getDataUI(E);if(I){var T=I._79o(),G=S._29I,_=G.x,l=G.y,B=G.width,x=G.height,r=S._zoom;T&&!pe(T,G)&&(T.x+T.width<_&&S.tx(-T.x*r),T.x>_+B&&S.tx(-(T.x+T.width-B)*r),T.y+T.height<l&&S.ty(-T.y*r),T.y>l+x&&S.ty(-(T.y+T.height-x)*r))}delete S._23I}S._83I&&(delete S._83I,delete S._84I),S._98O(),jj(S._24I)||Ln(S.iv,S)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(O){var S=this;O!==S.isScrollBarVisible()&&(O?(kr(S._view,S._79O=ac()),kr(S._79O,S._27I=ac()),kr(S._79O,S._28I=ac())):(eq(S._79O),delete S._79O,delete S._27I,delete S._28I),S.fp("scrollBarVisible",!O,O))},showScrollBar:function(){var w=this;w._79O&&(w._85I||(b(function(){w._86I()},Xk),w.iv()),w._85I=new Date)},_86I:function(){var T=this;if(T._85I){var J=new Date,M=J.getTime();M-T._85I.getTime()>=Xk?(delete T._85I,T.iv()):b(function(){T._86I()},Xk)}},_98O:function(){var C=this,a=this._27I,n=this._28I;if(C._79O){if(C._autoHideScrollBar&&!C._85I)return a.style.visibility=cs,n.style.visibility=cs,void 0;var S=C.getScrollBarColor(),t=C._zoom,_=C.getScrollBarSize(),Z=C.getViewRect(),E=C.getScrollRect(),v=Z.height*t,V=E.height*t,d=Z.width*t-_-2,w=v*((Z.y-E.y)*t/V),R=v*(v/V),M=a.style;V-.5>v?(Dj>R&&(w=w+R/2-Dj/2,0>w&&(w=0),w+Dj>v&&(w=v-Dj),R=Dj),Sf(a,d,w,_,R),M.visibility=_k,M.background=S,M.borderRadius=_/2+Rn):M.visibility=cs;var U=Z.width*t,r=E.width*t,w=Z.height*t-_-2,d=U*((Z.x-E.x)*t/r),G=U*(U/r),M=n.style;r-.5>U?(Dj>G&&(d=d+G/2-Dj/2,0>d&&(d=0),d+Dj>U&&(d=U-Dj),G=Dj),Sf(n,d,w,G,_),M.visibility=_k,M.background=S,M.borderRadius=_/2+Rn):M.visibility=cs}},setDataModel:function(H){var n=this,z=n._dataModel,Y=n._selectionModel;z!==H&&(z&&(z.ump(n.handleDataModelPropertyChange,n),z.umm(n.handleDataModelChange,n),z.umd(n.handleDataPropertyChange,n),z.removeIndexChangeListener(n._75O,n),z.removeHierarchyChangeListener(n.handleHierarchyChange,n),Y||z.sm().ums(n.handleSelectionChange,n)),n._dataModel=H,H.mp(n.handleDataModelPropertyChange,n),H.mm(n.handleDataModelChange,n),H.md(n.handleDataPropertyChange,n),H.addIndexChangeListener(n._75O,n),H.addHierarchyChangeListener(n.handleHierarchyChange,n),Y?Y._21I(H):H.sm().ms(n.handleSelectionChange,n),n.invalidateAll(!0),n.fp(Fr,z,H),n._canvas.style.background=H.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===d){var u=this.getLayers();u?(this._layersInfo={},u.forEach(function(J){var x=eh(J)?J.name:J;this._layersInfo[x]=J},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=d,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(n){if("background"===n.property){var Q=this._canvas.style.background,P=n.newValue||"";this._canvas.style.background=P,this.fp("canvasBackground",Q,P)}else"a:width"===n.property||"a:height"===n.property?(this._83I=1,this.redraw()):"layers"===n.property?this.updateLayers():"hierarchicalRendering"===n.property&&this.redraw()},handleDataPropertyChange:function(s){this.dm().isHierarchicalRendering()&&"parent"===s.property&&s.data.hasChildren()&&this.redraw(),this.invalidateData(s.data)},onPropertyChanged:function(v){var C=this,U=v.property;if(C.redraw(),"zoom"===U){var c=C.sm().getSelection();c.size()&&c.each(function(R){R.invalidate()})}Qo[U]?C.showScrollBar():U===Fl&&C.onCurrentSubGraphChanged(v)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(I){var M=this,S=I.kind,p=I.data;if(M._83I=1,"add"===S)M.invalidateData(p),Hm(p)&&p.getEdgeGroup()&&p.getEdgeGroup().eachSiblingEdge(M.invalidateData,M);else if(S===Ek){M._21Q(p);var B=p._id,o=M._25I[B];if(o){if(M._56I[B]){var X=o._79o();X&&M.redraw(X)}o.dispose(),delete M._25I[B],delete M._24I[B],delete M._56I[B]}p===M._currentSubGraph&&M.setCurrentSubGraph(N)}else S===qf&&(M.invalidateAll(!0),M.setCurrentSubGraph(N))},_75O:function(R){this.invalidateData(R.data)},handleHierarchyChange:function(h){this.dm().isHierarchicalRendering()&&h.data.hasChildren()&&this.redraw(),this.invalidateData(h.data)},adjustIndex:function(o){var k=this;if(k.isVisible(o)){k.dm().beginTransaction();for(var C=o;C._parent&&k.isVisible(C._parent);)C=C._parent;C&&C!==o&&k._dataModel.adjustIndex(C),k._dataModel.adjustIndex(o),k.dm().endTransaction()}},getImage:function(c){return c.getImage?c.getImage():d},getSelectWidth:function(u){return u.s("select.width")},isSelectable:function(n){if(!this._clickThroughChecking&&n.getParent()instanceof ti&&n.getParent().isSyncSize())return!1;var P=this.getLayersInfo();if(P){var u=P[n._layer];if(u&&u.selectable===!1)return!1}return n.s("2d.selectable")&&this.sm().isSelectable(n)},isMovable:function(m){var M=this;if(Hm(m)&&m.getStyle(Zk)!==Sb)return!1;var e=this.getLayersInfo();if(e){var L=e[m._layer];if(L&&L.movable===!1)return!1}return m.s("2d.movable")?M._movableFunc?M._movableFunc(m):!0:!1},isEditable:function(l){var i=this;if(M._uiSerializing)return i._uieditable;if(!i._editInteractor||!i.isSelected(l))return!1;if(xs(l)){var m=i.getDataUI(l);if(!m||m._88I)return!1}if(Hm(l)&&l.getStyle(Zk)!==Sb)return!1;var Z=this.getLayersInfo();if(Z){var r=Z[l._layer];if(r&&r.editable===!1)return!1}return l.s("2d.editable")?i._editableFunc?i._editableFunc(l):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(R){return Oh(R)&&0!==R.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(R):!0},isRectEditable:function(Z){return this._rectEditableFunc?this._rectEditableFunc(Z):!0},isAnchorEditable:function(N){return this._anchorEditableFunc?this._anchorEditableFunc(N):!0},isRotationEditable:function(m){return m.setRotation&&m.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(m):!0:!1},getRotationPoint:function(j){var S=j.getAnchor(),I=j.getScale(),q=this._zoom,f=nj(j.getRotation(),0,-j.getHeight()*I.y*S.y-(I.y<0?-1:1)*(Bq?32:16)/q),F=j.p();return f.x+=F.x,f.y+=F.y,f},getLogicalPoint:function(y){var W=this;return ar(y,W._canvas,W.tx(),W.ty(),W._zoom,W._zoom)},getSelectedDataAt:function(y){var X=this;return this.getDataAt(y,function(T){return X.isSelected(T)})},getDataInfoAt:function(B,Q,J){var C,p=this.lp(B),G=this.getDataAt(p,Q,J);if(G){var X=this.getDataUI(G);C={data:G,ui:X,point:p};var S=X._38o;if(S){var I=S.icons;for(var w in I){var D=I[w],U=S.rects[w];if(U)for(var l=Hr(D.names,G,this),L=l?l.length:0,y=U.rotation,A=L-1;A>=0;A--){var v=l[A],R=U[A];if(Ah(R,p,y))return C.part="icons",C.name=w,C.icon=v,C.rect=R,C.index=A,C.rotation=y,C}}}if(this.isNoteVisible(G)){if(X.note2Info&&Ah(X.note2Info.clickRect,p,N,X.note2Info.scale))return C.part="note2",C;if(X.noteInfo&&Ah(X.noteInfo.clickRect,p,N,X.noteInfo.scale))return C.part="note",C}if(this.isLabelVisible(G)){if(X.label2Info&&Ah(X.label2Info.rect,p,X.label2Info.rotation,X.label2Info.scale))return C.part="label2",C;if(X.labelInfo&&Ah(X.labelInfo.rect,p,X.labelInfo.rotation,X.labelInfo.scale))return C.part="label",C}if(G.isInRect&&G.isInRect(p))return C.part="body",C}return C},getDataAt:function(j,O,l){j.target&&(j=this.lp(j));var i,F=this._zoom;return this.reverseEach(function(s){return(O?O(s):this.isSelectable(s))&&this.rectIntersects(s,Ve(j.x,j.y,l,F))?(i=s,!1):void 0},this),i},getIconInfoAt:function(z,P){var g=this;if(z.target&&(z=g.lp(z)),P||(P=g.getDataAt(z)),P){var D=g.getDataUI(P);if(D&&D._38o){var c,G=D._38o,y=new Ol;for(c in G.icons)y.add(c);for(var h=y.size()-1;h>=0;h--){c=y.get(h);for(var Q=G.rects[c],x=Q.rotation,K=Q.length-1;K>=0;K--){var Y=Q[K],k=Y.width,S=Y.height,F={x:z.x-Y.x-k/2,y:z.y-Y.y-S/2};x!=N&&(F=nj(-x,F.x,F.y));var Y={x:-k/2,y:-S/2,width:k,height:S};if(Ah(Y,F))return{key:c,index:K,name:G.icons[c].names[K],rect:Q[K],point:z,rotation:x,relativeRect:Y,relativePoint:F,data:P}}}}}return N},getDatasInRect:function(i,q,B){B===d&&(B=1);var u=this,L=new Ol;return u.reverseEach(function(_){B&&!u.isSelectable(_)||(q?u.rectIntersects(_,i):u.rectContains(_,i))&&L.add(_)}),L},moveSelection:function(Q,$){var b=this;b.dm().beginTransaction(),Vr(b.sm().toSelection(b.isMovable,b),Q,$),b.dm().endTransaction()},moveDatas:function(u,s,B){var v=this;v.dm().beginTransaction(),u instanceof Ol||(u=new Ol(u)),Vr(u,s,B),v.dm().endTransaction()},getDataUIBounds:function(A){var M=this.getDataUI(A);return M?M._79o():N},drawData:function(q,r){var y=this.getDataUI(r);y&&(y._79o(),y._42(q)),r instanceof M.Block&&r.eachChild(function(j){this.drawData(q,j)},this)},getBoundsForGroup:function(Q){return Q.s(af)?this.getDataUIBounds(Q):N},rectIntersects:function(e,n){this.validate();var V=N;if(this._56I[e._id]){var v=this._25I[e._id];if(v){var l=v._79o();if(_l(n,l))V=!0;else if((n=_e(n,l))&&(v.rectIntersects&&(V=v.rectIntersects(n)),V==N)){if(!e.s("pixelPerfect"))return!0;var P=n.x,M=n.y,f=n.width,O=n.height,g=this._zoom,B=Q.hitMaxArea,D=f*O*g*g;if(D>B){var w=Math.sqrt(B/D);g*=w}f*=g,O*=g,2>f&&(f=2),2>O&&(O=2),P*=g,M*=g;var k=Zr(f,O);qo(k,-P,-M),k.scale(g,g),this._drawForChecking=!0,this.drawData(k,e),this._drawForChecking=!1;try{for(var x=0,q=k.getImageData(0,0,f,O).data;x<q.length;x+=4)if(0!==q[x+3]){V=!0;break}k.restore()}catch(a){Yb=N,V=!1}}}}return V?!0:!1},rectContains:function(y,V){if(this._56I[y._id]){var B=this._25I[y._id];if(B)return _l(V,B._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(U){if(!Q.isInput(U.target)){var k=this,J=k._focusData,v=J&&k._25I[J._id],d=0,n=k._dataModel._datas;if(!(J&&J._enabled&&J._editable&&v&&v.onKeyDown&&v.onKeyDown(U)===!0))if(9===U.keyCode&&(J&&(d=n.indexOf(J),of(U)?-1===--d&&(d=0):++d===n.size()&&(d=0)),k._focusData=J=n.get(d),k.sm().setSelection(J)),xd(U)?k.selectAll():Qr(U)&&k.isResettable()&&k.reset(),k.sm().isEmpty()){if(k._editing)return;var A=k.tx(),V=k.ty(),p=!1,t=of()?100:10;Pd(U)&&(A-=t,p=!0),_b(U)&&(V-=t,p=!0),bi(U)&&(A+=t,p=!0),Wo(U)&&(V+=t,p=!0),p&&k.setTranslate(A,V)}else{Mq(U)&&k.handleDelete(U);var w=of()?10:1;Pd(U)&&(k.moveSelection(-w,0),k.fi({kind:"moveLeft"})),_b(U)&&(k.moveSelection(0,-w),k.fi({kind:"moveUp"})),bi(U)&&(k.moveSelection(w,0),k.fi({kind:"moveRight"})),Wo(U)&&(k.moveSelection(0,w),k.fi({kind:"moveDown"}))}}},handleScroll:function(Y,b){zq(Y);var l=this.lp(Y);b>0?this.scrollZoomIn(l):0>b&&this.scrollZoomOut(l)},handlePinch:function(f,D,C){this._68I||(D>C?this.pinchZoomIn(f):this.pinchZoomOut(f))},checkDoubleClickOnNote:function(U,r){var d=this,f=d.lp(U),j=d.getDataUI(r),N=j.note2Info;return N&&r.s("note2.toggleable")&&Ah(N.clickRect,f)?(r.s(Og,!r.s(Og)),d.fi({kind:"toggleNote2",event:U,data:r}),!0):(N=j.noteInfo,N&&r.s("note.toggleable")&&Ah(N.clickRect,f)?(r.s(Ad,!r.s(Ad)),d.fi({kind:"toggleNote",event:U,data:r}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function($,W){var I=this,c=I.getAutoScrollZone(),_=c/I.getZoom(),x=c/4,B=I._29I,p=I.lp($),H={x:I.tx(),y:I.ty()};return p&&c>0&&B&&(p.x-B.x<_?I.translate(x,0):B.x+B.width-p.x<_&&I.translate(-x,0),p.y-B.y<_?I.translate(0,x):B.y+B.height-p.y<_&&I.translate(0,-x)),H.x=I.tx()-H.x,H.y=I.ty()-H.y,W&&(W.x+=H.x,W.y+=H.y),H
},getMoveMode:function(y,R){var K=R.s("2d.move.mode");return K?K:El["88"]?"x":El["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(h,_,q){var A=this;return"currentSubGraph"===_?{__i:h.getId()}:q.serializeProperty(h,_,A)},deserializeProperty:function(T,S,u){var b=this;if("currentSubGraph"===S){var g=b.dm(),O=g.__idMap;return O[T.__i]}return u.deserializeProperty(T,S,b)},setDefaultCursor:function(i,r){this._defaultCursor=i,r!==!1&&this.setCursor(i)},setCursor:function(l){"default"===l&&(l=this._defaultCursor||l);var D=this.getView().style;D.cursor=l,D.cursor="-webkit-"+l,D.cursor="-moz-"+l},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(F){return Q.getConnectAction(null,F)?(this._currentActionType=F,!0):!1},isInteractive:function(V){return V.s("interactive")}});var vo=function(S,u){var X=this;X.gv=S,X.s=function(S){return u.getStyle(S)},X._data=u,X._87I=new Ol};Gd(vo,J,{_6I:N,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var E=this,y=E.gv.isSelected(E._data);return!y||E.isShadowed()?0:E.gv.getSelectWidth(E._data)},getBodyColor:function(V){var f=this._data,U=this.gv.getBodyColor(f);return U?U:V?f.getStyle(V):N},_2Q:function(g){return this.s(g)},_1Q:function(J,c,L,i){var _=this.s,G=_(c+".dash.color");J.strokeStyle=G,J.lineWidth=L,J.stroke(),_(c+".dash.3d")&&Af(J,G,_(c+".dash.3d.color"),L,this.gv._zoom,_(c+".dash.3d.accuracy")),xm(J,i)},invalidate:function(){this._6I=N},_79o:function(){var E=this;if(!E._6I){var b=E._data,i=E.gv;E.labelInfo=E.label2Info=E.noteInfo=E.note2Info=E._38o=N,E._87I.clear(),E.interactiveInfo=i.isInteractive(b)?{}:N,E._3O(),E._55O=i.isEditable(b)?{_42O:i.isRectEditable(b),_43O:i.isPointEditable(b),_56O:i.isRotationEditable(b)}:N,E._6I=E._81o()}return E._6I},_3O:function(){},getPosition:function(){return be},_68o:function(n,$){n&&this._87I.add(Ip(n,$))},_81o:function(){var s=this,I=s.s;s._24O(Wi,"getLabel"),s._24O(Pn,"getLabel2"),s._26O(ub,"getNote"),s._26O(Uj,"getNote2"),s._15O(),s._55O&&s._48O();var Z;if(s._87I.each(function(Q){Z=fi(Z,Q)}),Z&&s.isShadowed()){var J=hg(Z);J.x+=I("shadow.offset.x"),J.y+=I("shadow.offset.y"),po(J,I("shadow.blur")),Z=fi(Z,J)}return s._87I.clear(),Z},_42:function(C){var v=this,g=v._data,A=v.gv,K=v.s,u=K("opacity"),O=this.isShadowed();if(O){var U=C.shadowOffsetX,$=C.shadowOffsetY,t=C.shadowBlur,h=C.shadowColor,c=A.getZoom();C.shadowOffsetX=K("shadow.offset.x")*c,C.shadowOffsetY=K("shadow.offset.y")*c,C.shadowBlur=K("shadow.blur")*c,C.shadowColor=K("select.color")}if(u!=N){var w=C.globalAlpha;C.globalAlpha=u}v._80o(C),A.isLabelVisible(g)&&((!A._drawForChecking||K("label.selectable"))&&_m(C,v.labelInfo),(!A._drawForChecking||K("label2.selectable"))&&_m(C,v.label2Info)),A.isNoteVisible(g)&&(hr(C,v.noteInfo),hr(C,v.note2Info)),v._99O(C),u!=N&&(C.globalAlpha=w),O&&(C.shadowOffsetX=U,C.shadowOffsetY=$,C.shadowBlur=t,C.shadowColor=h)},_80o:function(){},_47O:function(){},_24O:function(O,T){var _=this,q=_._data,l=_.gv,h=_.s,D=l[T](q);if(D!=N){var e=h(O+".scale"),k=h(O+".max"),d=h(O+".position"),K=_[O+"Info"]={label:D,scale:e,color:l[T+"Color"](q),font:h(O+".font"),opacity:h(O+".opacity"),align:h(O+".align"),rotation:_.getRotation(h(O+".rotation"),!1,d),background:l[T+"Background"](q)},n=Uc(K,D);k>0&&k<n.width&&(K.labelWidth=n.width,n.width=k),1!==e&&(n.width*=e,n.height*=e);var g=_.getPosition(d,h(O+".offset.x"),h(O+".offset.y"),n,h(O+".position.fixed"));if(n.x=g.x-n.width/2,n.y=g.y-n.height/2,_._68o(K.rect=n,K.rotation),1!==e){var p=n.width/e,Q=n.height/e;K.rect={x:g.x-p/2,y:g.y-Q/2,width:p,height:Q}}}},_26O:function(s,j){var o=this,Y=o.gv,J=o._data,C=o.s,T=Y[j](J);if(T!=N){var n,c,l=C(s+".scale"),k=o[s+"Info"]={note:T,scale:l,data:J,view:Y,expanded:C(s+".expanded"),font:C(s+".font"),color:C(s+".color"),opacity:C(s+".opacity"),align:C(s+".align"),icon:C(s+".icon"),backgroundImage:C(s+".backgroundImage"),borderWidth:C(s+".border.width"),borderColor:C(s+".border.color"),background:Y[j+"Background"](J)},y=o.getPosition(C(s+".position"),C(s+".offset.x"),C(s+".offset.y")),M=y.x,W=y.y;if(k.expanded){var v,t=C(s+".max"),z=C(s+".backgroundImage");z?(z=cd(z),v={width:pg(z,J),height:gh(z,J)}):v=Uc(k,T),v.width+=6,v.height+=2,t>0&&t<v.width&&(k.labelWidth=v.width,v.width=t),n=v.width,c=v.height+8,k.clickRect={x:M-n*l/2,y:W-c*l,width:n*l,height:c*l*v.height/c}}else{var q=C(s+".icon");q?(q=cd(q),n=pg(q,J),c=gh(q,J)):(n=12,c=18),k.clickRect={x:M-n*l/2,y:W-c*l,width:n*l,height:c*l}}k.rect={x:M-n/2,y:W-c*l/2-c/2,width:n,height:c};var f=U(k.borderWidth/2)*l;o._68o({x:M-n*l/2-f,y:W-c*l-f,width:n*l+2*f,height:c*l+2*f})}},_48O:function(){},_99O:function(F){var Z=this,u=Z._38o;if(u){var C=Z.gv,Q=Z._data,M=u.icons,j=Z.interactiveInfo;j&&(j._38o={});for(var O in M){var g=M[O],e=u.rects[O];if(e){j&&(j._38o[O]=[]);var h=Hr(g.opacity,Q,C),s=Hr(g.names,Q,C),b=s?s.length:0,z=e.rotation;if(h!=N){var m=F.globalAlpha;F.globalAlpha*=h}for(var R=0;b>R;R++){var S=s[R],H=cd(S),r=e[R];if(z){var v=r.x+r.width/2,t=r.y+r.height/2;F.save(),qo(F,v,t),Gm(F,z),qo(F,-v,-t)}j&&j._38o[O].push(F.interactiveInfo={compInfos:[],stacks:z?[{t:[v,t]},{r:z},{t:[-v,-t]}]:[]}),Nq(F,H,Hr(g.stretch,Q,C),r.x,r.y,r.width,r.height,Z._data,Z.gv),F.interactiveInfo=N,z&&F.restore()}h!=N&&(F.globalAlpha=m)}}}}});var df=function(z,d){Ho(df,this,[z,d])};Gd(df,vo,{_checkEmptyRect:!0,_40O:function(n,L){var m=this,D=m.s,w=n.rect;(n.borderColor=m.gv.getBorderColor(m._data))&&(n.borderType=D("border.type"),n.borderWidth=D("border.width"),n.borderPadding=D("border.padding"),L=t(L,n.borderPadding+n.borderWidth/2));var B=m._data.getScale(),Z=t(1,t(A(B.x),A(B.y)));if(n.selectWidth=m.getSelectWidth()){var Y=m.gv._zoom;n.selectType=D("select.type"),n._97o=D("select.color"),n.selectPadding=D("select.padding"),L=t(L,(n.selectPadding+n.selectWidth/2/Y)/Z)}L>0&&(L*=Z,w=hg(w),po(w,L)),m._68o(w)},_39O:function(h,j){var w,z=this,C=j.rect;if(j.borderWidth>0&&(w=j.borderPadding,h.strokeStyle=j.borderColor,h.lineWidth=j.borderWidth,Xn(h,j.borderType,{x:C.x-w,y:C.y-w,width:C.width+2*w,height:C.height+2*w}),h.stroke()),j.selectWidth>0){var K=z.gv._zoom;if(w=j.selectPadding,h.strokeStyle=j._97o,h.lineWidth=j.selectWidth/K,j.rotation!=N){h.save(),h.translate(j.position.x,j.position.y),h.rotate(j.rotation);var c=z._data,T=c.getWidth(),O=c.getHeight(),g=j.scale,o=j.anchor;C={x:g.x*-T*o.x,y:g.y*-O*o.y,width:g.x*T,height:g.y*O}}Xn(h,j.selectType,{x:C.x-w,y:C.y-w,width:C.width+2*w,height:C.height+2*w}),j.rotation!=N&&h.restore(),h.stroke()}},_3O:function(){var D=this,z=D.s,v=D._data,f=v.getStyle(gn),F=D.getBodyColor(),j=D._83o=f?{shape:f,_53o:D.getBodyColor("shape.background"),_27Q:cd(z("shape.repeat.image"),F),shapeGradientPack:z("shape.gradient.pack"),_54o:z("shape.border.width"),_55o:z("shape.border.color"),_56o:z("shape.border.3d"),_57o:z("shape.border.3d.color"),_58o:z("shape.border.3d.accuracy"),shapeGradient:z("shape.gradient"),_59o:z("shape.gradient.color"),_60o:z("shape.border.pattern"),_61o:z("shape.border.cap"),_62o:z("shape.border.join"),bodyColor:F}:{img:cd(D.gv.getImage(v),F),bodyColor:F,stretch:z("image.stretch")};if(p&&!l);else{j.rect=v.getRect(),j.position=v.p(),j.scale=v.getScale(),j.anchor=v.getAnchor(),j.rotation=v.getRotation(),f===cb&&(j._63o=z("shape.depth"));var w=0;if(f)w=bs(N,j._54o/2,j._62o),D.s("shape.dash")&&(w=t(w,(D.s("shape.dash.width")||j._54o)/2));else if(j.img&&j.img.boundExtend)if(w=Hr(j.img.boundExtend,v,D.gv),j.img.boundExtendAbsolute){var W=v.getScale();w/=D.gv._zoom*t(1,t(A(W.x),A(W.y)))}else if(!Hr(j.img.fitSize,v,D.gv)){var Y=Hr(j.img.width,v,D.gv),n=Hr(j.img.height,v,D.gv);w*=t(v.getWidth()/Y,v.getHeight()/n)}D._40O(j,w);var Q=z("clip.percentage");if(1>Q&&(0>Q&&(Q=0),j.clipRect=Sp(v.getAnchorRect(),z("clip.direction"),Q)),f){var y=z("shape.fill.clip.percentage");1>y&&(0>y&&(y=0),j.shapeClipRect=Sp(v.getAnchorRect(),z("shape.fill.clip.direction"),y))}}},getPosition:function(L,G,Z,k){var F=Dg(L,this._83o.rect,k);return F.x+=G,F.y+=Z,F},_80o:function(Y){var K=this,l=K.s,g=K.gv,Z=K._data,$=K._83o,q=$.rect,o=$.position,U=$.rotation,G=$.anchor,Q=$.scale,r=$.shape,J=$.clipRect;if(!K._checkEmptyRect||q.width>0&&q.height>0){var V=Z.getSize();if(V.x=-V.width*G.x,V.y=-V.height*G.y,Y.save(),qo(Y,o.x,o.y),Gm(Y,U),Eh(Y,Q.x,Q.y),J&&(Y.beginPath(),Y.rect(J.x,J.y,J.width,J.height),Y.clip()),K.freeDraw)K.freeDraw(Y,V,$);else if(r){var f,m,F,c,h=$._60o,z=Nj(Y,h),O=$._53o,s=$._27Q,e=$._54o,H=$._55o,w=$.shapeGradientPack,v=Y.lineJoin,S=Y.lineCap;if("roundRect"===r?f=l("shape.corner.radius"):"polygon"===r?f=l("shape.polygon.side"):"arc"===r&&(f=l("shape.arc.from"),m=l("shape.arc.to"),F=l("shape.arc.close"),c=l("shape.arc.oval")),Y.lineJoin=$._62o,Y.lineCap=$._61o,O||s||w){var X=$.shapeClipRect;X&&(Y.save(),Y.beginPath(),Y.rect(X.x,X.y,X.width,X.height),Y.clip()),Xn(Y,r,V,f,m,F,c),w?zb(Y,w):s?qn(Y,s,$.bodyColor,null,Z,g):ik(Y,O,$.shapeGradient,$._59o,V),Y.fill(),X&&Y.restore(),w&&Y.restore(),Y!==z&&Xn(z,r,V,f,m,F,c)}else Xn(z,r,V,f,m,F,c);if(e>0){var I=l("shape.border.width.absolute");I&&(Y.save(),Y.setTransform(1,0,0,1,0,0)),Y.lineWidth=e,Y.strokeStyle=H,Y.stroke(),I&&Y.restore(),$._56o&&Af(Y,H,$._57o,e,g._zoom,$._58o)}if(xm(Y,h),l("shape.dash")){var k=l("shape.dash.width")||e;if(k>0){h=l("shape.dash.pattern");var z=Nj(Y,h,K._2Q("shape.dash.offset"));z!==Y&&Xn(z,r,V,f,m,F,c),K._1Q(Y,"shape",k,h)}}Of(Y,O,$._63o,V),Y.lineJoin=v,Y.lineCap=S}else{var R=K.interactiveInfo;R&&(Y.interactiveInfo=R.bodyInfo={compInfos:[],stacks:[{t:[o.x,o.y]},{r:U},{s:[Q.x,Q.y]}]}),Nq(Y,$.img,$.stretch,V.x,V.y,V.width,V.height,Z,g,$.bodyColor),Y.interactiveInfo=N}Y.restore()}K._39O(Y,$)},_48O:function(){},_47O:function(){}});var ms=function(h,z){Ho(ms,this,[h,z])},Up=function(Z,R,m,r){var u=uk(Z,R);return m=r?O(m,u):Hp(m,u),u?m/=u:m=0,{x:Z.x+(R.x-Z.x)*m,y:Z.y+(R.y-Z.y)*m}};Gd(ms,vo,{_3O:function(){var v,Z=this,n=Z._data,h=Z.gv,z=Z.s,V=z(Zk),f=n.isLooped(),C=z("edge.width"),T=z("edge.center"),S=z("edge.offset"),$=h.getBorderColor(n),c=$?z("border.width"):0,i=Z.getSelectWidth(),l=n._40I,w=n._41I,A=Z._78o=l&&w?{looped:f,type:V,width:C,center:T,color:Z.getBodyColor("edge.color"),borderColor:$,borderWidth:c,_97o:i?z("select.color"):N,selectWidth:i,pattern:z("edge.pattern"),cap:z("edge.cap"),join:z("edge.join"),is3d:z("edge.3d"),_67o:z("edge.3d.color"),_66o:z("edge.3d.accuracy")}:N;if(A){var X=Q.getEdgeType(V);if(X){var b=X(n,zo(Z,h,n,f,V),h,Z._19Q);b.points&&b.points.size()>1?(A.edgeTypeInfo=b,v=re(A.edgeTypeInfo.points)):b[Yi]&&b.rect&&(A.edgeTypeInfo=b,v=b.rect)}else{var P=z("edge.source.anchor.x"),y=z("edge.source.anchor.y"),J=z("edge.target.anchor.x"),r=z("edge.target.anchor.y"),I=xo(h,l,z("edge.source.position"),z("edge.source.offset.x"),z("edge.source.offset.y"),P,y),U=xo(h,w,z("edge.target.position"),z("edge.target.offset.x"),z("edge.target.offset.y"),J,r);if(V===Sb){var s=A.points=z(sq)||np,F=s.size();A.segments=z("edge.segments");var e=P!==d||y!==d,u=J!==d||r!==d;if(!T)if(S)e||(I=Up(I,F?s.get(0):U,S,F)),u||(U=Up(U,F?s.get(F-1):I,S,F));else{var E;e||(E=wl(I,F?s.get(0):U,Wp(h,l)),E&&(I={x:E[0],y:E[1]})),u||(E=wl(F?s.get(F-1):I,U,Wp(h,w)),E&&(U={x:E[0],y:E[1]}))}v=fi(re(A.points),re(I,U))}else{var k=zo(Z,h,n,f,V);if(Z._19Q||(k=-k),f)I=hg(I),I.x=h.getNodeRect(l).x,A.radius=k,v={x:I.x-k,y:I.y-k,width:2*k,height:2*k};else{var _=uk(I,U),K=Hp(S,_),p={x:K,y:k},x={x:_-K,y:k},m=D(U.y-I.y,U.x-I.x),G=A.mat=new Yp(m);if(A.orienAngle=m,A.angle=U.x<I.x?m+H:m,A.rect={x:p.x,y:p.y,width:x.x-p.x,height:0},A.origin=I,p=G.tf(p),p.x+=I.x,p.y+=I.y,x=G.tf(x),x.x+=I.x,x.y+=I.y,T){var M={x:_,y:0};M=G.tf(M),M.x+=I.x,M.y+=I.y,v=re([I,p,x,M]),A.c1=I,A.c2=M}else v=re(p,x);I=p,U=x}}A.sourcePoint=I,A.targetPoint=U,n._lastSourcePoint=I,n._lastTargetPoint=U}var j=0;z("edge.dash")&&(j=z("edge.dash.width")||C);var o="square"===A.cap?.71:.5;bs(v,t(j*o,C*o+c+i),A.join),Z._68o(v)}},getRotation:function(g,X,Y){g=g||0;var F=this._78o;if(F){var p,e=F.angle,Z=F.points,r=F.edgeTypeInfo;if(e!=N)return X?F.orienAngle+g:e+g;if(r&&r[Yi])return r.getRotation?r.getRotation(this,g,X,Y):0;if(r&&r.points){var D=r.points;return p=D.size(),$f[Y]?p&&0===p%2?xe(D.get(p/2-1),D.get(p/2),X,g):g:ap[Y]?xe(D.get(0),D.get(1),X,g):xe(D.get(p-2),D.get(p-1),X,g)}if(Z)return p=Z.size(),$f[Y]?p&&0===p%2?xe(Z.get(p/2-1),Z.get(p/2),X,g):g:ap[Y]?xe(F.sourcePoint,p?Z.get(0):F.targetPoint,X,g):xe(p?Z.get(p-1):F.sourcePoint,F.targetPoint,X,g)}return g},getPosition:function(a,v,l,o,_){var R=this._78o;if(R){var r,H=R.type,p=R.points,J=R.edgeTypeInfo,k=R.sourcePoint,O=R.targetPoint;if(!H)return R.looped?{x:k.x-R.radius+v,y:k.y+l}:(_&&k&&O&&(k.x>O.x||k.x===O.x&&k.y>O.y)&&(a=ei[a],l=-l),r=Dg(a,R.rect,o),r.x+=v,r.y+=l,r=R.mat.tf(r),r.x+=R.origin.x,r.y+=R.origin.y,r);if(J&&J[Yi])return J.getPosition?J.getPosition(this,a,v,l,o,_):{x:(k.x+O.x)/2,y:(k.y+O.y)/2};if(p){var r,T=p.size();if($f[a]){if(T){var t=T%2;if(0===t)return iq(p.get(T/2-1),p.get(T/2),a,v,l,o,_);r=p.get((T-t)/2)}else r={x:(k.x+O.x)/2,y:(k.y+O.y)/2};return r=Dg(a,{x:r.x,y:r.y,width:0,height:0},o),r.x+=v,r.y+=l,r}return ap[a]?iq(k,T?p.get(0):O,a,v,l,o,_):iq(T?p.get(T-1):k,O,a,v,l,o,_)}if(J){var Z=J.points,T=Z.size();if($f[a]){var t=T%2;return 0===t?iq(Z.get(T/2-1),Z.get(T/2),a,v,l,o,_):(r=Z.get((T-t)/2),r=Dg(a,{x:r.x,y:r.y,width:0,height:0},o),r.x+=v,r.y+=l,r)}return ap[a]?iq(Z.get(0),Z.get(1),a,v,l,o,_):iq(Z.get(T-2),Z.get(T-1),a,v,l,o,_)}}return be},_42:function(U){this._78o&&ms.superClass._42.call(this,U)},drawPath:function(z,n){z.beginPath();var R=n.type,d=n.points,t=n.segments,c=n.edgeTypeInfo;if(!R||d){var Y=n.sourcePoint,u=Y.x,s=Y.y,h=n.targetPoint,M=h.x,e=h.y;if(R)if(t){var N=new Ol({x:u,y:s});N.addAll(d),N.add({x:M,y:e}),zj(z,N,t)}else z.moveTo(u,s),d.each(function(k){z.lineTo(k.x,k.y)}),z.lineTo(M,e);else n.looped?z.arc(u,s,n.radius,0,q,!0):n.center?(z.moveTo(n.c1.x,n.c1.y),z.lineTo(u,s),z.lineTo(M,e),z.lineTo(n.c2.x,n.c2.y)):(z.moveTo(u,s),z.lineTo(M,e))}else c&&(c.points?zj(z,c.points,c.segments):c[Yi]&&c[Yi](z,c))},_80o:function(t){var v=this,C=v.s,Z=v._78o,$=Z.width,I=Z.selectWidth,m=Z.borderWidth,N=Z.color,d=t.lineJoin,l=t.lineCap,b=Z.pattern;t.lineJoin=Z.join,t.lineCap=Z.cap,v.drawPath(Nj(t,b),Z);var Y=C("edge.width.absolute");if(Y&&(t.save(),t.setTransform(1,0,0,1,0,0)),I&&(t.strokeStyle=Z._97o,t.lineWidth=$+2*(m+I),t.stroke()),m&&(t.strokeStyle=Z.borderColor,t.lineWidth=$+2*m,t.stroke()),t.strokeStyle=N,t.lineWidth=$,t.stroke(),Z.is3d&&Af(t,N,Z._67o,$,v.gv._zoom,Z._66o),Y&&t.restore(),xm(t,b),C("edge.dash")){b=C("edge.dash.pattern");var M=Nj(t,b,v._2Q("edge.dash.offset"));M!==t&&v.drawPath(M,Z),v._1Q(t,"edge",C("edge.dash.width")||$,b)}t.lineJoin=d,t.lineCap=l},_48O:function(){},_47O:function(){},_71o:function(w,W){var t=this,s=t._data;if(t._19Q=!0,!s.getEdgeGroup())return w?s.s("edge.gap"):0;var x,u=0,C=0,e=0;if(s.getEdgeGroup().getSiblings().each(function(l){l.each(function(p){if(t.gv.isVisible(p)&&p.s(Zk)==W){var k=p.s("edge.gap");x?(C+=e/2+k/2,e=k):(x=p,e=k),p===s&&(u=C)}})}),w)return C-u+e;var L=u-C/2;return x&&s._40I!==x._40I&&(t._19Q=!1),L}});var _q=function(S,R){Ho(_q,this,[S,R])};Gd(_q,df,{_3O:function(){var V,n,W=this,u=W.s,Y=W._data,X=W.gv;if(W._88I=N,Y.isExpanded()&&Y.eachChild(function(g){var b=X.getBoundsForGroup(g);b&&(n||(n=[]),n.push(b),V=fi(V,b))}),V){var S=X.getLabel(Y),R=u("group.type");V=Xl(R,n,V),ok(V,Y,"group.padding",1);var j=W._88I={type:R,rect:V,_64o:V};if(!R&&S!=N){var $,I=W.labelInfo={label:S,color:u("group.title.color"),font:u("group.title.font"),align:u("group.title.align")},p=Uc(I,S),Q=p.width,O=p.height,d=u("group.title.align");Q>V.width&&(V.width=Q),I.rect={y:V.y-O,width:p.width,height:O},$=d===kj?V.x:d===Lj?V.x+V.width-Q:V.x+V.width/2-Q/2,I.rect.x=$,j.titleRect={x:V.x,y:V.y-O,width:V.width,height:O+1},j.rect={x:V.x,y:V.y-O,width:V.width,height:V.height+O}}W._40O(j,u("group.border.width")/2)}else _q.superClass._3O.call(W)},getPosition:function(R,J,Z,w){var m=this._88I;if(m){var p=Dg(R,m.rect,w);return p.x+=J,p.y+=Z,p}return _q.superClass.getPosition.apply(this,arguments)},_24O:function(Z,N){var l=this._88I;(!l||l.type||"label2"===Z)&&_q.superClass._24O.call(this,Z,N)},_80o:function(l){var J=this,Y=J._88I;if(Y){var M=J._data,T=J.s,Z=J.gv,u=Y.type,O=Y.rect,h=Y._64o,G=Y.titleRect,Q=J.getBodyColor(),L=cd(T("group.image"),Q),f=T("group.image.stretch"),t=J.getBodyColor("group.background"),d=cd(T("group.repeat.image"),Q),n=T("group.gradient.pack"),I=T("group.gradient"),k=T("group.gradient.color"),e=T("group.depth");if(u){var c=T("group.border.pattern"),x=T("group.border.width"),$=l.lineJoin,b=l.lineCap;if(l.lineJoin=T("group.border.join"),l.lineCap=T("group.border.cap"),L){if(l.save(),Xn(l,u,O),l.clip(),Nq(l,L,f,O.x,O.y,O.width,O.height,M,Z,Q),l.restore(),x>0){var w=Nj(l,c);Xn(w,u,O),l.lineWidth=x,l.strokeStyle=T("group.border.color"),l.stroke(),xm(l,c)}}else{var w=Nj(l,c);t||d||n?(Xn(l,u,O),n?zb(l,n):d?qn(l,d,Q,null,M,Z):ik(l,t,I,k,O),l.fill(),n&&l.restore(),l!==w&&Xn(w,u,O)):Xn(w,u,O),x>0&&(l.lineWidth=x,l.strokeStyle=T("group.border.color"),l.stroke()),xm(l,c),u===cb&&Of(l,t,e,O)}l.lineJoin=$,l.lineCap=b}else if(L?Nq(l,L,f,h.x,h.y,h.width,h.height,M,Z,J.getBodyColor()):(t||d)&&(d?qn(l,d,Q,null,M,Z):ik(l,t,I,k,h),Xn(l,cb,h),l.fill(),Of(l,t,e,h)),G){var z=T("group.title.background");zs(l,G.x,G.y,G.width,G.height,z),Of(l,z,e,G)}J._39O(l,Y)}else _q.superClass._80o.call(J,l)}});var rj=function(I,R){Ho(rj,this,[I,R])};Gd(rj,df,{_80o:function(F){this._39O(F,this._83o)}});var je=function(Q,C){Ho(je,this,[Q,C])};Gd(je,df,{_3O:function(){var r=this,P=r._data,x=r.s,B=r.gv,g=P.getPoints(),$=B.getBorderColor(P),m=$?x("border.width"):0,M=r.getSelectWidth(),R=x("shape.border.width"),S=P.getRect(),V=B.getBodyColor(P),h=r._99o=g.isEmpty()?N:{rect:S,rotation:P.getRotation(),fillRule:x("shape.fill.rule"),scale:P.getScale(),position:P.p(),points:g,segments:P.getSegments(),bodyColor:V,borderColor:$,borderWidth:m,_94o:x("shape.border.3d"),_95o:x("shape.border.3d.color"),_96o:x("shape.border.3d.accuracy"),_97o:M?x("select.color"):N,selectWidth:M,_53o:x("shape.background"),_27Q:cd(x("shape.repeat.image"),V),shapeGradientPack:x("shape.gradient.pack"),_54o:R,_55o:x("shape.border.color"),shapeGradient:x("shape.gradient"),_59o:x("shape.gradient.color"),_60o:x("shape.border.pattern"),_61o:x("shape.border.cap"),_62o:x("shape.border.join")};if(h){var b=P.getScale(),H=t(1,t(A(b.x),A(b.y)));x("shape.dash")&&x("shape.dash.width")>R&&(R=x("shape.dash.width"));var U=R*("square"===h._61o?.71:.5)+m+M/r.gv._zoom/H;U&&(U*=H,S=hg(S),bs(S,U,h._62o)),r._68o(S);var k=x("clip.percentage");1>k&&(0>k&&(k=0),h.clipRect=Sp(P.getAnchorRect(),x("clip.direction"),k));var f=x("shape.fill.clip.percentage");1>f&&(0>f&&(f=0),h.shapeClipRect=Sp(P.getAnchorRect(),x("shape.fill.clip.direction"),f))}},getPosition:function(Z,O,E,M){var r=this._99o;if(r){var w=Dg(Z,r.rect,M);return w.x+=O,w.y+=E,w}return be},_42:function(o){this._99o&&je.superClass._42.call(this,o)},_80o:function(S){var G,L=this,T=L.s,d=L._99o,P=d.position,F=d.scale,H=d.rotation,r=d.bodyColor,q=d.borderWidth,w=d.selectWidth,t=d._53o,E=d._27Q,B=d.shapeGradientPack,e=d._54o,C=d.clipRect,J=d.shapeClipRect,k=d.points,n=d.segments,g=L._data.isClosePath(),i=d.fillRule,o=t||E||B;S.save(),qo(S,P.x,P.y),Gm(S,H),Eh(S,F.x,F.y),C&&(S.beginPath(),S.rect(C.x,C.y,C.width,C.height),S.clip()),o&&J&&(S.save(),S.beginPath(),S.rect(J.x,J.y,J.width,J.height),S.clip()),qo(S,-P.x,-P.y);var W=d._60o,M=Nj(S,W),l=S.lineJoin,U=S.lineCap;S.lineJoin=d._62o,S.lineCap=d._61o,o?(zj(S,k,n,g),B?zb(S,B):E?qn(S,E,r,null,L._data,L.gv):(G=r?r:t,ik(S,G,d.shapeGradient,d._59o,d.rect)),S.fill(i),J&&(S.restore(),qo(S,-P.x,-P.y)),B&&S.restore(),M!==S&&zj(M,k,n,g)):zj(M,k,n,g);var f=T("shape.border.width.absolute");if(f&&(S.save(),S.setTransform(1,0,0,1,0,0)),w&&(S.strokeStyle=d._97o,S.lineWidth=e+2*(q+w),S.stroke()),q&&(S.strokeStyle=d.borderColor,S.lineWidth=e+2*q,S.stroke()),e&&(G=d._55o,!t&&r&&(G=r),S.strokeStyle=G,S.lineWidth=e,S.stroke(),d._94o&&Af(S,G,d._95o,e,L.gv._zoom,d._96o)),f&&S.restore(),xm(S,W),T("shape.dash")){var Y=T("shape.dash.width")||e;if(Y>0){W=T("shape.dash.pattern");var M=Nj(S,W,L._2Q("shape.dash.offset"));M!==S&&zj(M,k,n,g),L._1Q(S,"shape",Y,W)}}S.lineJoin=l,S.lineCap=U,S.restore()},_48O:function(){},_47O:function(){}});var oe=function(h,w){Ho(oe,this,[h,w])};Gd(oe,je,{getRotation:function(q,w,f){q=q||0;var k=this._data.getPoints(),m=k.size();return m>1?$f[f]?m&&0===m%2?xe(k.get(m/2-1),k.get(m/2),w,q):q:ap[f]?xe(k.get(0),k.get(1),w,q):xe(k.get(m-2),k.get(m-1),w,q):q},getPosition:function(X,V,l,b,R){var f=this._data.getPoints(),k=f.size();if(k>1){if($f[X]){var p=k%2;if(0===p)return iq(f.get(k/2-1),f.get(k/2),X,V,l,b,R);var G=f.get((k-p)/2),H={x:G.x,y:G.y,width:0,height:0};return G=Dg(X,H,b),G.x+=V,G.y+=l,G}return ap[X]?iq(f.get(0),f.get(1),X,V,l,b,R):iq(f.get(k-2),f.get(k-1),X,V,l,b,R)}return be}});var Zj=function(i,_){Ho(Zj,this,[i,_])};Gd(Zj,df,{_3O:function(){var b=this;Zj.superClass._3O.call(b);var z=b.s,T=b._83o;b._82o=T.img||T.shape?N:{background:b.getBodyColor("grid.background"),depth:z("grid.depth"),rect:T.rect,_88o:z("grid.cell.depth"),cellBorderColor:z("grid.cell.border.color"),_89o:z("grid.row.count"),_90o:z("grid.column.count"),block:z("grid.block"),_91o:z("grid.block.color"),_92o:z("grid.block.padding"),_93o:z("grid.block.width")}},_80o:function(x){var V=this,p=V._82o;if(!p)return Zj.superClass._80o.call(V,x),void 0;var I,l,z=V._data,c=p.background,U=p.rect,Y=p.block,h=p._91o,D=p._92o,m=p._93o,R=p._88o,K=p.cellBorderColor,Z=p._89o,B=p._90o;if(c)if(zs(x,U.x,U.y,U.width,U.height,c),Of(x,c,p.depth,U),R)for(I=0;Z>I;I++)for(l=0;B>l;l++)U=z.getCellRect(I,l),U&&Of(x,c,R,U);else if(K){for(x.beginPath(),I=0;Z>I;I++)for(l=0;B>l;l++)U=z.getCellRect(I,l),U&&x.rect(U.x,U.y,U.width,U.height);x.strokeStyle=K,x.lineWidth=1,x.stroke()}if("h"===Y)for(I=0;Z>I;I++)U=fi(z.getCellRect(I,0),z.getCellRect(I,B-1)),po(U,D),Qk(x,h,U.x,U.y,U.width,U.height,m);else if("v"===Y)for(l=0;B>l;l++)U=fi(z.getCellRect(0,l),z.getCellRect(Z-1,l)),po(U,D),Qk(x,h,U.x,U.y,U.width,U.height,m);V._39O(x,V._83o)}});var Pc=function($,m){Ho(Pc,this,[$,m])};Gd(Pc,df,{_checkEmptyRect:!1,_81o:function(){var P=this._data,y=Pc.superClass._81o.call(this),l=P.s("text");if(l!=N){var A,h,r=P.s("text.font"),O=P.s("text.align"),z=P.s("text.vAlign"),C=sl(r,l),e=C.width,i=C.height,k=P.getAnchor(),Y=P.getWidth(),_=P.getHeight();"left"===O?A=-Y*k.x:"center"===O?A=-Y*k.x+(Y-e)/2:"right"===O&&(A=Y*(1-k.x)-C.width),"top"===z?h=-_*k.y:"middle"===z?h=-_*k.y+(_-i)/2:"bottom"===z&&(h=_*(1-k.y)-C.height);var F,M=P.getMatrix();if(F=re([M.tf(A,h),M.tf(A+e,h),M.tf(A+e,h+i),M.tf(A,h+i)]),y=fi(y,F),y&&P.s("text.shadow")){var E=hg(y);E.x+=P.s("text.shadow.offset.x"),E.y+=P.s("text.shadow.offset.y"),po(E,P.s("text.shadow.blur")),y=fi(y,E)}}return y}});var Cd=Bd.Interactor=function(i){this.gv=this._graphView=i};Kd("Interactor",J,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(F){this.gv.fi(F)},setCursor:function(r){Bq||this.gv.setCursor(r)},startDragging:function(O){var U=this;U._lastClientPoint=zc(O),U._lastLogicalPoint=U.gv.lp(O),ds(U,O)},clearDragging:function(){var z=this;z._lastClientPoint=z._lastLogicalPoint=z._logicalPoint=N},autoScroll:function(r){return this.gv.autoScroll(r,this._lastClientPoint)}});var Ee=function(e){var B=this;B.gv=e,B.filter=function(h){return e.isSelectable(h)&&e.isInteractive(h)},e.getView(),["mousedown","mousemove","touchstart","touchmove"].forEach(function(D){B.addListener(D)}),X.addEventListener(Ei,function($){Fq($)&&B.handleWindowMove($)},!1),X.addEventListener(mp,function(T){Fq(T)&&B.handleWindowUp(T)},!1),X.addEventListener(qj,function(p){Fq(p)&&B.handleWindowMove(p)},!1),X.addEventListener(Fe,function(O){Fq(O)&&B.handleWindowUp(O)},!1)};Gd(Ee,Cd,{addListener:function($){var M=this;M.gv.getView().addEventListener($,function(A){Q.preventDefault(A),Fq(A)&&!M.disabled&&M["handle_"+$](A)},!1)},handle:function(p,w,E){var t=this.gv;if(E=E||t.getDataInfoAt(w,this.filter)){var W=E.ui.interactiveInfo;if(W){var f,H=E.data;if(H.s(p)&&H.s(p)(w,H,t),"body"===E.part&&W.bodyInfo)f="body",E.hits=this.handleImage(f,t.getImage(H),p,w,H,E.point,W.bodyInfo);else if("icons"===E.part&&W._38o){var S=W._38o[E.name];S&&S[E.index]&&(f="icons|"+E.name+"|"+E.index,E.hits=this.handleImage(f,E.icon,p,w,H,E.point,S[E.index]))}}return E}},handleImage:function(j,p,w,k,z,l,c){var q={};if(p&&(p=cd(p))){var d=this.gv,t=c.rect,H=this.convertPoint(l,c);H.inRect&&(p[w]&&p[w](k,z,d,H,t.width,t.height),q[j+"|image"]={target:p,point:H,width:t.width,height:t.height});for(var I=c.compInfos,O=I.length-1;O>=0;O--){var y=I[O],N=y.comp;H=this.convertPoint(l,y),H.inRect&&(t=y.rect,N[w]&&N[w](k,z,d,H,t.width,t.height),(p=t.image)&&p[w]&&p[w](k,z,d,H,t.width,t.height),q[j+"|"+O]={target:N,point:H,width:t.width,height:t.height},p&&(q[j+"|"+O+"|image"]={target:p,point:H,width:t.width,height:t.height}))}}return q},handle_mousedown:function(L){this.isDragging&&(this.handleDownInfo("onEndDrag",L),this.isDragging=!1),this.downInfo=this.handle("onDown",L)},handle_mousemove:function(V){var T=this,D=T.gv;T._hoverTimer&&(f(T._hoverTimer),delete T._hoverTimer);var w,S,U,O=T.handle("onMove",V),h=this.currentInfo?this.currentInfo.data:N,o=this.currentInfo?this.currentInfo.hits:N;if(O&&(S=O.data,U=O.hits,T._hoverTimer=b(function(){f(T._hoverTimer),delete T._hoverTimer,T.handle("onHover",V,O)},D.getHoverDelay()||Q.hoverDelay)),S!==h){if(S&&S.s("onEnter")&&S.s("onEnter")(V,S,D),h&&h.s("onLeave")&&h.s("onLeave")(V,h,D),o)for(w in o)o[w].target.onLeave&&this.handleLeave(V,w);if(U)for(w in U)U[w].target.onEnter&&U[w].target.onEnter(V,S,D,U[w].point,U[w].width,U[w].height)}else{if(o)for(w in o)U&&U[w]||o[w].target.onLeave&&this.handleLeave(V,w);if(U)for(w in U)o&&o[w]||U[w].target.onEnter&&U[w].target.onEnter(V,S,D,U[w].point,U[w].width,U[w].height)}this.currentInfo=O},handleLeave:function(X,n){if(this.currentInfo){var D=this.currentInfo,a=D.ui.interactiveInfo;if(a){var v,m=this.gv.lp(X),F=D.data;if("body"===D.part&&a.bodyInfo)v="body",this.handleLeaveImage(n,v,this.gv.getImage(F),X,F,m,a.bodyInfo);else if("icons"===D.part&&a._38o){var B=a._38o[D.name];B&&B[D.index]&&(v="icons|"+D.name+"|"+D.index,this.handleLeaveImage(n,v,D.icon,X,F,m,B[D.index]))}}}},handleLeaveImage:function(s,Q,j,I,O,$,R){if(j&&(j=cd(j))){var Z=this.gv,w=R.rect,m=this.convertPoint($,R);s===Q+"|image"&&j.onLeave&&j.onLeave(I,O,Z,m,w.width,w.height);for(var g=R.compInfos,o=g.length-1;o>=0;o--){var D=g[o],S=D.comp;m=this.convertPoint($,D),w=D.rect,S.onLeave&&s===Q+"|"+o&&S.onLeave(I,O,Z,m,w.width,w.height),(j=w.image)&&j.onLeave&&s===Q+"|"+o+"|image"&&j.onLeave(I,O,Z,m,w.width,w.height)}}},handleMissingUp:function(l){var I=this.downInfo;if(I){var B=I.ui.interactiveInfo;if(B){var O,S=this.gv.lp(l),F=I.data;if("body"===I.part&&B.bodyInfo)O="body",this.handleMissingUpImage(O,this.gv.getImage(F),l,F,S,B.bodyInfo);else if("icons"===I.part&&B._38o){var c=B._38o[I.name];c&&c[I.index]&&(O="icons|"+I.name+"|"+I.index,this.handleMissingUpImage(O,I.icon,l,F,S,c[I.index]))}}}},handleMissingUpImage:function(H,k,C,h,Q,q){var W="onUp",l=this.downInfo.hits;if(l&&k&&(k=cd(k))){var s=q.rect,m=this.convertPoint(Q,q);!m.inRect&&l[H+"|image"]&&k[W]&&k[W](C,h,this.gv,m,s.width,s.height);for(var V=q.compInfos,Y=V.length-1;Y>=0;Y--){var d=V[Y],i=d.comp;m=this.convertPoint(Q,d),m.inRect||(s=d.rect,i[W]&&l[H+"|"+Y]&&i[W](C,h,this.gv,m,s.width,s.height),(k=s.image)&&k[W]&&l[H+"|"+Y+"|image"]&&k[W](C,h,this.gv,m,s.width,s.height))}}},handle_touchstart:function(O){this.handle_mousedown(O)},handle_touchmove:function(L){this.handle("onMove",L)},handleWindowMove:function(t){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",t):(this.handleDownInfo("onBeginDrag",t),this.isDragging=!0))},handleWindowUp:function(g){this.isDragging&&(this.handleDownInfo("onEndDrag",g),this.isDragging=!1);var B=this.handle("onUp",g);this.downInfo&&(B&&B.data===this.downInfo.data?this.handleMissingUp(g):this.handleDownInfo("onUp",g),this.downInfo=N)},handleDownInfo:function(U,B){if(this.downInfo){var M=this.downInfo,Z=M.ui.interactiveInfo;if(Z){var h,q=this.gv.lp(B),e=M.data;if(e.s(U)&&e.s(U)(B,e,this.gv),"body"===M.part&&Z.bodyInfo)h="body",this.handleDownInfoImage(h,this.gv.getImage(e),U,B,e,q,Z.bodyInfo);else if("icons"===M.part&&Z._38o){var p=Z._38o[M.name];p&&p[M.index]&&(h="icons|"+M.name+"|"+M.index,this.handleDownInfoImage(h,M.icon,U,B,e,q,p[M.index]))}}}},handleDownInfoImage:function(R,i,v,G,b,J,D){var k=this.downInfo.hits;if(k&&i&&(i=cd(i))){var U=this.gv,T=D.rect,A=this.convertPoint(J,D);k[R+"|image"]&&i[v]&&i[v](G,b,U,A,T.width,T.height);for(var K=D.compInfos,w=K.length-1;w>=0;w--){var j=K[w],s=j.comp;A=this.convertPoint(J,j),T=j.rect,s[v]&&k[R+"|"+w]&&s[v](G,b,U,A,T.width,T.height),(i=T.image)&&i[v]&&k[R+"|"+w+"|image"]&&i[v](G,b,U,A,T.width,T.height)}}},convertPoint:function(A,n){var k=A.x,W=A.y;n.stacks.forEach(function(M){if(M.t)k-=M.t[0],W-=M.t[1];else if(M.s)k/=M.s[0],W/=M.s[1];else if(M.r){var n=R(-M.r),D=E(-M.r),N=D*k-n*W,u=n*k+D*W;k=N,W=u}});var V=n.rect;return A={x:k-V.x,y:W-V.y},A.inRect=A.x>=0&&A.y>=0&&A.x<=V.width&&A.y<=V.height,A}});var wc=Bd.DefaultInteractor=function(V){Ho(wc,this,[V])};Kd("DefaultInteractor",Cd,{handle_mousedown:function(b){zq(b);var I=this,r=I.gv,y=r.getDataAt(b);!r.setFocus(b)||r._editing||r._scrolling||(hn(b)?r.handleDoubleClick(b,y):r.handleClick(b,y),!Qr()&&y||!r.isPannable()||!Fq(b)||op(b)||(I._tx=r.tx(),I._ty=r.ty(),I.startDragging(b)))},handleWindowMouseUp:function(S){var v=this,A=v.gv;A._panning&&(delete A._panning,A.onPanEnded(),v.fi({kind:"endPan",event:S})),delete v._tx,delete v._ty,v.clearDragging()},handle_mousemove:function($){var p=this,F=p.gv;p._hoverTimer&&(f(p._hoverTimer),delete p._hoverTimer),p._hoverTimer=b(function(){p.fi({kind:"hover",event:$}),f(p._hoverTimer),delete p._hoverTimer},F.getHoverDelay()||Q.hoverDelay)},handle_touchmove:function(O){this.handle_mousemove(O)},handleWindowMouseMove:function(u){var F=this,X=F.gv,l=F._lastClientPoint;F.fi({kind:X._panning?"betweenPan":"beginPan",event:u}),X._panning=1,X.setTranslate(F._tx+u.clientX-l.x,F._ty+u.clientY-l.y)},handle_mousewheel:function(k){this.gv.handleScroll(k,k.wheelDelta)},handle_DOMMouseScroll:function(b){2===b.axis&&this.gv.handleScroll(b,-b.detail)},handle_keydown:function(C){this.gv.handleKeyDown(C)}});var uh=Bd.SelectInteractor=function(N){Ho(uh,this,[N])};Kd("SelectInteractor",Cd,{_42:function(){var F=this,M=F.gv,t=M.getZoom(),I=F.mark,U=F.div;U||(U=F.div=ac(),kr(F.getView(),U));var X={};X.x=I.x*t+M.tx(),X.y=I.y*t+M.ty(),X.width=I.width*t,X.height=I.height*t,Sf(U,X),this.intersects()?(U.style.border="",U.style.background=M.getRectSelectBackground()):(U.style.background="",U.style.border="1px solid "+M.getRectSelectBorderColor())},handle_mousedown:function(P){var $=this,a=$.gv;if($._57I=N,!(a._editing||a._scrolling||Qr())){var d=a.getDataAt(P),M=a.sm();if(d)if(op(P))M.co(d)?M.rs(d):M.as(d);else if(M.co(d)){if(hn(P)&&d instanceof ti&&d.isClickThroughEnabled()){var j=a.getDataAt(P,function(e){a._clickThroughChecking=!0;var m=e.getParent()===d&&a.isSelectable(e);return delete a._clickThroughChecking,m});j&&(P.clickThrough=!0,M.ss(j))}}else M.ss(d);else op(P)||!a.isPannable()?Fq(P)&&(op(P)||M.cs(),a.isRectSelectable()&&($.startDragging(P),a._77O=1)):Fq(P)&&($._57I=zc(P))}},handle_mouseup:function(w){var n=this,Z=n._57I;Z&&(uk(Z,zc(w))<=1&&n.gv.sm().cs(),n._57I=N)
},handleWindowMouseUp:function(c){this.clear(c)},handleWindowMouseMove:function(E){var H=this,B=H.gv;H._logicalPoint=B.lp(E),H.mark?(H.fi({kind:"betweenRectSelect",event:E}),B.isPannable()&&H.autoScroll(E),H.redraw()):H.fi({kind:"beginRectSelect",event:E}),H.mark=re(H._lastLogicalPoint,H._logicalPoint),H.redraw()},intersects:function(){var s=this,u=s._lastLogicalPoint,d=s._logicalPoint;return u.x>d.x||u.y>d.y},clear:function(R){var M=this,Z=M.gv,q=M.mark;if(M._57I=N,M._lastLogicalPoint){if(q){if(0!==q.width&&0!==q.height){var O=Z.getDatasInRect(q,M.intersects());if(!O.isEmpty()){var b=Z.sm(),v=b.toSelection();O.each(function($){b.co($)?v.remove($):v.add($)}),b.ss(v)}}eq(M.div),delete M.div,delete M.mark,M.redraw(),M.fi({kind:"endRectSelect",event:R}),Z.onRectSelectEnded()}M.clearDragging(),delete Z._77O}},redraw:function(){var C=this;C._draw||(C._draw=1,b(function(){C.mark&&C._42(),delete C._draw},16))}});var Hi=Bd.MoveInteractor=function(o){Ho(Hi,this,[o])};Kd("MoveInteractor",Cd,{handle_mousedown:function(V){var d=this,I=d.gv;if(Fq(V)&&!I._editing&&!I._scrolling&&!Qr()){var C=I.getSelectedDataAt(V);C?(d._data=C,I.handleMouseDown&&I.handleMouseDown(V,C),d.startDragging(V),I.isMovable(C)&&(I._moving=1)):I._focusData=N}},handleWindowMouseUp:function(n){var F=this,S=F.gv;S.handleMouseUp&&S.handleMouseUp(n,F._data),F.clear(n)},handleWindowMouseMove:function(e){var o=this,U=o._data,x=o.gv;if((!x._93O||!x._93O(e,U))&&x._moving){o._logicalPoint||o.fi({kind:"prepareMove",event:e});var B=o._logicalPoint?"betweenMove":"beginMove",I={kind:B,event:e},Y=o._logicalPoint=x.lp(e);"beginMove"!==B||o._alreadyBeginTransaction||(o._alreadyBeginTransaction=!0,x.getDataModel().beginTransaction());var H=o._calcShift(B,e),W=H.x,m=H.y,K=o.gv.getMoveMode(e,U);K&&("x"===K?m=0:"y"===K?W=0:"xy"!==K&&(W=m=0)),x.moveSelection(W,m),o._lastLogicalPoint=Y,o.autoScroll(e),o.fi(I)}},_calcShift:function(){var W=this,m=W._logicalPoint,u=W._lastLogicalPoint,K=m.x-u.x,_=m.y-u.y;return{x:K,y:_}},clear:function(v){var c=this,Y=c.gv;c._lastLogicalPoint&&(c._lastLogicalPoint=c._data=Y._moving=N,c._logicalPoint&&(c.fi({kind:"endMove",event:v}),Y.onMoveEnded()),c.clearDragging()),c._alreadyBeginTransaction&&(c._alreadyBeginTransaction=!1,Y.getDataModel().endTransaction())}});var If=Bd.ScrollBarInteractor=function(z){Ho(If,this,[z])};Kd("ScrollBarInteractor",Cd,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(d){var q=this.gv.getViewRect();return this._41o()&&(q.x+q.width-this.gv.lp(d).x)*this.gv.getZoom()<ip},isH:function(O){var Z=this.gv.getViewRect();return this._40o()&&(Z.y+Z.height-this.gv.lp(O).y)*this.gv.getZoom()<ip},handle_mousemove:function(r){this.handle_touchmove(r)},handle_touchmove:function(H){if(!Ki&&Fq(H)&&this.gv.isScrollBarVisible()){var A=this,W=A.isV(H),q=A.isH(H);(W||q)&&A.gv.showScrollBar(),A.gv._scrolling=W||q}},handleWindowMouseUp:function(i){this.handleWindowTouchEnd(i)},handleWindowTouchEnd:function(o){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=N,this.fi({kind:"endScroll",event:o})},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(p){var m=this;if(m.gv.setFocus(p),zq(p),m.handle_touchmove(p),!(Wf(p)>1)&&m.gv._scrolling&&m.gv.isScrollBarVisible()){m._cp=zc(p),m._tx=m.gv.tx(),m._ty=m.gv.ty();var r=m.isV(p);m._state=r?"vScroll":"hScroll",ds(m,p),m.fi({kind:"beginScroll",event:p})}},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(d){var Q=zc(d),G=this.gv.getViewRect(),f=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-Q.y)*f.height/G.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-Q.x)*f.width/G.width),this.fi({kind:"betweenScroll",event:d})}});var mh=Bd.TouchInteractor=function(Y,O){O=O||{},O.selectable===d&&(O.selectable=!0),O.movable===d&&(O.movable=!0),O.pannable===d&&(O.pannable=!0),O.pinchable===d&&(O.pinchable=!0),O.editable===d&&(O.editable=!0),this.params=O,Ho(mh,this,[Y])};Kd("TouchInteractor",Cd,{ms_edit:1,setUp:function(){var v=this;mh.superClass.setUp.call(v),Bq&&v.params.editable&&v.gv.setEditInteractor(v)},tearDown:function(){var R=this;mh.superClass.tearDown.call(R),Bq&&R.params.editable&&R.gv.setEditInteractor(N)},clear:function(R){var Q=this,I=Q.gv;I._moving&&(Q.fi({kind:"endMove",event:R}),delete I._moving,I.onMoveEnded(),I.dm().endTransaction()),I._panning&&(Q.fi({kind:"endPan",event:R}),delete I._panning,I.onPanEnded()),I._pinching&&(Q.fi({kind:"endPinch",event:R}),delete I._pinching,I.onPinchEnded()),I._editing&&(Q._46O(R),Q._77I=Q._node=Q._edge=Q._shape=Q._rect=Q._89I=Q._index=I._editing=N),Q._moving=Q._panning=Q._pinching=Q._editing=Q._57I=Q._data=Q._beginHistory=N,Q.clearDragging()},handle_touchstart:function(h){var V=this;if(!V.gv._editing){zq(h),V._57I=N;var H=V.params,d=V.gv,Y=d.sm(),w=d.getDataAt(h),o=Wf(h);if(1===o){if(hn(h))return d.handleDoubleClick(h,w),void 0;d.handleClick(h,w),w&&(d.handleMouseDown&&d.handleMouseDown(h,w),V._data=w),H.selectable||(w=N),w?(Y.co(w)||Y.ss(w),H.editable&&d.isEditable(w)&&V._79I(h,w,!0)?(V._editing=1,V.startDragging(h)):H.movable&&d.isMovable(w)&&(V._moving=1,V.startDragging(h))):(V._57I=zc(h),H.pannable&&d.isPannable()&&(V._panning=1,V.startDragging(h),V._translate={x:d.tx(),y:d.ty()}))}else if(H.pinchable&&2===o){V._pinching=1,V.startDragging(h);var E=d.getView(),X=d.getZoom(),G=E.getBoundingClientRect(),e=h.touches[0],Z=h.touches[1],v={x:(e.clientX+Z.clientX)/2-G.left,y:(e.clientY+Z.clientY)/2-G.top};v.x-=d.tx(),v.y-=d.ty(),v.x/=X,v.y/=X,V._p=v,V._d=Xi(h)}}},handle_touchend:function(I){var X=this,n=X.gv,C=X._57I,w=X._data;C&&(uk(C,zc(I))<=1&&n.sm().cs(),X._57I=N),w&&n.handleMouseUp&&n.handleMouseUp(I,w)},handleWindowTouchEnd:function(c){this.clear(c)},handleWindowTouchMove:function(t){var $=this,z=$.gv,s=Wf(t);if(1===s){if($._editing&&($._beginHistory||($._beginHistory=1,z.dm().beginTransaction()),z._editing=1,$._78I(t)),$._moving)$._beginHistory||($._beginHistory=1,z.dm().beginTransaction()),$.handleMove(t);else if($._panning){var y=zc(t);z.setTranslate($._translate.x+y.x-$._lastClientPoint.x,$._translate.y+y.y-$._lastClientPoint.y),$.fi({kind:z._panning?"betweenPan":"beginPan",event:t}),z._panning=1}}else if(2===s&&$._pinching){var Q=Xi(t);z.handlePinch($._p,Q,$._d),$._d=Q,$.fi({kind:z._pinching?"betweenPinch":"beginPinch",event:t}),z._pinching=1}},handleMove:function(m){var J=this,h=J.gv,M=h.lp(m);h._93O&&h._93O(m,J._data)||(h.moveSelection(M.x-J._lastLogicalPoint.x,M.y-J._lastLogicalPoint.y),J._lastLogicalPoint=M,J.autoScroll(m),J.fi({kind:h._moving?"betweenMove":"beginMove",event:m}),h._moving=1)}});var M=X.ht,Gj=M.graph._editor={Math:M.Math,Guide:{}};Gj.getStyle=function(n){var K,u=Gj.StyleMap;return u&&(K=u[n],K!==d)?K:Gj.DefaultStyleMap[n]},Gj.setStyle=function(o,F){var E=Gj.StyleMap;E||(E=Gj.StyleMap={}),E[o]=F},Gj.inEdit=function(m){return m._inXEdit===!0},Gj.startEdit=function(r){r._inXEdit=!0,Gj.Inject.doInject(r)},Gj._46O=function(s){s._inXEdit=!1,Gj.Inject.undoInject(s)},Gj.toScreenPosition=function(G,B){var h=G.tx(),p=G.ty(),J=G._zoom;return new Gj.Math.Vector2(B.x*J+h,B.y*J+p)},Gj.checkHit=function(p,s,E){return p.distanceTo(s)<E?!0:!1},Gj.toWorldPosition=function(Y,g){var G=Y.tx(),t=Y.ty(),P=Y._zoom;return{x:(g.x-G)/P,y:(g.y-t)/P}},Gj.setAntialias=function(q,a){for(var R,D=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],d=0,E=D.length;E>d&&(R=D[d],!(R in q));d++);q[R],q[R]=a},Gj.getTargetCornersOnScreen=function(Q,f){if(!f)return null;var C,x=[];if(rq(f,Q)){var G=Wp(Q,f);C=[{x:G.x,y:G.y},{x:G.x+G.width,y:G.y},{x:G.x+G.width,y:G.y+G.height},{x:G.x,y:G.y+G.height}]}else{if(!f.getCorners)return null;C=f.getCorners()}return C.forEach(function($){var y=Gj.toScreenPosition(Q,$);x.push(y.x,y.y)}),x},Gj.log=function(){};var Ce=Gj.Inject={_modules:[]};Ce.registAsModule=function(a,o){var Z={},q={};for(var S in a){var l=o.prototype[S];Z[S]=l}a.getBackup=function(A){return Z[A]},a.getBackups=function(){return Z},q.doInject=function(){for(var d in a)"getBackup"!==d&&(o.prototype[d]=a[d])},q.undoInject=function(){for(var u in a)"getBackup"!==u&&(o.prototype[u]=Z[u])},Ce._modules.push(q)},Ce.doInject=function(R){for(var d,Y=Ce._modules,a=0,Q=Y.length;Q>a;a++)d=Y[a],d.doInject(R)},Ce.undoInject=function(x){for(var i,n=Ce._modules,g=0,Q=n.length;Q>g;g++)i=n[g],i.undoInject(x)};var Cd=M.graph.EditInteractor=function(D){var z=this,p=K.createElement("canvas");p.className="editCanvas",p.style.position="absolute",z._styleMap={},z._canvas=p,z._context=p.getContext("2d"),Cd.superClass.constructor.call(z,D),Gj.setAntialias(z._context,!1),z._subModules=[new Gj.Anchor(z),new Gj.Rect(z),new Gj.Curve(z),new Gj.MoveHelper(z)],z._gridGuide=new Gj.Guide.Grid(z),z._rectGuide=new Gj.Guide.Rect(z)},Uo=Cd;M.Default.def(Cd,M.graph.Interactor,{ms_edit:1,ms_fire:1}),J.defineProperties(Cd.prototype,{editDetail:{get:function(){var Q=!!this._editDetail;return Q},set:function(k){var u=this,K=u._editDetail;K!==k&&(u._editDetail=k,u.gv._editing=k,u.fp("editDetail",K,k),u.fp("pointsEditingMode",K,k),u.fi({kind:k?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(S){(!this._editDetail||S)&&(this.gv._editing=S,S||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(k){this._editing=k,this.gvEditing=k}},pointsEditingMode:{get:function(){return this.editDetail},set:function(P){var v=this;v.editDetail!==P&&(P?v._tryEnterEditDetailMode():v._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var Z=this._gridEnabled;if(!Z)return!1;var F=this.gv;return F?!0:!0},set:function(x){x!==this._gridEnabled&&(this._gridEnabled=x,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(o){o!==this._agEnabled&&(this._agEnabled=o,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Cd.prototype.getSubModule=function(Q){var E,O,P,d=this._subModules;for(O=0,P=d.length;P>O;O++)if(E=d[O],E.catalog===Q)return E},Cd.prototype.invokeSubModule=function(j,m){var l=this,W=l._subModules;if(W)for(var Q,k,D,q=Array.prototype.slice.call(arguments,2),M=0,p=W.length;p>M;M++)if(Q=W[M],k=Q[j],k&&(D=k.apply(Q,q),D!=d&&m))return Q},Cd.prototype.invokeSubModuleInverse=function(f,x){var A=this,t=A._subModules;if(t)for(var S,k,l,p=Array.prototype.slice.call(arguments,2),U=t.length-1;U>=0;U--)if(S=t[U],k=S[f],k&&(l=k.apply(S,p),l!=d&&x))return S},Cd.prototype.setUp=function(){Gj.log("setUp");var O=this,J=O.gv,y=J.getView(),W=O._canvas;Cd.superClass.setUp.call(O),J.setEditInteractor(O),J._79O?y.insertBefore(W,J._79O):y.appendChild(W),Gj.startEdit(J),O.invokeSubModule("setUp"),J.dm().mm(O._onDataModelChanged,O),J.dm().md(O._onDataPropertyChanged,O)},Cd.prototype.tearDown=function(){Gj.log("tearDown");var P=this,V=P.gv,i=V.getView();P._resetCustomCursorStyle(),Cd.superClass.tearDown.call(P),V.dm().umm(P._onDataModelChanged,P),V.dm().umd(P._onDataPropertyChanged,P),V.setEditInteractor(null),i.removeChild(P._canvas),P._drawTimer&&(f(P._drawTimer),P._drawTimer=null),Gj._46O(V),P.invokeSubModule("tearDown")},Cd.prototype._onDataModelChanged=function(p){var r=this;("clear"===p.kind||"remove"===p.kind&&r.editDetail&&p.data===r.getSubModule("Curve").target)&&(r.editDetail=!1,r._42())},Cd.prototype._onDataPropertyChanged=function(j){var $=this;if($.editDetail){var Z=$.getSubModule("Curve"),_=j.data;_===Z.target&&(_._writing||Z._handleDataChanged())}},Cd.prototype.clear=function(){Gj.log("clear")},Cd.prototype.redraw=function(){this._42()},Cd.prototype._42=function(){var I=this;I._drawTimer||(I._drawTimer=b(function(){I._drawTimer=null,I.drawImpl()},0))},Cd.prototype.drawImpl=function(){var y;for(y in{_42:!0})break;return function(){var V=this,l=V._canvas,E=V.gv,c=E.getWidth(),T=E.getHeight(),s=V._context,L=M.Default.getInternal();(l.width!==c||l.height!==T)&&L.setCanvas(l,c,T),s.clearRect(0,0,l.width,l.height);var t=V._getValidSelection();s.save();var d=M.Default.devicePixelRatio;s.scale(d,d),V._gridGuide._42(),V.invokeSubModuleInverse(y,!1,s,E,t),V._rectGuide._42(),s.restore()}}(),Cd.prototype._getValidSelection=function(){var m=this,j=m.gv,z=j.sm().getSelection(),F=[];return z.each(function(A){j.isVisible(A)&&j.isEditable(A)&&F.push(A)}),F},Cd.prototype.handle_touchmove=function(X){return this.handle_mousemove(X)},Cd.prototype.handle_mousemove=function(m){if(!M.Default.isDragging()){var J=this;(J.editDetail||!Qr())&&(J.gvEditing=!1,J._checkEdit(m)&&(J.gvEditing=!0))}},Cd.prototype.handle_touchstart=function(g){return this.handle_mousedown(g)},Cd.prototype.handle_mousedown=function(f){zq(f);var K=this;if(K.editDetail||!Qr()){if(hn(f)&&!f.clickThrough){if(K.editDetail){if(K._tryQuitEditDetailMode(f))return}else if(K._tryEnterEditDetailMode())return;K.gv.dm().beginTransaction();var Q=K.invokeSubModule("handleDoubleClick",!0,f);if(K.gv.dm().endTransaction(),Q)return}var F=K._checkEdit(f);F&&(K._downPosition=K._getLogicalPoint(f),K.gv.dm().beginTransaction(),F.startEdit(K,f),K.editing=!0)}},Cd.prototype._checkEdit=function(I){var O=this,X=O.gv,F=O._getLogicalPoint(I),x=O.invokeSubModule("check",!0,X,I,F)||null;return O._editMod=x,x},Cd.prototype.handleWindowTouchMove=function(Q){return this.handleWindowMouseMove(Q)},Cd.prototype.handleWindowMouseMove=function(T){var j=this,V=j._downPosition;if(V){var M=j._getLogicalPoint(T);if(M.distanceTo(V)<j.getStyle("moveSensitivity"))return;delete j._downPosition}var y=j._editMod;y&&y.handleEdit(j.gv,T)},Cd.prototype._getLogicalPoint=function(B){var L=this,I=M.Default.getLogicalPoint(B,L._canvas);return new Gj.Math.Vector2(I)},Cd.prototype.handleWindowTouchEnd=function(q){return this.handleWindowMouseUp(q)},Cd.prototype.handleWindowMouseUp=function(){var v;for(v in{_46O:!0})break;return function(I){var $=this;$.editing=!1,$.setCursor("default"),$.invokeSubModule(v,!1,I),$._42(),$.gv.dm().endTransaction()}}(),Cd.prototype.handle_mousewheel=function(V){var K=this;zq(V),K.invokeSubModule("preHandleScroll",!0)||K.gv.handleScroll(V,V.wheelDelta)},Cd.prototype.handleDelete=function(){var c=this;if(!c.editDetail){c.gv.dm().beginTransaction();var x=c.invokeSubModule("handleNormalStateDelete",!0);return c.gv.dm().endTransaction(),x||c.gv.removeSelection(),void 0}c.gv.dm().beginTransaction(),c.invokeSubModule("handleDelete",!0),c.gv.dm().endTransaction(),c._42()},Cd.prototype.handle_keydown=function(I){var k=this;if((I.metaKey||I.ctrlKey)&&k._42(),Qr(I)&&!k.editing)return k.gvEditing=!1,k.setCursor("default"),k._42(),void 0;var E=bl(I);return k.editDetail?((E||oj(I))&&(k.editDetail=!1,k._42()),k.gv.dm().beginTransaction(),k.invokeSubModule("handle_keydown",!0,I),k.gv.dm().endTransaction(),void 0):(k.gv.dm().beginTransaction(),k.invokeSubModule("handleNormalStateKeyDown",!0,I),k.gv.dm().endTransaction(),E&&k._tryEnterEditDetailMode(),void 0)},Cd.prototype.handle_keyup=function(q){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,q),this.gv.dm().endTransaction()},Cd.prototype._tryEnterEditDetailMode=function(){var T=this;return!T.editDetail&&T.invokeSubModule("canEnterEditDetailMode",!0)&&1===T._getValidSelection().length?(T.editDetail=!0,T._42(),!0):void 0},Cd.prototype._tryQuitEditDetailMode=function(X){var r=this;if(r.editDetail){var B=r.gv,A=r.getSubModule("Curve").target;return X&&B.getDataAt(X)===A?void 0:(r.editDetail=!1,r._42(),!0)}},Cd.prototype.setStyle=function(C,z,r){var R=this;r?Gj.setStyle(C,z):R._styleMap[C]=z,R.fp("styleChanged",null,{key:C,value:z,base:r}),R._42()},Cd.prototype.getStyle=function(p){var I=this,O=I._styleMap[p];return O!==d?O:Gj.getStyle(p)},Cd.prototype.setCursor=function(I){this._resetCustomCursorStyle(),M.graph.EditInteractor.superClass.setCursor.call(this,I)},Cd.prototype._resetCustomCursorStyle=function(){var U=this;if(U._customStyle){var J=this.gv.getView();J.classList&&J.classList.remove&&J.classList.remove(U._customStyle),U._customStyle=null}},Cd.prototype._setRotateCursor=function(p){var k=this,A=k._cursorFactory;A||(A=k._cursorFactory=new Gj.CursorFactory(k));var L=A.getRotateCursor(p),j=k.gv.getView();k._resetCustomCursorStyle(),k._customStyle=L,j.classList&&j.classList.add&&j.classList.add(L)};var Km=Gj.Group=function(f){var I=this;I._entities=f,I._64O=0,I._position={x:0,y:0},I._scale={x:1,y:1},I._anchor={x:.5,y:.5},I._anchor2={x:.5,y:.5}};Km.prototype={},Km.prototype.constructor=Km;var wh=null;Km.findOrCreateGroup=function($){if(wh&&wh.checkIsMe($))return wh;var y=new Gj.Group($);return y.getKeyOb()?(wh=y,y):void 0},Km.prototype.checkIsMe=function(a){var O=this._entities;if(O.length!==a.length)return!1;var q,n={},U=a.length;for(q=0;U>q;q++)n[a[q]._id]=!0;for(q=0;U>q;q++)if(!n[O[q]._id])return!1;return!0},Km.prototype.getRotation=function(){return this._64O},Km.prototype.getPosition=function(){return this._position},Km.prototype.getAnchor=function(){return this._anchor},Km.prototype.getWidth=function(){return this._width},Km.prototype.getScale=function(){return this._scale},Km.prototype.getSize=function(){return{width:this._width,height:this._height}},Km.prototype.getHeight=function(){return this._height},Km.prototype.getKeyOb=function(){for(var l=this._entities,i=l.length-1;i>=0;i--){var b=l[i];if(this.isNode(b))return b}},Km.prototype.getAnchor2=function(){var U=this,E=U.rotateCenter;if(E)return E;var i=U.getKeyOb();if(!i)return U._anchor;var Y=U._anchor2,u=i.getMatrix();return u.tf({x:i.getWidth()*(Y.x-i.getAnchor().x),y:i.getHeight()*(Y.y-i.getAnchor().y)})},Km.prototype.setAnchor2=function(b,x){var j=this,K=j.getKeyOb();if(K){var F,f=K.getMatrix();F="number"==typeof b?{x:b,y:x}:b;var i=f.tfi(F);j._anchor2={x:K.getAnchor().x+i.x/K.getWidth(),y:K.getAnchor().y+i.y/K.getHeight()}}},Km.prototype.setRotation=function(){},Km.prototype.beginRotate=function(m){this.rotateCenter=m.pos,this.rotateMode=m.groupRotateMode},Km.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Km.prototype.addRotation=function(Z,C){return"batch"===C?this._addRotationInBatchMode(Z):"block"===C?this._addRotationInBlockMode(Z):void 0},Km.prototype._addRotationInBlockMode=function(t){var p=this,Q=p.rotateCenter||p.getPosition();p._entities.forEach(function(T){if(p.isNode(T)){var v=T.getMatrix();v.translate(-Q.x,-Q.y),v.rotate(t),v.translate(Q.x,Q.y);var f=Math.sign(T.getScale().x);T.setRotation(D(v.b*f,v.a*f)),T.setPosition(v.tx,v.ty)}})},Km.prototype._addRotationInBatchMode=function(U){var R=this,X=R._anchor2;R._entities.forEach(function(S){if(R.isNode(S)){var w=S.getAnchor(),K=S.getMatrix(),G=K.tf({x:S.getWidth()*(X.x-w.x),y:S.getHeight()*(X.y-w.y)}),p=new Gj.Math.Matrix2;p.set(K.a,K.b,K.c,K.d,K.tx,K.ty),p.translate(-G.x,-G.y),p.rotate(U),p.translate(G.x,G.y);var m=Math.sign(S.getScale().x);S.setRotation(D(p.b*m,p.a*m)),S.setPosition(p.tx,p.ty)}})},Km.prototype.setPosition=function(g){var d,P,N,e,$=this,t=$._position,B=g.x-t.x,k=g.y-t.y,n=$._entities;for(P=0,N=n.length;N>P;P++)d=n[P],Oh(d)&&(e=d.getPosition(),d.setPosition(e.x+B,e.y+k));$._position=g},Km.prototype.setScale=function(W,N){var E=this,b=W/E._scale.x,u=N/E._scale.y;E._adjustChildScaleOrSize(b,u,"size"),E._scale={x:W,y:N}},Km.prototype.getRect=function(){var t=this,d=t._position,W=t._width,b=t._height;return{x:d.x-W/2,y:d.y-b/2,width:W,height:b}},Km.prototype.setSize=function(n,V){var F=this,n=Math.max(1,n),V=Math.max(1,V),N=n/F._width,L=V/F._height;F._adjustChildScaleOrSize(N,L,"size"),F._width=n,F._height=V},Km.prototype._adjustChildScaleOrSize=function(V,b,F){var v,h,L,B,c,o,r,S,M,t,l,e,T,A,x=this,J=x._position,n=x._entities,g=new Gj.Math.Matrix2;for(h=0,L=n.length;L>h;h++)if(v=n[h],x.isNode(v)){if(B=v.getPosition(),c=v.getRotation(),o=v.getWidth(),r=v.getHeight(),S=v.getScale(),l=S.x*o,e=S.y*r,g.identity().scale(l,e).rotate(c).translate(B.x,B.y).translate(-J.x,-J.y).rotate(-x._64O),c=D(g.b*Math.sign(l),g.a*Math.sign(l)),g.scale(V,b),M=Math.cos(c),t=Math.sin(c),Math.abs(M)<.001?(T=g.b/t,A=-g.c/t):(T=g.a/M,A=g.d/M),"scale"===F)v.setScale(T/o,A/r);else if("size"===F){var H=T/S.x,$=A/S.y;v.setScale(Qe(T)*Math.abs(S.x),Qe(A)*Math.abs(S.y)),v.setSize(Math.max(.1,Math.abs(H)),Math.max(.1,Math.abs($)))}g.rotate(x._64O).translate(J.x,J.y),v.setPosition(g.tx,g.ty)}},Km.prototype.getMatrix=function(){var K=this,l=K._position,P=M.Default.getInternal(),p=K._scale;return new P.Mat(K._64O,l.x,l.y,p.x,p.y)},Km.prototype.getCorners=function(){var Q=this,M=Q._width,P=Q._height,X=Q._anchor,I=-M*X.x,D=-P*X.y,H=Q.getMatrix();return[H.tf(I,D),H.tf(I,D+P),H.tf(I+M,D+P),H.tf(I+M,D)]},Km.prototype.calcInfo=function(){var J,N,Z,c,b,F,t=this,I=[],v=t._entities,z=t._64O;for(c=0,b=v.length;b>c;c++)F=v[c],t.isNode(F)&&F.getCorners&&I.push.apply(I,F.getCorners());if(I.length){var r=Math.cos(-z),s=Math.sin(-z),i=1/0,S=-1/0,Y=1/0,G=-1/0;for(c=0,b=I.length;b>c;c++)Z=I[c],J=Z.x,N=Z.y,Z.x=r*J-s*N,Z.y=s*J+r*N,i=Math.min(i,Z.x),S=Math.max(S,Z.x),Y=Math.min(Y,Z.y),G=Math.max(G,Z.y);t._width=(S-i)/t._scale.x,t._height=(G-Y)/t._scale.y,r=Math.cos(z),s=Math.sin(z);var P=t._anchor;J=i+(S-i)*P.x,N=Y+(G-Y)*P.y,t._position={x:r*J-s*N,y:s*J+r*N}}},Km.prototype.isNode=function(W){return Oh(W)?rq(W)?!1:!0:!1},Km.prototype._42=function(Y,L,s){var g,n,f,w,t,u,N,C,x=this,q=x._entities,c=x.rotateMode;for("batch"===c&&(C=x.getKeyOb()),g=0,n=q.length;n>g;g++)f=q[g],x.isNode(f)&&(u=f.getRect(),w=Gj.toScreenPosition(s,{x:u.x,y:u.y}),t=Gj.toScreenPosition(s,{x:u.x+u.width,y:u.y+u.height}),N={min:w,max:t},f===C&&(N.isKeyOb=!0),Gj.Icons.DrawIcon(Y,L,Gj.Icons.GroupSubEntityRect,N))};var Nr=Gj.CurveActiving=function(U,d){this._curve=U,this._interactor=U._interactor;for(var L in d)this[L]=d[L]};Nr.prototype={},Nr.prototype.constructor=Nr,J.defineProperties(Nr.prototype,{point:{get:function(){return this._point},set:function(C){var E=this;E._point=C,E.editingCtrl||E._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(V){var i=this;i._pairs=V,i.editingCtrl&&i._firePointChange()}}}),Nr.prototype._firePointChange=function(){var k=this,j=k.getCurrentEditingPoint();if(!j)return r.fi({kind:"selectPoint"}),void 0;var r=k._interactor,F=this._curve.target;if(F){var Z=Gj.getDataMatrix(F).invert(),I=j.e;j=Z.apply(Gj.toWorldPosition(r.gv,j)),j.e=I;var f=k._lastFirePoint;f&&Math.abs(j.x-f.x)<1e-5&&Math.abs(j.y-f.y)<1e-5&&(j.e==d&&f.e==d||Math.abs(j.e-f.e)<1e-5)||(k._lastFirePoint=j,r.fi({kind:"selectPoint",x:j.x,y:j.y,e:j.e}))}},Nr.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Nr.prototype.getCurrentEditingPoint=function(){var Y=this,s=Y.editingCtrl;if(s){var h=Y.pairs;if(h){var H=h[s.pairId],e=H[s.type];if(e)return e}}return Y._point};var qh=Gj.CursorFactory=function(S){var U=this;U._interactor=S,U._rotateCursorStyles={}};qh.prototype={},qh.prototype.constructor=qh,qh.prototype.getRotateCursor=function(v){var N=this;0>v&&(v+=2*Math.PI);var q=N._interactor,H=q.getStyle("rotateCursorSize"),g=q.getStyle("rotateCursorRound"),r=Math.round(180*(v/Math.PI)/g);r*g>=360&&(r=0);var n=N._rotateCursorStyles,m="htCustomRotateStyle_"+H+"_"+g+"_"+r;return n[m]||(N._produceRotateCursor(m,H,g,r),n[m]=!0),m},qh.prototype._produceRotateCursor=function(i,J,e,z){var Q=this;Q._interactor;var F=Q._canvas;F||(F=Q._canvas=K.createElement("canvas")),F.width=F.height=J*devicePixelRatio,F.style.width=F.style.height=J+" px";var N=F.getContext("2d");Gj.setAntialias(N,!1),N.scale(devicePixelRatio,devicePixelRatio);var I,L,D,m,h,H=Math.round(J/2),V=""+H+" "+H+",auto !important;";I=Math.PI/180*z*e,N.clearRect(0,0,J,J),N.save(),N.scale(J/32,J/32),N.translate(16,16),N.rotate(I+Math.PI/2),N.beginPath(),N.moveTo(-8,0),N.lineTo(-8,3),N.lineTo(-5,3),N.moveTo(8,0),N.lineTo(8,3),N.lineTo(5,3),N.moveTo(-8,3),N.quadraticCurveTo(0,-6,8,3),N.restore(),N.strokeStyle="white",N.lineWidth=4,N.stroke(),N.strokeStyle="black",N.lineWidth=2,N.stroke(),L=JSON.stringify(F.toDataURL()),m="cursor:url("+L+")"+V,1!==devicePixelRatio&&(D='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+J+'px" height="'+J+'px"><image xlink:href='+L+' width="'+J+'" height="'+J+'"/></svg>',m+="cursor:url(data:image/svg+xml;base64,"+btoa(D)+")"+V,m+="cursor:-webkit-image-set(url("+L+")"+devicePixelRatio+"x,url("+L+")1x)"+V),h=K.createElement("style"),h.textContent="body."+i+" *, ."+i+"{"+m+"}",K.head.appendChild(h)};var xj=Gj.Guide.Grid=function(Y){var P=this;P._interactor=Y,P._alignmentGuideId=0,P._xAlignmentGuide=[],P._yAlignmentGuide=[]};xj.prototype={},xj.prototype.constructor=xj,J.defineProperties(xj.prototype,{gridBlockSize:{get:function(){var T=this;return T._gridBlockSize||T._interactor.getStyle("gridBlockSize")},set:function(J){this._gridBlockSize=J,this._interactor._42()}},gridThickLinesEvery:{get:function(){var V=this;return V._gridThickLinesEvery||V._interactor.getStyle("gridThickLinesEvery")},set:function(Y){this._gridThickLinesEvery=Y,this._interactor._42()}},gridEnabled:{get:function(){var J=this,b=J._interactor;return b.gridEnabled&&J.isValidGrid()}}}),xj.prototype._42=function(){var k=this,R=k._interactor;k.gridEnabled&&k.drawGrid(),R.alignmentGuideEnabled&&k.drawAlignmentGuide()},xj.prototype.makeMatrix=function(){var h=this,Z=h._interactor.getStyle("gridAngle"),K=h._interactor.getStyle("gridRotation"),c=new Gj.Math.Matrix2,k=Math.sin(Z),u=Math.cos(Z);return c.set(1,0,u,k,0,0),c.rotate(K),c},xj.prototype.isValidGrid=function(){var z=this,Q=Math.PI,S=z._interactor,L=S.gv;if(L._zoom<S.getStyle("gridZoomThreshold"))return!1;var J=S.getStyle("gridAngle"),k=Math.abs(180*(J%Q/Q)),i=1-1e-8;return i>k||k>180-i?!1:!0},xj.prototype.drawAlignmentGuide=function(){var M=this,V=M._interactor,j=V.gv,i=V._canvas,n=V._context,c=i.width,T=i.height,q=j.tx(),k=j.ty(),U=j._zoom;n.beginPath(),n.strokeStyle=V.getStyle("gridAlignmentGuideColor"),n.lineWidth=1,M._xAlignmentGuide.forEach(function(H){var $=H.p*U+q;n.moveTo($,0),n.lineTo($,T)}),M._yAlignmentGuide.forEach(function(R){var N=R.p*U+k;n.moveTo(0,N),n.lineTo(c,N)}),n.stroke()},xj.prototype.drawGrid=function(){function E(i,R,W,Q){var U=Gj.toScreenPosition(p,r.apply({x:i,y:R})),T=Gj.toScreenPosition(p,r.apply({x:W,y:Q}));N.moveTo(U.x,U.y),N.lineTo(T.x,T.y)}var F=this,g=F._interactor,q=F.gridBlockSize,X=F.gridThickLinesEvery,j=g.getStyle("gridThickColor"),S=g.getStyle("gridLightColor"),p=g.gv,w=g._canvas,N=g._context,u=w.width,b=w.height,r=F.makeMatrix(),$=r.applyInverse(Gj.toWorldPosition(p,{x:0,y:0})),c=r.applyInverse(Gj.toWorldPosition(p,{x:u,y:0})),o=r.applyInverse(Gj.toWorldPosition(p,{x:0,y:b})),v=r.applyInverse(Gj.toWorldPosition(p,{x:u,y:b})),K=Math.min($.x,c.x,o.x,v.x),V=Math.max($.x,c.x,o.x,v.x),s=Math.min($.y,c.y,o.y,v.y),D=Math.max($.y,c.y,o.y,v.y);u=V-K,b=D-s;var H=Math.ceil(K/q),f=Math.floor(V/q),I=Math.ceil(s/q),G=Math.floor(D/q);p.tx(),p.ty(),p._zoom;var A,e,P;for(N.save(),N.lineWidth=1,N.beginPath(),N.strokeStyle=j,P=Math.ceil(H/X)*X;f>=P;P+=X)A=P*q,E(A,s,A,D);for(P=Math.ceil(I/X)*X;G>=P;P+=X)e=P*q,E(K,e,V,e);for(N.stroke(),N.beginPath(),N.strokeStyle=S,P=H;f>=P;P++)0!==P%X&&(A=P*q,E(A,s,A,D));for(P=I;G>=P;P++)0!==P%X&&(e=P*q,E(K,e,V,e));N.stroke(),N.restore()},xj.prototype.getAlignmentGuides=function(){var i=this;return{x:i._xAlignmentGuide,y:i._yAlignmentGuide}},xj.prototype.addAlignmentGuide=function(N,B,r){var $=this,F="x"===N?$._xAlignmentGuide:$._yAlignmentGuide,r=r?r:++$._alignmentGuideId,C={p:B,id:r};if(F.length){var M=$._findClosestAlignmentGuide(C.p,F);M.dis<0?F.splice(M.index+1,0,C):F.splice(M.index,0,C)}else F.push(C);return $._interactor._42(),r},xj.prototype.findClosest=function(A,M,Q){var W=this,j=W._interactor,K=j.gv;Q&&(A=Gj.toWorldPosition(K,A));var O,J,H,p=1/0,o=1/0,C=A.x,G=A.y;if(W.gridEnabled){var _=W.gridBlockSize,w=W.makeMatrix(),i=w.applyInverse(A);i=w.apply({x:Math.round(i.x/_)*_,y:Math.round(i.y/_)*_}),p=i.x-C,o=i.y-G,H=!0}if(j.alignmentGuideEnabled&&(O=W._findClosestAlignmentGuide(C,W._xAlignmentGuide).dis,J=W._findClosestAlignmentGuide(G,W._yAlignmentGuide).dis,Math.abs(O)<Math.abs(p)&&(p=O,H=!0),Math.abs(J)<Math.abs(o)&&(o=J,H=!0)),H){H=!1;var k=K._zoom,B=j.getStyle("smartGuideSensitivity")/k,U={};if(Math.abs(p)<B&&"y"!==M&&(U.x=Q?p*k:p,H=!0),Math.abs(o)<B&&"x"!==M&&(U.y=Q?o*k:o,H=!0),H)return U}},xj.prototype._findClosestAlignmentGuide=function(s,N){if(!N.length)return{dis:1/0};for(var H,B=0,W=N.length-1;W-B>1;)H=Math.floor((B+W)/2),N[H].p<s?B=H:W=H;var J=N[B].p-s,d=N[W].p-s;return Math.abs(J)<=Math.abs(d)?{line:N[B],dis:J,index:B}:{line:N[W],dis:d,index:W}},xj.prototype.removeAllAlignmentGuide=function(B){var h=this;"y"!==B&&(h._xAlignmentGuide=[]),"x"!==B&&(h._yAlignmentGuide=[]),h._interactor._42()},xj.prototype.removeAlignmentGuide=function(c){for(var R,q,T,x=this,b=x._xAlignmentGuide,X=0;2>X;X++)for(b=0===X?x._xAlignmentGuide:x._yAlignmentGuide,R=0,q=b.length;q>R;R++)if(T=b[R],T.id===c)return b.splice(R,1),x._interactor._42(),{axis:0===X?"x":"y",position:T.p};return!1},xj.prototype.adjustAlignmentGuide=function(v,Z){var G=this,_=G.removeAlignmentGuide(v);return _?(G.addAlignmentGuide(_.axis,Z,v),!0):!1};var ul=Gj.Guide.Rect=function(i){var y=this;y._interactor=i};ul.prototype={},ul.prototype.constructor=ul,ul.prototype.gatherRects=function(){var U,L,C,j,V=this,o=V._interactor.gv,w=[],P=[],x={x:w,y:P},K={},e=o.getDataModel(),c=e.a("width"),Y=e.a("height");c&&Y&&(U=0,L=0,C=c,j=Y,w.push({node:e,type:0,p:U},{node:e,type:1,p:U+C/2},{node:e,type:2,p:U+C}),P.push({node:e,type:0,p:L},{node:e,type:1,p:L+j/2},{node:e,type:2,p:L+j}),K[e._id||0]={x:U,y:L,width:C,height:j}),e.each(function(x){if(Oh(x)&&!o.isSelected(x)&&o.isVisible(x)){var p=!1;if(o.sm().getSelection().each(function(q){p||(x.isHostOn(q)?p=!0:x.isDescendantOf(q)&&(p=!0))}),!p){var F=x.getRect();U=F.x,L=F.y,C=F.width,j=F.height,w.push({node:x,type:0,p:U},{node:x,type:1,p:U+C/2},{node:x,type:2,p:U+C}),P.push({node:x,type:0,p:L},{node:x,type:1,p:L+j/2},{node:x,type:2,p:L+j}),K[x._id]=F}}}),w.sort(function(v,X){return v.p-X.p}),P.sort(function(H,Z){return H.p-Z.p}),V._grid=x,V._87I=K},ul.prototype.gatherLines=function(k,r,Z){var C,a,q,I,h,P,j,E,M,L,H,J,t=this,V=[t.findClosest({x:k.x,y:k.y},r),t.findClosest({x:k.x+k.w/2,y:k.y+k.h/2},r),t.findClosest({x:k.x+k.w,y:k.y+k.h},r)],G={},y=t._87I;Z=Z||255;var e,u;for(t._guideLine=[],C=0;2>C;C++)for(G={},0===C?(I="y",E=k.x,M=E+k.w):(I="x",E=k.y,M=E+k.h),a=0;3>a;a++)h=V[a],h&&isFinite(h[I])&&(e=1<<3*C+a,Z&e&&(P=h[I+"Line"],j=P.node,u=j._id||0,G[u]||(G[u]=!0,J=y[u],"y"===I?(L=J.x,H=J.x+J.width):(L=J.y,H=J.y+J.height),q=P.p,t._guideLine.push({type:I,a:E,b:M,c:L,d:H,p:q,center:1===P.type}))))},ul.prototype._binarySearchClosest=function(S,T){if(!T.length)return{dis:1/0};for(var l,z=0,s=T.length-1;s-z>1;)l=Math.floor((z+s)/2),T[l].p<S?z=l:s=l;var M=T[z].p-S,X=T[s].p-S;return Math.abs(M)<=Math.abs(X)?{line:T[z],dis:M}:{line:T[s],dis:X}},ul.prototype.findClosest=function(J,i,A){var F=this,z=F._interactor,m=z.gv,R=F._grid;A&&(J=Gj.toWorldPosition(m,J));var I,K=F._binarySearchClosest(J.x,R.x),V=F._binarySearchClosest(J.y,R.y),$=K.dis,g=V.dis,w=m._zoom,Q=z.getStyle("smartGuideSensitivity")/w,X={};return Math.abs($)<Q&&"y"!==i&&(X.x=A?$*w:$,X.xLine=K.line,I=!0),Math.abs(g)<Q&&"x"!==i&&(X.y=A?g*w:g,X.yLine=V.line,I=!0),I?X:void 0},ul.prototype._42=function(){var C=this,m=C._guideLine;if(m&&!M.Default.isCtrlDown()){var R,$,t,n,f,D,u,E,T,i,y,H,j,Y,b,P,K,X=C._interactor,S=X.gv,B=X._context,F=S.tx(),V=S.ty(),z=S._zoom,I=X.getStyle("guideLineTextSpacing");for(R=0,$=m.length;$>R;R++)t=m[R],E=t.type,T=t.p,i=t.a,y=t.b,H=t.c,j=t.d,Y=Math.min(i,H),b=Math.max(y,j),"x"===E?(n=T*z+F,f=Y*z+V,D=n,u=b*z+V):(n=Y*z+F,f=T*z+V,D=b*z+F,u=f),Gj.Icons.DrawIcon(X,B,Gj.Icons.MoveLineGuide,{rect:[n,f,D,u],center:t.center}),j>=i&&y>=H||(Y=i>j?j:y,b=i>j?i:H,K=b-Y,"x"===E?(t.center2center||(n-=I,D=n),f=Y*z+V,u=b*z+V,P=Gj.Icons.MoveLineGuideDistanceV):"y"===E&&(t.center2center||(f-=I,u=f),n=Y*z+F,D=b*z+F,P=Gj.Icons.MoveLineGuideDistanceH),Gj.Icons.DrawIcon(X,B,P,{x0:n,y0:f,x1:D,y1:u,dis:K}))
}},ul.prototype.clear=function(){this._guideLine=null},Gj.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var rr=Gj.Icons={},zr=1e4,jk=null,Ye="rgb(51,153,255)",Kq="rgb(183,232,135)",Oc="rgb(255,204,153)",Pi=6;M.Default.setImage("Icons.RectPoint",{width:Pi,height:Pi,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:Ye,rect:[0,0,Pi,Pi]}]});var hq="#e000e0";rr.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var V=rr.GroupSubEntityRect.data;if(!V)return[];var J=V.min,N=V.max;return[J.x,J.y,J.x,N.y,N.x,N.y,N.x,J.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return rr.GroupSubEntityRect.data.isKeyOb?hq:"#666666"}}}]},rr.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[rr.Line.data.P1.x,rr.Line.data.P1.y],Pi,Pi]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[rr.Line.data.P2.x,rr.Line.data.P2.y],Pi,Pi]}}}]},rr.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return rr.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},rr.Rect={comps:[{type:"shape",points:{func:function(){var O=rr.Rect.data;if(!O)return[];var l=O.LT,Q=O.LB,p=O.RB,n=O.RT;return[l.x,l.y,Q.x,Q.y,p.x,p.y,n.x,n.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:Ye},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rr.Rect.data.rotation}},rect:{func:function(){return[[rr.Rect.data.LT.x,rr.Rect.data.LT.y],Pi,Pi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rr.Rect.data.rotation}},rect:{func:function(){return[[rr.Rect.data.LB.x,rr.Rect.data.LB.y],Pi,Pi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rr.Rect.data.rotation}},rect:{func:function(){return[[rr.Rect.data.RB.x,rr.Rect.data.RB.y],Pi,Pi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rr.Rect.data.rotation}},rect:{func:function(){return[[rr.Rect.data.RT.x,rr.Rect.data.RT.y],Pi,Pi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rr.Rect.data.rotation}},visible:{func:function(){return rr.Rect.data.L?!0:!1}},rect:{func:function(){return[[rr.Rect.data.L.x,rr.Rect.data.L.y],Pi,Pi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rr.Rect.data.rotation}},visible:{func:function(){return rr.Rect.data.R?!0:!1}},rect:{func:function(){return[[rr.Rect.data.R.x,rr.Rect.data.R.y],Pi,Pi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rr.Rect.data.rotation}},visible:{func:function(){return rr.Rect.data.T?!0:!1}},rect:{func:function(){return[[rr.Rect.data.T.x,rr.Rect.data.T.y],Pi,Pi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return rr.Rect.data.rotation}},visible:{func:function(){return rr.Rect.data.B?!0:!1}},rect:{func:function(){return[[rr.Rect.data.B.x,rr.Rect.data.B.y],Pi,Pi]}}}]};var wk=16;M.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:Ye,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:Ye,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),rr.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[rr.Anchor.data.POS.x,rr.Anchor.data.POS.y],wk,wk]}}}]},rr.TipShiftX=12,rr.TipShiftY=12;var Gp=[8,28];rr.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[rr.TipHelper.data.helperPos.x,rr.TipHelper.data.helperPos.y,Gp[0]*rr.TipHelper.data.size,Gp[1]]}},background:{func:function(){return jk.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return rr.TipHelper.data.text}},rect:{func:function(){return[rr.TipHelper.data.helperPos.x,rr.TipHelper.data.helperPos.y,Gp[0]*rr.TipHelper.data.size,Gp[1]]}},color:{func:function(){return jk.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var $e=7;rr.ShapePoint={comps:[{type:"circle",rect:{func:function(){var m=rr.ShapePoint.data;return[m,$e,$e]}},background:"#ffffff",borderWidth:1,borderColor:Ye}]},rr.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return rr.ShapeBgCurve.data.P}},segments:{func:function(){return rr.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:Ye}]};var we=8;rr.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var P=rr.ShapeHighlighPoint.data;return[[P.x,P.y],we,we]}},background:{func:function(){return jk.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var li=10;rr.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var f=rr.ShapeHighlighRealPoint.data;return[[f.x,f.y],li,li]}},background:"#ffffff",borderWidth:2,borderColor:Ye}]};var Rd=8;rr.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var e=rr.ShapeHighlighCtrlPoint.data,f=e.x,P=e.y,D=Rd/2;return[f-D,P-D,f-D,P+D,f+D,P+D,f+D,P-D]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return jk.getStyle("shapeCtrlPointBorderColor")||Ye}}}]};var ah=3;rr.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return rr.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:ah,borderColor:{func:function(){return jk.getStyle("curveHighlightColor")}}}]},rr.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return rr.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},rr.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return rr.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return rr.MoveLineGuide.data.center?Kq:Oc}}}]};var Mi=5;rr.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var s=rr.MoveLineGuideDistanceH.data,R=s.x0,w=s.y0;return[R,w-Mi,R,w+Mi]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Oc},{type:"shape",points:{func:function(){var i=rr.MoveLineGuideDistanceH.data,C=i.x1,g=i.y1;return[C,g-Mi,C,g+Mi]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Oc},{type:"text",text:{func:function(){return Math.round(rr.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var z=rr.MoveLineGuideDistanceH.data;return[[(z.x0+z.x1)/2,z.y0-10],20,20]}},color:Oc,font:"12px Arial",align:"center"}]},rr.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var e=rr.MoveLineGuideDistanceV.data,C=e.x0,_=e.y0;return[C-Mi,_,C+Mi,_]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Oc},{type:"shape",points:{func:function(){var H=rr.MoveLineGuideDistanceV.data,Q=H.x1,m=H.y1;return[Q-Mi,m,Q+Mi,m]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Oc},{type:"text",text:{func:function(){return Math.round(rr.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var G=rr.MoveLineGuideDistanceV.data;return[[G.x0-10,(G.y0+G.y1)/2],20,20]}},color:Oc,font:"12px Arial",align:"center"}]},M.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),rr.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var n=rr.EdgeElevationGuide.data,x=n.x,w=n.y,i=jk.getStyle("curveElevationIntersectSize"),k=jk.getStyle("curveElevationGuideShift");return x+=k[0],w+=k[1],[x-i,w-i,2*i,2*i]}}}]},M.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),M.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),rr.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return rr.ConnectGuide.data.rotation}},rect:{func:function(){var d=rr.ConnectGuide.data.connect;d.x,d.y;var k=jk.getStyle("connectGuideIntersectSize");return[[d.x,d.y],2*k,2*k]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var Q=rr.ConnectGuide.data.cursorPos||rr.ConnectGuide.data.connect,w=jk.getStyle("connectGuideIntersectSize");return[[Q.x,Q.y],2*w-2,2*w-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var O=rr.ConnectGuide.data.connect,P=rr.ConnectGuide.data.cursorPos||O;return[O.x,O.y,O.x+.5*(P.x-O.x),O.y,P.x+.5*(O.x-P.x),P.y,P.x,P.y]}}}]},M.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),M.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),rr.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var M=rr.ConnectGuideGarbage.data.hover;return M?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var t=rr.ConnectGuideGarbage.data,_=jk.getStyle("connectGuideGarbageIntersectsize");return t.hover&&(_+=5),[[t.x,t.y],2*_,2*_]}}}]};var Wd=6;rr.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return rr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var i=rr.ShapeActivingCtrl.data;return[i.point.x,i.point.y,i.c1.x,i.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Ye},{type:"shape",visible:{func:function(){return rr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var L=rr.ShapeActivingCtrl.data;return[L.point.x,L.point.y,L.c2.x,L.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Ye},{type:"shape",visible:{func:function(){return rr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var d=rr.ShapeActivingCtrl.data.c1,x=d.x,n=d.y,m=Wd/2;return"c1"===rr.ShapeActivingCtrl.data.hl&&(m+=.5),[x-m,n-m,x-m,n+m,x+m,n+m,x+m,n-m]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===rr.ShapeActivingCtrl.data.hl?jk.getStyle("shapeCtrlPointHighlightBorder")||Ye:jk.getStyle("shapeCtrlPointBorderColor")||Ye}}},{type:"shape",visible:{func:function(){return rr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var Y=rr.ShapeActivingCtrl.data.c2,g=Y.x,U=Y.y,V=Wd/2;return"c2"===rr.ShapeActivingCtrl.data.hl&&(V+=.5),[g-V,U-V,g-V,U+V,g+V,U+V,g+V,U-V]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===rr.ShapeActivingCtrl.data.hl?jk.getStyle("shapeCtrlPointHighlightBorder")||Ye:jk.getStyle("shapeCtrlPointBorderColor")||Ye}}}]},Gj.Icons.DrawIcon=function(b,S,c,m){c.width=c.height=zr,c.data=m,jk=b,M.Default.drawImage(S,c,0,0,zr,zr)},Gj.Icons.MapPoints=function($,E){for(var N=0,b=$.length;b>N;N++)$[N]/=E},Gj.roundTo=function(F,t,c){var R=Math.abs(F%t);return c>R||c>t-R?t*Math.round(F/t):F},Gj.toFixed=function(N){return Math.round(100*N)/100},Gj.getDataMatrix=function(U){if(U instanceof M.Shape){var N=new Gj.Math.Matrix2,R=U.getPosition();return N.translate(-R.x,-R.y).scale(U.getScale().x,U.getScale().y).rotate(U.getRotation()).translate(R.x,R.y),N}return U.getMatrix?U.getMatrix():new Gj.Math.Matrix2};var mq=Gj.Math.Curve=function(){this._curves=[]};mq.prototype={},mq.prototype.constructor=mq,mq.prototype.createFromHtShape=function(x,R,q){R instanceof M.List&&(R=R.toArray());var e,P,N,L,T,v,h,r=this,E=null,W=null,$=0,l=Gj.Math.Vector2,X=Gj.Math.CubicBezier,a=function(K){return new l(x[K],x[K+1],q?q[K/2]:d)};for(P=0,N=R.length;N>P;P++){switch(L=R[P],T=null,L){case 1:W=a($),E=W,$+=2;break;case 2:e=a($),$+=2,T=new X(W,W.clone(),e.clone(),e),W=e;break;case 3:v=a($),e=a($+2),$+=4,T=new X(W,v.clone().sub(W).multiplyScalar(2/3).add(W),v.clone().sub(e).multiplyScalar(2/3).add(e),e),W=e;break;case 4:v=a($),h=a($+2),e=a($+4),$+=6,T=new X(W,v,h,e),W=e;break;case 5:if(!E)break;T=new X(W,W.clone(),E.clone(),E),W=null,E=null}T&&(T._index=r._curves.length,r._curves.push(T))}},mq.prototype.checkPoint=function(V,z){var _,M,f,L,Q,c=this,U=c._curves;for(_=0,M=U.length;M>_;_++)if(L=U[_],Q=L.intersectRect(V,z,z),Q.length)return f=0,Q.forEach(function(n){f+=n.t}),f/=Q.length,V=L.getPointAt(f),V.t=f,{bezier:L,intersection:V}},mq.prototype.insertKnot=function(T,M){var x=T.insertKnot(M),P=this,v=P._curves;v.splice(T._index,1,x[0],x[1])},mq.prototype._isCloseEnough=function(O,s){return Math.abs(O.x-s.x)<1e-6&&Math.abs(O.y-s.y)<1e-6},mq.prototype._isSamePoint=function(t,l){return t===l},mq.prototype.moveRealPoint=function(x,c){var Y=this,X=Y._curves,u=c.clone().sub(x);X.forEach(function(I){var k=I._p1;I._p2,I._p3;var q=I._p4;Y._isSamePoint(k,x)&&(I._p2.add(u),I._p1=c),Y._isSamePoint(q,x)&&(I._p3.add(u),I._p4=c)})},mq.prototype.moveCtrlDueToRealPointMovement=function(A,F){var I=this,V=I._curves,W=function(C){C.add(F),C.e&&F.e&&(C.e+=F.e)};V.forEach(function(x){var k=x._p1;x._p2,x._p3;var $=x._p4;I._isSamePoint(k,A)&&W(x._p2),I._isSamePoint($,A)&&W(x._p3)})},mq.prototype.moveCtrlPoint=function(N,J,p){var P=N[p];if(P){P.e!==d&&(J.e=P.e);var e=this,H=e._curves;J.clone().sub(P),H.forEach(function(S){var O;"c2"===p?O="_p2":"c1"===p&&(O="_p3"),e._isSamePoint(S[O],P)&&(S[O]=J)}),N[p]=J}},mq.prototype.deleteRealPoint=function(v,W){var Z,K,m,G,z,k,X,S=this,c=S._curves,p={},r=[],H=Gj.Math.CubicBezier;for(K=0,m=c.length;m>K;K++)Z=c[K],G=Z._p1,z=Z._p2,k=Z._p3,X=Z._p4,(p[K]||!S._isSamePoint(G,v))&&(S._isSamePoint(X,v)?m>K+1&&S._isSamePoint(c[K+1]._p1,v)&&(W||r.push(new H(G,z,c[K+1]._p3,c[K+1]._p4))):r.push(Z));S._curves=r},mq.prototype.findPairs=function(R,c){var g,r,p,P,m,S,M,W,u=this,x=u._curves,L={},j=[];for(r=0,p=x.length;p>r;r++)g=x[r],P=g._p1,m=g._p2,S=g._p3,M=g._p4,!L[r]&&u._isSamePoint(P,R)&&(c?j.push({point:P,r2:M}):j.push({point:P,c2:m})),u._isSamePoint(M,R)&&(W=c?{point:M,r1:P}:{point:M,c1:S},p>r+1&&u._isSamePoint(x[r+1]._p1,R)&&(c?W.r2=x[r+1]._p4:W.c2=x[r+1]._p2,L[r+1]=!0),j.push(W));return j},mq.prototype.toHtShape=function(){var m=this,f=m._curves,z=[],G=[],N={x:1/0,y:1/0};return f.forEach(function(a){var X=a._p1,R=a._p2,L=a._p3,$=a._p4;return m._isCloseEnough(X,N)||(z.push(1),G.push(X.clone())),N=$,m._isCloseEnough(X,R)&&m._isCloseEnough(L,$)?(z.push(2),G.push($.clone()),void 0):(z.push(4),G.push(R.clone(),L.clone(),$.clone()),void 0)}),{segments:z,points:G}};var yq=Gj.Math.CubicBezier=function(f,q,p,G){var C=this;C._id=Gj.Math.CubicBezier._globalId++,C._p1=f,C._p2=q,C._p3=p,C._p4=G};yq._globalId=1,yq.prototype={},yq.prototype.constructor=yq,yq.prototype.toString=function(){return this._id},yq.prototype.intersectRect=function(F,l,o){var i=l/2,Z=o/2,w=F.x,d=F.y,N=Gj.Math.Vector2,z=new N(-i+w,-Z+d),h=new N(i+w,Z+d),b=new N(h.x,z.y),s=new N(z.x,h.y),k=this,e=k.intersectLine(z,b),L=k.intersectLine(b,h),j=k.intersectLine(h,s),C=k.intersectLine(s,z),D=e.concat(L).concat(j).concat(C);return D},yq.prototype.intersectLine=function(f,B){var w,m,r,u,k,c,T,O,s,V,M,L,A,R=this,v=f.clone().min(B),z=f.clone().max(B);u=R._p1,k=R._p2,c=R._p3,T=R._p4,w=u.clone().multiplyScalar(-1),m=k.clone().multiplyScalar(3),r=c.clone().multiplyScalar(-3),M=w.add(m).add(r).add(T),w=u.clone().multiplyScalar(3),m=k.clone().multiplyScalar(-6),r=c.clone().multiplyScalar(3),V=w.add(m).add(r),w=u.clone().multiplyScalar(-3),m=k.clone().multiplyScalar(3),s=w.add(m),O=u.clone(),A=new Gj.Math.Vector2(f.y-B.y,B.x-f.x),L=f.x*B.y-B.x*f.y;for(var n=R.getRoots(A.dot(M),A.dot(V),A.dot(s),A.dot(O)+L),e=new Array,N=0,Q=n.length;Q>N;N++){var U=n[N];if(!(0>U||U>1)){var P=u.clone().lerp(k,U),Y=k.clone().lerp(c,U),$=c.clone().lerp(T,U),C=P.lerp(Y,U),l=Y.lerp($,U),H=C.lerp(l,U);H.t=U,f.x==B.x?v.y<=H.y&&H.y<=z.y&&e.push(H):f.y==B.y?v.x<=H.x&&H.x<=z.x&&e.push(H):H.x>=v.x&&H.y>=v.y&&H.x<=z.x&&H.y<=z.y&&e.push(H)}}return e},yq.prototype.solveTForPoint=function(S){var $,g,V,U,y=this;$=y._p1.x-S.x,g=y._p2.x-S.x,V=y._p3.x-S.x,U=y._p4.x-S.x;for(var k=y.getRoots(U-3*V+3*g-$,3*V-6*g+3*$,3*g-3*$,$),z=d,M=1/0,o=0,H=k.length;H>o;o++){var f=k[o];if(!(0>f||f>1)){var Z=y._p1.clone().lerp(y._p2,f),h=y._p2.clone().lerp(y._p3,f),j=y._p3.clone().lerp(y._p4,f),n=Z.lerp(h,f),K=h.lerp(j,f),O=n.lerp(K,f);O.t=f;var B=Math.abs(O.y-S.y);M>B&&(M=B,z=O)}}return z},yq.prototype.getPointAt=function(f){var t=this,b=t._p1,l=t._p2,D=t._p3,P=t._p4,I=b.clone().lerp(l,f),Q=l.clone().lerp(D,f),$=D.clone().lerp(P,f),d=I.lerp(Q,f),H=Q.lerp($,f);return d.lerp(H,f)},yq.prototype.getRoots=function(F,$,D,O){var f,B,i,v,m,R=new Array;if(Math.abs(F)<1e-6){var f=$,B=D/f,i=O/f,v=B*B-4*i;if(v>0){var m=Math.sqrt(v);R.push(.5*(-B+m)),R.push(.5*(-B-m))}else 0==v&&R.push(.5*-B)}$/=F,D/=F,O/=F,f=(3*D-$*$)/3,B=(2*$*$*$-9*D*$+27*O)/27;var L=$/3,c=B*B/4+f*f*f/27,T=B/2;if(Math.abs(c)<=1e-6&&(c=0),c>0){var p,s,m=Math.sqrt(c);p=-T+m,s=p>=0?Math.pow(p,1/3):-Math.pow(-p,1/3),p=-T-m,p>=0?s+=Math.pow(p,1/3):s-=Math.pow(-p,1/3),R.push(s-L)}else if(0>c){var K=Math.sqrt(-f/3),J=Math.atan2(Math.sqrt(-c),-T)/3,S=Math.cos(J),l=Math.sin(J),N=Math.sqrt(3);R.push(2*K*S-L),R.push(-K*(S+N*l)-L),R.push(-K*(S-N*l)-L)}else{var p;p=T>=0?-Math.pow(T,1/3):Math.pow(-T,1/3),R.push(2*p-L),R.push(-p-L)}return R},yq.prototype._70I=function(){var e=this;return e._p1.distanceToSquared(e._p2)<1e-10&&e._p3.distanceToSquared(e._p4)<1e-10},yq.prototype.insertKnot=function(y){var z=this,c=z._p1,i=z._p2,v=z._p3,T=z._p4,w=c.clone().lerp(i,y),h=i.clone().lerp(v,y),k=v.clone().lerp(T,y),q=w.clone().lerp(h,y),O=h.clone().lerp(k,y),V=q.clone().lerp(O,y);return z._70I()?(c.clone().lerp(T,y),[new Gj.Math.CubicBezier(c,c.clone(),V.clone(),V),new Gj.Math.CubicBezier(V,V.clone(),T.clone(),T)]):[new Gj.Math.CubicBezier(c,w,q,V),new Gj.Math.CubicBezier(V,O,k,T)]};var ms=M.Default.getInternal().ui().EdgeUI,am={_47O:function(r){var K=this,c=am.getBackups()._47O;Gj.inEdit(K.gv)||c.call(K,r)}};Gj.Inject.registAsModule(am,ms);var df=M.Default.getInternal().ui().NodeUI,Yk={_47O:function(o){var n=this,X=Yk.getBackups()._47O;Gj.inEdit(n.gv)||X.call(n,o)},getSelectWidth:function(){var i=this,S=i.gv,y=i._data;if(S.isEditable(y)&&Gj.inEdit(S))return 0;var K=Yk.getBackup("getSelectWidth");return K.call(i)}};Gj.Inject.registAsModule(Yk,df);var $k=M.graph.GraphView,io={_editPointSize:function(){var i=M.Default.isTouchable,f=Gj.getStyle("pointSize");return f[i?0:1]}(),isPointEditable:function(A){var U=this;if(Gj.inEdit(U))return U._pointEditableFunc?U._pointEditableFunc(A):!0;var W=io.getBackup("isPointEditable");W.call(U,A)},isEditable:function(W){var Z,d=this,E=io.getBackup("isEditable");if(Z=W instanceof Gj.Group?!0:E.call(d,W),!Gj.inEdit(d))return Z;if(!(W instanceof M.Edge))return Z;if(!W.s("2d.editable"))return!1;var u=d.getEditableFunc();return u?u(W):!0},_42:function(v,h){var c=this,S=io.getBackups()._42;if(S.call(c,v,h),Gj.inEdit(c)){var A=c.getEditInteractor();A.drawImpl()}}};Gj.Inject.registAsModule(io,$k);var je=M.Default.getInternal().ui().ShapeUI,bc={_47O:function(F){var r=this,g=bc.getBackups()._47O;Gj.inEdit(r.gv)||g.call(r,F)}};Gj.Inject.registAsModule(bc,je);var wc=M.graph.DefaultInteractor,Lc={handle_mousewheel:function($){var B=this,e=Lc.getBackup("handle_mousewheel");Gj.inEdit(B.gv)||e.call(B,$)}};Gj.Inject.registAsModule(Lc,wc);var Hi=M.graph.MoveInteractor,As={_calcShift:function(k,Y){var s=this,B=As.getBackup("_calcShift"),E=s.gv;if(!Gj.inEdit(E))return B.call(s,k,Y);var V=E.getEditInteractor(),R=V.getSubModule("Move").calcShift(k,Y,s);return R||B.call(s,k,Y)},clear:function(H){var f=this,Y=As.getBackup("clear");Y.call(f,H);var l=f.gv;if(Gj.inEdit(l)){var M=l.getEditInteractor();M.getSubModule("Move").clear(H)}}};Gj.Inject.registAsModule(As,Hi);var ul=Gj.Rect=function(d){this.catalog="Rect",this._interactor=d};ul.prototype={},ul.prototype.constructor=ul,ul.prototype.gatherInfo=function(C,i){var c=this;if(1===i.length){var s=i[0];return s instanceof M.Shape&&s._70I()?c.gatherLine(C,s):rq(s,C)?!1:c.gatherSingleTarget(C,s)}return i.length>1?c.gatherMultiTargets(C,i):!1},ul.prototype.gatherSingleTarget=function(K,l){if(l.getCorners){var T,C=this,W=C.info;C.target=l,T=C.screenInfo={};var O=l.getCorners();W.LT=new Gj.Math.Vector2(O[0]),W.LB=new Gj.Math.Vector2(O[1]),W.RB=new Gj.Math.Vector2(O[2]),W.RT=new Gj.Math.Vector2(O[3]),W.T=W.LT.clone().add(W.RT).divideScalar(2),W.B=W.LB.clone().add(W.RB).divideScalar(2),W.L=W.LT.clone().add(W.LB).divideScalar(2),W.R=W.RT.clone().add(W.RB).divideScalar(2);for(var J in W)T[J]=Gj.toScreenPosition(K,W[J]);var N=C._interactor,Z=N.getStyle("checkSize"),b=function(X,P,s){var U=P.clone().sub(X).setLength(-Z),N=s.clone().sub(X).setLength(-Z),p=U.add(N).add(X);return p};return T.rotLT=b(T.LT,T.RT,T.LB),T.rotLB=b(T.LB,T.LT,T.RB),T.rotRB=b(T.RB,T.LB,T.RT),T.rotRT=b(T.RT,T.LT,T.RB),T.rotT=T.rotLT.clone().add(T.rotRT).divideScalar(2),T.rotB=T.rotLB.clone().add(T.rotRB).divideScalar(2),T.rotL=T.rotLT.clone().add(T.rotLB).divideScalar(2),T.rotR=T.rotRT.clone().add(T.rotRB).divideScalar(2),T.rotation=l.getRotation(),C.gatherConnectInfo(),!0}},ul.prototype.gatherConnectInfo=function(){var k=this,Z=k.target,m=k._interactor,J=k.screenInfo,U=m.gv;if(Z instanceof M.Node&&m.getStyle("connectGuideVisible")){var H=Z.s("connectGuideShift")||m.getStyle("connectGuideShift"),K=Z.getAnchor(),q=Z.getSize(),f=Z.toGlobal({x:q.width*(H[0]-K.x),y:q.height*(H[1]-K.y)});f=Gj.toScreenPosition(U,f),J.P1?f.add(J.P2.clone().sub(J.P1).setLength(H[2])):(f.add(J.RT.clone().sub(J.LT).setLength(H[2])),f.add(J.LB.clone().sub(J.LT).setLength(H[3]))),J.connect=f}},ul.prototype.gatherMultiTargets=function(p,Z){var P=Gj.Group.findOrCreateGroup(Z);if(!P)return!1;var y=this;return y.editing&&"rotate"!==y.editing.mode||P.calcInfo(),y.gatherSingleTarget(p,P)},ul.prototype.gatherLine=function(m,O){this.target=O;var U=this.screenInfo={},g=O.getPoints(),b=Gj.getDataMatrix(O);return U.P1=Gj.toScreenPosition(m,b.apply(g.get(0))),U.P2=Gj.toScreenPosition(m,b.apply(g.get(1))),this.gatherConnectInfo(),!0},ul.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],ul.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],ul.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],ul.prototype.check=function(L,r,b){if(M.Default.isLeftButton(r)){var C=this;if(C.editing=null,C.tipInfo=null,C.screenInfo){var f=C.target,W=L.isEditable(f),p=C.screenInfo;if(W&&p.connect){var a=C._checkConnect(b);if(a)return a}if(p.P1)return C._checkLine(b);var Z,t,l,i=null,x=C._interactor,S=x.getStyle("checkSize");if(W&&L.isRectEditable(f))for(t=0;t<Gj.Rect.ResizeKeys.length;t++)if(l=Gj.Rect.ResizeKeys[t],Gj.checkHit(b,p[l],S)){i=l,Z="resize";break}if(!i&&W&&L.isRotationEditable(f)){var $=x.getStyle("rotateCheckSize");for(t=0;t<Gj.Rect.RotateKeys.length;t++)if(l=Gj.Rect.RotateKeys[t],Gj.checkHit(b,p[l],$)){i=l,Z="rotate";break}}if(!i)return x.setCursor("default"),void 0;if("rotate"===Z){var d,A=L.lp(r);if(f instanceof Gj.Group){var B=x.getStyle("groupRotateModeKey");"string"==typeof B&&(B=[B]);for(var y=!1,e=0,w=B.length;w>e;e++)if(r[B[e]]){y=!0;break}var m=x.getStyle("groupRotateModeDefault");d=y?"batch"===m?"block":"batch":m}var O="batch"===d?f.getAnchor2():f.getPosition(),g=Math.atan2(A.y-O.y,A.x-O.x);x._setRotateCursor(g),C.editing={mode:Z,key:i,pos:O,flipY:f.getScale().y<0,rotation:f.getRotation(),hitRot:g},d&&(C.editing.groupRotateMode=d)}else{var D=Gj.Rect.ResizeKeys.indexOf(i),I=Gj.Rect.ResizeDirection[D],n=Math.cos(f.getRotation()),N=Math.sin(f.getRotation()),Y=I.x*Math.sign(f.getScale().x),c=I.y*Math.sign(f.getScale().y),T=Math.atan2(-N*Y-n*c,n*Y-N*c),s=(Math.round(T/(Math.PI/4))+8)%8,v=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][s];this._interactor.setCursor(v);var G=f.getWidth(),j=f.getHeight(),E=f.getAnchor();C.editing={mode:Z,key:i,rect:{x:-G*E.x,y:-j*E.y,width:G,height:j},anchor:E,matrix:f.getMatrix()}}return i}}},ul.prototype._checkLine=function(H){var c=this;c.screenInfo;var k,A=c._interactor.getStyle("checkSize");if(Gj.checkHit(H,c.screenInfo.P1,A))k="P1";else{if(!Gj.checkHit(H,c.screenInfo.P2,A))return this._interactor.setCursor("default"),void 0;k="P2"}return c.editing={mode:"line",key:k},k},ul.prototype._checkConnect=function(k){var y=this,z=y.screenInfo,S=y._interactor,E=S.getStyle("connectGuideIntersectSize"),f=z.connect,U=k.x,d=f.x;if(d>U&&E>d-U&&Math.abs(f.y-k.y)<E||U>=d&&Gj.checkHit(k,f,E)){var q="connect",W=Q.getConnectAction(S.gv);return y.editing={mode:q},W&&W.delete&&W.delete.visible.call(null,S.gv,y.target)&&(y.editing.hasDeleteAction=!0),S.setCursor("default"),q}},ul.prototype._fireEditEvent=function(r,V){var f=this._interactor,d=this.editing;if(d){var p=d.mode;p="rotate"===p?"Rotation":"connect"===p?"Connection":p[0].toUpperCase()+p.slice(1),f.fi({kind:r+"Edit"+p,event:V})}},ul.prototype.startEdit=function(F,_){F.startDragging(_);var g=this;g._interactor.fi({kind:"prepareEdit",event:_});var T=g.editing,O=g.target;if(T){if(g._fireEditEvent("begin",_),"rotate"===T.mode)return T.groupRotateMode&&O.beginRotate(T),void 0;if("connect"!==T.mode)("line"===T.mode||O&&0===O.getRotation())&&(g._inSmartGuide=!0,g._interactor.rectGuide.gatherRects());else if(T.hasDeleteAction){var q=F.gv,G=g._interactor.getStyle("connectGuideGarbageShift");T.garbageInfo={x:q.getWidth()*G[0]+G[2],y:q.getHeight()*G[1]+G[3],size:g._interactor.getStyle("connectGuideGarbageIntersectsize")},F._42()}}},ul.prototype._46O=function(J){var l,T=this,r=T.editing;if(r){if("connect"===r.mode&&!r.canceled&&!r.deleted)try{r.garbageInfo&&r.garbageInfo.hover?Q.doDeleteConnectionAction(T._interactor.gv,T.target):Q.doConnectAction(T._interactor.gv,T.target,r.target)}catch(P){console.error(P)}l=T.editing.groupRotateMode,T._fireEditEvent("end",J),T.editing=null}T.tipInfo=null,T._inSmartGuide&&(T._interactor.rectGuide.clear(),T._inSmartGuide=!1),l&&T.target&&T.target.endRotate()},ul.prototype.handleNormalStateDelete=function(){var D=this,c=D.editing;if(c&&"connect"===c.mode&&!c.canceled&&!c.deleted){if(c.garbageInfo){try{Q.doDeleteConnectionAction(D._interactor.gv,D.target)}catch(Z){console.error(Z)}c.garbageInfo=null}return c.cursorPos=null,c.targetCorners=null,c.deleted=!0,D._interactor._42(),!0}},ul.prototype.handleNormalStateKeyDown=function(N){var t=this,J=t.editing;return!J||"connect"!==J.mode||J.canceled||J.deleted?void 0:M.Default.isEsc(N)?(J.cursorPos=null,J.targetCorners=null,J.canceled=!0,t._interactor._42(),!0):void 0},ul.prototype.handleEdit=function(F,D){var V=this,I=V.editing;if(I){var w,y,a,q,G,W=V.target,C=I.key,U=I.mode,T=F.lp(D),A=V._interactor;if("connect"===U){if(I.canceled)return;if(I.deleted)return;I.cursorPos=A._getLogicalPoint(D);var X=I.garbageInfo;return X&&Gj.checkHit(I.cursorPos,X,X.size)?(X.hover=!0,I.target=null,I.targetCorners=null):(X&&(X.hover=!1),I.target=F.getDataAt(T,function(N){return F.isSelectable(N)?Oh(N)?!0:!1:!1})||null,I.targetCorners=Gj.getTargetCornersOnScreen(F,I.target)),A._42(),void 0}if("rotate"===U){var b,n,K=I.pos,r=Math.atan2(T.y-K.y,T.x-K.x);if(I.groupRotateMode?n=r-I.hitRot:(b=r-I.hitRot,n=I.rotation+b),n%=2*Math.PI,0>n&&(n+=2*Math.PI),!M.Default.isCtrlDown(D)){var P,g;of(D)?(P=A.getStyle("shiftRotateRound"),g=P/2):(P=A.getStyle("rotateRound"),g=A.getStyle("rotateSensitivity")),n=Gj.roundTo(n,P,g)}I.groupRotateMode?(b=n-(I.lastRotation||0),0!==b&&(W.addRotation(b,I.groupRotateMode),I.lastRotation=n)):W.setRotation(n),A._setRotateCursor(r),n>Math.PI&&(n-=2*Math.PI);var H=180*(n/Math.PI);H=H.toFixed(2),w=""+H+"°"}else if("resize"===U){var J=I.rect;a=J.x,q=J.y;var z,L=J.width,f=J.height,O=I.anchor,d=I.matrix,j=of(D),$=V._unionPointMode1,v=V._unionPointMode2;if(V._inSmartGuide&&!M.Default.isCtrlDown(D)&&!j){var Y;"L"===C||"R"===C?Y="x":("T"===C||"B"===C)&&(Y="y"),V._adsorbedToClosest(T,Y),G=!0}z=d.tfi(T);var _;"LT"===C?(J=$(z,{x:a+L,y:q+f},L,f,j),_=9):"T"===C?(J=v({x:a,y:z.y},{x:a+L,y:q+f},L,f,j,"v"),_=1):"RT"===C?(J=$(z,{x:a,y:q+f},L,f,j),_=33):"L"===C?(J=v({x:z.x,y:q},{x:a+L,y:q+f},L,f,j,"h"),_=8):"R"===C?(J=v({x:a,y:q},{x:z.x,y:q+f},L,f,j,"h"),_=32):"LB"===C?(J=$(z,{x:a+L,y:q},L,f,j),_=12):"B"===C?(J=v({x:a,y:q},{x:a+L,y:z.y},L,f,j,"v"),_=4):"RB"===C&&(J=$(z,{x:a,y:q},L,f,j),_=36);var m=d.tf(J.x+J.width*O.x,J.y+J.height*O.y);W.setPosition(m),W.setSize(J.width,J.height),G&&(y=W.getRect(),A.rectGuide.gatherLines({node:W,x:y.x,y:y.y,w:y.width,h:y.height},Y,_)),w=""+Math.round(J.width)+" * "+Math.round(J.height)}else if("line"===U){if(of(D)){var Z=W.getPoints(),N="P1"===C?Z.get(1):Z.get(0),Q={x:T.x-N.x,y:T.y-N.y},k=A.getStyle("shiftLineRotateRound"),B=V._shiftDirList;
if(!B||V._shiftRotateRound!==k){V._shiftRotateRound=k,V._shiftDirList=B=[];for(var i=0;i<Math.PI;i+=k)B.push({x:R(i),y:E(i)})}for(var s,u=0,l=0,p=B.length;p>l;l++){var c=B[l],x=c.x*Q.x+c.y*Q.y;Math.abs(x)>Math.abs(u)&&(u=x,s=c)}T={x:N.x+s.x*u,y:N.y+s.y*u},A.rectGuide.clear()}else V._inSmartGuide&&!M.Default.isCtrlDown(D)&&(V._adsorbedToClosest(T),G=!0);var o=Gj.getDataMatrix(W).applyInverse(T);W.setPoint("P1"===C?0:1,o,!0);var e=W.getPoints(),S=e.get(0),h=e.get(1);a=S.x-h.x,q=S.y-h.y,w=" "+Math.round(Math.sqrt(a*a+q*q))+" ",G&&(y=W.getRect(),A.rectGuide.gatherLines({node:W,x:y.x,y:y.y,w:y.width,h:y.height}))}if(w){var t=M.Default.getLogicalPoint(D,A._canvas);t.x+=Gj.Icons.TipShiftX,t.y+=Gj.Icons.TipShiftY,V.tipInfo={helperPos:t,text:w,size:w.length}}V._fireEditEvent("between",D)}},ul.prototype._unionPointMode1=function(w,X,Y,p,I){if(I&&Y&&p){var A=w.x-X.x,s=w.y-X.y;Math.abs(A*p)<Math.abs(s*Y)?(s=Math.sign(s)*Math.abs(A*p/Y),w.y=X.y+s):(A=Math.sign(A)*Math.abs(s*Y/p),w.x=X.x+A)}return M.Default.unionPoint(w,X)},ul.prototype._unionPointMode2=function(P,E,s,D,t,u){var a=M.Default.unionPoint(P,E);if(t&&s&&D){var m;"v"===u?(m=a.x+a.width/2,a.width=s*a.height/D,a.x=m-a.width/2):(m=a.y+a.height/2,a.height=D*a.width/s,a.y=m-a.height/2)}return a},ul.prototype._adsorbedToClosest=function(q,$){var p=this,H=p._interactor,S=H.rectGuide.findClosest(q,$),f=H.gridGuide.findClosest(q,$),N=1/0,X=1/0;S&&(isFinite(S.x)&&(N=S.x),isFinite(S.y)&&(X=S.y)),f&&(isFinite(f.x)&&Math.abs(f.x)<Math.abs(N)&&(N=f.x),isFinite(f.y)&&Math.abs(f.y)<Math.abs(X)&&(X=f.y)),isFinite(N)&&(q.x+=N),isFinite(X)&&(q.y+=X)},ul.prototype._42=function(l,k,A){var p=this;p.info={},p.screenInfo=null;var e=p._interactor;if(!e.editDetail&&p.gatherInfo(k,A)){var i=p.editing,I=i?i.groupRotateMode:null,g=p.screenInfo;"block"!==I&&(g.P1?Gj.Icons.DrawIcon(e,l,Gj.Icons.Line,g):Gj.Icons.DrawIcon(e,l,Gj.Icons.Rect,g),g.connect&&(Gj.Icons.DrawIcon(e,l,Gj.Icons.ConnectGuide,{rotation:g.rotation,connect:g.connect,cursorPos:i?i.cursorPos:null}),i&&(i.targetCorners&&Gj.Icons.DrawIcon(e,l,Gj.Icons.NodeHoverGuide,i.targetCorners),i.garbageInfo&&Gj.Icons.DrawIcon(e,l,Gj.Icons.ConnectGuideGarbage,i.garbageInfo))),p.tipInfo&&Gj.Icons.DrawIcon(e,l,Gj.Icons.TipHelper,p.tipInfo)),p.target instanceof Gj.Group&&p.target._42(e,l,k)}};var vr=Gj.Anchor=function(m){this.catalog="Anchor",this._interactor=m};vr.prototype={},vr.prototype.constructor=vr,vr.prototype.gatherInfo=function(l,k){var K=this;if(1===k.length){var b=k[0];if(!b.getAnchor)return;if(b instanceof M.Shape&&b._70I())return;if(rq(b,l))return;return K.gatherSingleTarget(l,k[0])}return k.length>1?K.gatherMultiTargets(l,k):!1},vr.prototype.gatherSingleTarget=function(E,X){var K=this;return K.info.POS=X.getPosition(),K.screenInfo.POS=Gj.toScreenPosition(E,K.info.POS),K.target=X,!0},vr.prototype.gatherMultiTargets=function(A,b){var k=this,H=Gj.Group.findOrCreateGroup(b);return H?(k.screenInfo.POS=Gj.toScreenPosition(A,H.getAnchor2()),k.target=H,!0):!1},vr.prototype.isVisible=function(){var a=this,A=a._interactor;if(A.getStyle("anchorVisible")===!1)return!1;var I=a.target;if(I){if(this.editing)return!0;var O=I.getAnchor(),P=A.getStyle("anchorOutsideVisibleThreshold");if(O.x<-P||O.x>1+P||O.y<-P||O.y>1+P)return!0;var D=I.getSize(),d=I.getScale(),p=Math.min(Math.abs(D.width*d.x),Math.abs(D.height*d.y));if(p*A.gv._zoom<A.getStyle("anchorHideThreshold"))return!1}return!0},vr.prototype.check=function(B,$,x){if(M.Default.isLeftButton($)){var g=this,b=g._interactor;if(g.isVisible()&&b.getStyle("anchorMovable")!==!1){g.editing=null,g.tipInfo=null;var r=g.target;if(r&&B.isAnchorEditable(r)&&B.isEditable(r)){var T;if(g.screenInfo&&(T=g.screenInfo.POS)&&Gj.checkHit(x,new Gj.Math.Vector2(T),b.getStyle("checkSize"))){if(r instanceof Gj.Group)return g.editing={},!0;var s=r.getWidth(),y=r.getHeight(),w=r.getAnchor();return g.editing={rect:{x:-s*w.x,y:-y*w.y,width:s,height:y},anchor:w,matrix:r.getMatrix()},!0}}}}},vr.prototype.startEdit=function(b,Y){b.startDragging(Y),b.fi({kind:"beginEditAnchor",event:Y})},vr.prototype._46O=function(m){var P=this;P.editing&&(P.editing=null,P._interactor.fi({kind:"endEditAnchor",event:m})),P.tipInfo=null},vr.prototype.handleEdit=function(e,v){var Z=this,N=Z.target;if(N){var F=Z.editing;if(F){var o=e.lp(v),d=Z._interactor;if(N instanceof Gj.Group)return N.setAnchor2(o),d._42(),void 0;var h=F.matrix,l=h.tfi(o),H=F.rect,P=(l.x-H.x)/H.width,g=(l.y-H.y)/H.height;if(!M.Default.isCtrlDown(v)){var L=d.getStyle("anchorRound"),S=d.getStyle("anchorSensitivity");P=Gj.roundTo(P,L,S),g=Gj.roundTo(g,L,S)}N.setAnchor(P,g,!0);var Q=M.Default.getLogicalPoint(v,d._canvas);Q.x+=Gj.Icons.TipShiftX,Q.y+=Gj.Icons.TipShiftY;var w=""+P.toFixed(2)+", "+g.toFixed(2);Z.tipInfo={helperPos:Q,text:w,size:w.length},d.fi({kind:"betweenEditAnchor",event:v})}}},vr.prototype._42=function(G,X,J){var Q=this;Q.info={},Q.screenInfo={};var E=Q._interactor;E.editDetail||Q.gatherInfo(X,J)&&Q.isVisible()&&(Gj.Icons.DrawIcon(E,G,Gj.Icons.Anchor,Q.screenInfo),Q.tipInfo&&Gj.Icons.DrawIcon(E,G,Gj.Icons.TipHelper,Q.tipInfo))};var mq=Gj.Curve=function(A){this.catalog="Curve",this._interactor=A};mq.prototype={},mq.prototype.constructor=mq,J.defineProperties(mq.prototype,{activing:{get:function(){return this._activing},set:function(i){var O=this;if(i)O._activing=new Gj.CurveActiving(this,i);else{var R=O._activing;R&&R.dispose(),O._activing=null}}}}),mq.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},mq.prototype.setUp=function(){var k=this,c=k._interactor;c&&c.gv.mp(k._onGraphviewPropertyChanged,k)},mq.prototype._onGraphviewPropertyChanged=function(G){("zoom"===G.property||"translateX"===G.property||"translateY"===G.property)&&this._handleDataChanged()},mq.prototype.tearDown=function(){var $=this,l=$._interactor;l&&l.gv.ump($._onGraphviewPropertyChanged,$)},mq.prototype.canEnterEditDetailMode=function(){var r=this,p=r._interactor,C=p._getValidSelection();if(1===C.length){var _=C[0],O=_ instanceof M.Edge;if(_ instanceof M.Shape||O){if(O){var R=_.s("edge.type");if(R&&"points"!==R)return}var L=p.gv;if(L.isPointEditable(_)&&L.isEditable(_))return r.target=_,!0}}},mq.prototype.preHandleScroll=function(){var A=this.editing;return A&&A.inEdit?!0:void 0},mq.prototype.getCurrentSelectintStatus=function(){var y=this;if(y.activing&&!y.activing.selections){if(y.activing.status!=d)return y.activing.status;var z=function(i){var j=y.activing.status;y.activing.status=i,y._interactor.fp("shapePointStatus",j,i)},U=Gj.Curve.PointType,K=y.activing.point,E=y.activing.pairs;if(!E||1!==E.length)return z(U.Mirrored);var h=E[0],v=h.c1&&h.c1.isNearEnough(K),G=h.c2&&h.c2.isNearEnough(K);if(!h.c1||!h.c2)return v||G?z(U.Straight):z(U.Disconnected);if(v&&G)return z(U.Straight);if(v||G)return z(U.Asymmetric);var L=h.c1.clone().sub(K),r=h.c2.clone().sub(K);return Math.abs(L.x*r.y-L.y*r.x)>1e-5||L.x*r.x>0?z(U.Disconnected):Math.abs(L.length()-r.length())>1e-5?z(U.Asymmetric):z(U.Mirrored)}},mq.prototype.handle_keydown=function(J){var R=this;if(R._interactor.editDetail){var r=Gj.Curve.PointType;"1"===J.key?R.setCurrentSelectionStatus(r.Straight):"2"===J.key?R.setCurrentSelectionStatus(r.Mirrored):"3"===J.key?R.setCurrentSelectionStatus(r.Disconnected):"4"===J.key&&R.setCurrentSelectionStatus(r.Asymmetric)}},mq.prototype.setCurrentSelectionStatus=function(e){var X=this,K=X.activing;if(K){var F=X.getCurrentSelectintStatus();if(null!==F&&F!==e){K.status=e;var N=X.activing.point,m=X.activing.pairs;if(m&&1===m.length){var B=m[0],b=X.screenInfo.curve,E=Gj.Curve.PointType,J=function(){X._writeToHt(),X._interactor.fp("shapePointStatus",F,e)};if(e===E.Straight)return b.moveCtrlPoint(B,N,"c1"),b.moveCtrlPoint(B,N,"c2"),J(),void 0;if(F===E.Straight){var z=b.findPairs(N,!0),p=z[0],H=p.r1||N,Q=p.r2||N,A=Q.clone().sub(H).multiplyScalar(.25);return b.moveCtrlPoint(B,N.clone().sub(A),"c1"),b.moveCtrlPoint(B,N.clone().add(A),"c2"),J(),void 0}var I=B.c1,q=B.c2;if(I&&q){if(e===E.Mirrored)return b.moveCtrlPoint(B,N.clone().multiplyScalar(2).sub(q),"c1"),J(),void 0;if(e===E.Asymmetric&&F===E.Disconnected){var C=I.clone().sub(N).length(),A=N.clone().sub(q).setLength(C).add(N);return b.moveCtrlPoint(B,A,"c1"),J(),void 0}}K._firePointChange(),X._interactor.fp("shapePointStatus",F,e)}}}},mq.prototype._handleDataChanged=function(j){var d=this;if(d.screenInfo&&d.target){var N=d._interactor;d.gatherSingleTarget(N.gv,d.target,!0),d.check(N.gv,null,j?N._getLogicalPoint(j):new Gj.Math.Vector2(N._lastClientPoint)),N._42()}},mq.prototype.gatherSingleTarget=function(i,L,E){var G,y,Z=this;Z.screenInfo&&Z.screenInfo.curve&&(y=Z.screenInfo.curve._curves);var l=Z.editing;G=l?Z.screenInfo:Z.screenInfo={};var j,z,_=L instanceof M.Edge;_?(j=L.s("edge.segments"),z=L.s("edge.points")||new M.List):(j=L._58O,z=L._59O),G.S=j;var P,W=G.P=[],T=Gj.getDataMatrix(L);if(L instanceof M.Polyline&&(P=L.getElevation()||0,G.E=[]),z.each(function(s){G.E&&G.E.push(s.e||P),s=T.apply(s);var g=Gj.toScreenPosition(i,s);W.push(g.x,g.y)}),_){var c=Gj.toScreenPosition(i,L._lastSourcePoint),N=Gj.toScreenPosition(i,L._lastTargetPoint);W.splice(0,0,c.x,c.y),W.push(N.x,N.y)}if(!G.S||!G.S.size()){G.S=new M.List,G.S.add(1);for(var b=0;b<W.length/2-1;b++)G.S.add(2)}if((!l||E)&&Z.convertToCubicBezier(y),Z.activing&&(E||!Z.editing||"realPoint"===Z.editing.type)){var h=G.curve.findPairs(Z.activing.point);Z.activing.pairs=h}_&&"points"!==L.s("edge.type")&&Z._writeToHt()},mq.prototype._convertToNewPoint=function(x,T,l){var R,W,U;for(R=0,W=T.length;W>R;R++){if(U=T[R],U._p1.isNearEnough(x))return U._p1;if(U._p4.isNearEnough(x))return U._p4}if(l)for(R=0,W=Math.min(l.length,W);W>R;R++){if(U=l[R],U._p1===x)return T[R]._p1;if(U._p4===x)return T[R]._p4}},mq.prototype.convertToCubicBezier=function(V){var g,B,m=this,C=new Gj.Math.Curve,W=m.screenInfo;if(C.createFromHtShape(W.P,W.S,W.E),W.curve=C,m.activing){var O=C._curves;if(g=m.activing.point,B=m._convertToNewPoint(g,O,V),B&&(m.activing.point=B),m.activing.selections){var E=-1,b=m.activing.selections;b.forEach(function(u){E++,B=m._convertToNewPoint(u,O,V),B&&(b[E]=B)})}}},mq.prototype.check=function(J,G,P){if(!G||M.Default.isLeftButton(G)){var t=this;if(t._interactor.setCursor("default"),t.editing=null,t.highlight=null,t.tipInfo=null,t.screenInfo){if(Qr())return t._interactor._42(),!0;if(t._checkEditCtrlPoint(P))return t._interactor._42(),!0;if(t._checkEditRealPoint(P))return t._interactor._42(),!0;if(t._checkEditElevation(P))return t._interactor._42(),!0;var n=t.screenInfo.curve,l=n.checkPoint(P,t._interactor.getStyle("curveIntersectSize"));if(l){var e=t.highlight={};e.type="insertKnot",e.bezier=l.bezier,e.point=l.intersection}return t._interactor._42(),!0}}},mq.prototype._checkEditRealPoint=function(a){var c,F,y,Y,S,O,e=this,X=e.screenInfo.curve._curves,J=e._interactor.getStyle("curvePointIntersectSize"),n=1/0;for(J*=J,y=0,Y=X.length;Y>y;y++)c=X[y],S=c._p1,O=a.distanceToSquared(S),n>O&&(n=O,F=S),S=c._p4,O=a.distanceToSquared(S),n>O&&(n=O,F=S);if(n>J)return!1;var z=e.highlight={};return z.type="changeRealPoint",z.point=F,e.editing={type:"realPoint",point:F,shiftGuide:{point:F.clone(),dir:"x",limit:0}},e._interactor.setCursor("crosshair"),!0},mq.prototype._checkEditElevation=function(h){var X=this;if(!X._interactor.getStyle("curveElevationVisible"))return!1;var L=X.activing;if(!L)return!1;var r=L.getCurrentEditingPoint();if(!r)return!1;var P=X._interactor,w=P.getStyle("curveElevationGuideShift"),c=P.getStyle("curveElevationIntersectSize"),z=h.distanceToSquared({x:r.x+w[0],y:r.y+w[1]});if(!(z>c*c)){var n=X.highlight={};n.type="elevation";var G=new Gj.Math.Vector2(h.x,h.y,r.e);return X.editing={type:"elevation",startPoint:G},X._interactor.setCursor("crosshair"),!0}},mq.prototype._checkEditCtrlPoint=function(G){var N=this;if(N.activing&&!N.activing.selections){var Z=N.getCurrentSelectintStatus();if(Z!==Gj.Curve.PointType.Straight){var H=N.activing.pairs;if(H){var v=N._interactor.getStyle("curvePointIntersectSize");v*=v;var C,K,D,e,Q,O,q,t,s,V=1/0;for(q=0,s=H.length;s>q;q++)for(e=H[q],t=0;2>t;t++)Q=0===t?"c1":"c2",e[Q]&&(O=G.distanceToSquared(e[Q]),V>O&&(V=O,C=e,K=q,D=Q));if(V>v)return!1;N.activing.hlpair=C,N.activing.hltype=D;var p=N.highlight={};return p.type="changeCtrlPoint",p.point=C[D],N.editing={type:"ctrlPoint",pair:C,pairId:K,ctrlType:D,direction:C[D].clone().sub(N.activing.point).normalize()},N._interactor.setCursor("crosshair"),!0}}}},mq.prototype.startEdit=function(p,Z){p.startDragging(Z);var X=this;X.highlight&&"insertKnot"===X.highlight.type&&(X.insertKnot(),X.gatherSingleTarget(X._interactor.gv,X.target),X.activing=null,X._checkEditRealPoint(X._interactor._getLogicalPoint(Z)));var P=X._activing;if(P){var F=X.editing?X.editing.type:null;"ctrlPoint"===F?P.editingCtrl={pairId:X.editing.pairId,type:P.hltype}:"realPoint"===F&&(P.editingCtrl=!1)}var t=X.highlight,S=M.Default.isCtrlDown(Z);if(!t||Qr()){var b=X._interactor.gv;if(!b.setFocus(Z)||b._scrolling)return;return b.isPannable()&&Fq(Z)&&!S&&(X._pan={tx:b.tx(),ty:b.ty()},p.fi({kind:"beginPan",event:Z})),void 0}if("changeRealPoint"===t.type){var u,e=X.activing?X.activing.point:null,q=X.activing?X.activing.selections:null;if(S&&X.activing)e===t.point?(q?(X.activing={point:q[0]},q.length>1&&(q.splice(0,1),X.activing.selections=q)):X.activing=null,X.editing=null):q&&(u=q.indexOf(t.point))>=0?(q.length>1?q.splice(u,1):delete X.activing.selections,X.editing=null):q?(q.push(e),X.activing={point:t.point,selections:q}):X.activing={point:t.point,selections:[e]};else if(q)e===t.point||((u=q.indexOf(t.point))>=0?(q.splice(u,1,e),X.activing={point:t.point,selections:q}):X.activing={point:t.point});else{var s;e===t.point&&(s=X.activing.status),X.activing={point:t.point},s&&(X.activing.status=s)}p.fi({kind:"beginEditPoint",event:Z})}},mq.prototype.insertKnot=function(){var e=this,n=e.highlight,d=e.screenInfo.curve;d.insertKnot(n.bezier,n.point.t),e._writeToHt()},mq.prototype._writeToHt=function(){var J,j,E,w,Q=this,C=Q.screenInfo.curve,b=C.toHtShape(),Z=b.points,y=[],v=b.segments,G=Q._interactor.gv,p=Q.target,D=p instanceof M.Edge,k=Gj.getDataMatrix(p).invert();w=p instanceof M.Polyline,w&&(E=p.getElevation());for(var u=0,U=Z.length;U>u;u++)J=Z[u],j=Gj.toWorldPosition(G,J),j=k.apply(j),J.e!=d&&J.e!==E&&(j.e=J.e),y.push(j);if(p._writing=!0,D){p.s("edge.type","points"),p.setStyle("edge.segments",v),p.setStyle("edge.points",y.slice(1,y.length-1)),p.setStyle("edge.source.offset.x",0),p.setStyle("edge.source.offset.y",0),p.setStyle("edge.target.offset.x",0),p.setStyle("edge.target.offset.y",0);var X=Q._nextChangeEdgeHost;delete Q._nextChangeEdgeHost,X&&("source"===X.type?p.setSource(X.host):p.setTarget(X.host)),Q._writeEdgeHostAnchor("source",y[0]),Q._writeEdgeHostAnchor("target",y[y.length-1])}else y.length?(p.setSegments(v),p.setPoints(y,!0)):p.removeFromDataModel();delete p._writing},mq.prototype._writeEdgeHostAnchor=function(K,a){var z=this,h=z.target,B=z._calcHostAnchor(h,K,a);h.s("edge."+K+".anchor.x",B.x),h.s("edge."+K+".anchor.y",B.y)},mq.prototype._calcHostAnchor=function(Z,L,u,e){e||(e="source"===L?Z.getSource():Z.getTarget());var P=e.getRotation(),k=e.getAnchor(),x=this._interactor.gv;if(rq(e,x)&&(P=0),P){var F=e.getMatrix(),Q=F.tfi(u),X=e.getSize();return{x:Q.x/X.width+k.x,y:Q.y/X.height+k.y}}var E=Wp(x,e),j={x:(u.x-E.x)/E.width,y:(u.y-E.y)/E.height};return j},mq.prototype._handlePanning=function(l){var i=this,R=i._pan;if(R){R.started=!0;var v=i._interactor,b=v.gv,u=v._lastClientPoint,y=zc(l);b.setTranslate(R.tx+y.x-u.x,R.ty+y.y-u.y),i.gatherSingleTarget(v.gv,i.target),v._42(),v.fi({kind:"betweenPan",event:l})}},mq.prototype.handleEdit=function(B,$){var e=this,Z=e.editing;if(e._pan)return e._handlePanning($),void 0;if(Z){Z.inEdit=!0;var O,D,k,C=e._interactor._getLogicalPoint($),c=M.Default.isCtrlDown($),T=M.Default.isShiftDown($),p=Z.type,j=e.activing;if(e._guideInfo=null,"ctrlPoint"===p&&T){var w=e.editing.direction.clone();O=j.point;var f=w.dot(C.clone().sub(O));C=w.setLength(f).add(O)}else if("ctrlPoint"===p||"realPoint"===p){var w;if("realPoint"===p&&T){var A=e.editing.shiftGuide;D=A.point;var H=Math.abs(C.x-D.x),h=Math.abs(C.y-D.y);H>h&&H>A.limit&&"y"===A.dir&&(A.dir="x"),h>H&&h>A.limit&&"x"===A.dir&&(A.dir="y"),w=A.dir,"x"===w?(C.y=D.y,A.limit=Math.max(A.limit,H)):"y"===w&&(C.x=D.x,A.limit=Math.max(A.limit,h))}var U=e._isEditEdgeSourceTarget();if(U){var E=e._editEdgeSourceTarget(U,C,c);E&&(k=E.tipText)}else if(!c){var J=e._guidingToEdit(C,w),m="realPoint"===p?e._interactor.gridGuide.findClosest(C,w,!0):null,L=1/0,P=1/0;m&&(m.x&&(L=m.x),m.y&&(P=m.y));var r=!1;J&&(J.xList&&(Math.abs(J.x)<=Math.abs(L)?(r=!0,L=J.x):delete J.xList),J.yList&&(Math.abs(J.y)<=Math.abs(P)?(r=!0,P=J.y):delete J.yList),r&&(e._guideInfo=J)),isFinite(L)&&(C.x+=L),isFinite(P)&&(C.y+=P),r&&(J.v=C)}}var R=e.screenInfo.curve;if("realPoint"===Z.type){O=Z.point,O.e!==d&&(C.e=O.e),R.moveRealPoint(O,C),Z.point=C,e.highlight.point=C;var y=j.status,a=j.selections;if(e.activing={point:C,status:y},a){var S=C.clone().sub(O),b=0;a.forEach(function(f){var q=f.clone().add(S);R.moveRealPoint(f,q),a[b++]=q}),e.activing.selections=a}}else if("ctrlPoint"===Z.type){var q=j.pairs,l=q[Z.pairId];R.moveCtrlPoint(l,C,Z.ctrlType);var t=j.status,I=Gj.Curve.PointType;if((t===I.Mirrored||t===I.Asymmetric)&&l.c1&&l.c2){var O=new Gj.Math.Vector2(j.point),g="c1"===Z.ctrlType?"c2":"c1";if(t===Gj.Curve.PointType.Mirrored)R.moveCtrlPoint(l,O.clone().multiplyScalar(2).sub(C),g);else if(t===I.Asymmetric){var f=l[g].clone().sub(O).length(),Q=O.clone().sub(l[Z.ctrlType]).setLength(f).add(O);isNaN(Q.x)||R.moveCtrlPoint(l,Q,g)}}j._firePointChange()}else if("elevation"===Z.type){D=Z.startPoint;var v=D.e+(D.y-C.y)/B._zoom;e._setCurrentPointImpl("e",v),j._firePointChange(),k="E: "+Gj.toFixed(v)}var K=M.Default.getLogicalPoint($,e._interactor._canvas);if(K.x+=Gj.Icons.TipShiftX,K.y+=Gj.Icons.TipShiftY,!k){var i=Gj.toWorldPosition(B,C);k=""+Gj.toFixed(i.x)+", "+Gj.toFixed(i.y)}e.tipInfo={helperPos:K,text:k,size:k.length},e._writeToHt(),e._interactor.fi({kind:"betweenEditPoint",event:$})}},mq.prototype._setCurrentPointImpl=function(C,A){var Q=this,H=Q._activing;if(!H)return!1;var j=Q.target;if(!j)return!1;var g=H.getCurrentEditingPoint();if(!g)return!1;var e=H.editingCtrl;if(!e)var Y=g.clone();if("e"===C)g.e=A;else{var f;if("x"===C||"y"===C){var y=H._lastFirePoint;f="x"===C?{x:A,y:y?y.y:0}:{x:y?y.x:0,y:A}}else"object"==typeof C?(f=C,C.e!==d&&(g.e=C.e)):(f={x:arguments[0],y:arguments[1]},arguments[2]!==d&&(g.e=arguments[2]));var k=Gj.getDataMatrix(j);f=Gj.toScreenPosition(Q._interactor.gv,k.apply(f)),g.x=f.x,g.y=f.y}if(!e){var m=Y.multiplyScalar(-1).add(g);g.e&&Y.e&&(m.e=g.e-Y.e),Q.screenInfo.curve.moveCtrlDueToRealPointMovement(g,m)}return!0},mq.prototype.setCurrentPoint=function(P,Y){return this._setCurrentPointImpl(P,Y)?(this._writeToHt(),!0):!1},mq.prototype._isEditEdgeSourceTarget=function(){var _=this,d=_.target;if(!(d instanceof M.Edge))return!1;var X=_.editing.point,C=_.screenInfo.curve._curves;return X===C[0]._p1?"source":X===C[C.length-1]._p4?"target":!1},mq.prototype._editEdgeSourceTarget=function(Y,T,r){var Q,P=this,C=P.target;if(Q="source"===Y?C.getSource():C.getTarget()){var h=P._interactor.gv,n=Gj.toWorldPosition(h,T),b=P._calcHostAnchor(C,Y,n,Q);if(!r){var Z=P._interactor.getStyle("anchorRound"),U=P._interactor.getStyle("anchorSensitivity");b.x=Gj.roundTo(b.x,Z,U),b.y=Gj.roundTo(b.y,Z,U)}if(P._interactor.getStyle("edgeHostDetectPerFrame")||b.x<0||b.x>1||b.y<0||b.y>1){var o=h.getDataAt(n,function(b){return h.isSelectable(b)?Oh(b)?!0:!1:!1});if(o){var M=P._calcHostAnchor(C,Y,n,o);Q=o,P._nextChangeEdgeHost={type:Y,host:o},b=M,r||(b.x=Gj.roundTo(b.x,Z,U),b.y=Gj.roundTo(b.y,Z,U))}}if(!r){var X=xo(h,Q,0,0,0,b.x,b.y),m=Gj.toScreenPosition(h,X);T.x=m.x,T.y=m.y}return P._edgeHostGuideInfo=Gj.getTargetCornersOnScreen(h,Q),{host:Q,anchor:b,tipText:""+b.x.toFixed(2)+", "+b.y.toFixed(2)}}},mq.prototype._guidingToEdit=function(m,r){var h,u,U=this;if(h=U.screenInfo.curve){u=h._curves;var d,z,Y,Q,e,S,l,t,q=1/0,a=1/0,_=[];for(U.editing&&"realPoint"===U.editing.type&&(t=U.editing.point),e=0,S=2*u.length;S>e;e++)l=u[Math.floor(e/2)][e%2?"_p4":"_p1"],_.indexOf(l)>=0||(_.push(l),t&&t===l||(Y=l.x-m.x,Q=l.y-m.y,Math.abs(Y)<Math.abs(q)?(q=Y,d=[l]):Y===q&&d.push(l),Math.abs(Q)<Math.abs(a)?(a=Q,z=[l]):Q===a&&z.push(l)));var f=U._interactor.getStyle("smartGuideSensitivity");if((Math.abs(q)>f||"y"===r)&&(d=null),(Math.abs(a)>f||"x"===r)&&(z=null),d||z){var M=!1,y={};if(d&&(M=!0,y.xList=d,y.x=q),z&&(M=!0,y.yList=z,y.y=a),M)return y}}},mq.prototype._46O=function(d){var n=this;n.editing&&(n.editing=null,n._interactor.fi({kind:"endEditPoint",event:d})),n._guideInfo=null,n._edgeHostGuideInfo=null,n._pan&&(n._pan=null,n._interactor.fi({kind:"endPan",event:d})),n.tipInfo=null},mq.prototype._canDeletePoint=function(p,O){var l=this.target;if(!(l instanceof M.Edge))return!0;var r=p._curves[0],U=p._curves[p._curves.length-1];return r._p1===O||U._p4===O?!1:!0},mq.prototype.handleDelete=function(){var b=this;if(b.activing&&b.screenInfo){var f=M.Default.isShiftDown(),T=b.screenInfo.curve;b._canDeletePoint(T,b.activing.point)&&T.deleteRealPoint(b.activing.point,f),b.activing.selections&&b.activing.selections.forEach(function(i){b._canDeletePoint(T,i)&&T.deleteRealPoint(i,f)}),b.activing=null,delete b.editing,delete b.tipInfo,delete b._pan,b._writeToHt(),b._interactor.fp("deleteShapePoint",!1,!0)}},mq.prototype.handleDoubleClick=function(f){var p=this,L=p._interactor._getLogicalPoint(f);if(p.screenInfo&&p._checkEditRealPoint(L)){var h=p.getCurrentSelectintStatus(),D=Gj.Curve.PointType;return h=h===D.Mirrored?D.Straight:D.Mirrored,p.setCurrentSelectionStatus(h),p._interactor._42(),!0}},mq.prototype._drawHighlight=function(C){var k=this,x=k.highlight;if(x){var l=x.bezier,n=k._interactor;l&&Gj.Icons.DrawIcon(n,C,Gj.Icons.ShapeHighlightCurve,[l._p1.x,l._p1.y,l._p2.x,l._p2.y,l._p3.x,l._p3.y,l._p4.x,l._p4.y]);var B=x.point;B&&"insertKnot"===x.type&&Gj.Icons.DrawIcon(n,C,Gj.Icons.ShapeHighlighPoint,B)}},mq.prototype._drawGuide=function(S){var x=this,B=x._guideInfo;if(B){var R,w,u,O,F=B.v;for(R=0;2>R;R++)if(O=0===R?B.xList:B.yList)for(w=0,u=O.length;u>w;w++)Gj.Icons.DrawIcon(x._interactor,S,Gj.Icons.ShapeGuideLine,[F.x,F.y,O[w].x,O[w].y])}},mq.prototype._drawCurrentPoint=function(Z){var D=this;if(D.activing){var u=D.activing,J=D.getCurrentSelectintStatus(),T=D._interactor;if(J!==Gj.Curve.PointType.Straight){var K=u.pairs;u.hlpair,u.hltype;var M=u.selections,f=u.editingCtrl;if(K&&!M){var a,E,m;for(E=0,m=K.length;m>E;E++)a=K[E],f&&E===f.pairId&&a[f.type]?Gj.Icons.DrawIcon(T,Z,Gj.Icons.ShapeActivingCtrl,{point:a.point,c1:a.c1,c2:a.c2,hl:f.type}):Gj.Icons.DrawIcon(T,Z,Gj.Icons.ShapeActivingCtrl,a)}}Gj.Icons.DrawIcon(T,Z,Gj.Icons.ShapeHighlighRealPoint,D.activing.point),M&&M.forEach(function(h){Gj.Icons.DrawIcon(T,Z,Gj.Icons.ShapeHighlighRealPoint,h)})}},mq.prototype.clear=function(){var z=this;z.editing=null,z._guideInfo=null,z.activing=null,z.highlight=null},mq.prototype._42=function(G){var j=this;j.info={},j.editing||(j.screenInfo=null);var z=j._interactor;if(!z.editDetail)return j.clear(),void 0;if(!j.target||!j._interactor.gv.isSelected(j.target)||!j._interactor.gv.isVisible(j.target))return z.editDetail=!1,j.clear(),void 0;if(j.gatherSingleTarget(z.gv,j.target),Gj.Icons.DrawIcon(z,G,Gj.Icons.ShapeBgCurve,j.screenInfo),j._drawHighlight(G),j._drawCurrentPoint(G),j._getRealPoint().forEach(function(d){Gj.Icons.DrawIcon(z,G,Gj.Icons.ShapePoint,d)}),j._drawGuide(G),j.tipInfo&&Gj.Icons.DrawIcon(z,G,Gj.Icons.TipHelper,j.tipInfo),j._edgeHostGuideInfo&&Gj.Icons.DrawIcon(z,G,Gj.Icons.NodeHoverGuide,j._edgeHostGuideInfo),j._interactor.getStyle("curveElevationVisible")&&j.target instanceof M.Polyline&&j.activing){var e=j.activing.getCurrentEditingPoint();e&&Gj.Icons.DrawIcon(z,G,Gj.Icons.EdgeElevationGuide,e)}},mq.prototype._getRealPoint=function(){var K=this.screenInfo,e=K.P,X=K.S,F=-1,h=[];return X.each(function(b){var n=1;if(3===b)n=2;else if(4===b)n=3;else if(5===b)return;F+=n,h.push({x:e[2*F],y:e[2*F+1]})}),h};var Cl=Gj.MoveHelper=function(a){var d=this;d.catalog="Move",d._interactor=a};Cl.prototype={},Cl.prototype.constructor=Cl,Cl.prototype.calcShift=function(s,H,e){var i,C,u=this,t=u._interactor.gv,W=t.lp(H);if("beginMove"===s&&u._gatherGridInfo(e._lastLogicalPoint||W),i=u._target){var F=i.downPosition;if(F){var Y=u._interactor.getStyle("moveSensitivity")/t._zoom;if(F.distanceTo(W)<Y)return{x:0,y:0};delete i.downPosition}var b;C=M.Default.isShiftDown(H),C&&(W=u._dealShiftDown(W),b=i.shiftGuide.dir);var g,Z=i.rawPos={x:i.pos.x+W.x-i.lp.x,y:i.pos.y+W.y-i.lp.y};if(M.Default.isCtrlDown(H)){if(g=u._calcShiftByAddon(),u._target.node instanceof Gj.Group){var G=u._target.node;G._position.x+=g.x,G._position.y+=g.y}return g}for(var O,w=i.x+Z.x,a=i.y+Z.y,r={x:w,y:a},R={x:w+i.w/2,y:a+i.h/2},B={x:w+i.w,y:a+i.h},Q=u._interactor.rectGuide,v=u._interactor.gridGuide,N=[Q.findClosest(r,b),Q.findClosest(R,b),Q.findClosest(B,b),v.findClosest(r,b),v.findClosest(R,b),v.findClosest(B,b)],k=1/0,x=1/0,V=0,o=N.length;o>V;V++)O=N[V],O&&(w=O.x,a=O.y,isFinite(w)&&Math.abs(w)<Math.abs(k)&&(k=w),isFinite(a)&&Math.abs(a)<Math.abs(x)&&(x=a));if(isFinite(k)||(k=0),isFinite(x)||(x=0),g=u._calcShiftByAddon(k,x),u._target.node instanceof Gj.Group){var G=u._target.node;G._position.x+=g.x,G._position.y+=g.y}var J=i.node;if(!rq(J,t)){var L=Z.x+k,p=Z.y+x;u._interactor.rectGuide.gatherLines({node:J,x:i.x+L,y:i.y+p,w:i.w,h:i.h},b)}return g}},Cl.prototype._calcShiftByAddon=function(n,$){var A=this._target,L=A.rawPos,m=A.node.getPosition();return n=n||0,$=$||0,{x:L.x-m.x+n,y:L.y-m.y+$}},Cl.prototype._dealShiftDown=function(g){var Y=this,B=Y._target.shiftGuide,N=Y._target.lp,w=Math.abs(g.x-N.x),v=Math.abs(g.y-N.y);w>v&&w>B.limit&&"y"===B.dir&&(B.dir="x"),v>w&&v>B.limit&&"x"===B.dir&&(B.dir="y");var x=B.dir;return"x"===x?(g.y=N.y,B.limit=Math.max(B.limit,w)):"y"===x&&(g.x=N.x,B.limit=Math.max(B.limit,v)),g},Cl.prototype._gatherGridInfo=function(S){var g,R=this,A=R._interactor,O=A._getValidSelection();if(1===O.length){if(g=O[0],!g.getRect)return R._target=null,void 0}else if(g=Gj.Group.findOrCreateGroup(O),!g)return R._target=null,void 0;var G=g.getPosition(),q=g.getRect();R._target={node:g,x:q.x-G.x,y:q.y-G.y,w:q.width,h:q.height,lp:{x:S.x,y:S.y},pos:{x:G.x,y:G.y},shiftGuide:{dir:"x",limit:0},downPosition:new Gj.Math.Vector2(S)},A.rectGuide.gatherRects()},Cl.prototype.clear=function(){var W=this;W._interactor.rectGuide.clear(),W._interactor._42()};var qm="directional",On="point",Mk="spot",jd="light.color",wr=function(t,f){Hq(f)&&cl.test(f)?dm(t,f):eh(f)&&f.modelType?Oj(t,f):Mp[t]=f},Mn=function(m){if(eh(m))return m;var q=Mp[m];return m&&q===d&&cl.test(m)&&(oh&&oh[m]||dm(m,m)),q};Jc(Q,{graph3dViewAttributes:N,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:H/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:al,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:H/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:wr,getShape3dModel:Mn,createMatrix:function(Z,L){Sg(Z)||(Z=[Z]);for(var O=Z.length-1;O>=0;O--){var J=Z[O];L=rs(J.mat,J.s3,J.r3,J.rotationMode,J.t3,L)}return L},transformVec:function(F,w){return Po(F,w)},createBoxModel:function(){return{vs:Qm,ns:lq,uv:Lh,is:Xh}},createRoundRectModel:function(S,J){return Ri.roundRect(S,J)},createStarModel:function(U,i){return Ri.star(U,i)},createRectModel:function(e,y){return Ri.rect(e,y)},createTriangleModel:function(D,z){return Ri.triangle(D,z)},createRightTriangleModel:function(l,H){return Ri.rightTriangle(l,H)},createParallelogramModel:function(G,N){return Ri.parallelogram(G,N)},createTrapezoidModel:function(W,A){return Ri.trapezoid(W,A)},createSmoothSphereModel:function(e,i,L,j,B,s,n){return Tq(new jq(e,i,L,j,B,s,n))},createSphereModel:function(I,w,S,o,V,C){return I?ll(I,w,S,o,V,C):Q.createSmoothSphereModel()},createSmoothConeModel:function(F,q,y,Q,_){return le(F,q,y,Q,_)},createConeModel:function(w,F,Y,L,q,D){return w?ir(w,F,Y,L,q,D):le(D)},createSmoothCylinderModel:function(b,X,T,g,w,I,z,t){return Tq(new Eo(b,X,T,g,w,I,z,t))},createCylinderModel:function(m,q,K,H,k,o,V){return m?Ii(m,q,K,H,k,o,V):Rq(o,V)},createSmoothTorusModel:function(V,x,T,$,Z,O){return Tq(new ii(V,x,T,$,Z,O))},createTorusModel:function(v,l,u,K,g,L,Y){return v?fk(v,l,u,K,g,L,Y):js(L,Y)},createExtrusionModel:function(r,U,k,I,l,o,A,c){return Kh(r,U,k,I,l,o,A,c)},createSmoothRingModel:function(e,O,v,s,P,x){for(var Z=[],o=0;o<e.length-1;o+=2)Z.push({x:e[o],y:e[o+1]});for(e=fg(Z,O,v)[0],Z=[],o=0;o<e.length;o++){var W=e[o];Z.push(new ng(W.x,0,W.y))}return Tq(new Ec(Z,x,s,P))},createTextGeometry:function(t,M){return Tq(new dp(t,M))},loadFontFace:function(Y,B){Q.xhrLoad(Y,function(X){if(!X)return B();var _;try{_=JSON.parse(X)}catch(p){_=JSON.parse(X.substring(65,X.length-2))}Fn.loadFace(_),B&&B(_.familyName.toLowerCase())},B?null:{sync:!0})},getRotationFromMatrix4:function(A,Z){var q=j,t=A[0],E=A[4],a=A[8],c=A[1],U=A[5],d=A[9],y=A[2],W=A[6],C=A[10];Z=Z||"xyz",Z=Z[2]+Z[1]+Z[0],Z=Z.toUpperCase();var u={};if("XYZ"===Z)u._y=Math.asin(q(a,-1,1)),Math.abs(a)<.99999?(u._x=Math.atan2(-d,C),u._z=Math.atan2(-E,t)):(u._x=Math.atan2(W,U),u._z=0);else if("YXZ"===Z)u._x=Math.asin(-q(d,-1,1)),Math.abs(d)<.99999?(u._y=Math.atan2(a,C),u._z=Math.atan2(c,U)):(u._y=Math.atan2(-y,t),u._z=0);else if("ZXY"===Z)u._x=Math.asin(q(W,-1,1)),Math.abs(W)<.99999?(u._y=Math.atan2(-y,C),u._z=Math.atan2(-E,U)):(u._y=0,u._z=Math.atan2(c,t));else if("ZYX"===Z)u._y=Math.asin(-q(y,-1,1)),Math.abs(y)<.99999?(u._x=Math.atan2(W,C),u._z=Math.atan2(c,t)):(u._x=0,u._z=Math.atan2(-E,U));else if("YZX"===Z)u._z=Math.asin(q(c,-1,1)),Math.abs(c)<.99999?(u._x=Math.atan2(-d,U),u._y=Math.atan2(-y,t)):(u._x=0,u._y=Math.atan2(a,C));else{if("XZY"!==Z)return null;u._z=Math.asin(-q(E,-1,1)),Math.abs(E)<.99999?(u._x=Math.atan2(W,U),u._y=Math.atan2(a,t)):(u._x=Math.atan2(-d,C),u._y=0)}return[u._x,u._y,u._z]},createRingModel:function(k,L,D,b,I,i,G,q,Z,j){for(var v=[],U=0;U<k.length-1;U+=2)v.push({x:k[U],y:k[U+1]});i=i||Q.shapeSide,G=G||0,q=q||i;var O,u,w,o,z,a,t,y,F,r,U,X,s,h,B,Y,m,f,g=[],e=[],M=Z?[]:N,V=Z?[]:N,S=j?[]:N,_=j?[]:N,c=b?[]:N,x=b?[]:N,C=I?[]:N,H=I?[]:N,k=fg(v,L,D),P=rp(k),J=0,l=2*Math.PI/i;return k.forEach(function(T){if(w=T.length,w>1){if(o=T[0],b)for(a=o.x,y=o.y,U=G;q>U;U++)X=U+1,s=U*l,h=X*l,B=E(s),Y=R(s),m=E(h),f=R(h),c.push(B*a,y,-Y*a,m*a,y,-f*a,0,y,0),x.push(.5-.5*B,.5-.5*Y,.5-.5*m,.5-.5*f,.5,.5);for(r=0;w>r;r++){for(z=T[r],a=o.x,t=z.x,y=o.y,F=z.y,O=J/P,J+=uk(o,z),u=J/P,U=G;q>U;U++)X=U+1,s=U*l,h=X*l,B=E(s),Y=R(s),m=E(h),f=R(h),g.push(B*t,F,-Y*t,m*t,F,-f*t,B*a,y,-Y*a,m*t,F,-f*t,m*a,y,-f*a,B*a,y,-Y*a),e.push(U/i,u,X/i,u,U/i,O,X/i,u,X/i,O,U/i,O),Z&&U===G&&(M.push(0,y,0,0,F,0,B*t,F,-Y*t,B*t,F,-Y*t,B*a,y,-Y*a,0,y,0),V.push(0,.5-y,0,.5-F,2*t,.5-F,2*t,.5-F,2*a,.5-y,0,.5-y)),j&&X===q&&(S.push(0,y,0,m*t,F,-f*t,0,F,0,m*t,F,-f*t,0,y,0,m*a,y,-f*a),_.push(1,.5-y,1-2*t,.5-F,1,.5-F,1-2*t,.5-F,1,.5-y,1-2*a,.5-y));o=z}if(I)for(a=o.x,y=o.y,U=G;q>U;U++)X=U+1,s=U*l,h=X*l,B=E(s),Y=R(s),m=E(h),f=R(h),C.push(m*a,y,-f*a,B*a,y,-Y*a,0,y,0),H.push(.5-.5*m,.5+.5*f,.5-.5*B,.5+.5*Y,.5,.5)}}),{vs:g,uv:e,bottom_vs:C,bottom_uv:H,top_vs:c,top_uv:x,from_vs:M,from_uv:V,to_vs:S,to_uv:_}
}},!0),Jc(_,{"3d.move.mode":d,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":d,"edge.gradient.color":d,"edge.source.t3":d,"edge.target.t3":d,"light.type":On,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":H/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Kr,"wf.short":!1,"wf.mat":d,"wf.geometry":!1,batch:d,"transparent.mask":!1,brightness:d,"select.brightness":.7,"repeat.uv.length":d,alphaTest:.4,"label.face":Sh,"label.t3":d,"label.r3":d,"label.texture.scale":2,"label.rotationMode":Yo,"label.light":!1,"label.blend":d,"label.reverse.flip":!1,"label.reverse.color":Dl,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Sh,"label2.t3":d,"label2.r3":d,"label2.texture.scale":2,"label2.rotationMode":Yo,"label2.light":!1,"label2.blend":d,"label2.reverse.flip":!1,"label2.reverse.color":Dl,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Sh,"note.t3":d,"note.r3":d,"note.texture.scale":2,"note.rotationMode":Yo,"note.light":!1,"note.blend":d,"note.reverse.flip":!1,"note.reverse.color":Dl,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Sh,"note2.t3":d,"note2.r3":d,"note2.texture.scale":2,"note2.rotationMode":Yo,"note2.light":!1,"note2.blend":d,"note2.reverse.flip":!1,"note2.reverse.color":Dl,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:d,"shape3d.color":ol,"shape3d.top.color":d,"shape3d.bottom.color":d,"shape3d.from.color":d,"shape3d.to.color":d,"shape3d.image":d,"shape3d.top.image":d,"shape3d.bottom.image":d,"shape3d.from.image":d,"shape3d.to.image":d,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":d,"shape3d.side.to":d,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":d,"shape3d.opacity":d,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Dl,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":d,"shape3d.uv.scale":d,"shape3d.top.uv.offset":d,"shape3d.top.uv.scale":d,"shape3d.bottom.uv.offset":d,"shape3d.bottom.uv.scale":d,"shape3d.from.uv.offset":d,"shape3d.from.uv.scale":d,"shape3d.to.uv.offset":d,"shape3d.to.uv.scale":d,"shape3d.top.cap":d,"shape3d.bottom.cap":d,"shape3d.start.angle":0,"shape3d.sweep.angle":q,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":d,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":ol,"all.image":d,"all.blend":d,"all.opacity":d,"all.reverse.flip":!1,"all.reverse.color":Dl,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":d,"all.uv.offset":d,"all.uv.scale":d,"all.discard.selectable":!0,mat:d,"left.mat":d,"right.mat":d,"top.mat":d,"bottom.mat":d,"front.mat":d,"back.mat":d},!0);var Fo,Rp=!1,Be=[0,0,0,0],fs={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:kj,2:Lj,3:Kf,4:si,5:Sh,6:tf}},sk=function(Q,g,y,$){if(g.getFaceVisible(Q,y)){yj(g,Qq(Q,g.getFaceMat(Q,y)||g.getMat(Q)));var C=g._26I;g.getFaceReverseCull(Q,y)?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE),ao(C,g._prg.uFixPickReverseColor,fs[y]),ld(C),Tj(C,$,6),fp(C),Hg(g)}},mf=function(E){return E instanceof Oo},Wm=function(Y){return[Y.x,Y.e||0,Y.y]},vi=function(i,c,r){for(var c=Ie(c),g=c[0],p=c[1],t=c[2];r--;)i.push(g,p,t)},$b=function(z,H,o){for(var H=Ie(H),W=H[0],U=H[1],V=H[2],c=H[3];o--;)z.push(W,U,V,c)},Nf=function(q,d,V){if(d)for(var Z,D,U,k=d[0],M=d[1],y=d[2],r=d[4],a=d[5],B=d[6],i=d[8],v=d[9],H=d[10],m=d[12],C=d[13],Y=d[14],X=V.length,f=0,f=0;X>f;f+=3)Z=V[f],D=V[f+1],U=V[f+2],q.push(k*Z+r*D+i*U+m,M*Z+a*D+v*U+C,y*Z+B*D+H*U+Y);else Cr(q,V)},rf=function(G,C){var g=C.s("light.intensity"),c=Ie(C.s(jd)),x=c[0],m=c[1],w=c[2];1!==g&&(x*=g,m*=g,w*=g),G.push(x,m,w,C.s("light.disabled")?1:0)},Er=function(o,C,$){ao(C,$.uHeadlightRange,o._headlightRange);var x=o._headlightIntensity,L=Ie(o._headlightColor);1!==x&&(L=[L[0]*x,L[1]*x,L[2]*x]),ao(C,$.uHeadlightColor,[L[0],L[1],L[2],o._headlightDisabled?1:0]);var T=o._59O,H=o._spots,Q=o._dirs;if(T.length){var X=[],M=[],F=[];T.forEach(function(L){rf(X,L),Cr(M,o._transformPointToViewSpace(L.p3())),F.push(L.s("light.range"))}),C.uniform4fv($.uPointColor,X),C.uniform1fv($.uPointRange,F),C.uniform3fv($.uPointPosition,M)}if(H.length){var d=[],k=[],q=[],D=[],h=[],l=[];H.forEach(function(g){rf(d,g),Cr(k,o._transformPointToViewSpace(g.p3())),Cr(h,o._transformDirectionToViewSpace(g.p3(),g.s("light.center"))),q.push(g.s("light.range")),D.push(E(g.s("light.angle")/2)),l.push(g.s("light.exponent"))}),C.uniform4fv($.uSpotColor,d),C.uniform1fv($.uSpotRange,q),C.uniform1fv($.uSpotAngle,D),C.uniform1fv($.uSpotExponent,l),C.uniform3fv($.uSpotPosition,k),C.uniform3fv($.uSpotDirection,h)}if(Q.length){var m=[],w=[];Q.forEach(function(v){rf(m,v),Cr(w,o._transformDirectionToViewSpace(v.p3()))}),C.uniform4fv($.uDirColor,m),C.uniform3fv($.uDirDirection,w)}},uj=function(b){return b>0&&0===(b-1&b)},$h=function(f){return f=t(0,O(H,f)),f=t(ad,O(H-ad,f))},kd=function(){return.05+v()/2},Xo=function(I,h,U,i){var Q,w=I.getEye();return I.isOrtho()?(Q=fn(I.getCenter(),w),Q[0]+=i[0],Q[1]+=i[1],Q[2]+=i[2]):Q=w,Qb(h,U,i,Q)},Qb=function(n,K,r,O){var H=_o(n,K),l=fn(O,r,!0),T=_o(l,K);if(A(T)<ad)return N;var I=(H-_o(r,K))/T;return[r[0]+l[0]*I,r[1]+l[1]*I,r[2]+l[2]*I]},Op=function(l,H){return{x:2*l.x-H.x,y:2*l.y-H.y}},oq=function(U,P,A,u){var _,g;if(!U)return _=D(P.y-A.y,A.x-P.x),{x:P.x+u*R(_),y:P.y+u*E(_)};if(!A)return _=D(U.y-P.y,P.x-U.x),{x:P.x+u*R(_),y:P.y+u*E(_)};var C=fn([U.x,U.y,0],[P.x,P.y,0],!0),N=fn([A.x,A.y,0],[P.x,P.y,0],!0),S=-(C[0]+N[0])/2,M=-(C[1]+N[1])/2,H=m(S*S+M*M);if(ad>H)return _=D(U.y-P.y,P.x-U.x),{x:P.x+u*R(_),y:P.y+u*E(_)};var k=U.x-P.x,K=U.y-P.y,$=A.x-P.x,l=A.y-P.y,f=m(k*k+K*K),B=m($*$+l*l);_=F(_o(C,N))/2,g=C[1]*N[0]-C[0]*N[1]>0?-1:1,S/=H,M/=H;var X=u/R(_),x=t(f,B)/E(_);H=Math.min(X,x);var q={x:P.x+g*H*S,y:P.y+g*H*M};return A.b&&X>B/E(_)&&(q.adjust=!0),q},bj=function(w){var t=w[1],d=w[2],u=w[3],b=w[6],U=w[7],m=w[11];w[1]=w[4],w[2]=w[8],w[3]=w[12],w[4]=t,w[6]=w[9],w[7]=w[13],w[8]=d,w[9]=b,w[11]=w[14],w[12]=u,w[13]=U,w[14]=m},wi=function(w){var O=w[0],E=w[1],n=w[2],u=w[3],l=w[4],U=w[5],P=w[6],j=w[7],e=w[8],X=w[9],d=w[10],L=w[11],t=w[12],p=w[13],C=w[14],Q=w[15],g=O*U-E*l,m=O*P-n*l,B=O*j-u*l,A=E*P-n*U,K=E*j-u*U,b=n*j-u*P,a=e*p-X*t,i=e*C-d*t,q=e*Q-L*t,T=X*C-d*p,F=X*Q-L*p,h=d*Q-L*C,z=g*h-m*F+B*T+A*q-K*i+b*a;return z?(z=1/z,w[0]=(U*h-P*F+j*T)*z,w[1]=(n*F-E*h-u*T)*z,w[2]=(p*b-C*K+Q*A)*z,w[3]=(d*K-X*b-L*A)*z,w[4]=(P*q-l*h-j*i)*z,w[5]=(O*h-n*q+u*i)*z,w[6]=(C*B-t*b-Q*m)*z,w[7]=(e*b-d*B+L*m)*z,w[8]=(l*F-U*q+j*a)*z,w[9]=(E*q-O*F-u*a)*z,w[10]=(t*K-p*B+Q*g)*z,w[11]=(X*B-e*K-L*g)*z,w[12]=(U*i-l*T-P*a)*z,w[13]=(O*T-E*i+n*a)*z,w[14]=(p*m-t*A-C*g)*z,w[15]=(e*A-X*m+d*g)*z,void 0):N},Ze=function(D,U){if(U){var P=U[0],x=U[1],A=U[2];D[12]=D[0]*P+D[4]*x+D[8]*A+D[12],D[13]=D[1]*P+D[5]*x+D[9]*A+D[13],D[14]=D[2]*P+D[6]*x+D[10]*A+D[14],D[15]=D[3]*P+D[7]*x+D[11]*A+D[15]}},Ug=function(I,D){if(D){var v=D[0],U=D[1],y=D[2];I[0]=I[0]*v,I[1]=I[1]*v,I[2]=I[2]*v,I[3]=I[3]*v,I[4]=I[4]*U,I[5]=I[5]*U,I[6]=I[6]*U,I[7]=I[7]*U,I[8]=I[8]*y,I[9]=I[9]*y,I[10]=I[10]*y,I[11]=I[11]*y}},jn=function(i,C,E){var g=C[0],U=C[1],j=C[2],B=C[3],G=C[4],h=C[5],r=C[6],I=C[7],d=C[8],x=C[9],q=C[10],z=C[11],R=C[12],l=C[13],J=C[14],Z=C[15],K=E[0],b=E[1],w=E[2],$=E[3];return i[0]=K*g+b*G+w*d+$*R,i[1]=K*U+b*h+w*x+$*l,i[2]=K*j+b*r+w*q+$*J,i[3]=K*B+b*I+w*z+$*Z,K=E[4],b=E[5],w=E[6],$=E[7],i[4]=K*g+b*G+w*d+$*R,i[5]=K*U+b*h+w*x+$*l,i[6]=K*j+b*r+w*q+$*J,i[7]=K*B+b*I+w*z+$*Z,K=E[8],b=E[9],w=E[10],$=E[11],i[8]=K*g+b*G+w*d+$*R,i[9]=K*U+b*h+w*x+$*l,i[10]=K*j+b*r+w*q+$*J,i[11]=K*B+b*I+w*z+$*Z,K=E[12],b=E[13],w=E[14],$=E[15],i[12]=K*g+b*G+w*d+$*R,i[13]=K*U+b*h+w*x+$*l,i[14]=K*j+b*r+w*q+$*J,i[15]=K*B+b*I+w*z+$*Z,i},dd=function(F,h,X,t){var R,n,V,C,e,s,E,M,I,S,x=h[0],z=h[1],a=h[2],G=t[0],P=t[1],Z=t[2],w=X[0],o=X[1],c=X[2];return A(x-w)<ad&&A(z-o)<ad&&A(a-c)<ad?Ro(F):(E=x-w,M=z-o,I=a-c,S=1/m(E*E+M*M+I*I),E*=S,M*=S,I*=S,R=P*I-Z*M,n=Z*E-G*I,V=G*M-P*E,S=m(R*R+n*n+V*V),S?(S=1/S,R*=S,n*=S,V*=S):(R=0,n=0,V=0),C=M*V-I*n,e=I*R-E*V,s=E*n-M*R,S=m(C*C+e*e+s*s),S?(S=1/S,C*=S,e*=S,s*=S):(C=0,e=0,s=0),F[0]=R,F[1]=C,F[2]=E,F[3]=0,F[4]=n,F[5]=e,F[6]=M,F[7]=0,F[8]=V,F[9]=s,F[10]=I,F[11]=0,F[12]=-(R*x+n*z+V*a),F[13]=-(C*x+e*z+s*a),F[14]=-(E*x+M*z+I*a),F[15]=1,F)},or=function(r,h,Z,f,u){var R=1/o(h/2),P=1/(f-u);return r[0]=R/Z,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=R,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(u+f)*P,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*u*f*P,r[15]=0,r},bd=function(I,z,X,N,W,Q,E){var t=1/(z-X),w=1/(N-W),s=1/(Q-E);return I[0]=-2*t,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=-2*w,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=2*s,I[11]=0,I[12]=(z+X)*t,I[13]=(W+N)*w,I[14]=(E+Q)*s,I[15]=1,I},De=function(M,h){var T=h[0],a=h[1],Y=h[2],r=h[3],f=T*T+a*a+Y*Y+r*r,$=f?1/f:0;return M[0]=-T*$,M[1]=-a*$,M[2]=-Y*$,M[3]=r*$,M},Ep=function(Q,Z){var U=Z[0]+Z[5]+Z[10],n=0;return U>0?(n=2*Math.sqrt(U+1),Q[3]=.25*n,Q[0]=(Z[6]-Z[9])/n,Q[1]=(Z[8]-Z[2])/n,Q[2]=(Z[1]-Z[4])/n):Z[0]>Z[5]&Z[0]>Z[10]?(n=2*Math.sqrt(1+Z[0]-Z[5]-Z[10]),Q[3]=(Z[6]-Z[9])/n,Q[0]=.25*n,Q[1]=(Z[1]+Z[4])/n,Q[2]=(Z[8]+Z[2])/n):Z[5]>Z[10]?(n=2*Math.sqrt(1+Z[5]-Z[0]-Z[10]),Q[3]=(Z[8]-Z[2])/n,Q[0]=(Z[1]+Z[4])/n,Q[1]=.25*n,Q[2]=(Z[6]+Z[9])/n):(n=2*Math.sqrt(1+Z[10]-Z[0]-Z[5]),Q[3]=(Z[1]-Z[4])/n,Q[0]=(Z[8]+Z[2])/n,Q[1]=(Z[6]+Z[9])/n,Q[2]=.25*n),Q},Mj=function(E,k,b){var I=k[0],T=k[1],r=k[2],K=k[3],l=I+I,P=T+T,C=r+r,H=I*l,i=I*P,q=I*C,F=T*P,g=T*C,t=r*C,c=K*l,m=K*P,V=K*C;return E[0]=1-(F+t),E[1]=i+V,E[2]=q-m,E[3]=0,E[4]=i-V,E[5]=1-(H+t),E[6]=g+c,E[7]=0,E[8]=q+m,E[9]=g-c,E[10]=1-(H+F),E[11]=0,E[12]=b[0],E[13]=b[1],E[14]=b[2],E[15]=1,E},Bk=Q.getRotationFromMatrix4,Aj=function(){var n=[0,0,0],h=[0,0,0],Z=[0,0,0],R=function(d,Z,B){d[0]=Z[1]*B[2]-Z[2]*B[1],d[1]=Z[2]*B[0]-Z[0]*B[2],d[2]=Z[0]*B[1]-Z[1]*B[0]},M=function(j){return j[0]*j[0]+j[1]*j[1]+j[2]*j[2]},m=function(c){var P=Math.sqrt(M(c));c[0]/=P,c[1]/=P,c[2]/=P},G=function(L,m,B){L[0]=m[0]-B[0],L[1]=m[1]-B[1],L[2]=m[2]-B[2]};return function(J,L,d){var O=wp();return G(Z,J,L),0===M(Z)&&(Z[2]=1),m(Z),R(n,d,Z),0===M(n)&&(1===Math.abs(d[2])?Z[0]+=1e-4:Z[2]+=1e-4,m(Z),R(n,d,Z)),m(n),R(h,Z,n),O[0]=n[0],O[4]=h[0],O[8]=Z[0],O[1]=n[1],O[5]=h[1],O[9]=Z[1],O[2]=n[2],O[6]=h[2],O[10]=Z[2],O}}(),Il=function(v,B){if(v.vr.enable){var l=v.vr.getViewMatrix(B);if(l)return l}return dd(B?B:wp(),v._eye,v._center,v._up)},as=function(_){if(_.vr.enable){var N=_.vr.getProjectMatrix();if(N)return N}var q=_.getAspect(),S=_._near,L=_._far,c=wp();if(_._ortho){var C=_._orthoWidth/2,e=C/q;bd(c,-C,C,-e,e,S,L)}else or(c,_._fovy,q,S,L);return c},Fc=function(C,Y){if(!C)return N;var p=0,H=1,a=2,h=[],i=0,K=C.length,c=K/3;if(Y){for(;K>i;i++)h[i]=0;for(i=0;i<Y.length;i+=3){var y=[],f=[],o=[];y[p]=C[3*Y[i+1]+p]-C[3*Y[i]+p],y[H]=C[3*Y[i+1]+H]-C[3*Y[i]+H],y[a]=C[3*Y[i+1]+a]-C[3*Y[i]+a],f[p]=C[3*Y[i+2]+p]-C[3*Y[i+1]+p],f[H]=C[3*Y[i+2]+H]-C[3*Y[i+1]+H],f[a]=C[3*Y[i+2]+a]-C[3*Y[i+1]+a],o[p]=y[H]*f[a]-y[a]*f[H],o[H]=y[a]*f[p]-y[p]*f[a],o[a]=y[p]*f[H]-y[H]*f[p];for(var _=0;3>_;_++)h[3*Y[i+_]+p]+=o[p],h[3*Y[i+_]+H]+=o[H],h[3*Y[i+_]+a]+=o[a]}}else for(i=0;c>i;i+=3){var y=[],f=[],o=[];y[p]=C[3*(i+1)+p]-C[3*i+p],y[H]=C[3*(i+1)+H]-C[3*i+H],y[a]=C[3*(i+1)+a]-C[3*i+a],f[p]=C[3*(i+2)+p]-C[3*(i+1)+p],f[H]=C[3*(i+2)+H]-C[3*(i+1)+H],f[a]=C[3*(i+2)+a]-C[3*(i+1)+a],o[p]=y[H]*f[a]-y[a]*f[H],o[H]=y[a]*f[p]-y[p]*f[a],o[a]=y[p]*f[H]-y[H]*f[p];for(var _=0;3>_;_++)h[3*(i+_)+p]=o[p],h[3*(i+_)+H]=o[H],h[3*(i+_)+a]=o[a]}for(i=0;K>i;i+=3){var I=[];I[p]=h[i+p],I[H]=h[i+H],I[a]=h[i+a];var J=m(I[p]*I[p]+I[H]*I[H]+I[a]*I[a]);0===J&&(J=ad),I[p]=I[p]/J,I[H]=I[H]/J,I[a]=I[a]/J,h[i+p]=I[p],h[i+H]=I[H],h[i+a]=I[a]}return new oi(h)},pl=function(Z,e,L,z){if(L||(L=Z.createTexture()),e){var X=Z.TEXTURE_2D,H=Z.REPEAT,x=Z.CLAMP_TO_EDGE,g=Z.TEXTURE_MIN_FILTER;z!==Z.NEAREST&&(z=Z.LINEAR),wo(Z,L),Z.texImage2D(X,0,Z.RGBA,Z.RGBA,Z.UNSIGNED_BYTE,e),Xe(Z,Z.TEXTURE_MAG_FILTER,z),uj(e.width)&&uj(e.height)&&!e.clampToEdge?(Xe(Z,Z.TEXTURE_WRAP_S,H),Xe(Z,Z.TEXTURE_WRAP_T,H),Xe(Z,g,Z.LINEAR_MIPMAP_LINEAR),Z.generateMipmap(X)):(Xe(Z,Z.TEXTURE_WRAP_S,x),Xe(Z,Z.TEXTURE_WRAP_T,x),Xe(Z,g,z)),wo(Z,N)}return L},gm=function(B,u){var j=new Uint8Array(3);return u=u||B.createTexture(),wo(B,u),Xe(B,B.TEXTURE_MIN_FILTER,B.LINEAR),B.texImage2D(B.TEXTURE_2D,0,B.RGB,1,1,0,B.RGB,B.UNSIGNED_BYTE,j),u},Lk=function(j){j._26I&&j._prg&&(j._26I.deleteProgram(j._prg),j._prg=N)},Xr=function(E,$,h,D){var Y=E.createShader(h);return E.shaderSource(Y,D),E.compileShader(Y),E.attachShader($,Y),Y},yk=function(B){return B.createBuffer()},wo=function(m,Z){m.bindTexture(m.TEXTURE_2D,Z)},Je=function(A,_){A.bindFramebuffer(A.FRAMEBUFFER,_)},Xe=function(N,r,o){N.texParameteri(N.TEXTURE_2D,r,o)},Hf=function($,G){if(G){var G=Ie(G);$.clearColor(G[0],G[1],G[2],G[3])}},Zb=function(O,b){ao(O,b.uFix,!0),ck(O,b.aNormal)},zh=function(C,z){ao(C,z.uFix,!1),Tc(C,z.aNormal)},Fj=function(L,G,g,T,v,O,S,$){L._picking||(g?(ao(L,G.uBlend,!0),ao(L,G.uBlendColor,g)):ao(L,G.uBlend,!1),ao(L,G.uLight,T==N?!0:T),wf(v)&&1!==v&&ao(L,G.uPartOpacity,v),ao(L,G.uReverseFlip,O==N?!1:O),ao(L,G.uFixPickReverseColor,S||Dl)),$?L.enable(L.CULL_FACE):L.disable(L.CULL_FACE)},gg=function(m,c){m._picking||ao(m,c.uPartOpacity,1)},ld=function(A,J,y,K,z,w,T,G,j){if(!y)return A.activeTexture(A.TEXTURE0),wo(A,A._emptyTexture),A.activeTexture(A.TEXTURE1),wo(A,A._emptyBlendTexture),void 0;ao(A,J.uTexture,!0),ao(A,J.uDiscardSelectable,mr(K)?K:!0),Tc(A,J.aUv),Um(A,z,w,J.aUv,2),j?(ao(A,J.uBlendTexture,!0),A.activeTexture(A.TEXTURE1),wo(A,j),A.uniform1i(J.uBlendSampler,1)):(ao(A,J.uBlendTexture,!1),A.activeTexture(A.TEXTURE1),wo(A,A._emptyBlendTexture)),A.activeTexture(A.TEXTURE0),wo(A,y),A.uniform1i(J.uSampler,0);var P=[0,0,1,1];T&&(P[0]=T[0],P[1]=T[1]),G&&(P[2]=G[0],P[3]=G[1]),ao(A,J.uOffsetScale,P)},fp=function(W,T,z){W.activeTexture(W.TEXTURE0),wo(W,N),W.activeTexture(W.TEXTURE1),wo(W,N),z&&(ck(W,T.aUv),ao(W,T.uTexture,!1),ao(W,T.uBlendTexture,!1))},Jd=function(A,u,c,V,X,m){!c||Y||C||A.lineWidth(c),V&&!A._picking&&ao(A,u.uFixPickReverseColor,V),X&&Um(A,X,m,u.aPosition)},qb=function(F,P,w,y){Fo&&(y=F[Fo]),F.drawArrays(y==N?F.TRIANGLES:y,P,w);var B=F._renderInfo;B&&(B.calls++,B.vertices+=w,(y==N||y===F.TRIANGLES)&&(B.faces+=w/3),y===F.LINES&&(B.lines+=w/2))},Tj=function(J,g,t,o){Fo&&(o=J[Fo]),J.drawElements(o==N?J.TRIANGLES:o,t,J.UNSIGNED_SHORT,g==N?0:2*g);var j=J._renderInfo;j&&(j.calls++,j.vertices+=t,(o==N||o===J.TRIANGLES)&&(j.faces+=t/3),o===J.LINES&&(j.lines+=t/2))},Bf=function(T,d,v,j,M){var L=T.ARRAY_BUFFER;T.bindBuffer(L,d),v&&T.bufferData(L,v,T.STATIC_DRAW),j!=N&&T.vertexAttribPointer(j,M?M:3,T.FLOAT,!1,0,0)},Um=function(U,R,$,f,C){return $?(wn(U,U.ARRAY_BUFFER,R,$),f!=N&&U.vertexAttribPointer(f,C?C:3,U.FLOAT,!1,0,0),void 0):Bf(U,R,$,f,C)},Ng=function(l,p,e){var v=l.ELEMENT_ARRAY_BUFFER;l.bindBuffer(v,p),e&&l.bufferData(v,e,l.STATIC_DRAW)},vk=function(g,B,o){wn(g,g.ELEMENT_ARRAY_BUFFER,B,o)},wn=function(D,A,v,l){var v,C=l.glBuf,f=D._id;C&&(v=C[f])&&v._buf?D.bindBuffer(A,v._buf):(v={_buf:yk(D)},D._bufPool.push(v),D.bindBuffer(A,v._buf),D.bufferData(A,l,D.STATIC_DRAW),C||(C=l.glBuf={}),C[f]=v),v._fid=D._renderInfo.frame},ao=function(w,Y,p){if(p!=N&&Y!=N){p=Ie(p);var T=p.length;3===T?w.uniform3fv(Y,p):4===T?w.uniform4fv(Y,p):16===T?w.uniformMatrix4fv(Y,!1,p):mr(p)?w.uniform1i(Y,p?1:0):2===T?w.uniform2fv(Y,p):w.uniform1f(Y,p)}},Tc=function(g,t){t!=N&&t>=0&&g.enableVertexAttribArray(t)},ck=function(m,V){V!=N&&V>=0&&m.disableVertexAttribArray(V)},Hg=function(b,s){var V=b.getGL(),R=b._prg;b._7O=b._8O.pop(),s&&(ao(V,R.uMVMatrix,b._7O),b._6O=s,ao(V,R.uNMatrix,s))},ai=function(G,Y){return Y||(Y=wp()),rd(Y,G),wi(Y),bj(Y),Y},yj=function(S,J){var I=S.getGL(),W=S._prg,Z=S._7O;J&&(S._8O.push(so(Z)),jn(Z,Z,J)),ao(I,W.uMVMatrix,Z),ao(I,W.uNMatrix,ai(Z,S._6O))},Ib=function(b,D,N,s,Q,X){if(N){if(s){var Y=N.value++,m=2147483648|Y,R=[(255&m>>16)/255,(255&m>>8)/255,(255&m)/255,(255&m>>24)/255];N[Y]={data:Q,part:X}}else R=Be;return ao(b,D.uFixPickReverseColor,R),R}},go=function(){var p={center:function(p,r,M,L,C){var I=-r[1]/2,A={x:-r[0]/2,y:I,width:r[0],height:r[1]},S=Dg(p,A,M);return[S.x+L,-S.y-C,kd()]},front:function(V,n,b,J,Q){var U=-n[1]/2,T={x:-n[0]/2,y:U,width:n[0],height:n[1]},p=Dg(V,T,b);return[p.x+J,-p.y-Q,n[2]/2+kd()]},back:function(F,C,Y,k,X){var l=-C[0]/2,b=-C[1]/2,D={x:l,y:b,width:C[0],height:C[1]},u=Dg(F,D,Y);return[-u.x-k,-u.y-X,-C[2]/2-kd()]},left:function(j,S,B,J,P){var v=-S[1]/2,H={x:-S[2]/2,y:v,width:S[2],height:S[1]},i=Dg(j,H,B);return[-S[0]/2-kd(),-i.y-P,i.x+J]},right:function(R,b,x,Q,s){var U=-b[2]/2,p=-b[1]/2,F={x:U,y:p,width:b[2],height:b[1]},H=Dg(R,F,x);return[b[0]/2+kd(),-H.y-s,-H.x-Q]},top:function(k,w,J,K,i){var N={x:-w[0]/2,y:-w[2]/2,width:w[0],height:w[2]},t=Dg(k,N,J);return[t.x+K,w[1]/2+kd(),t.y+i]},bottom:function(G,C,v,Q,R){var t=-C[2]/2,Z={x:-C[0]/2,y:t,width:C[0],height:C[2]},r=Dg(G,Z,v);return[r.x+Q,-C[1]/2-kd(),-r.y-R]}};return function(C,i,r,f,E,d){return p[f](C,i,r,E||0,d||0)}}(),uf=function(P,s,F,Y,j,U,A,m,r,Z){if(j&&(s[0]+=j[0],s[1]+=j[1],s[2]+=j[2]),Ze(P,F),m){var S=wp();if(Xq(S,r,Z),Po(s,S),Ze(P,s),P.auto=m,P.pos=Po([0,0,0],P),U){var n=P.mat2=wp();Xq(n,U,A)}}else Xq(P,r,Z),Ze(P,s),Y===kj?sr(P,-z):Y===Lj?sr(P,z):Y===Kf?ci(P,-z):Y===si?ci(P,z):Y===tf&&sr(P,H),Xq(P,U,A);return P},Lo=function(J,u){var B=u.auto,K=u.mat2,l=J.gv;if(B){var U,W=wp(),f=[0,0,0,0];U="string"==typeof B?[B.indexOf("x")<0?l._eye[0]:l._center[0],B.indexOf("y")<0?l._eye[1]:l._center[1],B.indexOf("z")<0?l._eye[2]:l._center[2]]:l._eye,Ep(f,dd(wp(),U,l._center,l._up)),Mj(W,De(f,f),u.pos),K&&jn(W,W,K),yj(l,W)}else yj(l,u)},qi=function(d,G,N,$,K){var v=d.s,u=d.gv,y=u.getGL(),m=u._prg,Q=u._buffer,P=u._1O;pl(y,Yb,P),Lo(d,N),Fj(y,m,v(G+".blend"),v(G+".light"),v(G+".opacity"),v(G+".reverse.flip"),v(G+".reverse.color"),v(G+".reverse.cull")),ld(y,m,P,K,Q.uv,Gc),Um(y,Q.vs,$,m.aPosition),Um(y,Q.ns,Sj,m.aNormal),vk(y,Q.is,hd),Tj(y,0,hd.length),fp(y,m,P),gg(y,m),Hg(u)},Gg=function(e,N,A){var R=e.gv,Q=e.data,k=e[N]={blend:R.getBodyColor(Q)||R.getFaceBlend(Q,N),light:R.getFaceLight(Q,N),color:R.getFaceColor(Q,N),opacity:R.getFaceOpacity(Q,N),transparent:R.getFaceTransparent(Q,N),reverseFlip:R.getFaceReverseFlip(Q,N),reverseColor:R.getFaceReverseColor(Q,N),reverseCull:R.getFaceReverseCull(Q,N),texture:R.getFaceImage(Q,N),blendTexture:R.getFaceBlendImage(Q,N),discardSelectable:R.getFaceDiscardSelectable(Q,N)};if("csg"!==N){k.uv=R.getFaceUv(Q,N)||A&&A[N+"Uv"],k.uvScale=R.getFaceUvScale(Q,N)||A&&A[N+"UvScale"],k.uvOffset=R.getFaceUvOffset(Q,N)||A&&A[N+"UvOffset"];var B=R.getFaceMat(Q,N);B&&(k.mat=Qq(Q,B))}return k},Jf=function(Q,_,U,C,f){if(C){if(!f(C.transparent))return;var c=Q.data,l=Q.gv,V=l._buffer,d=l.getTexture(C.texture,c),B=l.getTexture(C.blendTexture,c);ld(_,U,d,C.discardSelectable,V.uv,C.tuv,C.uvOffset,C.uvScale,B),Fj(_,U,C.blend,C.light,C.opacity,C.reverseFlip,C.reverseColor,C.reverseCull),ao(_,U.uDiffuse,C.color),Um(_,V.vs,C.vs,U.aPosition),Um(_,V.ns,C.ns,U.aNormal),qb(_,0,C.vs.length/3),gg(_,U),fp(_,U,d)}},Dq=function(i,n,v,W,l,X){var a,x,H,B,g,w,E,R,r,$,L,b=[W-n,l-v],d=i?i.length:0;for(H=0;d>H;H++){for(B=2,a=i[H],g=a[0],w=a[1];B+1<a.length;){if(E=a[B],R=a[B+1],x=nm(n,v,W,l,g,w,E,R,!0)){r=[E-g,R-w],$=uk(r),r[0]/=$,r[1]/=$,$=_o(b,r),$=$>0?X:-X,L=[r[0]*$,r[1]*$];break}g=E,w=R,B+=2}if(L)break}if(L)for(W=n+L[0],l=v+L[1],H=0;d>H;H++)for(B=2,a=i[H],g=a[0],w=a[1];B+1<a.length;){if(E=a[B],R=a[B+1],x=nm(n,v,W,l,g,w,E,R,!0))return[0,0];g=E,w=R,B+=2}return L?L:[W-n,l-v]},gq=M.graph3d={},Uf=function(G,v,g){Gd(B+".graph3d."+G,v,g)},ej="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",up="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Jc(Q,{setBatchInfo:function(P,e){kh[P]=e},getBatchInfo:function(k){return kh[k]}},!0);var qk=[1,1,1],Rc=[1,0,0,0,0,1,0,1,1,1,1,0],_h=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Bs=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],wj=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Jn=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],$m=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Db=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Mh=function(U,p){Ue(U,p,"_batchModelMap","_batchIndexMap"),Ui(U,p,"_wireframeModelMap","_wireframeIndexMap"),Ui(U,p,"_polylineModelMap","_polylineIndexMap"),Ui(U,p,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Ui(U,p,"_polylineModelMapSwap","_polylineIndexMapSwap")},Ue=function(u,l,k,c){if(!l)return u[k]={},u[c]={},void 0;var g=l._id,$=u[c],O=$[g];if(O){var _=u[k],G=O.batch,X=_[G],i=X.ds,p=O.index;if(X.invalidate=!0,delete $[g],i.splice(p,1),Yc(i))return delete _[G],void 0;for(var H=O.begin,P=O.size,v=3*H,s=3*P,F=4*H,x=4*P,q=X.vs,I=X.ps,n=X.uv,h=X.cs,Y=X.bs,y=X.rs,Z=X.ns,L=X.ls;p<i.length;p++)O=$[i[p]._id],O.index--,O.begin-=P;q.splice(v,s),I.splice(F,x),n&&n.splice(2*H,2*P),h&&h.splice(F,x),Y&&Y.splice(v,s),y&&y.splice(H,P),Z&&Z.splice(v,s),L&&L.splice(H,P)}},Ui=Ue,lg=function(o,U,S,t){if(!t)return N;var J=U[t];if(!J){var r=kh[t]||Zi,v=r.image?[]:N;J=U[t]={vs:[],ns:[],uv:v,cs:v?N:r.color?N:[],bs:r.blend?[]:N,ps:[],rs:r.brightness?[]:N,ds:[]}}return J.invalidate=!0,o[S._id]={index:J.ds.length,begin:J.vs.length/3,batch:t},J.ds.push(S),J},Fh=function(U,G){return G!=N&&1!==G?[U[0]*G,U[1]*G,U[2]*G,U[3]]:U},dc=function(D,i,e){var K=D.getBrightness(i),c=Ie(e.color||"white"),H=c[3]<1,y=Math.ceil(e.width)||1,F=(H?"T":"O")+y,U=D._wireframeIndexMap,b=D._wireframeModelMap,z=b[F];z||(z=b[F]={vs:[],cs:[],ps:[],ds:[],T:H,W:y});var E,B=D.getData3dUI(i),a=fj(B);if(e.geometry){if(!a)return;if(E=kq(a),!E)return}else E=e.short?Ae:cj;z.invalidate=!0;var T=z.vs,d=z.cs,w=z.ds,r=U[i._id]={index:w.length,begin:T.length/3,batch:F};w.push(i);var o=Qq(i,e.mat),v=B._calcAnchorMat(i);v&&jn(o,o,v),Nf(T,o,E);var x=r.size=T.length/3-r.begin;$b(d,Fh(c,K),x)},vs=function(t,X,r,U,G,$,B,m,M){var D=t.getBrightness(X);D==N&&(D=1);var x=Fh(Ie(U),D),C=x[3]<1;$=Math.ceil($)||1;var u=(C?"T":"O")+$;if(B){var z=B[0],W=(B[1]||z)+z;u+="-"+z+"-"+W,M&&(u+="-"+hf(M)+"-"+D,M=Fh(Ie(M),D))}var c=t._polylineIndexMap,n=t._polylineModelMap,i=n[u];i||(i=n[u]={vs:[],cs:[],ps:[],ds:[],ls:B?[]:N,T:C,W:$},B&&(i.D=z,i.G=W,i.A=M)),i.invalidate=!0;var O,P=i.vs,L=i.cs,q=i.ds,f=i.ls,p=c[X._id]={index:q.length,begin:P.length/3,batch:u};q.push(X),Cr(P,r);var Q,b=p.size=P.length/3-p.begin,E=r.length,h=0,s=[];if(B||G)for(O=0;E>O;O+=6)Q=uk([r[O],r[O+1],r[O+2]],[r[O+3],r[O+4],r[O+5]]),s.push(Q),h+=Q;if(h&&G){var d,o=Fh(Ie(G),D),k=[o[0]-x[0],o[1]-x[1],o[2]-x[2],o[3]-x[3]],H=0;for(O=0;E>O;O+=6)d=H/h,$b(L,[x[0]+k[0]*d,x[1]+k[1]*d,x[2]+k[2]*d,x[3]+k[3]*d],1),H+=s[O/6],d=H/h,$b(L,[x[0]+k[0]*d,x[1]+k[1]*d,x[2]+k[2]*d,x[3]+k[3]*d],1)}else $b(L,x,b);if(B)for(H=m||0,O=0;E>O;O+=6)f.push(H),H+=s[O/6],f.push(H)},He=function(r,x,C){if(x)for(var s=4*x.begin,P=C[x.batch].ps,Q=0;Q<x.size;Q++)P[s++]=r[0],P[s++]=r[1],P[s++]=r[2],P[s++]=r[3]},kn=function(q,O){var c=O+["32"],u=q[O],x=q[c];u?x&&x.length===u.length?(x.set(u),x.glBuf=null):q[c]=new oi(u):delete q[c]},Gn=function(p,H,h,j,E,s,k,G,W){if(Sg(h))h.forEach(function(D){Gn(p,H,D,j,E,s,k,G,W)});else if(Hq(h))Gn(p,H,fj(j,h),j,E,s,k,G,W);else if(eh(h)){var S,T=Hr(h.mat,H,p),b=Hr(h.s3,H,p),r=Hr(h.t3,H,p),N=Hr(h.r3,H,p);if((b||N||r||T)&&(S=rs(T,b,N,Hr(h.rotationMode,H,p),r),s.push(S)),h.shape3d)Gn(p,H,h.shape3d,j,E,s,k,G,h);else{var m=j.s;W=W||Zi;var A=s[0],e=s.length,y=m("shape3d.color",h.color,W.color);if(E||(E=m("shape3d.blend",h.blend,W.blend)),e>1){A=so(A);for(var Z=1;e>Z;Z++)jn(A,A,s[Z])}h.vs&&m(ji,h.visible,W.visible)&&he(A,k,G,h.vs,h.uv,h.is,E,y),h.top_vs&&m(Ni,h.topVisible,W.topVisible)&&he(A,k,G,h.top_vs,h.top_uv,h.top_is,E,m("shape3d.top.color",h.topColor,W.topColor)||y),h.bottom_vs&&m(Vi,h.bottomVisible,W.bottomVisible)&&he(A,k,G,h.bottom_vs,h.bottom_uv,h.bottom_is,E,m("shape3d.bottom.color",h.bottomColor,W.bottomColor)||y),h.from_vs&&m(rn,h.fromVisible,W.fromVisible)&&he(A,k,G,h.from_vs,h.from_uv,h.from_is,E,m("shape3d.from.color",h.fromColor,W.fromColor)||y),h.to_vs&&m(te,h.toVisible,W.toVisible)&&he(A,k,G,h.to_vs,h.to_uv,h.to_is,E,m("shape3d.to.color",h.toColor,W.toColor)||y)}S&&s.pop()}},he=function(t,B,f,N,i,y,W,q){var p,E=B.cs,H=B.uv,J=B.bs;if(y){p=y.length;for(var m=0;p>m;m++){var D=y[m];Nf(f,t,[N[3*D],N[3*D+1],N[3*D+2]]),H&&Cr(H,[i[2*D],i[2*D+1]])}}else p=N.length/3,Nf(f,t,N),H&&Cr(H,i);E&&$b(E,q,p),J&&(W?vi(J,W,p):Cr(J,qk,p))},lb=function(d,F,s,v){var a=[];v?Gn(d.gv,d.data,v,d,d.getBodyColor(),[F],s,a):(Qc(d,kj,F,s,a),Qc(d,Lj,F,s,a),Qc(d,Sh,F,s,a),Qc(d,tf,F,s,a),Qc(d,Kf,F,s,a),Qc(d,si,F,s,a),Qc(d,"csg",F,s,a)),a.length&&(Cr(s.vs,a),Cr(s.ns,Fc(a)))},Qc=function(m,B,t,M,Z){var I=m[B];if(I){var x=I.tuv;if(x){var f,q,K,v,l=I.uvScale,n=I.uvOffset;if(l)for(f=x.length,q=l[0],K=l[1],v=0;f>v;v+=2)x[v]*=q,x[v+1]*=K;if(n)for(f=x.length,q=n[0],K=n[1],v=0;f>v;v+=2)x[v]+=q,x[v+1]+=K}he(t,M,Z,I.vs,x,N,I.blend,I.color)}},gb=function(d,C,E,l,Q,D,O,i){var u,c=E.cs,J=E.uv,b=E.bs;if(d.getFaceVisible(C,D)){var o=d.getFaceMat(C,D);if(o&&(Q=Qq(C,o)),Nf(O,Q,i),c&&$b(c,d.getFaceColor(C,D),6),J){var F=d.getFaceUv(C,D)||l[D+"Uv"],N=d.getFaceUvScale(C,D)||l[D+"UvScale"],p=d.getFaceUvOffset(C,D)||l[D+"UvOffset"];F=F?[F[6],F[7],F[0],F[1],F[2],F[3],F[2],F[3],F[4],F[5],F[6],F[7]]:Rc;var t=F[0],r=F[1],Y=F[2],T=F[3],a=F[4],n=F[5],K=F[6],z=F[7],A=F[8],h=F[9],y=F[10],X=F[11];
if(N){var G=N[0],S=N[1];t*=G,r*=S,Y*=G,T*=S,a*=G,n*=S,K*=G,z*=S,A*=G,h*=S,y*=G,X*=S}if(p){var R=p[0],f=p[1];t+=R,r+=f,Y+=R,T+=f,a+=R,n+=f,K+=R,z+=f,A+=R,h+=f,y+=R,X+=f}J.push(t,r,Y,T,a,n,K,z,A,h,y,X)}b&&(u=d.getBodyColor(C)||d.getFaceBlend(C,D),u?vi(b,u,6):Cr(b,qk,6))}},kl=function(T,k,S,P){var b=T.getGL(),L=T._prg,o=T._buffer;if(!jj(k)){yj(T),Zb(b,L);for(var l in k){var n=k[l];if(!(P&&!n.T||!P&&n.T)){n.invalidate?(n.invalidate=!1,kn(n,"vs"),kn(n,"cs"),kn(n,"ls"),kn(n,"ps")):S&&kn(n,"ps");var q=n.vs32,D=S?n.ps32:n.cs32;Jd(b,L,n.W,N,o.vs,q);var $=n.D,G=!T._dashDisabled&&$;ao(b,L.uAlphaTest,_.alphaTest),G&&(ao(b,L.uDash,!0),ao(b,L.uDashDistance,$),ao(b,L.uDashGapDistance,n.G),Tc(b,L.aLineDistance),Um(b,o.lineDistance,n.ls32,L.aLineDistance,1),ao(b,L.uDiffuse,n.A||wb));var O=!T._batchColorDisabled;O&&(ao(b,L.uBatchColor,!0),Tc(b,L.aBatchColor),Um(b,o.batchColor,D,L.aBatchColor,4)),ld(b),qb(b,0,q.length/3,b.LINES),fp(b),O&&(ao(b,L.uBatchColor,!1),ck(b,L.aBatchColor)),G&&(ao(b,L.uDash,!1),ck(b,L.aLineDistance))}}zh(b,L)}},Zg=function(S,n,E){var b,Z,I,L,Y,g,C,y,O,f,F,X=S.getGL(),$=S._prg,G=S._buffer,v=S._batchModelMap;if(!jj(v)){yj(S);for(b in v)if(Z=kh[b]||Zi,!(E&&!Z.transparent||!E&&Z.transparent)&&(I=v[b],n||!Z.transparentMask)){var J=E&&Z.autoSort!==!1&&(S._33Q||I.invalidate);if(I.invalidate?(I.invalidate=!1,kn(I,"vs"),kn(I,"ns"),kn(I,"cs"),kn(I,"rs"),kn(I,"ps"),kn(I,"bs"),kn(I,"uv")):n&&kn(I,"ps"),Y=I.vs32,g=n?I.ps32:I.cs32,O=I.uv32,C=I.bs32,y=I.rs32,F=Y.length/3,J&&(I.is=co(Y,S.getEye())),F){L=Z.light,f=S.getTexture(Z.image),Fj(X,$,N,Z.light,Z.opacity,Z.reverseFlip,Z.reverseColor,Z.reverseCull),g?S._batchColorDisabled||(ao(X,$.uBatchColor,!0),Tc(X,$.aBatchColor),Um(X,G.batchColor,g,$.aBatchColor,4)):ao(X,$.uDiffuse,Z.color);var l=Z.alphaTest;ao(X,$.uAlphaTest,l===d?_.alphaTest:l);var a=C&&!S._batchBlendDisabled;a&&(ao(X,$.uBatchBlend,!0),Tc(X,$.aBatchBlend),Um(X,G.batchBlend,C,$.aBatchBlend));var K=y&&!S._batchBrightnessDisabled;K&&(ao(X,$.uBatchBrightness,!0),Tc(X,$.aBatchBrightness),Um(X,G.batchBrightness,y,$.aBatchBrightness,1)),O?ld(X,$,f,Z.discardSelectable,G.uv,O,Z.uvOffset,Z.uvScale):ld(X),Um(X,G.vs,Y,$.aPosition),Um(X,G.ns,I.ns32,$.aNormal),I.is?(Ng(X,G.is,I.is),Tj(X,0,F)):qb(X,0,F),O?fp(X,$,f):fp(X),g&&!S._batchColorDisabled&&(ao(X,$.uBatchColor,!1),ck(X,$.aBatchColor)),a&&(ao(X,$.uBatchBlend,!1),ck(X,$.aBatchBlend)),K&&(ao(X,$.uBatchBrightness,!1),ck(X,$.aBatchBrightness)),gg(X,$)}}}},co=function(B,w){for(var u=B.length/3,k=new Array(u),Z=u/3,H=new Array(Z),m=0;Z>m;m++)H[m]=m;H.sort(function(A,l){var k=9*A,J=[(B[k]+B[k+3]+2*B[k+6])/4,(B[k+1]+B[k+4]+2*B[k+7])/4,(B[k+2]+B[k+5]+2*B[k+8])/4];k=9*l;var r=[(B[k]+B[k+3]+2*B[k+6])/4,(B[k+1]+B[k+4]+2*B[k+7])/4,(B[k+2]+B[k+5]+2*B[k+8])/4],b=uk(w,J)-uk(w,r);return b>0?-1:0>b?1:0});for(var m=0;Z>m;m++){var o=3*m,j=3*H[m];k[o]=j,k[o+1]=j+1,k[o+2]=j+2}return new tp(k)},Zl={obj:function(m,U){var H={mat:m.mat,s3:m.s3,r3:m.r3,rotationMode:m.rotationMode,t3:m.t3,cube:m.cube==N?!0:m.cube,center:m.center==N?!0:m.center,ignoreMtls:m.ignoreMtls,ignoreTransparent:m.ignoreTransparent,ignoreColor:m.ignoreColor,ignoreImage:m.ignoreImage,ignoreNormal:m.ignoreNormal,prefix:m.prefix,flipY:m.flipY,flipFace:m.flipFace,reverseFlipMtls:m.reverseFlipMtls,finishFunc:function(N,Q){if(N){var Q=[];for(var $ in N){var j=N[$];Q.rawS3=j.rawS3,Q.push(j),m.eachModel&&m.eachModel($,j)}Q.json=m,U(Q)}else U()}};Q.loadObj(m.obj,m.mtl,H)}};Q.getModelTypeHandlers=function(){return Zl},Q.setModelTypeHandler=function(p,s){Zl[p]=s},Q.getModelTypeHandler=function(W){return Zl[W]},Q.handleModelLoaded=function(){},Q.handleUnfoundModel=function(){};var oh=N,lf=N,En=function(z){oh&&!z._loadingModelView_&&(lf||(lf={}),lf[z._loadingModelView_=vd()]=z)},dm=function(B,l){oh||(oh={});var S=oh[B];if(S){if(S.url===l)return;S.request.onload=Kp,S.request.onerror=Kp}var P=new XMLHttpRequest;if(oh[B]={request:P,url:l},P.overrideMimeType&&P.overrideMimeType("text/plain"),l=Q.beforeLoadURL(l),l.data){var h=Q.parse(l.data);Oj(B,h,l)}else P.open("GET",encodeURI(l),!0),P.onload=function(g){if(200===this.status||0===this.status){var k=Q.parse(g.target.response||g.target.responseText);Oj(B,k,l)}else tq(B,Q.handleUnfoundModel(B,l)||N)},P.onerror=function(){tq(B,Q.handleUnfoundModel(B,l)||N)},P.send(null)},Oj=function(O,m,x){var I=m.modelType;if(!I)return tq(O,m),Q.handleModelLoaded(O,m),void 0;var U=Q.getModelTypeHandler(I);if(U){var V=function(Z){Z?(tq(O,Z),Q.handleModelLoaded(O,Z)):tq(O,Q.handleUnfoundModel(O,x)||N)};U(m,V)}else tq(O,Q.handleUnfoundModel(O,x)||N)},tq=function(j,Y){if(Mp[j]=Y,delete oh[j],jj(oh)&&(oh=N,lf)){for(var i in lf){var A=lf[i];A._2O&&(A._2O={}),A.invalidateAll&&A.invalidateAll(d,"modelLoaded",j),A.redraw&&A.redraw(),A.iv(),delete A._loadingModelView_}lf=N}if(Y&&lf)for(var i in lf){var A=lf[i];A.invalidateAll&&A.invalidateAll(d,"modelLoading",j),A.redraw&&A.redraw(),A.iv()}},Gc=new oi([0,0,0,1,1,1,1,0]),Sj=new oi([0,0,1,0,0,1,0,0,1,0,0,1]),hd=new tp([0,1,2,2,3,0]),Qm=new oi([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Xh=new tp([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Lh=new oi([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),lq=Fc(Qm,Xh),cj=(new oi([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new tp([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),Ae=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],ll=function(X,_,f,W,e,d){d=d||16,X=X||16,_=_||0,f=f||X;var C,U,j,F,v,Z,y,z,L=.5,u=[],k=[],l=q/X,c=H/d;for(C=0;d>C;C++)for(v=C+1,F=C*c,z=v*c,U=_;f>U;U++)Z=U+1,j=U*l,y=Z*l,u.push(L*R(F)*E(j),L*E(F),-L*R(F)*R(j),L*R(z)*E(y),L*E(z),-L*R(z)*R(y),L*R(F)*E(y),L*E(F),-L*R(F)*R(y),L*R(F)*E(j),L*E(F),-L*R(F)*R(j),L*R(z)*E(j),L*E(z),-L*R(z)*R(j),L*R(z)*E(y),L*E(z),-L*R(z)*R(y)),k.push(U/X,C/d,Z/X,v/d,Z/X,C/d,U/X,C/d,U/X,v/d,Z/X,v/d);if(W){var t=[],$=[];for(j=_*l,C=0;d>C;C++)v=C+1,F=C*c,z=v*c,t.push(0,0,0,L*R(z)*E(j),L*E(z),-L*R(z)*R(j),L*R(F)*E(j),L*E(F),-L*R(F)*R(j)),$.push(0,.5,_/X,v/d,_/X,C/d)}if(e){var m=[],N=[];for(j=f*l,C=0;d>C;C++)v=C+1,F=C*c,z=v*c,m.push(0,0,0,L*R(F)*E(j),L*E(F),-L*R(F)*R(j),L*R(z)*E(j),L*E(z),-L*R(z)*R(j)),N.push(1,.5,f/X,C/d,f/X,v/d)}return{vs:u,uv:k,from_vs:t,from_uv:$,to_vs:m,to_uv:N}},js=function(Q,x,Y){Q=Q||.17,x=x||12,Y=Y||18,0>Q?Q=0:Q>.25&&(Q=.25);var S,W,F,Z,w,V,v,L=.5,C=[],p=[],X=[],j=q/Y,I=q/x,T=L-Q;for(W=0;x>=W;W++)for(Z=-H+W*I,V=E(Z),w=R(Z),S=0;Y>=S;S++)F=S*j,v=T+Q*V,C.push(E(F)*v,w*Q,-R(F)*v),p.push(S/Y,1-W/x);for(W=0;x>W;W++){var B=W*(Y+1),m=(W+1)*(Y+1);for(S=0;Y>S;S++)X.push(B+S,m+S+1,m+S,B+S,B+S+1,m+S+1)}return{vs:C,uv:p,is:X}},fk=function(s,B,P,o,O,J,d){d=d||12,s=s||18,B=B||0,P=P||s,J=J||.17,0>J?J=0:J>.25&&(J=.25);var p,j,W,M,v,b,F,a,c,L,h=.5,f=[],x=[],r=q/s,e=q/d,I=h-J;for(W=0;d>W;W++)for(M=W+1,F=-H+W*e,a=-H+M*e,p=B;P>p;p++)j=p+1,v=p*r,b=j*r,c=I+J*E(F),L=I+J*E(a),f.push(E(v)*c,R(F)*J,-R(v)*c,E(b)*c,R(F)*J,-R(b)*c,E(b)*L,R(a)*J,-R(b)*L,E(v)*c,R(F)*J,-R(v)*c,E(b)*L,R(a)*J,-R(b)*L,E(v)*L,R(a)*J,-R(v)*L),x.push(p/s,1-W/d,j/s,1-W/d,j/s,1-M/d,p/s,1-W/d,j/s,1-M/d,p/s,1-M/d);if(o){var k=[],i=[];for(W=0;d>W;W++)M=W+1,F=-H+W*e,a=-H+M*e,v=B*r,c=I+J*E(F),L=I+J*E(a),k.push(E(v)*c,R(F)*J,-R(v)*c,E(v)*L,R(a)*J,-R(v)*L,E(v)*I,0,-R(v)*I),i.push(.5+.5*E(F),.5-.5*R(F),.5+.5*E(a),.5-.5*R(a),.5,.5)}if(O){var A=[],z=[];for(W=0;d>W;W++)M=W+1,F=-H+W*e,a=-H+M*e,v=P*r,c=I+J*E(F),L=I+J*E(a),A.push(E(v)*c,R(F)*J,-R(v)*c,E(v)*I,0,-R(v)*I,E(v)*L,R(a)*J,-R(v)*L),z.push(.5-.5*E(F),.5-.5*R(F),.5,.5,.5-.5*E(a),.5-.5*R(a))}return{vs:f,uv:x,from_vs:k,from_uv:i,to_vs:A,to_uv:z}},Rq=function(z,s){for(var x,u,o,W=.5,d=16,k=[],P=[],e=[],K=q/d,B=0;d>=B;B++)x=B*K,u=E(x)*W,o=R(x)*W,k.push(u,-W,o,u,W,o),P.push(1-B/d,1,1-B/d,0);for(B=0;d>B;B++)e.push(2*B,2*B+1,2*B+3,2*B,2*B+3,2*B+2);if(s){var T=[],L=[],n=[];for(T.push(0,-W,0),L.push(.5,.5),B=0;d>=B;B++)x=B*K,u=E(x),o=R(x),T.push(u*W,-W,-o*W),L.push(.5+.5*u,.5+.5*o);for(B=0;d>B;B++)n.push(0,B+2,B+1)}if(z){var C=[],j=[],p=[];for(C.push(0,W,0),j.push(.5,.5),B=0;d>=B;B++)x=B*K,u=E(x),o=R(x),C.push(u*W,W,-o*W),j.push(.5+.5*u,.5-.5*o);for(B=0;d>B;B++)p.push(0,B+1,B+2)}return{vs:k,uv:P,is:e,bottom_vs:T,bottom_uv:L,bottom_is:n,top_vs:C,top_uv:j,top_is:p}},Ii=function(c,W,H,k,S,u,y){c=c||12,W=W||0,H=H||c;for(var o,F,T,t,h,p,V,M,z=.5,Y=[],b=[],f=q/c,C=W;H>C;C++)o=C+1,F=C*f,T=o*f,t=E(F)*z,h=R(F)*z,p=E(T)*z,V=R(T)*z,Y.push(t,-z,-h,p,-z,-V,t,z,-h,p,-z,-V,p,z,-V,t,z,-h),b.push(C/c,1,o/c,1,C/c,0,o/c,1,o/c,0,C/c,0);if(y){var Q=[],L=[];for(C=W;H>C;C++)F=f*C,T=f*(C+1),t=E(F),h=R(F),p=E(T),V=R(T),Q.push(t*z,-z,-h*z,0,-z,0,p*z,-z,-V*z),L.push(.5+.5*t,.5+.5*h,.5,.5,.5+.5*p,.5+.5*V)}if(u){var s=[],B=[];for(C=W;H>C;C++)F=f*C,T=f*(C+1),t=E(F),h=R(F),p=E(T),V=R(T),s.push(t*z,z,-h*z,p*z,z,-V*z,0,z,0),B.push(.5+.5*t,.5-.5*h,.5+.5*p,.5-.5*V,.5,.5)}if(k){var m=[],r=[];F=f*W,t=E(F)*z,h=R(F)*z,M=W/c,m.push(0,z,0,0,-z,0,t,-z,-h,t,-z,-h,t,z,-h,0,z,0),r.push(0,0,0,1,M,1,M,1,M,0,0,0)}if(S){var i=[],v=[];F=f*H,t=E(F)*z,h=R(F)*z,M=H/c,i.push(0,-z,0,0,z,0,t,z,-h,t,z,-h,t,-z,-h,0,-z,0),v.push(1,1,1,0,M,0,M,0,M,1,1,1)}return{vs:Y,uv:b,bottom_vs:Q,bottom_uv:L,top_vs:s,top_uv:B,from_vs:m,from_uv:r,to_vs:i,to_uv:v}},le=function(I,u,o,m,x){u=u||18,o=o||0,m=m==N?q:m,x=x==N?.5:x;for(var M,J,P,C,L,$,X=[0,.5,.75,.875,.9375],i=[],Q=[],n=[],Z=m/u,D=0;D<X.length;D++){var w=0===D%2?0:.5;for(M=0;u>=M;M++)J=(M+w)*Z+o,P=1-X[D],i.push(E(J)*x*P,-x+2*X[D]*x,-R(J)*x*P),Q.push((M+w)/u,P)}for(D=0;D<X.length-1;D++){var G=D*(u+1),y=(D+1)*(u+1);for(M=0;u>M;M++)n.push(G+M,y+M+1,y+M,G+M,G+M+1,y+M+1)}for($=i.length/3-(u+1),M=0;u>M;M++)i.push(0,x,0),Q.push((M+.5)/u,0);for(M=0;u>M;M++)n.push($+M,$+M+1,$+(u+1)+M);if(I){var p=[],B=[],f=[];for(p.push(0,-x,0),B.push(.5,.5),M=0;u>=M;M++)J=M*Z+o,C=E(J),L=R(J),p.push(C*x,-x,-L*x),B.push(.5+.5*C,.5+.5*L);for(M=0;u>M;M++)f.push(0,M+2,M+1)}return{vs:i,uv:Q,is:n,bottom_vs:p,bottom_uv:B,bottom_is:f}},ir=function(V,g,i,X,l,y){V=V||16,g=g||0,i=i||V;for(var H=.5,o=[],f=[],Z=q/V,w=g;i>w;w++){var U=w+1,r=Z*w,p=Z*U;o.push(E(r)*H,-H,-R(r)*H,E(p)*H,-H,-R(p)*H,0,H,0),f.push(w/V,1,U/V,1,(w+U)/2/V,0)}if(y){var $=[],C=[];for(w=g;i>w;w++){r=Z*w,p=Z*(w+1);var e=E(r),b=R(r),K=E(p),B=R(p);$.push(e*H,-H,-b*H,0,-H,0,K*H,-H,-B*H),C.push(.5+.5*e,.5+.5*b,.5,.5,.5+.5*K,.5+.5*B)}}if(X){var Y=[],W=[];r=Z*g,Y.push(0,H,0,0,-H,0,E(r)*H,-H,-R(r)*H),W.push(0,0,0,1,g/V,1)}if(l){var T=[],S=[];r=Z*i,T.push(0,-H,0,0,H,0,E(r)*H,-H,-R(r)*H),S.push(1,1,1,0,i/V,1)}return{vs:o,uv:f,bottom_vs:$,bottom_uv:C,from_vs:Y,from_uv:W,to_vs:T,to_uv:S}},Kh=function(J,i,G,r,O,A,e,c){for(var R=[],Z=0;Z<J.length-1;Z+=2)R.push({x:J[Z],y:J[Z+1]});return se(R,i,G,r,O,A,e,c,!1)},Ri={roundRect:function($,C){return Kh([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],$,C,3)},star:function(b,W){return Kh([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],b,W)},rect:function(f,Y){return Kh([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],f,Y)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(R,y){return Kh([0,-.5,.5,.5,-.5,.5],[1,2,2,5],R,y)},rightTriangle:function(V,C){return Kh([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],V,C)},parallelogram:function(P,v){return Kh([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],P,v)},trapezoid:function(K,D){return Kh([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],K,D)}},Wc={sphere:1,cylinder:1,cone:1,torus:1},Pe={torus:1,sphere:1},dr=Jc(hg(Ri),{cylinder:1}),Yg=Jc(hg(Ri),{cylinder:1,cone:1}),bb=function(s,N,Q){var A,j=Hr(s.mat,Q,N),G=Hr(s.s3,Q,N),y=Hr(s.t3,Q,N),f=Hr(s.r3,Q,N);return(G||f||y||j)&&(A=so(N._6O),yj(N,rs(j,G,f,Hr(s.rotationMode,Q,N),y))),A},db=function(y,e,p,K,t,H,m){if(Sg(p))p.forEach(function(i){db(y,e,i,K,t,H,m)});else if(Hq(p))db(y,e,fj(K,p),K,t,H,m);else if(eh(p))if(p.shape3d){var k=bb(p,y,e);db(y,e,p.shape3d,K,t,H,p),k&&Hg(y,k)}else Np(y,e,p,K.s,t,H,m)},Np=function(T,Y,C,B,e,u,r){if(r=r||Zi,!u||u(B("shape3d.transparent",C.transparent,r.transparent))){var q=bb(C,T,Y);Ic(C);var v=T._26I,p=T._prg,m=T._buffer,F=B("shape3d.color",C.color,r.color);e||(e=B("shape3d.blend",C.blend,r.blend));var o,I=C.opacity==N?r.opacity:C.opacity,t=B("shape3d.opacity");o=t!=N&&I!=N?I*t:I!=N?I:t,Fj(v,p,e,B("shape3d.light",C.light,r.light),o,B("shape3d.reverse.flip",C.reverseFlip,r.reverseFlip),B("shape3d.reverse.color",C.reverseColor,r.reverseColor),B("shape3d.reverse.cull",C.reverseCull,r.reverseCull)),C.vs&&B(ji,C.visible,r.visible)&&Pb(v,p,m,F,T.getTexture(B("shape3d.image",C.image,r.image),Y),B("shape3d.discard.selectable",C.discardSelectable,r.discardSelectable),C.vs,C.uv,C.ns,C.is,B("shape3d.uv.offset",C.uvOffset,r.uvOffset),B("shape3d.uv.scale",C.uvScale,r.uvScale)),C.top_vs&&B(Ni,C.topVisible,r.topVisible)&&Pb(v,p,m,B("shape3d.top.color",C.topColor,r.topColor)||F,T.getTexture(B("shape3d.top.image",C.topImage,r.topImage),Y),B("shape3d.top.discard.selectable",C.topDiscardSelectable,r.topDiscardSelectable),C.top_vs,C.top_uv,C.top_ns,C.top_is,B("shape3d.top.uv.offset",C.topUvOffset,r.topUvOffset),B("shape3d.top.uv.scale",C.topUvScale,r.topUvScale)),C.bottom_vs&&B(Vi,C.bottomVisible,r.bottomVisible)&&Pb(v,p,m,B("shape3d.bottom.color",C.bottomColor,r.bottomColor)||F,T.getTexture(B("shape3d.bottom.image",C.bottomImage,r.bottomImage),Y),B("shape3d.bottom.discard.selectable",C.bottomDiscardSelectable,r.bottomDiscardSelectable),C.bottom_vs,C.bottom_uv,C.bottom_ns,C.bottom_is,B("shape3d.bottom.uv.offset",C.bottomUvOffset,r.bottomUvOffset),B("shape3d.bottom.uv.scale",C.bottomUvScale,r.bottomUvScale)),C.from_vs&&B(rn,C.fromVisible,r.fromVisible)&&Pb(v,p,m,B("shape3d.from.color",C.fromColor,r.fromColor)||F,T.getTexture(B("shape3d.from.image",C.fromImage,r.fromImage),Y),B("shape3d.from.discard.selectable",C.fromDiscardSelectable,r.fromDiscardSelectable),C.from_vs,C.from_uv,C.from_ns,C.from_is,B("shape3d.from.uv.offset",C.fromUvOffset,r.fromUvOffset),B("shape3d.from.uv.scale",C.fromUvScale,r.fromUvScale)),C.to_vs&&B(te,C.toVisible,r.toVisible)&&Pb(v,p,m,B("shape3d.to.color",C.toColor,r.toColor)||F,T.getTexture(B("shape3d.to.image",C.toImage,r.toImage),Y),B("shape3d.to.discard.selectable",C.toDiscardSelectable,r.toDiscardSelectable),C.to_vs,C.to_uv,C.to_ns,C.to_is,B("shape3d.to.uv.offset",C.toUvOffset,r.toUvOffset),B("shape3d.to.uv.scale",C.toUvScale,r.toUvScale)),gg(v,p),q&&Hg(T,q)}},Pb=function(q,c,B,E,X,U,G,M,t,Z,m,F){G&&(ao(q,c.uDiffuse,E),M?ld(q,c,X,U,B.uv,M,m,F):ld(q),Um(q,B.vs,G,c.aPosition),Um(q,B.ns,t,c.aNormal),Z?(vk(q,B.is,Z),Tj(q,0,Z.length)):qb(q,0,G.length/3),M?fp(q,c,X):fp(q))},fj=function(O,a){var U=O.s;if(a||(a=U(Go)),!a)return N;var J=Mn(a);if(J)return J;if("text"===a){var Y={amount:U("shape3d.text.amount"),size:U("shape3d.text.size"),font:U("shape3d.text.font"),style:U("shape3d.text.style"),weight:U("shape3d.text.weight"),fill:U("shape3d.text.fill"),curveSegments:U("shape3d.text.curveSegments"),spacing:U("shape3d.text.spacing")},l=O.gv.getShape3dText(O.data),c=l;for(var t in Y)c+="_"+(Y[t]===d?"U":Y[t]);return O._cachedTextKey===c?O._cachedTextGeometry:(O._cachedTextKey=c,O._cachedTextGeometry=Q.createTextGeometry(l,Y))}var t=a;if(Wc[a]){var S=U("shape3d.side"),A=U("shape3d.side.from"),R=U("shape3d.side.to"),r=U(rn),L=U(te);3>S?(S=0,A=0,R=0,r=!1,L=!1):((A==N||0>A)&&(A=0),(R==N||R>S)&&(R=S),0===A&&R===S&&(r=!1,L=!1)),t+="-"+S+"-"+A+"-"+R+"-"+r+"-"+L}if(dr[a]){var n=U(Ni);t+="-"+n}if(Yg[a]){var m=U(Vi);t+="-"+m}if("torus"===a){var P=U("shape3d.torus.radius");0>P?P=0:P>.25&&(P=.25),t+="-"+P}if(Pe[a]){var o=U(Zp);t+="-"+o}return J=nn[t],J||("box"===a?J=Q.createBoxModel():Ri[a]?J=Ri[a](n,m):"sphere"===a?J=Q.createSphereModel(S,A,R,r,L,o):a===gf?J=Q.createCylinderModel(S,A,R,r,L,n,m):"cone"===a?J=Q.createConeModel(S,A,R,r,L,m):"torus"===a&&(J=Q.createTorusModel(S,A,R,r,L,P,o)),nn[t]=J),J},Ic=function(){var t=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],m=["is","top_is","bottom_is","from_is","to_is"];return x=sp(ej.substr(ej.indexOf("^#")+2)),Ko(Q[Lq(Ag+t[15]+"n"+t[16])]())&&Pg()?function(A){A&&!A._complete_&&(A._complete_=!0,A.vs&&Yc(A.ns)&&(A.ns=Fc(A.vs,A.is)),A.top_vs&&Yc(A.top_ns)&&(A.top_ns=Fc(A.top_vs,A.top_is)),A.bottom_vs&&Yc(A.bottom_ns)&&(A.bottom_ns=Fc(A.bottom_vs,A.bottom_is)),A.from_vs&&Yc(A.from_ns)&&(A.from_ns=Fc(A.from_vs,A.from_is)),A.to_vs&&Yc(A.to_ns)&&(A.to_ns=Fc(A.to_vs,A.to_is)),t.forEach(function(s){var t=A[s];Sg(t)&&(A[s]=new oi(t))}),m.forEach(function(E){var V=A[E];Sg(V)&&(A[E]=new tp(V))}))}:void 0}(),Xb=function(O,Y){var y=O[Y];Sg(y)&&(O[Y]=new oi(y))};Jc(sf,{_25Q:function(d){d._16O=function(u,R,Q,I,B,z,m,l,O){var K=this.info;if(K){var S,t,s,J,E,d,G=wp();if($f[R]?(S=K.p3,t=K.c1,s=K.c2):ap[R]?(t=K.s1||K.c1,s=K.s2||K.c2):(t=K.t1||K.c1,s=K.t2||K.c2),S)d=go(R,nr,Q,I,l,O);else{var F=fn(s,t),f=uk(t,s);J=[0,-D(F[2],F[0]),$(F[1]/f)],E="zyx",S=[(t[0]+s[0])/2,(t[1]+s[1])/2,(t[2]+s[2])/2],d=go(R,[f,0,0],Q,I,l,O)}return uf(G,d,S,I,B,z,m,u,J,E)}return vn},d._80o=function(p,C,J){var e=this,N=e.shapeModel;if(N){var T=e.gv;yj(T),db(T,e.data,N,e,e.getBodyColor(),J)}},d.createLineModel=function(B,K,l,A,m){for(var $=this,p=$.s,z=hk(B,K,p(Zp)),R=[],c=0;c<z.length;c++){var E=z[c],j=E.length;if(j>1){var G=E[0];R.push(G.x,G.y,G.z);for(var i=1;j-1>i;i++)G=E[i],R.push(G.x,G.y,G.z),R.push(G.x,G.y,G.z);G=E[j-1],R.push(G.x,G.y,G.z)}}var b,T,y,o=p(A+".color"),M=p(m),S=0;return M&&(T=p(m+".color"),b=p(m+".pattern"),S=p(m+".offset"),y=o),vs($.gv,$.data,R,T||o,y?N:p(A+".gradient.color"),l,b||p(A+".pattern"),S,y),z},d.createTubeModel=function(j,O,W,C){for(var q=this,k=q.s,$=k("shape3d.side")||vp,t=k("shape3d.start.angle"),v=k("shape3d.sweep.angle"),P=k(Ni)?k("shape3d.top.cap"):N,A=k(Vi)?k("shape3d.bottom.cap"):N,b="flat"===P,R="flat"===A,G=b&&(C?C.uv:k("shape3d.top.image")),x=R&&(C?C.uv:k("shape3d.bottom.image")),c=C?C.uv:k("shape3d.image"),y={vs:[],uv:c?[]:N,top_vs:b?[]:N,top_uv:G?[]:N,bottom_vs:R?[]:N,bottom_uv:x?[]:N},S=hk(j,O,k(Zp),W),Y=0,h=S.length;h>Y;Y++)Xd(y,S[Y],k(mi),W,$,t,v,P,A);if(C){var p=[];Gn(q.gv,q.data,y,q,q.getBodyColor(),[],C,p),p.length&&(Cr(C.vs,p),Cr(C.ns,Fc(p)))}else q.shapeModel=y;return S},d.getCache=function(){var P=this.info;if(P){var D=P.list;if(D){var c=P.cache;return c||(c=P.cache=hj(D)),c}}return N}}});var ve=function(j,t){for(var h,z=0,l=j.length,$=0,Z=l-1;Z>=$;)if(z=y($+(Z-$)/2),h=j[z].length-t,0>h)$=z+1;else{if(!(h>0)){Z=z;break}Z=z-1}z=Z;var Q=j[z],C=Q.point;return z===l-1||Q.length===t||(C=(new ng).subVectors(j[z+1].point,C).normalize().multiplyScalar(t-Q.length).add(C)),{point:C,tangent:Q.tangent}},hj=function(x){for(var i,D,c=[],$=0,I=0;I<x.length;I++){for(var r=x[I],y=0;y<r.length;y++){i=r[y],D&&($+=D.distanceTo(i));var E=new ng,J=r[y+1];J?E.subVectors(J,i):D?E.subVectors(i,D):E.x=1,E.normalize(),c.push({point:i,length:$,tangent:E}),D=i}D=null}return c},hk=function(C,P,v,q){v=v||$l;for(var c=[],k=0,e=C.size();e>k;k++){var F=C.get(k);c.push(new ng(F.x,F.e||0,F.y))}P&&(xi(P)&&(P=P._as),P.length||(P=null));for(var d,t,w,J,H,Z=[],u=0,L=0,Q=P?P.length:e;Q>L;L++)if(H=P?P[L]:0===L?1:2,1===H)Z.push(w=[]),w.push(c[u++]);else if(2===H||5===H)if(J=2===H?c[u++]:w[0],q){var E=P?P[L+1]:Q>L+1?2:N;if(2===E||5===E){var K=w[w.length-1],$=2===E?c[u]:w[0],l=(new ng).subVectors(K,J),S=(new ng).subVectors($,J),n=l.length(),g=S.length();if(n&&g)if(q>n/2&&q>g/2)w.push(J);else for(l.multiplyScalar(O(q,n/2)/n).add(J),S.multiplyScalar(O(q,g/2)/g).add(J),d=new $r(l,J,S).getPoints(v),t=0;v>=t;t++)w.push(d[t])}else w.push(J)}else w.push(J);else if(3===H)for(d=new $r(w[w.length-1],c[u++],c[u++]).getPoints(v),t=1;v>=t;t++)w.push(d[t]);else if(4===H)for(d=new fe(w[w.length-1],c[u++],c[u++],c[u++]).getPoints(v),t=1;v>=t;t++)w.push(d[t]);return Z},zk=function(P){for(var S,D,m=new ng,w=[],i=[],L=[],Y=0,$=P.length;$>Y;Y++)S=P[Y],D=P[Y+1],D?m.subVectors(D,S):m.subVectors(S,P[Y-1]),w.push(m.normalize().clone());var B,E,u,c,j=new ng,x=new ng,I=new Zq,r=1e-4,Q=Number.MAX_VALUE,T=w[0],H=i[0]=new ng,p=L[0]=new ng;for(E=A(T.x),u=A(T.y),c=A(T.z),Q>=E&&(Q=E,j.set(1,0,0)),Q>=u&&(Q=u,j.set(0,1,0)),Q>=c&&j.set(0,0,1),x.crossVectors(T,j).normalize(),H.crossVectors(T,x),p.crossVectors(T,H),Y=1;$>Y;Y++)i[Y]=i[Y-1].clone(),L[Y]=L[Y-1].clone(),x.crossVectors(w[Y-1],w[Y]),x.length()>r&&(x.normalize(),B=F(Oe(w[Y-1].dot(w[Y]),-1,1)),i[Y].applyMatrix4(I.makeRotationAxis(x,B))),L[Y].crossVectors(w[Y],i[Y]);return{B:L,T:w,N:i}},Xd=function(){var l=function(z){for(var U=1;U<arguments.length;U++){var s=arguments[U];z.push(s.x,s.y,s.z)}},B=function(P){for(var E=1;E<arguments.length;E++){var t=arguments[E].uv;P.push(t[0],t[1])}},o=function(w,U,X,y,F){var h=-y*E(F),p=y*R(F);return new ng(w.x+h*X.x+p*U.x,w.y+h*X.y+p*U.y,w.z+h*X.z+p*U.z)},O=function(F,h,t,X,y,J,g,B){g=g||q;for(var L=[],T=g/y,u=0;y>=u;u++){var b=o(F,h,t,X,u*T+J);L.push(b),B!=N&&(b.uv=[B,u/y])}return L},s=function(A,C,V,j,i,$,e,u,N){N=N||q;var p=C?A.top_vs:A.bottom_vs;if(p)for(var w=C?A.top_uv:A.bottom_uv,G=N/e,g=0;e>g;g++){var s,a;C?(s=g*G+u,a=(g+1)*G+u):(a=g*G+u,s=(g+1)*G+u),l(p,o(V,j,i,$,s),o(V,j,i,$,a),V),w&&w.push(.5-.5*E(s),.5-.5*R(s),.5-.5*E(a),.5-.5*R(a),.5,.5)}};return function(k,x,h,v,H,t,f,b,i){var r=x.length;if(r>1){var T,$,g,z,W,S,n,y=zk(x),L=y.T,_=y.N,Z=y.B;"flat"===b&&s(k,!0,x[0],Z[0],_[0],v,H,t,f),"flat"===i&&s(k,!1,x[r-1],Z[r-1],_[r-1],v,H,t,f);var M,D,R=[],C=U(H/2),V="round"===b,F="round"===i,K=x[0],w=L[0],Q=Z[0],e=_[0],q=x[r-1],c=L[r-1],u=Z[r-1],P=_[r-1];if(V){for(g=1;C>=g;g++)_.splice(0,0,e),Z.splice(0,0,Q),L.splice(0,0,w),D=-g/C*v,x.splice(0,0,w.clone().multiplyScalar(D).add(K)),R[C-g]=m(v*v-D*D);r+=C}if(F){for(g=1;C>=g;g++)_.push(P),Z.push(u),L.push(c),D=g/C*v,x.push(c.clone().multiplyScalar(D).add(q)),R[x.length-1]=m(v*v-D*D);r+=C}if(k.uv){var G=0,J=0,a=[];for(h&&(G=h),W=x[0],a[0]=0,g=1;r>g;g++)z=x[g],a[g]=W.distanceTo(z),W=z,h||(G+=a[g]);for(M=[],g=0;r>g;g++)J+=a[g],M[g]=G?J/G:0}for(g=0;r>g;g++){if(z=x[g],S=Z[g],n=_[g],T=O(z,S,n,R[g]===d?v:R[g],H,t,f,M?M[g]:N),$)for(var A=0;H>A;A++){var I=$[A],Y=$[A+1]||$[0],E=T[A],o=T[A+1]||T[0];l(k.vs,Y,I,E,E,o,Y),k.uv&&B(k.uv,Y,I,E,E,o,Y)}$=T}}}}();Jc(Q,{getLineLength:function(a){return a[a.length-1].length},getLineOffset:function(y,s){return ve(y,s)},getLineCacheInfo:function(A,J,s,f){return hj(hk(A,J,s,f))}});var Oo=M.Light=function(){Ho(Oo,this),this.s(jd,_[jd]),this.s(Go,"sphere"),this.s3(20,20,20)};Wj("Light",ts,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(F,d,C){Oo.superClass.onStyleChanged.apply(this,arguments),F===jd&&this.s("shape3d.color",C)}});var Zo=gq.Graph3dView=function(D,K){var p=this;p._attributes=K||Q.graph3dViewAttributes,p._25I={},p._view=nh(1,p);var c=p._canvas=Uq(p._view);c.addEventListener("webglcontextlost",function(H){H.preventDefault(),Lk(p),p._26I&&p._doBufferGC(p._26I,!0),p._26I=N,p._1o.texture=N,p._35O=!0},!1),c.addEventListener("webglcontextrestored",function(){p._35O=!1,p.iv()},!1),p._batchIndexMap={},p._batchModelMap={},p._wireframeIndexMap={},p._wireframeModelMap={},p._wireframeIndexMapSwap={},p._wireframeModelMapSwap={},p._polylineIndexMap={},p._polylineIndexMap={},p._polylineIndexMapSwap={},p._polylineIndexMapSwap={},p._8O=[],p._7O=wp(),p._6O=wp(),p._1o=new un(p),p._30O=new vc(p),p._31O=new yn(p),p._32O=new fq(p),p._raycaster=new gk(p),p.vr=new Lb(p),p._33Q=!0,p._eye=hg(Q.graph3dViewEye),p._center=hg(Q.graph3dViewCenter),p._up=hg(Q.graph3dViewUp),p._lightChanged=!1,p._59O=[],p._spots=[],p._dirs=[],p._frameId=0,p.overlappingBox=new od(p),p.dm(D?D:new Mf),p.setInteractors([new Zn(p)])},Vd={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},vb=0;Uf("Graph3dView",J,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Fl,ob,"firstPersonMode",Jh,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Kn,bq,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_editHelperDisabled:Q.graph3dViewEditHelperDisabled,_devicePixelRatio:d,_boundaries:d,_moveStep:Q.graph3dViewMoveStep,_rotateStep:Q.graph3dViewRotateStep,_pannable:Q.graph3dViewPannable,_rotatable:Q.graph3dViewRotatable,_walkable:Q.graph3dViewWalkable,_resettable:Q.graph3dViewResettable,_zoomable:Q.graph3dViewZoomable,_firstPersonMode:Q.graph3dViewFirstPersonMode,_mouseRoamable:Q.graph3dViewMouseRoamable,_gridVisible:Q.graph3dViewGridVisible,_gridSize:Q.graph3dViewGridSize,_gridGap:Q.graph3dViewGridGap,_gridColor:Q.graph3dViewGridColor,_originAxisVisible:Q.graph3dViewOriginAxisVisible,_centerAxisVisible:Q.graph3dViewCenterAxisVisible,_axisXColor:Q.graph3dViewAxisXColor,_axisYColor:Q.graph3dViewAxisYColor,_axisZColor:Q.graph3dViewAxisZColor,_ortho:Q.graph3dViewOrtho,_orthoWidth:Q.graph3dViewOrthoWidth,_fovy:Q.graph3dViewFovy,_near:Q.graph3dViewNear,_far:Q.graph3dViewFar,_headlightColor:Q.graph3dViewHeadlightColor,_headlightIntensity:Q.graph3dViewHeadlightIntensity,_headlightRange:Q.graph3dViewHeadlightRange,_headlightDisabled:Q.graph3dViewHeadlightDisabled,_rectSelectable:Q.graph3dViewRectSelectable,_rectSelectBackground:Q.graph3dViewRectSelectBackground,_editSizeColor:Q.graph3dViewEditSizeColor,_autoMakeVisible:rk,_fogDisabled:Q.graph3dViewFogDisabled,_fogColor:Q.graph3dViewFogColor,_fogNear:Q.graph3dViewFogNear,_fogFar:Q.graph3dViewFogFar,_dashDisabled:Q.graph3dViewDashDisabled,_batchColorDisabled:Q.graph3dViewBatchColorDisabled,_batchBlendDisabled:Q.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:Q.graph3dViewBatchBrightnessDisabled,setEye:function(O,j,o){1===arguments.length&&(j=O[1],o=O[2],O=O[0]);var z=this._eye;z[0]=O,z[1]=j,z[2]=o,this.fp(Kn,N,z)},setCenter:function(F,W,X){1===arguments.length&&(W=F[1],X=F[2],F=F[0]);var O=this._center;O[0]=F,O[1]=W,O[2]=X,this.fp(bq,N,O)},setUp:function(x,S,D){1===arguments.length&&(S=x[1],D=x[2],x=x[0]);var y=this._up;y[0]=x,y[1]=S,y[2]=D,this.fp("up",N,y)},isTransparentMask:function(D){return D.s("transparent.mask")},getAspect:function(){var _=this,k=_._aspect;return k?k:_.getWidth()/_.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(R){var s=this,B=s._dataModel,J=s._selectionModel;B!==R&&(B&&(B.ump(s.handleDataModelPropertyChange,s),B.umm(s.handleDataModelChange,s),B.umd(s.handleDataPropertyChange,s),J||B.sm().ums(s.handleSelectionChange,s)),s._dataModel=R,R.mp(s.handleDataModelPropertyChange,s),R.mm(s.handleDataModelChange,s),R.md(s.handleDataPropertyChange,s),J?J._21I(R):R.sm().ms(s.handleSelectionChange,s),s.invalidateAll(!0),s.invalidateLight(),s.fp(Fr,B,R),s._canvas.style.background=R.getBackground()||"")},handleDataModelPropertyChange:function(U){if("background"===U.property){var H=this._canvas.style.background,f=U.newValue||"";this._canvas.style.background=f,this.fp("canvasBackground",H,f)}},handleDataPropertyChange:function(Z){var Y=Z.data;this.invalidateData(Y),mf(Y)&&"s:light.type"===Z.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(d){var o=this,n=d.property;o.iv(),o._18Q=N,"eye"===n?o._33Q=!0:"devicePixelRatio"===n?o._42(N,o._devicePixelRatio||Wn):Vd[n]&&Lk(o)},_5O:function(I){var s=I._22Q();return s?new s(this,I):N},getData3dUI:function(V){var m=this._25I[V._id];return m===d&&(m=this._5O(V),this._25I[V._id]=m),m},invalidateAll:function(m){var Z=this;if(m){for(var l in Z._25I){var z=Z._25I[l];z&&z.dispose()}Z._25I={},Z.iv(),Mh(Z)}else Z.dm().each(function(q){Z.invalidateData(q)})},invalidateSelection:function(){var j=this;j.sm().each(function(d){j.invalidateData(d)})},invalidateData:function(c){var E=this,r=E.getData3dUI(c);r&&(r.iv(),E.iv()),Mh(E,c)},getShape3dText:function(x){return x.getStyle("shape3d.text")||this.getLabel(x)},invalidateBatch:function(g){var x=this,Y=x._batchModelMap,M=Y[g],e=[],N={};if(M){M.ds.forEach(function(r){var T=x.getData3dUI(r);T&&T.iv(),delete x._batchIndexMap[r._id],e.push(r._id)}),delete Y[g];for(var W,K,o,i,l,w,T,S,G,t=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],p=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],n=0;n<t.length;n++){var C=x[t[n]],k=x[p[n]];for(N={},S=0;S<e.length;S++){var j=k[e[S]];if(j){delete k[e[S]],G=j.batch,W=C[G];var L=j.begin,h=j.size,F=3*L,a=3*h,v=4*L,O=4*h;for(K=W.ds,o=W.vs,i=W.cs,l=W.ps,w=W.ls,T=j.index,W.invalidate=!0,K[T]=d,T=F;F+a>T;T++)o[T]=d;for(T=v;v+O>T;T++)i[T]=d;for(T=v;v+O>T;T++)l[T]=d;if(w)for(T=F;F+a>T;T++)w[T]=d;N[G]=!0}}for(G in N){W=C[G],K=W.ds,o=W.vs,i=W.cs,l=W.ps,w=W.ls;var R=[];for(T=0;T<K.length;T++)K[T]!==d&&R.push(K[T]);if(0===R.length)delete C[G];else{for(W.ds=R,R=[],T=0;T<o.length;T++)o[T]!==d&&R.push(o[T]);for(W.vs=R,R=[],T=0;T<i.length;T++)i[T]!==d&&R.push(i[T]);for(W.cs=R,R=[],T=0;T<l.length;T++)l[T]!==d&&R.push(l[T]);if(W.ps=R,w){for(R=[],T=0;T<w.length;T++)w[T]!==d&&R.push(w[T]);W.ls=R}}}}x.iv()}},handleDataModelChange:function(g){var w=this,t=g.kind,k=g.data;if("add"===t)w.invalidateData(k),Hm(k)&&k.getEdgeGroup()&&k.getEdgeGroup().eachSiblingEdge(w.invalidateData,w),mf(k)&&w.invalidateLight();else if(t===Ek){var n=k._id,U=w._25I[n];U&&(U.dispose(),delete w._25I[n],w.iv()),k===w._currentSubGraph&&w.setCurrentSubGraph(N),Mh(w,k),mf(k)&&w.invalidateLight()}else t===qf&&(w.invalidateAll(!0),w.setCurrentSubGraph(N),Mh(w),w.invalidateLight())},toCanvas:function(d){var O=this,t=O.getGL();if(O.validate(),d){var x=t.getParameter(t.COLOR_CLEAR_VALUE);Hf(t,d)}O._42(N,1);var z=O.getWidth(),s=O.getHeight(),u=new Uint8Array(4*z*s),j=Uq(),R=j.getContext("2d");t.readPixels(0,0,z,s,t.RGBA,t.UNSIGNED_BYTE,u),pp(j,z,s,1);for(var X=R.getImageData(0,0,z,s),h=X.data,V=0;V<h.length;V+=4){var L=V/4,F=y(L/z),a=L-F*z;L=4*((s-1-F)*z+a),h[L]=u[V],h[L+1]=u[V+1],h[L+2]=u[V+2],h[L+3]=u[V+3]}return R.putImageData(X,0,0),d&&Hf(t,x),O._42(N,O._devicePixelRatio||Wn),j},toDataURL:function(f,k){var D=this,b=D.getGL();if(D.validate(),f){var w=b.getParameter(b.COLOR_CLEAR_VALUE);Hf(b,f)}D._42(N,1);var B=D._canvas.toDataURL(k||"image/png",1);return f&&Hf(b,w),D._42(N,D._devicePixelRatio||Wn),B},getGL:function(){var x=this,Z=x._26I,$=x._prg;if(!Z)try{x._2O={},Z=x._26I=x._canvas.getContext("webgl",x._attributes)||x._canvas.getContext("experimental-webgl",x._attributes),Z._emptyTexture=gm(Z),Z._emptyBlendTexture=gm(Z),Z._bufPool=[],Z._id=++vb,x._buffer={vs:yk(Z),ns:yk(Z),is:yk(Z),uv:yk(Z),batchColor:yk(Z),batchBlend:yk(Z),batchBrightness:yk(Z),lineDistance:yk(Z)},x._1O=pl(Z);
var V=x._cube={vs:yk(Z),ns:yk(Z),is:yk(Z),uv:yk(Z)};Bf(Z,V.vs,Qm),Bf(Z,V.ns,lq),Bf(Z,V.uv,Lh),Ng(Z,V.is,Xh)}catch(d){}if(Z&&!$){if($=x._prg=Z.createProgram(),!$)return N;var m=x._dirs.length,j=x._spots.length,X=x._59O.length,h=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];m&&h.push("uDirColor","uDirDirection"),j&&h.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),X&&h.push("uPointColor","uPointRange","uPointPosition"),Hf(Z,[0,0,0,0]),Z.clearDepth(1),Z.enable(Z.DEPTH_TEST),Z.depthFunc(Z.LEQUAL),Z.enable(Z.BLEND),Z.blendFuncSeparate(Z.SRC_ALPHA,Z.ONE_MINUS_SRC_ALPHA,Z.ONE,Z.ONE_MINUS_SRC_ALPHA),Rp||(ej=sp(ej.substring(0,ej.indexOf("^#"))),up=sp(up),Rp=!0);var K=["#define MAX_DIR "+m,"#define MAX_SPOT "+j,"#define MAX_POINT "+X,x._fogDisabled?"":"#define FOG",x._dashDisabled?"":"#define DASH",x._batchColorDisabled?"":"#define BATCHCOLOR",x._batchBlendDisabled?"":"#define BATCHBLEND",x._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),v=Xr(Z,$,Z.VERTEX_SHADER,ej.replace("PREFIX",K)),p=Xr(Z,$,Z.FRAGMENT_SHADER,up.replace("PREFIX",K));Y?h.push("aPosition"):($.aPosition=0,Z.bindAttribLocation($,0,"aPosition")),Z.linkProgram($),h.forEach(function(G){$[G]=/^u/.test(G)?Z.getUniformLocation($,G):Z.getAttribLocation($,G)}),Z.useProgram($),Z.deleteShader(v),Z.deleteShader(p)}return Z},getBrightness:function(U){var V=U.s("brightness"),y=this.isSelected(U)?U.s("select.brightness"):N;return V==N?y:y==N?V:V*y},getWireframe:function(i){var u=i.s("wf.visible"),P=i.s("wf.width");return u===!0||P>0&&"selected"===u&&this.isSelected(i)?{color:i.s("wf.color"),width:P,"short":i.s("wf.short"),mat:i.s("wf.mat")}:void 0},_transformPointToViewSpace:function(w){var c=[w[0],w[1],w[2]];return Po(c,this._viewMatrix),c},_transformDirectionToViewSpace:function(R,q){var r=[R[0],R[1],R[2]];Po(r,this._viewMatrix);var z=q?[q[0],q[1],q[2]]:[0,0,0];Po(z,this._viewMatrix);var s=z[0]-r[0],T=z[1]-r[1],g=z[2]-r[2],F=Math.sqrt(s*s+T*T+g*g);return F?[s/F,T/F,g/F]:[s,T,g]},getWireframeGeometry:function(I){return I.s("wf.geometry")?{color:I.s("wf.color"),width:I.s("wf.width"),mat:I.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(F){return F.s("body.color")},getMat:function(l){return l.getMat?l.getMat():l.s("mat")},getFaceMat:function(U,p){return U.getFaceMat?U.getFaceMat(p):U.s(p+".mat")},getFaceBlend:function(N,L){return N.s(L+".blend")||N.s("all.blend")},getFaceColor:function(o,t){return o.s(t+".color")||o.s("all.color")},getFaceImage:function(N,r){return N.s(r+".image")||N.s("all.image")},getFaceBlendImage:function(V,S){return V.s(S+".blend.image")||V.s("all.blend.image")},getFaceDiscardSelectable:function(h,J){var t=h.s(J+".discard.selectable");return t==N?h.s("all.discard.selectable"):t},getFaceUv:function(D,K){return D.s(K+".uv")||D.s("all.uv")},getFaceUvOffset:function(Y,N){return Y.s(N+".uv.offset")||Y.s("all.uv.offset")},getFaceUvScale:function(R,s){return R.s(s+".uv.scale")||R.s("all.uv.scale")},getFaceLight:function(v,W){var D=v.s(W+".light");return D==N?v.s("all.light"):D},getFaceVisible:function(l,I){var f=l.s(I+".visible");return f==N?l.s("all.visible"):f},getFaceOpacity:function(P,p){var d=P.s(p+".opacity");return d==N?P.s("all.opacity"):d},getFaceTransparent:function(b,F){var T=b.s(F+".transparent");return T==N?b.s("all.transparent"):T},getFaceReverseColor:function(I,T){return I.s(T+".reverse.color")||I.s("all.reverse.color")},getFaceReverseFlip:function(k,V){var K=k.s(V+".reverse.flip");return K==N?k.s("all.reverse.flip"):K},getFaceReverseCull:function(s,L){var U=s.s(L+".reverse.cull");return U==N?s.s("all.reverse.cull"):U},getTextureMap:function(){return this._2O},deleteTexture:function(S){var J=this,b=J._2O[S];b&&(delete J._2O[S],J.getGL().deleteTexture(b))},invalidateShape3dCachedImage:function(C){var v=this.getData3dUI(C);v.invalidateCachedTexture(this.getGL())},getTexture:function(u,w){if(!u)return N;var h=this,d=h.getGL(),x=h._2O[u];if(!x){var b=cd(u);if(b)if(b.tagName){if(b.dynamic)return pl(d,b,h._1O);x=h._2O[u]=pl(d,b)}else{var R,U=w&&w.s("shape3d.image.cache");if(U&&(R=h.getData3dUI(w),x=R.getCachedTexture()),!x){var Z=w&&w.s("shape3d.fixSizeOnScreen"),Q=Z?d.NEAREST:d.LINEAR;Z||w&&w.s("shape3d.vector.dynamic")&&(R||(R=h.getData3dUI(w)),Z=R.getVectorDynamicSize());var E=w&&w.s("shape3d.texture.scale")||1,p=Z&&Z[0]>0?Z[0]:E*pg(b,w),S=Z&&Z[1]>0?Z[1]:E*gh(b,w);if(p>=1&&S>=1){p*=devicePixelRatio,S*=devicePixelRatio;var L=Zr(p,S);tg(L,b,0,0,p,S,w,h),L.restore(),U&&Id(b,w)?(x=pl(d,Yb,null,Q),R.setCachedTexture(x),Yb=null):x=pl(d,Yb,h._1O,Q)}}}}return x},redraw:function(){this.iv()},validateImpl:function(){var i=this;if(i._lightChanged){i._lightChanged=!1;var e=[],s=[],B=[];i.dm().each(function(Y){if(mf(Y)){var M=Y.s("light.type");M===On?e.push(Y):M===Mk?s.push(Y):M===qm&&B.push(Y)}}),(e.length!==i._59O.length||s.length!==i._spots.length||B.length!==i._dirs.length)&&Lk(i),i._59O=e,i._spots=s,i._dirs=B}i._42(),i._1o.iv()},getRenderInfo:function(){var Z=this.getGL();return Z?Z._renderInfo:void 0},showDebugTip:function(){var T=this,F=T._debugDiv;if(!F){F=T._debugDiv=K.createElement("div"),F.style.position="absolute",F.style.overflow="hidden",F.style.backgroundColor="white",F.style.color="black";var v=T.getView();T._79O?v.insertBefore(F,T._79O):v.appendChild(F),T._debugTipTimerId=setInterval(function(){var D=T.getRenderInfo();if(D){var h=T.getGL()._bufPool,X=h.length-(h._ivCount||0),O="Draw Calls: "+D.calls+"<br/>"+"Vertices: "+D.vertices+"<br/>"+"Faces: "+D.faces+"<br/>"+"Lines: "+D.lines+"<br/>"+"Buffer Count: "+X;F.innerHTML=O}},10)}},hideDebugTip:function(){var L=this,$=L._debugDiv;$&&(delete L._debugDiv,cancelAnimationFrame(L._debugTipTimerId),delete L._debugTipTimerId,L.getView().removeChild($))},_42:function(v,m){var x=this;if(!x._35O&&(!No||Fi(No))){var H,c;v&&(v instanceof ts?c=v:H=v);var g=x._canvas,V=x.getWidth(),Y=x.getHeight(),D=x.getGL(),e=x._prg;if(D){m?v||pp(g,V,Y,m):(m=x._devicePixelRatio||Wn,v||V===g.clientWidth&&Y===g.clientHeight||pp(g,V,Y,m)),D.clear(D.COLOR_BUFFER_BIT);var J=function(){if(D._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++x._frameId},x.overlappingBox.clear(),x._81O=N,D.clear(D.DEPTH_BUFFER_BIT),ao(D,e.uBrightness,1),ao(D,e.uOpacity,1),ao(D,e.uPartOpacity,1),D._picking=!!v,ao(D,e.uPick,!!v),ao(D,e.uTexture,!1),ao(D,e.uBlendTexture,!1),ao(D,e.uAlphaTest,_.alphaTest),ao(D,e.uTransparent,!1),ao(D,e.uFix,!1),ao(D,e.uBatchColor,!1),ao(D,e.uBatchBlend,!1),ao(D,e.uBatchBrightness,!1),ao(D,e.uPMatrix,x._projectMatrix=as(x)),ao(D,e.uViewMatrix,Il(x,x._7O)),x._viewMatrix=so(x._7O),v||(Er(x,D,e),x._fogDisabled||(ao(D,e.uFogColor,x._fogColor),ao(D,e.uFogNear,x._fogNear),ao(D,e.uFogFar,x._fogFar))),Tc(D,e.aPosition),Tc(D,e.aNormal),ck(D,e.aUv),ck(D,e.aBatchColor),ck(D,e.aBatchBlend),ck(D,e.aBatchBrightness),ck(D,e.aLineDistance),c){var T=D.getParameter(D.COLOR_CLEAR_VALUE);D.clearColor(0,0,0,0),D.disable(D.BLEND),ck(D,e.aNormal),Bf(D,x._cube.vs,N,e.aPosition),Ng(D,x._cube.is),sk(c,x,kj,0),sk(c,x,Sh,6),sk(c,x,Lj,12),sk(c,x,tf,18),sk(c,x,Kf,24),sk(c,x,si,30),Tc(D,e.aNormal),Hf(D,T)}else if(H){H.value=2;var T=D.getParameter(D.COLOR_CLEAR_VALUE);D.clearColor(0,0,0,0),D.disable(D.BLEND),x._95I(D,e,H),Zg(x,H),kl(x,x._polylineModelMap,H),kl(x,x._wireframeModelMap,H),ao(D,e.uTransparent,!0),x._95I(D,e,H,!0),Zg(x,H,!0),kl(x,x._polylineModelMap,H,!0),kl(x,x._wireframeModelMap,H,!0),ao(D,e.uTransparent,!1),D.clear(D.DEPTH_BUFFER_BIT),x._swapLineMap(),x._95I(D,e,H,!1,!0),kl(x,x._polylineModelMap,H),kl(x,x._wireframeModelMap,H),x._swapLineMap(),D.disable(D.DEPTH_TEST),x._30O._42(D,e,H),D.enable(D.DEPTH_TEST),Hf(D,T)}else D.disable(D.BLEND),x.drawSky(D,e),x._31O._42(D,e),x._95I(D,e),Zg(x),kl(x,x._polylineModelMap),kl(x,x._wireframeModelMap),D.enable(D.BLEND),ao(D,e.uTransparent,!0),D.depthMask(!1),x._95I(D,e,N,!0),Zg(x,N,!0),kl(x,x._polylineModelMap,N,!0),kl(x,x._wireframeModelMap,N,!0),D.depthMask(!0),ao(D,e.uTransparent,!1),D.clear(D.DEPTH_BUFFER_BIT),x._swapLineMap(),x._95I(D,e,N,!1,!0),kl(x,x._polylineModelMap),kl(x,x._wireframeModelMap),x._swapLineMap(),D.disable(D.DEPTH_TEST),D.disable(D.BLEND),x._32O._42(D,e),x._30O._42(D,e),D.enable(D.DEPTH_TEST);Bf(D,N),Ng(D,N)},E=!1,C=V*m,t=Y*m,Q=x.vr;Q.enable&&Q._42(D,C,t,J)&&(E=!0);var d=x.envRenderer;d&&d.enable&&d._42(D,C,t,J)&&(E=!0),E||(D.viewport(0,0,V*m,Y*m),J()),x._33Q=!1,x._doBufferGC(D)}}},setBufferGCInterval:function(N){this._bufferGCInterval=N},_doBufferGC:function(q,C){var Q=q._bufPool,m=Q.length;if(m){var l,u,w=q._renderInfo.frame,g=this._bufferGCInterval||10,f=0;for(l=0;m>l;l++)u=Q[l],u?(C||w-u._fid>g)&&(f++,q.deleteBuffer(u._buf),u._buf=null,Q[l]=null):f++;if(f>m/2&&f>128){var E=[];for(l=0;m>l;l++)Q[l]&&E.push(Q[l]);q._bufPool=E}else Q._ivCount=f}},_swapLineMap:function(){var I=this;W=I._polylineModelMap,I._polylineModelMap=I._polylineModelMapSwap,I._polylineModelMapSwap=W,W=I._wireframeModelMap,I._wireframeModelMap=I._wireframeModelMapSwap,I._wireframeModelMapSwap=W,W=I._polylineIndexMap,I._polylineIndexMap=I._polylineIndexMapSwap,I._polylineIndexMapSwap=W,W=I._wireframeIndexMap,I._wireframeIndexMap=I._wireframeIndexMapSwap,I._wireframeIndexMapSwap=W},_updateSkyBoxPosition:function(q){if(this._skyBox&&q&&"eye"===q.property){var W=q.newValue;this._skyBox.p3(W[0],W[1],W[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(b){this._skyBox=b,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),b&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(k,p,H){var W=this,G=W._skyBox;if(G){var n=W._headlightIntensity,R=Ie(W._headlightColor),p=W._prg;1!==n&&(R=[R[0]*n,R[1]*n,R[2]*n]),ao(k,p.uHeadlightColor,[R[0],R[1],R[2],1]);var S=W.getData3dUI(G);S&&S._42(k,p,H,function(){return!0}),k.clear(k.DEPTH_BUFFER_BIT),ao(k,p.uHeadlightColor,[R[0],R[1],R[2],W._headlightDisabled?1:0])}},_95I:function(W,P,F,e,n){function f(w){if(!!w.s("shape3d.alwaysOnTop")==!!n&&L.isVisible(w)&&(!p||l)){if(!F&&L.isTransparentMask(w))return;var m=L.getData3dUI(w);m&&m._42(W,P,F,K)}}var L=this,K=function(a){return e?a:!a};L.sky&&W.clear(W.DEPTH_BUFFER_BIT),L.dm().each(f)},getLogicalPoint:function(n){return ar(n,this._canvas)},isRectOverlapping:function(b){var A=this.getData3dUI(b);return A._rectOverlapping},getHitFaceInfo:function(G){G.target&&(G=this.lp(G));var O=this.getDataInfoAt(G);if(O){var u=this._1o.face(O.data,Ve(G.x,G.y));if(u)return{data:O.data,face:u}}return N},unproject:function(L,O){var B=this,j=B.getWidth(),q=B.getHeight(),z=L.target?B.lp(L):L,v=z.x-j/2,X=z.y-q/2,t=2*(v/j),m=2*(-1*X/q);O=O||0;var E=wp(),S=as(B),$=Il(B);jn(E,S,$),wi(E);var W=og([t,m,O,1],E);return[W[0]/W[3],W[1]/W[3],W[2]/W[3]]},getDataAt:function(m){var Z=this.getDataInfoAt(m);return Z?Z.data:N},getDataInfoAt:function(j,i){return j.target&&(j=this.lp(j)),this._1o.get(Ve(j.x,j.y,i),!0)},getDatasInRect:function(d){return this._1o.get(d)},setEditable:function(V){var G=this,t=G._editable;G._editable=V,this.fp(Ll,t,V)},isEditable:function(U){var M=this;return M._editable?Oh(U)?U.s("3d.editable")?M._editableFunc?M._editableFunc(U):!0:!1:!1:!1},isSelectable:function(A){return A.s("3d.selectable")&&this.sm().isSelectable(A)},isMovable:function(H){var r=this;return Hm(H)&&H.getStyle(Zk)!==Sb?!1:H.s("3d.movable")?r._movableFunc?r._movableFunc(H):!0:!1},isSizeEditable:function(j){return Oh(j)?this._sizeEditableFunc?this._sizeEditableFunc(j):!0:!1},isRotationEditable:function(g){return Oh(g)&&g.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(g):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(C){this.setZoom(ym,C)},zoomOut:function(z){this.setZoom(1/ym,z)},setZoom:function(h,d){if(1!==h){var z=this;if(z._ortho)return z.setOrthoZoom(h,d),void 0;z._14o&&z._14o.stop(!0);var O=1/h,K=z._eye,T=z._center,Z=T[0]+(K[0]-T[0])*O-K[0],H=T[1]+(K[1]-T[1])*O-K[1],o=T[2]+(K[2]-T[2])*O-K[2];if(!(uk(K,T)<z._moveStep&&1>O)){if(d=_p(d)){var v=hg(K);return d.action=function(_){z.fi({kind:z._zooming?"betweenZoom":"beginZoom"}),z._zooming=1,K[0]=v[0]+Z*_,K[1]=v[1]+H*_,K[2]=v[2]+o*_,z.fp(Kn,N,K)},d._37o=function(){delete z._14o,delete z._zooming,z.fi({kind:"endZoom"}),z.onZoomEnded()},z._14o=Cp(d)}K[0]+=Z,K[1]+=H,K[2]+=o,z.fp(Kn,N,K)}}},setOrthoZoom:function(Y,Q){if(1!==Y){var n=this;n._14o&&n._14o.stop(!0);var M=n._orthoWidth,v=M/Y-M;if(!(M<n._moveStep&&Y>1))return(Q=_p(Q))?(Q.action=function(f){n.fi({kind:n._zooming?"betweenZoom":"beginZoom"}),n._zooming=1,n.setOrthoWidth(M+v*f)},Q._37o=function(){delete n._14o,delete n._zooming,n.fi({kind:"endZoom"}),n.onZoomEnded()},n._14o=Cp(Q)):(n.setOrthoWidth(M/Y),void 0)}},getPositionInfo:function(a){var Y=this,p=Y._eye,L=Y._center,P=Y.getAspect(),c=a?_o(fn(L,p,!0),fn(a,p)):uk(p,L);if(Y._ortho){var S=Y._orthoWidth;return{length:c,height:S/P,width:S}}var W=2*o(Y._fovy/2)*c;return{length:c,height:W,width:W*P}},getCenterInfo:function(){var u=this;return u._81O||(u._81O=u.getPositionInfo()),hg(u._81O)},rotate:function($,w,k,_){var y=this;if($||w){_==N&&(_=y._firstPersonMode),y._88O&&y._88O.stop(!0);var c=y._center,T=y._eye,B=y.getCenterInfo().length,b=_?c:T,u=_?T:c,M=fn(b,u),J=D(M[0],M[2]),d=D(m(M[0]*M[0]+M[2]*M[2]),M[1]),V=_?bq:Kn;return _&&(w=-w),(k=_p(k))?(k.action=function(a){y.fi({kind:y._rotating?"betweenRotate":"beginRotate"}),y._rotating=1;var C=J+$*a,G=d+w*a;G=$h(G),M[0]=B*R(G)*R(C),M[1]=B*E(G),M[2]=B*R(G)*E(C),b[0]=u[0]+M[0],b[1]=u[1]+M[1],b[2]=u[2]+M[2],y.fp(V,N,b)},k._37o=function(){delete y._88O,delete y._rotating,y.fi({kind:"endRotate"}),y.onRotateEnded()},y._88O=Cp(k)):(J+=$,d+=w,d=$h(d),M[0]=B*R(d)*R(J),M[1]=B*E(d),M[2]=B*R(d)*E(J),b[0]=u[0]+M[0],b[1]=u[1]+M[1],b[2]=u[2]+M[2],y.fp(V,N,b),void 0)}},pan:function(O,l,F,o){if(O||l){var w=this;o==N&&(o=w._firstPersonMode),w._89O&&w._89O.stop(!0);var J=Il(w),c=[J[0]*O,J[4]*O,J[8]*O],z=[J[1]*l,J[5]*l,J[9]*l],L=c[0]+z[0],k=c[1]+z[1],_=c[2]+z[2],p=w._center,a=w._eye;if(o){var Q=Dq(w.getBoundaries(),a[0],a[2],a[0]+L,a[2]+_,m(L*L+_*_));L=Q[0],_=Q[1]}if(F=_p(F)){var u=hg(a),X=hg(p);return F.action=function(b){w.fi({kind:w._panning?"betweenPan":"beginPan"}),w._panning=1,p[0]=X[0]+L*b,p[1]=X[1]+k*b,p[2]=X[2]+_*b,a[0]=u[0]+L*b,a[1]=u[1]+k*b,a[2]=u[2]+_*b,w.fp(Kn,N,a),w.fp(bq,N,p)},F._37o=function(){delete w._89O,delete w._panning,w.fi({kind:"endPan"}),w.onPanEnded()},w._89O=Cp(F)}p[0]+=L,p[1]+=k,p[2]+=_,a[0]+=L,a[1]+=k,a[2]+=_,w.fp(Kn,N,a),w.fp(bq,N,p)}},walk:function(G,h,$){if(G){var V=this;$==N&&($=V._firstPersonMode),V._90O&&V._90O.stop(!0);var L=V._center,D=V._eye,n=fn(L,D,!0);if($){var j=Dq(V.getBoundaries(),D[0],D[2],D[0]+n[0]*G,D[2]+n[2]*G,A(G));if(G=uk(j),!G)return;n=[j[0]/G,0,j[1]/G]}if(h=_p(h)){var o=hg(D),u=hg(L);return h.action=function(y){V.fi({kind:V._walking?"betweenWalk":"beginWalk"}),V._walking=1;var q=G*y;D[0]=o[0]+n[0]*q,D[1]=o[1]+n[1]*q,D[2]=o[2]+n[2]*q,L[0]=u[0]+n[0]*q,L[1]=u[1]+n[1]*q,L[2]=u[2]+n[2]*q,V.fp(Kn,N,D),V.fp(bq,N,L)},h._37o=function(){delete V._90O,delete V._walking,V.fi({kind:"endWalk"}),V.onWalkEnded()},V._90O=Cp(h)}D[0]+=n[0]*G,D[1]+=n[1]*G,D[2]+=n[2]*G,L[0]+=n[0]*G,L[1]+=n[1]*G,L[2]+=n[2]*G,V.fp(Kn,N,D),V.fp(bq,N,L)}},handleScroll:function(N,q){N.preventDefault();var B=this,F=B._moveStep;B.isFirstPersonMode()?B.isPannable()&&B.pan(0,q>0?F:-F):B.isZoomable()&&B.setZoom(0>q?1/Cg:Cg)},handlePinch:function(Z,R){this.isZoomable()&&this.setZoom(R>Z?1/Lr:Lr)},reset:function(){this.setCenter(Q.graph3dViewCenter),this.setEye(Q.graph3dViewEye),this.setUp(Q.graph3dViewUp)},moveSelection:function(C,G,N){var D=this;D.dm().beginTransaction(),Vr(this.sm().toSelection(this.isMovable,this),C,G,N),D.dm().endTransaction()},getMoveMode:function(g,Z){var n=Z.s("3d.move.mode");if(n)return n;var x="88",f="89",y="90";return of(g)||El[x]&&El[f]&&El[y]?"xyz":El[x]&&El[f]?"xy":El[x]&&El[y]?"xz":El[f]&&El[y]?"yz":El[x]?"x":El[f]?"y":El[y]?"z":"xz"},handleTick:function(){var t=this,X=!1,f=t._moveStep,Z=f,o=!1,_=!0,M=t._rotateStep*(_?-1:1);if(t.isWalkable()||(Z=0),t.isPannable()||(f=0),t.isRotatable()||(M=0),t._32Q){var i=(Le()-t._32Q)/50;Z*=i,f*=i,M*=i}t._31Q&&(Rg(t._31Q),delete t._31Q,delete t._32Q),Bg()&&(X=!0,t.pan(-f,0,o,_)),Jb()&&(X=!0,t.pan(f,0,o,_)),_r()&&(X=!0,of()?t.pan(0,f,o,_):t.walk(Z,o,_)),nb()&&(X=!0,of()?t.pan(0,-f,o,_):t.walk(-Z,o,_)),Pd()&&(X=!0,t.rotate(-M,0,o,_)),bi()&&(X=!0,t.rotate(M,0,o,_)),_b()&&(X=!0,t.rotate(0,-M/2,o,_)),Wo()&&(X=!0,t.rotate(0,M/2,o,_)),X&&(t._32Q=Le(),t._31Q=Ln(t.handleTick,t))},handleKeyDown:function(m){var Q=this;!op(m)&&dq[m.keyCode]?Q.handleTick():xd(m)?Q.selectAll():Mq(m)?Q.handleDelete(m):Qr(m)&&this.isResettable()&&Q.reset()},checkDoubleClickOnNote:function($,W,k){var j=this;if(k===ub){if(W.s("note.toggleable"))return W.s(Ad,!W.s(Ad)),j.fi({kind:"toggleNote",event:$,data:W,part:k}),!0}else if(k===Uj&&W.s("note2.toggleable"))return W.s(Og,!W.s(Og)),j.fi({kind:"toggleNote2",event:$,data:W,part:k}),!0;return!1},checkDoubleClickOnRotation:function(f,l,Y){return Y===Sm?(l.setRotationX(0),!0):Y===Tl?(l.setRotationY(0),!0):Y===Bi?(l.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(z){var m=this,q=m.getWidth()/2,U=m.getHeight()/2,b=m._18Q;return b&&b._wh===q/U||(b=as(m),m._18Q=jn(b,b,Il(m)),m._18Q._wh!==q/U),z=og([z[0],z[1],z[2],1],b),{x:q+q*z[0]/z[3],y:U-U*z[1]/z[3]}},getHitPosition:function(l,J,F){var K=this,e=K.getWidth(),q=K.getHeight(),M=l.target?K.lp(l):l,y=M.x-e/2,p=M.y-q/2,n=K.getCenterInfo(),k=Il(K);J=J?J:[0,0,0],F=F?F:[0,1,0],y=y/e*n.width,p=-1*p/q*n.height;var v=[k[0]*y,k[4]*y,k[8]*y],V=[k[1]*p,k[5]*p,k[9]*p],S=[v[0]+V[0],v[1]+V[1],v[2]+V[2]],P=K.getCenter(),r=Xo(K,J,F,[S[0]+P[0],S[1]+P[1],S[2]+P[2]]);return r?r:[0,0,0]},intersectObject:function(d,T){return this._raycaster.intersectObject(d,T)},getLineLength:function(h){this.validate();var G=this.getData3dUI(h);if(G&&G.getCache){var j=G.getCache();if(j)return j[j.length-1].length}return 0},getLineOffset:function(r,T){var P=this.getData3dUI(r);if(P&&P.getCache){var y=P.getCache();if(y)return ve(y,T)}return N},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0}}),gq.RenderEnv=function(W){this.gv=W,this.enable=!1},J.defineProperties(gq.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(o){this._debugOn=o,this.capture&&this.capture()}}}),J.assign(gq.RenderEnv.prototype,{renderEnvToCube:function(n,q,L,Y){var G=this,p=G.gv;if(!n||!q||!L)return G.enable=!1,G._42=null,void 0;G.enable=!0;var i=Math.floor(Y/n*q),u=p.getGL(),v=G._renderTargets;v?v.length<L&&(v=G._renderTargets=v.concat(new Array(L-v.length))):v=G._renderTargets=new Array(L);for(var I=0;L>I;I++)v[I]?v[I].setSize(u,Y,i):v[I]=new gq.RenderTarget(p,u,Y,i);var _=!1;G.capture=function(){_=!0,p._42(),_=!1};var O=new Ej,J=new Ej,B=new Ej,W=new Ej,U=(new Ej).setY(0),x=2*Math.PI/L,Q=n/2/Math.tan(Math.PI/L),Z=2*Math.atan2(q/2,Q),R=n/q;G._42=function(d,h,X,C){var t=G._debugOn;if(!_&&!t)return!1;O.copy(p.getEye()),W.copy(p.getCenter()).sub(O);var e=Math.atan2(W.z,W.x),k=p.getNear(),j=p.getFovy(),V=p.getAspect();J.copy(p.getCenter());for(var s,i=0;L>i;i++)if(s=v[i],U.setZ(Math.cos(e)).setX(Math.sin(e)).multiplyScalar(Q),e-=x,B.addVectors(O,U),p.setNear(Q),p.setCenter([B.x,B.y,B.z]),p.setFovy(Z),p.setAspect(R),t){var A=Math.round(h/L);d.viewport(A*i,0,A,X),C()}else Je(d,s.frame),d.viewport(0,0,s.width,s.height),d.clear(d.COLOR_BUFFER_BIT),C(),Je(d,N),s.assureTexture();return p.setNear(k),p.setCenter([J.x,J.y,J.z]),p.setFovy(j),p.setAspect(V),!0},G.capture()},getTextureInfo:function(h){var I=this._renderTargets;if(!I)return null;var P=this._renderTargets[h];return P?{index:h,texture:P.texture,textureName:P.uuid}:null}}),J.assign(gq.Graph3dView.prototype,{renderEnvToCube:function(j,I,h,f){var o=this;o.envRenderer||(o.envRenderer=new gq.RenderEnv(o)),o.envRenderer.renderEnvToCube(j,I,h,f)}}),gq.RenderTarget=function(l,j,E,K){var q=this;q.uuid=M.Math.generateUUID(),q.gv=l,q.init(l,j),q.setSize(j,E,K)},J.assign(gq.RenderTarget.prototype,{init:function(k,j){var N=this,P=N.texture=j.createTexture();j.activeTexture(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,P),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.NEAREST),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.NEAREST),j.bindTexture(j.TEXTURE_2D,null),N.render=j.createRenderbuffer(),N.frame=j.createFramebuffer(),k._2O[N.uuid]=P},assureTexture:function(){var u=this,w=u.uuid,x=u.gv._2O;x[w]||(x[w]=u.texture)},setSize:function(q,Q,d){var r=this;if(r.width!==Q||r.height!==d){var l=q.RGBA,m=q.TEXTURE_2D,h=q.RENDERBUFFER,j=q.FRAMEBUFFER;wo(q,r.texture),q.texImage2D(m,0,l,Q,d,0,l,q.UNSIGNED_BYTE,N),Xe(q,q.TEXTURE_MIN_FILTER,q.LINEAR),q.bindRenderbuffer(h,r.render),q.renderbufferStorage(h,q.DEPTH_COMPONENT16,Q,d),Je(q,r.frame),q.framebufferTexture2D(j,q.COLOR_ATTACHMENT0,m,r.texture,0),q.framebufferRenderbuffer(j,q.DEPTH_ATTACHMENT,h,r.render),wo(q,N),q.bindRenderbuffer(h,N),Je(q,N),r.width=Q,r.height=d}},toCanvas:function(){var H=this,u=H.gv.getGL();u.bindFramebuffer(u.FRAMEBUFFER,H.frame);var q=H.width,w=H.height,$=new Uint8Array(4*q*w);u.readPixels(0,0,q,w,u.RGBA,u.UNSIGNED_BYTE,$),u.bindFramebuffer(u.FRAMEBUFFER,null);var L=K.createElement("canvas");L.width=q,L.height=w;var S=L.getContext("2d"),Y=S.createImageData(q,w);return Y.data.set($),S.putImageData(Y,0,0),L}});var tr=gq.Interactor=function(F){this.gv=F};Uf("Interactor",J,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Zn=gq.DefaultInteractor=function($){Ho(Zn,this,[$])};Uf("DefaultInteractor",tr,{handle_contextmenu:function(u){zq(u)},handle_mousewheel:function(F){this.gv.handleScroll(F,F.wheelDelta/40)},handle_DOMMouseScroll:function(J){2===J.axis&&this.gv.handleScroll(J,-J.detail)},handle_keydown:function(p){this.gv.handleKeyDown(p)},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function(i){zq(i);var e=this,T=e.gv,a=Fq(i),z=T.getDataInfoAt(i),D=z?z.data:N,O=z?z.part:N,X=T.sm(),A=Uk(i),L=Wf(i);T.setFocus(i)&&(e._62O=N,e._57I=N,D?op(i)?X.co(D)?X.rs(D):X.as(D):X.co(D)||X.ss(D):a&&(op(i)?T.isRectSelectable()&&(e._62O=Br):e._57I=zc(i)),e._31Q&&(Rg(e._31Q),delete e._31Q,delete e._32Q),e._62O||(T.isFirstPersonMode()&&(of(i)||L>2?e._62O="pan":T.isMouseRoamable()||Bq?(e._62O="roaming",e.foward=A&&Fq(i),e._32Q=Le(),e._31Q=Ln(e.tick,e)):a||(e._62O="roaming")),e._62O||(a&&A&&dl[O]?(e._62O=O,e.p3=D.p3()):a&&A&&Oh(D)&&T.isSelected(D)&&T.isMovable(D)?(e._62O="move",e.p3=D.p3(),e.movedata=D):Bq&&(L>2?e._62O="pan":2===L&&(e.dist=Xi(i),e._62O="pinch")))),e.point=T.lp(i),ds(e,i),hn(i)?T.handleDoubleClick(i,D,O):T.handleClick(i,D,O))},tick:function(){var $=this,S=$.gv,m=S._moveStep;$.point&&S.isWalkable()&&($._32Q&&(m*=(Le()-$._32Q)/50),S.walk($.foward?m:-m),$._32Q=Le(),$._31Q=Ln($.tick,$))},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(O){var T=this._57I;T&&(uk(T,zc(O))<=1&&this.gv.sm().cs(),this._57I=N)},handleWindowMouseMove:function(m){this.handleWindowTouchMove(m)},handleWindowTouchMove:function(d){var c,C,e=this,M=e.gv,B=e._62O,u=e.point,r=M.dm(),I=M.lp(d),K=I.x-u.x,x=I.y-u.y,g=-q*K/M.getWidth(),f=-q*x/M.getHeight();if("roaming"===B)e.rotate(d,g/2,f/2);else if(B===Sm||B===Tl||B===Bi)M._86O||r.beginTransaction(),M.fi({kind:M._86O?"betweenEditRotation":"beginEditRotation",event:d}),M._86O=1,M.sm().each(function(U){if(Oh(U)&&M.isRotationEditable(U)){var $=A(g)>A(f)?g:f;B===Sm?U.setRotationX(U.getRotationX()+$):B===Tl?U.setRotationY(U.getRotationY()+$):B===Bi&&U.setRotationZ(U.getRotationZ()+$)}});else if("move"===B||dl[B]){B===_j||B===Cj||B===ko?(M._87O||r.beginTransaction(),M.fi({kind:M._87O?"betweenEditSize":"beginEditSize",event:d}),M._87O=1):(M._moving||r.beginTransaction(),M.fi({kind:M._moving?"betweenMove":"beginMove",event:d}),M._moving=1);var a,L=e.p3,$=M.getPositionInfo(L),S=Il(M);a=B===ib?"x":B===ce?"y":B===$p?"z":B===_j?"sx":B===Cj?"sy":B===ko?"sz":M.getMoveMode(d,e.movedata),K=K/M.getWidth()*$.width,x=-1*x/M.getHeight()*$.height;var V,U,W=[S[0]*K,S[4]*K,S[8]*K],k=[S[1]*x,S[5]*x,S[9]*x],N=W[0]+k[0],X=W[1]+k[1],H=W[2]+k[2],i=[L[0]+N,L[1]+X,L[2]+H],R=fn(M.getEye(),i,!0);if("xyz"===a?(V=i,M.moveSelection(N,X,H)):"xz"===a?(V=Xo(M,L,[0,1,0],i),V&&M.moveSelection(V[0]-L[0],0,V[2]-L[2])):"xy"===a?(V=Xo(M,L,[0,0,1],i),V&&M.moveSelection(V[0]-L[0],V[1]-L[1],0)):"yz"===a?(V=Xo(M,L,[1,0,0],i),V&&M.moveSelection(0,V[1]-L[1],V[2]-L[2])):"x"===a||"sx"===a?(R[0]=0,V=Xo(M,L,R,i),V&&(U=V[0]-L[0],"x"===a?M.moveSelection(U,0,0):M.sm().each(function(k){Oh(k)&&M.isSizeEditable(k)&&(c=t(ad,k.getWidth()+U),C=c/k.getWidth(),k.setWidth(c),of(d)&&(k.setHeight(k.getHeight()*C),k.setTall(k.getTall()*C)))}))):"y"===a||"sy"===a?(R[1]=0,V=Xo(M,L,R,i),V&&(U=V[1]-L[1],"y"===a?M.moveSelection(0,U,0):M.sm().each(function(V){Oh(V)&&M.isSizeEditable(V)&&(c=t(ad,V.getTall()+U),C=c/V.getTall(),V.setTall(c),of(d)&&(V.setHeight(V.getHeight()*C),V.setWidth(V.getWidth()*C)))}))):("z"===a||"sz"===a)&&(R[2]=0,V=Xo(M,L,R,i),V&&(U=V[2]-L[2],"z"===a?M.moveSelection(0,0,U):M.sm().each(function(q){Oh(q)&&M.isSizeEditable(q)&&(c=t(ad,q.getHeight()+U),C=c/q.getHeight(),q.setHeight(c),of(d)&&(q.setTall(q.getTall()*C),q.setWidth(q.getWidth()*C)))}))),!V)return;e.p3=V}else if(B===Br){var G=e.div;G||(G=e.div=ac(),kr(e.getView(),G),G.op=u,G.style.background=M.getRectSelectBackground()),M.fi({kind:M._rectSelecting?"betweenRectSelect":"beginRectSelect",event:d}),M._rectSelecting=1,G.rect=re(G.op,I),Sf(G,G.rect)}else if("pinch"===B&&2===Wf(d)){M.fi({kind:M._pinching?"betweenPinch":"beginPinch",event:d}),M._pinching=1;var U=Xi(d);M.handlePinch(U,e.dist),e.dist=U}else"pan"===B||of(d)?e.pan(d,K,x):M.isFirstPersonMode()||(Fq(d)?e.rotate(d,g,f):(e.pan(d,K,0),M.isWalkable()&&(M.fi({kind:M._walking?"betweenWalk":"beginWalk",event:d}),M._walking=1,M.walk(x/M.getHeight()*M.getCenterInfo().height))));e.point=I},pan:function(Q,i,F){var w=this.gv;if(w.isPannable()){var c=w.getCenterInfo(),M=i/w.getWidth()*c.width,d=-1*F/w.getHeight()*c.height;w.fi({kind:w._panning?"betweenPan":"beginPan",event:Q}),w._panning=1,w.pan(-M,-d)}},rotate:function(X,J,u){var B=this.gv;B.isRotatable()&&(B.fi({kind:B._rotating?"betweenRotate":"beginRotate",event:X}),B._rotating=1,B.rotate(J,u))},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},handleWindowTouchEnd:function(D){var c=this,H=c.gv,u=H.dm(),B=c.div;if(B){var j=H.getDatasInRect(B.rect);if(!j.isEmpty()){var E=H.sm(),p=E.toSelection();j.each(function(d){E.co(d)?p.remove(d):p.add(d)}),E.ss(p)}eq(B)}H._moving&&(delete H._moving,H.fi({kind:"endMove",event:D}),H.onMoveEnded(),u.endTransaction()),H._panning&&(delete H._panning,H.fi({kind:"endPan",event:D}),H.onPanEnded()),H._rotating&&(delete H._rotating,H.fi({kind:"endRotate",event:D}),H.onRotateEnded()),H._86O&&(delete H._86O,H.fi({kind:"endEditRotation",event:D}),u.endTransaction()),H._87O&&(delete H._87O,H.fi({kind:"endEditSize",event:D}),u.endTransaction()),H._pinching&&(delete H._pinching,H.fi({kind:"endPinch",event:D}),H.onPinchEnded()),H._rectSelecting&&(delete H._rectSelecting,H.fi({kind:"endRectSelect",event:D}),H.onRectSelectEnded()),H._walking&&(delete H._walking,H.fi({kind:"endWalk",event:D}),H.onWalkEnded()),c.dist=c.point=c._62O=c.p3=c.movedata=c.div=c._57I=c._32Q=c._31Q=c.foward=N}});var de=gq.MapInteractor=function(O){Ho(de,this,[O]),this._minPhi=0,this._maxPhi=5*H/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};Uf("MapInteractor",tr,{handle_contextmenu:function(d){zq(d)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta/40)},handle_DOMMouseScroll:function(G){2===G.axis&&this.gv.handleScroll(G,-G.detail)},handle_keydown:function(h){this.gv.handleKeyDown(h)},handle_mousedown:function(s){this.handle_touchstart(s)},handle_touchstart:function(S){zq(S);var I=this,G=I.gv;if(G.setFocus(S)){G.lp(S);var z=I.editing={point:G.lp(S)};Bq?z.touch=!0:(z.touch=!1,z.pan=Fq(S)),ds(I,S)}},handle_mouseup:function(T){this.handle_touchend(T)},handle_touchend:function(){},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowTouchMove:function(j){var r=this,V=r.gv,k=r.editing;if(k){var W=V.lp(j),$=k.point,x=W.x-$.x,n=W.y-$.y;if(!k.moved){if(Math.abs(x)<r.threshold&&Math.abs(n)<r.threshold&&!(j.touches&&j.touches.length>1))return;k.moved=!0}if(k.point=W,k.touch){var M=j.touches.length;if(2!==M)r.pan(j,x,n);else{if(1>=M)return;var z=j.touches,s={x:z[0].clientX,y:z[0].clientY},l={x:z[1].clientX,y:z[1].clientY},K={x:l.x-s.x,y:l.y-s.y},I=k.lastCenter,E=Math.atan2(K.y,K.x),i=k.theta,b=0;i==N?i=k.theta=E:(b=E-i,k.thetaStarted||Math.abs(b)>r.touchRotateThreshold?(k.thetaStarted=!0,k.theta=E):b=0);var F=H*(s.y+l.y)/2/V.getHeight(),D=k.phi,C=0;D==N?D=k.phi=F:(C=F-D,k.phiStarted||Math.abs(C)>r.touchRotateThreshold?(k.phiStarted=!0,k.phi=F):C=0);var U,t=Math.sqrt(K.x*K.x+K.y*K.y),u=k.vlen;if(u){var O=s.x-I.x,G=s.y-I.y,v=l.x-I.x,P=l.y-I.y,L=Math.sqrt(O*O+G*G),J=Math.sqrt(v*v+P*P),T=u/2,S=r._sign2(L-T),Q=r._sign2(J-T);0>S*Q||0===S&&0===Q?(U=1,k.vlen=t):(U||(U=t/u),k.scaleStarted||Math.abs(U-1)>r.touchScaleThreshold?(k.vlen=t,k.scaleStarted=!0):U=1)}else u=k.vlen=t,U=1;1!==U&&V.setZoom(U),(C||b)&&r.rotate(j,b,-C),k.lastCenter={x:(l.x+s.x)/2,y:(l.y+s.y)/2}}}else if(k.pan)r.pan(j,x,n);else{var e=-q*x/V.getWidth(),Z=-q*n/V.getHeight();r.rotate(j,e,Z)}}},_sign2:function(O){return Math.abs(O)<this._touchScaleCheckAccuracy?0:O>0?1:-1},handleWindowMouseUp:function(S){this.handleWindowTouchEnd(S)},handleWindowTouchEnd:function(m){var x=this,H=x.editing;if(x.editing=null,H&&!H.moved&&H.pan){var i=x.gv,O=i.getDataAt(m);O?i.sm().setSelection([O]):i.sm().clearSelection()}},pan:function(O,x,b){var $=this,w=$.gv;if(w.isPannable()){var Z=w.getCenterInfo(),m=-x/w.getWidth()*Z.width,T=1*b/w.getHeight()*Z.height;w.fi({kind:w._panning?"betweenPan":"beginPan",event:O}),w._panning=1;var l=$.keepHorizon,v=$.editing.touch;if((v&&O.touches&&O.touches.length>1||!v&&of(O))&&(l=!l),!l)return w.pan(m,T);if(m||T){var P=Il(w),M=[P[0]*m,P[4]*m,P[8]*m],_=[P[1],0,P[9]],u=Math.sqrt(_[0]*_[0]+_[2]*_[2]);_=[_[0]/u*T,0,_[2]/u*T];var j=M[0]+_[0],f=M[1]+_[1],y=M[2]+_[2],Q=w._center,B=w._eye;Q[0]+=j,Q[1]+=f,Q[2]+=y,B[0]+=j,B[1]+=f,B[2]+=y,w.fp(Kn,N,B),w.fp(bq,N,Q)}}},rotate:function(x,I,j){var d=this,A=d.gv;if(A.isRotatable()){var $=A._center,S=A._eye,M=fn(S,$),c=D(m(M[0]*M[0]+M[2]*M[2]),M[1]),W=c+j;W=Math.max(d.minPhi,Math.min(d.maxPhi,W)),j=W-c,A.fi({kind:A._rotating?"betweenRotate":"beginRotate",event:x}),A._rotating=1,A.rotate(I,j)}}}),J.defineProperties(de.prototype,{minPhi:{get:function(){return this._minPhi},set:function(L){this._minPhi=L}},maxPhi:{get:function(){return this._maxPhi},set:function(U){this._maxPhi=U}},keepHorizon:{get:function(){return this._keepHorizon},set:function(y){this._keepHorizon=y}},threshold:{get:function(){return this._threshold},set:function(Q){this._threshold=Q}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(Z){this._touchScaleThreshold=Z}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(T){this._touchRotateThreshold=T}}});var un=function(z){this.gv=z};Gd(un,J,{_iv:!0,iv:function(){this._iv=!0},face:function(R,J){var H=this,t=H.gv.getGL();if(!t||!Oh(R))return N;var s=J.x,U=J.width,z=J.height,V=H.height-J.y-z,w=y(U/2),P=new Uint8Array(4*U*z),h=0;for(H.iv(),H.validate(R),Je(t,H.frame),t.readPixels(s,V,U,z,t.RGBA,t.UNSIGNED_BYTE,P),Je(t,N),H.iv();w>=h;h++)for(var b=w-h,u=w+h,X=b;u>=X;X++)for(var A=b;u>=A;A++)if(X===b||X===u||A===b||A===u){var O=fs.m[P[4*(X*U+A)]];
if(O)return O}},get:function(v,X){this.validate();var e=this,d=e.gv.getGL();if(!d)return N;var V,h,F=v.x,G=v.width,j=v.height,R=e.height-v.y-j,r=y(G/2),t=new Uint8Array(4*G*j),O=0,I=t.length,i=X?N:new Ol,L=X?N:{};if(Je(d,e.frame),d.readPixels(F,R,G,j,d.RGBA,d.UNSIGNED_BYTE,t),Je(d,N),X){for(;r>=O;O++)for(var c=r-O,M=r+O,Z=c;M>=Z;Z++)for(var K=c;M>=K;K++)if((Z===c||Z===M||K===c||K===M)&&(V=e.info(t,4*(Z*G+K))))return V}else for(;I>O;O+=4)V=e.info(t,O),V&&(h=V.data,L[h._id]||(i.add(h),L[h._id]=h));return i},info:function(b,X){return this.colorMap[(b[X]<<16)+(b[X+1]<<8)+b[X+2]+((127&b[X+3])<<24)]},validate:function(z){var w=this,K=w.gv,r=K.getGL();if(r){var U=K.getWidth(),y=K.getHeight(),x=r.RGBA,c=r.TEXTURE_2D,j=r.RENDERBUFFER,g=r.FRAMEBUFFER;w.texture||(w.texture=pl(r),w.render=r.createRenderbuffer(),w.frame=r.createFramebuffer()),(w.width!==U||w.height!==y)&&(wo(r,w.texture),r.texImage2D(c,0,x,U,y,0,x,r.UNSIGNED_BYTE,N),Xe(r,r.TEXTURE_MIN_FILTER,r.LINEAR),r.bindRenderbuffer(j,w.render),r.renderbufferStorage(j,r.DEPTH_COMPONENT16,U,y),Je(r,w.frame),r.framebufferTexture2D(g,r.COLOR_ATTACHMENT0,c,w.texture,0),r.framebufferRenderbuffer(g,r.DEPTH_ATTACHMENT,j,w.render),wo(r,N),r.bindRenderbuffer(j,N),Je(r,N),w.width=U,w.height=y),w._iv&&(w._iv=!1,Je(r,w.frame),K._42(z||(w.colorMap={}),1),Je(r,N))}}});var yn=function(d){this.gv=d};Gd(yn,J,{gap:0,size:0,_42:function(z,I){var X=this,A=X.gv,l=A._gridGap,Q=A._gridSize;if(A._gridVisible){if(X.gap!==l||X.size!==Q){for(var S=[],p=A._gridSize/2,T=l*p,V=0;2*p+1>V;V++){var W=6*V,m=6*(2*p+1)+W;S[W]=-T,S[W+1]=0,S[W+2]=-T+V*l,S[W+3]=T,S[W+4]=0,S[W+5]=-T+V*l,S[m]=-T+V*l,S[m+1]=0,S[m+2]=-T,S[m+3]=-T+V*l,S[m+4]=0,S[m+5]=T}X.vs=new oi(S),X.gap=l,X.size=Q}yj(A),Zb(z,I),ld(z),Jd(z,I,1,A._gridColor,A._buffer.vs,X.vs),qb(z,0,X.vs.length/3,z.LINES),fp(z),zh(z,I)}else X.vs=X.gap=X.size=N}});var fq=function(A){this.gv=A};Gd(fq,J,{_42:function(Q,J){var E=this.gv,o=E._buffer.vs,k=E._axisXColor,u=E._axisYColor,m=E._axisZColor,r=E._originAxisVisible,y=E._centerAxisVisible;if(r||y){var C=Y?Q.TRIANGLES:Q.TRIANGLE_FAN,B=Q.LINES;if(yj(E),Zb(Q,J),ld(Q),r){var W=E.getCenterInfo(),h=O(W.width,W.height)/5,$=.8*h,M=.05*h;Jd(Q,J,1.5,k,o,new oi([0,0,0,h,0,0,$,M,0,$,0,M,$,-M,0,$,0,-M,$,M,0,0,0,0,0,h,0,M,$,0,0,$,M,-M,$,0,0,$,-M,M,$,0,0,0,0,0,0,h,M,0,$,0,M,$,-M,0,$,0,-M,$,M,0,$])),qb(Q,0,2,B),qb(Q,1,6,C),Jd(Q,J,N,u),qb(Q,7,2,B),qb(Q,8,6,C),Jd(Q,J,N,m),qb(Q,14,2,B),qb(Q,15,6,C)}if(y){var t=E._center,b=t[0],Z=t[1],c=t[2],W=E.getPositionInfo(t);h=O(W.width,W.height)/20,Jd(Q,J,1.5,k,o,new oi([b,Z,c,b+h,Z,c,b,Z,c,b,Z+h,c,b,Z,c,b,Z,c+h])),qb(Q,0,2,B),Jd(Q,J,N,u),qb(Q,2,2,B),Jd(Q,J,N,m),qb(Q,4,2,B)}fp(Q),zh(Q,J)}}});var vc=function(q){this.gv=q},ib="edit_tx",ce="edit_ty",$p="edit_tz",Sm="edit_rx",Tl="edit_ry",Bi="edit_rz",_j="edit_sx",Cj="edit_sy",ko="edit_sz",dl={};dl[ib]=1,dl[ce]=1,dl[$p]=1,dl[Sm]=1,dl[Tl]=1,dl[Bi]=1,dl[_j]=1,dl[Cj]=1,dl[ko]=1,Gd(vc,J,{_42:function(J,Y,p){var f=this,e=f.gv,j=e.sm().ld();if(e.isEditable(j)&&!e.isEditHelperDisabled()&&Oh(j)&&(!e.isFirstPersonMode()||!e.isMouseRoamable()&&!Bq)){yj(e);var u,F,W=e.isMovable(j),E=e.isRotationEditable(j),o=e.isSizeEditable(j),C=e._axisXColor,B=e._axisYColor,g=e._axisZColor,q=e._editSizeColor,k=e.getCenterInfo(),i=O(k.width,k.height)/10,D=i/(p?5:10),m=.7*i,r=.4*m,l=j.p3(),T=l[0],h=l[1],G=l[2];u=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],W&&f._17O(J,Y,j,p,ib,C,u,[T,h-D,G,T+m,h-D,G,T+m,h,G,T+m,h,G,T,h,G,T,h-D,G,T,h-D,G+D,T+m,h-D,G+D,T+m,h-D,G,T+m,h-D,G,T,h-D,G,T,h-D,G+D]),F=T+m,o&&f._17O(J,Y,j,p,_j,q,u,[F,h-D,G,F+r,h-D,G,F+r,h,G,F+r,h,G,F,h,G,F,h-D,G,F,h-D,G+D,F+r,h-D,G+D,F+r,h-D,G,F+r,h-D,G,F,h-D,G,F,h-D,G+D]),F+=r,E&&f._17O(J,Y,j,p,Sm,C,u,[F,h-D,G,F+r,h-D,G,F+r,h,G,F+r,h,G,F,h,G,F,h-D,G,F,h-D,G+D,F+r,h-D,G+D,F+r,h-D,G,F+r,h-D,G,F,h-D,G,F,h-D,G+D]),u=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],W&&f._17O(J,Y,j,p,ce,B,u,[T,h,G,T,h+m,G,T-D,h+m,G,T-D,h+m,G,T-D,h,G,T,h,G,T,h,G,T,h,G-D,T,h+m,G-D,T,h+m,G-D,T,h+m,G,T,h,G]),F=h+m,o&&f._17O(J,Y,j,p,Cj,q,u,[T,F,G,T,F+r,G,T-D,F+r,G,T-D,F+r,G,T-D,F,G,T,F,G,T,F,G,T,F,G-D,T,F+r,G-D,T,F+r,G-D,T,F+r,G,T,F,G]),F+=r,E&&f._17O(J,Y,j,p,Tl,B,u,[T,F,G,T,F+r,G,T-D,F+r,G,T-D,F+r,G,T-D,F,G,T,F,G,T,F,G,T,F,G-D,T,F+r,G-D,T,F+r,G-D,T,F+r,G,T,F,G]),u=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],W&&f._17O(J,Y,j,p,$p,g,u,[T,h,G,T,h,G+m,T,h-D,G+m,T,h-D,G+m,T,h-D,G,T,h,G,T,h-D,G,T-D,h-D,G,T-D,h-D,G+m,T-D,h-D,G+m,T,h-D,G+m,T,h-D,G]),F=G+m,o&&f._17O(J,Y,j,p,ko,q,u,[T,h,F,T,h,F+r,T,h-D,F+r,T,h-D,F+r,T,h-D,F,T,h,F,T,h-D,F,T-D,h-D,F,T-D,h-D,F+r,T-D,h-D,F+r,T,h-D,F+r,T,h-D,F]),F+=r,E&&f._17O(J,Y,j,p,Bi,g,u,[T,h,F,T,h,F+r,T,h-D,F+r,T,h-D,F+r,T,h-D,F,T,h,F,T,h-D,F,T-D,h-D,F,T-D,h-D,F+r,T-D,h-D,F+r,T,h-D,F+r,T,h-D,F])}},_17O:function(Z,r,_,K,z,J,G,A){var m=this.gv._buffer;Ib(Z,r,K,!0,_,z),Fj(Z,r,N,!0,N,!0,N,!1),ao(Z,r.uDiffuse,J),Bf(Z,m.vs,new oi(A),r.aPosition),Bf(Z,m.ns,new oi(G),r.aNormal),ld(Z),qb(Z,0,12),fp(Z),gg(Z,r)}});var gk=M.Raycaster=function(o){this.gv=o};Wj("Raycaster",J,{intersect:function(N){var f=this,F=f.gv,x=F.getDataAt(N);return x?f.intersectObject(N,x):null},intersectObject:function(b,u){var Q,d,j=this,f=j.gv;d=f.unproject(b);var V=f.getEye();f.isOrtho()?(Q=fn(f.getCenter(),V),Q[0]+=Q[0],Q[1]+=Q[1],Q[2]+=Q[2]):Q=V,Q=new Ej(Q);var h=new Ej(d).sub(Q).normalize(),B=new M.Math.Ray(Q,h);return j._intersectObjectImpl(B,u)},_intersectObjectImpl:function(){var W=new rc,Z=new rc,u=new gi,A=new Ej,o=new Ej,V=new Ej,P=new Ej;return function(h,r){W.fromArray(r.mat),Z.getInverse(W),u.copy(h).applyMatrix4(Z);var D=this.gv.getData3dUI(r),i=fj(D);if(!i)return null;Sg(i)||(i=[i]);var Y,K,j,x,t,M,H,f,p=1/0;for(Y=0,K=i.length;K>Y;Y++)if(t=i[Y].vs)for(j=0,x=t.length;x>j;j+=9)o.fromArray(t,j),V.fromArray(t,j+3),P.fromArray(t,j+6),M=u.intersectTriangle(o,V,P,!1,A),M&&(f=u.origin.distanceTo(M),p>f&&(p=f,H=M.clone()));if(!H)return null;var q=H.clone().applyMatrix4(W);return{world:q,local:H}}}()});var Fk=function(m,V){this.gv=m,this.s=function(L,q,y){return q==N&&(q=y),q==N?V.getStyle(L):Hr(q,V,m)},this.data=V};Gd(Fk,J,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(c,r,n,q){var H=this,y=H.data;if(!(y instanceof ti)){var S,K,A,u,C,X,F,V=H.gv,J=y._id,Y=H.s("shape3d.alwaysOnTop")?null:H.s("batch"),k=V._batchIndexMap,P=V._batchModelMap,Q=V.isSelectable(y),w=V.getBrightness(y),M=w!=N&&1!==w;if(H.needValidate(c)){if(A=lg(k,P,y,Y),H.validate(A,Y?kh[Y]||Zi:N),A&&(u=k[J],C=u.size=A.vs.length/3-u.begin,F=A.rs))for(w=M?w:1,X=0;C>X;X++)F.push(w);if(Oh(y)){var I=V.getWireframeGeometry(y);if(I)dc(V,y,I);else{var p=V.getWireframe(y);p&&dc(V,y,p)}}H.labelInfo=H.label2Info=H.noteInfo=H.note2Info=H._38o=N,H._24O(Wi,"getLabel"),H._24O(Pn,"getLabel2"),H._26O(ub,"getNote"),H._26O(Uj,"getNote2"),H._15O(),H._iv=!1}M&&ao(c,r.uBrightness,w),ao(c,r.uAlphaTest,H.s("alphaTest")),K=Ib(c,r,n,Q,y,sg),K&&(He(K,k[J],P),He(K,V._polylineIndexMap[J],V._polylineModelMap),He(K,V._wireframeIndexMap[J],V._wireframeModelMap)),k[J]||H._80o(c,r,q),V.isLabelVisible(y)&&((S=H.labelInfo)&&(Ib(c,r,n,Q,y,Wi),H._28O(S,Wi,q)),(S=H.label2Info)&&(Ib(c,r,n,Q,y,Pn),H._28O(S,Pn,q))),V.isNoteVisible(y)&&((S=H.noteInfo)&&(Ib(c,r,n,Q,y,ub),H._29O(S,ub,q)),(S=H.note2Info)&&(Ib(c,r,n,Q,y,Uj),H._29O(S,Uj,q))),(S=H._38o)&&H._99O(c,r,S,n,Q,q),M&&ao(c,r.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return vn},_80o:function(){},dispose:function(){},_calcAnchorMat:function(C){if(C.hasOwnProperty("_anchor")||C.hasOwnProperty("_anchorElevation")){var j=C.getAnchor3d(),J={x:j.x-.5,y:j.y-.5,z:j.z-.5},z=wp();return Ze(z,[-J.x,-J.y,-J.z]),z}},getBodyColor:function(z){var p=this.data,D=this.gv.getBodyColor(p);return D?D:z?p.getStyle(z):N},_24O:function(g,Z){var r=this,v=r.data,h=r.gv,p=r.s,s=h[Z](v);if(s!=N){var b=p(g+".scale"),X=p(g+".max"),S=r[g+"Info"]={label:s,textureScale:p(g+".texture.scale"),color:h[Z+"Color"](v),font:p(g+".font"),align:p(g+".align"),background:h[Z+"Background"](v)},w=S.rect=Uc(S,s);X>0&&X<w.width&&(S.labelWidth=w.width,w.width=X),w.x=w.y=0,w.width*=b,w.height*=b,S.mat=r._16O(p(g+".autorotate"),p(g+".position"),w,p(g+".face"),p(g+".t3"),p(g+".r3"),p(g+".rotationMode"));var Q=w.width/2,d=w.height/2;S.vs=new oi([-Q,d,0,-Q,-d,0,Q,-d,0,Q,d,0]),w.width/=b,w.height/=b}},_26O:function(o,Q){var z=this,Y=z.data,m=z.gv,A=z.s,F=m[Q](Y);if(F!=N){var O=A(o+".scale"),r=this[o+"Info"]={note:F,textureScale:A(o+".texture.scale"),expanded:A(o+".expanded"),font:A(o+".font"),color:A(o+".color"),align:A(o+".align"),borderWidth:A(o+".border.width"),borderColor:A(o+".border.color"),background:m[Q+"Background"](Y)};if(r.expanded){var l=A(o+".max"),V=Uc(r,F);V.width+=6,V.height+=2,l>0&&l<V.width&&(r.labelWidth=V.width,V.width=l);var p={x:-V.width/2,y:-8-V.height,width:V.width,height:V.height+8}}else p={x:-6,y:-18,width:12,height:18};r.mat=z._16O(A(o+".autorotate"),A(o+".position"),N,A(o+".face"),A(o+".t3"),A(o+".r3"),A(o+".rotationMode")),r.rect=p,1!==O&&(p=hg(p),p.x*=O,p.height*=O,p.y=-p.height,p.width*=O);var t=p.x,B=p.y,H=p.width,i=p.height;r.vs=new oi([t,-B,0,t,-B-i,0,t+H,-B-i,0,t+H,-B,0])}},_28O:function(x,X,Z){if(Z(this.s(X+".transparent"))){var u=x.rect,n=x.textureScale,z=u.width*n,i=u.height*n;if(z>=1&&i>=1){var q=Zr(z,i);1!==n&&(q.translate(q,u.x,u.y),q.scale(n,n),q.translate(q,-u.x,-u.y)),_m(q,x),q.restore(),qi(this,X,x.mat,x.vs,!0)}}},_29O:function(Q,$,Z){if(Z(this.s($+".transparent"))){var W=Q.rect,s=Q.textureScale,g=W.x,p=W.y,B=W.width*s,M=W.height*s;if(B>=1&&M>=1){W.x=W.y=0;var n=Zr(B,M);1!==s&&n.scale(s,s),hr(n,Q),n.restore(),W.x=g,W.y=p,qi(this,$,Q.mat,Q.vs,!1)}}},_99O:function(U,R,G,f,L,D){if(G){var Z=this,F=Z.gv,Q=Z.data,x=F._buffer,M=F._1O,H=G.icons;for(var v in H){var X=H[v],d=G.rects[v];if(d&&D(Hr(X.transparent,Q,F))){Ib(U,R,f,L,Q,v);var O=Hr(X.shape3d,Q,F),P=O?[O]:Hr(X.names,Q,F),I=P?P.length:0,n=Hr(X.textureScale,Q,F)||1,T=Hr(X.light,Q,F);T==N&&(T=O?!0:!1),Fj(U,R,Hr(X.blend,Q,F),T,Hr(X.opacity,Q,F),Hr(X.reverseFlip,Q,F),Hr(X.reverseColor,Q,F),Hr(X.reverseCull,Q,F));for(var w=0;I>w;w++){var t=P[w],K=d[w];if(Lo(Z,K.mat),O)db(F,Q,fj(Z,O),Z);else{var A=cd(t);if(A){var E=K.width*n,Y=K.height*n;if(E>=1&&Y>=1){var e=Zr(E,Y);Nq(e,A,Hr(X.stretch,Q,F),0,0,E,Y,Q,F),e.restore(),pl(U,Yb,M),ld(U,R,M,Hr(X.discardSelectable,Q,F),x.uv,Gc),Bf(U,x.vs,K.vs,R.aPosition),Um(U,x.ns,Sj,R.aNormal),vk(U,x.is,hd),Tj(U,0,hd.length),fp(U,R,M)}}}Hg(F)}gg(U,R)}}}}});var Kj=function(K,z){Ho(Kj,this,[K,z])};Gd(Kj,Fk,{_16O:function(V,m,K,X,n,g,C,a,o){var J=this.data,y=J.getFinalScale3d(),e=go(m,y,K,X,a,o);if(J.hasOwnProperty("_anchor")||J.hasOwnProperty("_anchorElevation")){var u=J.getAnchor3d();e[0]-=(u.x-.5)*y[0],e[1]-=(u.y-.5)*y[1],e[2]-=(u.z-.5)*y[2]}return uf(wp(),e,J.p3(),X,n,g,C,V,J.r3(),J.getRotationMode())},clear:function(){var M=this;M.faceMat=M.mat=M.shapeModel=M.left=M.right=M.front=M.back=M.top=M.bottom=M.csg=N},needValidate:function(J){if(this._iv)return this._validateFrameId=J._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var R=J._renderInfo.frame;if(this._validateFrameId!==R)return this._validateFrameId=R,!0}return!1},validate:function(i,s){var v=this,q=v.gv,L=v.data,V=fj(v);v._updateAutoRotation(),v._updateFixSize2d(),v._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Ui(q,L,"_wireframeModelMap","_wireframeIndexMap"),Ui(q,L,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var S=Qq(L,q.getMat(L),V?v.s("shape3d.scaleable"):!0),O=v._calcAnchorMat(L);if(O&&jn(S,S,O),L.mat=S,v.clear(),i){var R=[];V?Gn(q,L,V,v,v.getBodyColor(),[S],i,R):(gb(q,L,i,s,S,kj,R,_h),gb(q,L,i,s,S,Lj,R,Bs),gb(q,L,i,s,S,Kf,R,wj),gb(q,L,i,s,S,si,R,Jn),gb(q,L,i,s,S,Sh,R,$m),gb(q,L,i,s,S,tf,R,Db)),R.length&&(Cr(i.vs,R),Cr(i.ns,Fc(R)))}else v.mat=S,(v.shapeModel=V)||(v._cubeUvs=null,v.vf(kj,0),v.vf(Lj,16),v.vf(Sh,8),v.vf(tf,24),v.vf(Kf,32),v.vf(si,40))},_updateAutoRotation:function(){var t=this,U=t.s("shape3d.autorotate");if(U){var B,E=t.gv,u=t.data;B="string"==typeof U?[U.indexOf("x")<0?E._eye[0]:E._center[0],U.indexOf("y")<0?E._eye[1]:E._center[1],U.indexOf("z")<0?E._eye[2]:E._center[2]]:E._eye;var P=E._center,j=[B[0]-P[0],B[1]-P[1],B[2]-P[2]],v=u.p3(),k=Aj([v[0]+j[0],v[1]+j[1],v[2]+j[2]],v,E._up),s=u.r3(),Y=Bk(k,u.getRotationMode());Math.abs(s[0]-Y[0])<1e-5&&Math.abs(s[1]-Y[1])<1e-5&&Math.abs(s[2]-Y[2])<1e-5||u.r3(Y)}},_updateFixSize2d:function(){var Z=this,O=Z.data,R=Z.s("shape3d.fixSizeOnScreen");if(!R)return O._dynamicScale3d&&delete O._dynamicScale3d,void 0;var x=Z.gv;O.getFinalScale3d();var d=Qq(O,x.getMat(O)),v=Po([0,0,0],d),B=x.toViewPosition(v);if(!isNaN(B.x)&&!isNaN(B.y)){var n=Po([1,0,0],d),E=x.toViewPosition(n),L=Po([0,1,0],d),Q=x.toViewPosition(L),X=E.x-B.x,M=Q.y-B.y,k=O._dynamicScale3d||[1,1,1],z=cd(O.s("shape3d.image")),U=R[0]>0?R[0]:z?pg(z,Z):20,r=R[1]>0?R[1]:z?gh(z,Z):20,$=Math.abs(X/U),f=Math.abs(M/r);Math.abs($-1)<.001&&Math.abs(f-1)<.001||(O._dynamicScale3d=[k[0]/$,k[1]/f,k[2]])}},_updateOverlapping:function(){var N=this,$=N.s("hide.overlapping.group");if(!$)return N._rectOverlapping&&(N._rectOverlapping=d),void 0;var e,J,E,q=N.gv,l=N.data,v=Qq(l,q.getMat(l)),w=1/0,u=1/0,R=-1/0,F=-1/0,T=l.getAnchor3d(),Y=T.x,P=T.y,G=T.z;for(e=0;8>e;e++){if(J=Po([(e>>2)-Y,(1&e>>1)-P,(1&e)-G],v),E=q.toViewPosition(J),isNaN(E.x)||isNaN(E.y))return;w=Math.min(w,E.x),R=Math.max(R,E.x),u=Math.min(u,E.y),F=Math.max(F,E.y)}var Z={x:w,y:u,w:R-w,h:F-u};N._rectOverlapping=q.overlappingBox.isOverlapping($,Z)},getVectorDynamicSize:function(){var B,P=this,S=P.s("shape3d"),L=P.data;if("billboard"===S||"plane"===S||(B=L._currentCubeElementId)!=N){var X,d,l=P.gv,y=Qq(L,l.getMat(L)),G=function(B,Q){var w=l.toViewPosition(Po(B,y)),O=l.toViewPosition(Po(Q,y)),s=w.x-O.x,X=w.y-O.y;return Math.min(2048,Math.sqrt(s*s+X*X))};if("billboard"===S)X=G([-.5,0,0],[.5,0,0]),d=G([0,-.5,0],[0,.5,0]);else if("plane"===S)X=G([-.5,0,0],[.5,0,0]),d=G([0,0,-.5],[0,0,.5]);else if(L._currentCubeElementId!=N){var x=3*Xh[B+1],E=3*Xh[B],i=3*Xh[B+2];X=G([Qm[x],Qm[x+1],Qm[x+2]],[Qm[i],Qm[i+1],Qm[i+2]]),d=G([Qm[x],Qm[x+1],Qm[x+2]],[Qm[E],Qm[E+1],Qm[E+2]])}return[X,d]}},getCachedTexture:function(){var r=this,k=r.data,f=k._currentCubeElementId;return f!=N?r._cubeCachedImage?r._cubeCachedImage[f]:null:r._shape3dCachedImage},setCachedTexture:function(q){var r=this,Y=r.data,Q=Y._currentCubeElementId;if(Q!=N){if(!r._cubeCachedImage)return r._cubeCachedImage={};r._cubeCachedImage[Q]=q}else r._shape3dCachedImage=q},invalidateCachedTexture:function(F){var Q,Z,M,d=this;if((M=d._shape3dCachedImage)&&(F.deleteTexture(M),d._shape3dCachedImage=null),Z=d._cubeCachedImage){for(Q in Z)F.deleteTexture(Z[Q]);d._cubeCachedImage=null}},vf:function(Z,X){var r=this;if(r.gv.getFaceVisible(r.data,Z)){var i=Gg(r,Z);i.mat&&(r.faceMat=!0);var w=i.uv;if(w){var q=r._cubeUvs;q||(q=r._cubeUvs=new oi([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var b=0;8>b;b++)q[X+b]=w[b]}return i}},_80o:function(O,o,J){var c=this;if(c._rectOverlapping)return!0;var k=c.gv,v=c.data,t=k._cube,T=c.shapeModel;yj(k,c.mat),T?db(k,v,T,c,c.getBodyColor(),J):(Bf(O,t.vs,N,o.aPosition),Bf(O,t.ns,N,o.aNormal),Ng(O,t.is),c._18O(O,o,c.left,0,J),c._18O(O,o,c.front,6,J),c._18O(O,o,c.right,12,J),c._18O(O,o,c.back,18,J),c._18O(O,o,c.top,24,J),c._18O(O,o,c.bottom,30,J)),Hg(k),c.faceMat&&(c._18O(O,o,c.left,0,J,!0),c._18O(O,o,c.front,6,J,!0),c._18O(O,o,c.right,12,J,!0),c._18O(O,o,c.back,18,J,!0),c._18O(O,o,c.top,24,J,!0),c._18O(O,o,c.bottom,30,J,!0))},_18O:function(o,T,A,C,y,e){if(A){if(!y(A.transparent))return;if(e&&!A.mat||!e&&A.mat)return;e&&yj(this.gv,A.mat);var h=this,g=h.data;g._currentCubeElementId=C;var s=h.gv,q=s.getTexture(A.texture,g),n=A.uv,p=A.uvScale,H=A.uvOffset,x=A.discardSelectable;q?n?ld(o,T,q,x,s._buffer.uv,h._cubeUvs,H,p):ld(o,T,q,x,s._cube.uv,N,H,p):ld(o),Fj(o,T,A.blend,A.light,A.opacity,A.reverseFlip,A.reverseColor,A.reverseCull),ao(o,T.uDiffuse,A.color),Tj(o,C,6),gg(o,T),fp(o,T,q),e&&Hg(s),g._currentCubeElementId=null}}});var Ne=function(S,C){Ho(Ne,this,[S,C])};Gd(Ne,Fk,{_25Q:1,validate:function(q){var K=this,y=K.gv,J=K.data,c=K.s,I=c("edge.width"),t=J._40I,d=J._41I;if(K.shapeModel=K.info=N,t&&d){var Z,V,j,i,p,H,w,S,L,g,U=J.isLooped(),x=c(Zk),B=Q.getEdgeType(x);if(B){var G=B(J,zo(K,y,J,U,x),y,K._19Q);if(!G.points||G.points.isEmpty())return;H=K.info={},w=G.segments,p=G.points,S=p.size();for(var R=t.getElevation(),b=d.getElevation(),D=0;S>D;D++){var v=p.get(D);v.e==N&&(v.e=R+(b-R)*D/(S-1))}L=Wm(p.get(0)),g=Wm(p.get(S-1));var X=S%2;0===X?(H.c1=Wm(p.get(S/2-1)),H.c2=Wm(p.get(S/2))):H.p3=Wm(p.get((S-X)/2)),H.s1=L,H.s2=Wm(p.get(1)),H.t1=Wm(p.get(S-2)),H.t2=g}else{p=new Ol,H=K.info={};var C=c("edge.offset"),u=c("edge.center"),Y=c("edge.source.t3"),z=c("edge.target.t3"),m=t.p3(),A=d.p3();if(Y&&(m[0]+=Y[0],m[1]+=Y[1],m[2]+=Y[2]),z&&(A[0]+=z[0],A[1]+=z[1],A[2]+=z[2]),x===Sb){w=c("edge.segments");var T=H.points=c(sq)||np;if(S=T.size()){L=Wm(T.get(0)),g=Wm(T.get(S-1)),!u&&C&&(j=fn(L,m,!0),C=O(C,uk(m,L)),m=[m[0]+j[0]*C,m[1]+j[1]*C,m[2]+j[2]*C],j=fn(A,g,!0),C=O(C,uk(g,A)),A=[A[0]-j[0]*C,A[1]-j[1]*C,A[2]-j[2]*C]);var X=S%2;0===X?(Z=Wm(T.get(S/2-1)),V=Wm(T.get(S/2))):H.p3=Wm(T.get((S-X)/2)),H.s1=m,H.s2=L,H.t1=g,H.t2=A}else!u&&C&&(j=fn(A,m,!0),i=uk(m,A),C=Hp(C,i),m=[m[0]+j[0]*C,m[1]+j[1]*C,m[2]+j[2]*C],A=[A[0]-j[0]*C,A[1]-j[1]*C,A[2]-j[2]*C]),Z=m,V=A;p.add({x:m[0],y:m[2],e:m[1]}),p.addAll(T),p.add({x:A[0],y:A[2],e:A[1]})}else{var W=zo(K,y,J,U,x);if(K._19Q||(W=-W),U){var k=m[0],P=m[1],o=m[2],n=t.getTall()/2+W;Z=[k-W,P+n,o],V=[k+W,P+n,o],p.add({x:k-W,y:o,e:P}),p.add({x:k-W,y:o,e:P+n}),p.add({x:k+W,y:o,e:P+n}),p.add({x:k+W,y:o,e:P})}else{j=fn(A,m,!0),i=uk(m,A);var _={x:m[0],y:m[2]},f={x:A[0],y:A[2]},e=oq(N,_,f,W),s=e.x-_.x,r=e.y-_.y;C=Hp(C,i),j[0]*=C,j[1]*=C,j[2]*=C,Z=[m[0]+j[0]+s,m[1]+j[1],m[2]+j[2]+r],V=[A[0]-j[0]+s,A[1]-j[1],A[2]-j[2]+r],u?(p.add({x:m[0],y:m[2],e:m[1]}),p.add({x:Z[0],y:Z[2],e:Z[1]}),p.add({x:V[0],y:V[2],e:V[1]}),p.add({x:A[0],y:A[2],e:A[1]})):(p.add({x:Z[0],y:Z[2],e:Z[1]}),p.add({x:V[0],y:V[2],e:V[1]}))}}H.c1=Z,H.c2=V}H.list=c(Go)===gf?K.createTubeModel(p,w,I/2,q):K.createLineModel(p,w,I,"edge","edge.dash")}}});var Mr=function(b,r){Ho(Mr,this,[b,r])};Gd(Mr,Kj,{_80o:function(i,B,e){var k=this,c=k.gv,W=k.shapeModel;yj(c,k.mat),W?db(c,k.data,W,k,k.getBodyColor(),e):(Jf(k,i,B,k.left,e),Jf(k,i,B,k.front,e),Jf(k,i,B,k.right,e),Jf(k,i,B,k.back,e),Jf(k,i,B,k.top,e),Jf(k,i,B,k.bottom,e)),Hg(c)},validate:function(y,q){var G,j,u=this,t=u.s,I=u.data,U=I.p3(),K=I._thickness/2,i=I.isClosePath(),T=I.getPoints(),Z=I.getSegments(),g=t(Zp),L=y&&y.uv;if(u.clear(),0>K)j=u.shapeModel=se(T,Z,t(Ni),t(Vi),g,t(mi),I.getTall(),I.getShapeElevation(),i),t(ji)?t("shape3d.image")||delete j.uv:(delete j.vs,delete j.ns,delete j.uv),t("shape3d.top.image")||delete j.top_uv,t("shape3d.bottom.image")||delete j.bottom_uv;else if(t(Go)===gf)G=fg(T,Z,g,i),j=u.shapeModel={vs:[]},t("shape3d.image")&&(j.uv=[],j.sum=t(mi)||rp(G)||1,j.len=0),t(Ni)&&!i&&(j.top_vs=[],t("shape3d.top.image")&&(j.top_uv=[])),t(Vi)&&!i&&(j.bottom_vs=[],t("shape3d.bottom.image")&&(j.bottom_uv=[])),u._12O(G,K);else{var o,B,v,l,J,d,F,P,D,b;if(G=fg(T,Z,g,i),J=u.vf(Sh,L,!1,q),K&&(d=u.vf(tf,L,!1,q),F=i?N:u.vf(kj,L,!1,q),P=i?N:u.vf(Lj,L,!1,q),D=u.vf(Kf,L,!1,q),b=u.vf(si,L,!1,q)),K){for(var A=0,k=G.length;k>A;A++)G[A]=u._tryRemoveBezierPoints(G[A],K);u._12O(G,K)}else J&&G.forEach(function(n){if(l=n.length,l>0)for(o=n[0],v=1;l>v;v++)B=n[v],u.addV(J.vs,o,B),o=B});u._20Q(G),y||(J&&(J.ns=Fc(J.vs),Xb(J,"vs"),Xb(J,Jm)),K&&(d&&(d.ns=Fc(d.vs),Xb(d,"vs"),Xb(d,Jm)),F&&(F.ns=Fc(F.vs),Xb(F,"vs"),Xb(F,Jm)),P&&(P.ns=Fc(P.vs),Xb(P,"vs"),Xb(P,Jm)),D&&(D.ns=Fc(D.vs),Xb(D,"vs"),Xb(D,Jm)),b&&(b.ns=Fc(b.vs),Xb(b,"vs"),Xb(b,Jm))))}var O=u.mat=wp();Ze(O,U),Xq(O,I.r3(),I.getRotationMode());var s=I.getScale3d(),z=I._dynamicScale3d;z&&(s[0]*=z[0],s[1]*=z[1],s[2]*=z[2]),Ug(O,s),Ze(O,kc(U)),y&&(lb(u,O,y,j),u.clear())},_20Q:function(p){var m,y,G,n,D,L,W,B=this,t=B.front,P=B.back,H=B.top,C=B.bottom,I=t?t.tuv:N,A=P?P.tuv:N,b=H?H.tuv:N,Y=C?C.tuv:N,j=0;(I||A||b||Y)&&(m=B.s(mi)||rp(p)||1,p.forEach(function(E){if(y=E.length,y>0)for(L=E[0],G=1;y>G;G++)W=E[G],n=j/m,j+=uk(L,W),D=j/m,B._14O(t,n,D),B._14O(P,1-D,1-n),B._14O(H,n,D),B._14O(C,n,D),L=W}))},_14O:function(h,p,I){if(h){var w=h.uv,T=h.tuv;if(T){if(w)var k=w[0]+(w[6]-w[0])*p,_=w[1]+(w[7]-w[1])*p,D=w[2]+(w[4]-w[2])*p,l=w[3]+(w[5]-w[3])*p,y=w[2]+(w[4]-w[2])*I,V=w[3]+(w[5]-w[3])*I,K=w[0]+(w[6]-w[0])*I,F=w[1]+(w[7]-w[1])*I;else k=p,_=0,D=p,l=1,y=I,V=1,K=I,F=0;T.push(D,l,y,V,K,F,K,F,k,_,D,l)}}},_13O:function(S){var w=S.uv,D=S.tuv;D&&(w?D.push(w[2],w[3],w[4],w[5],w[6],w[7],w[6],w[7],w[0],w[1],w[2],w[3]):D.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(I,b){var W=I.length;if(4>W)return I;var C,x,R,Q,N,E,h=!1,T=function(v){return I[v]},o=function(F){return I[W-1-F]};for(N=0;1>=N;N++)for(E=N?o:T,x=E(0),R=E(1),C=2;W-1>C;C++)if(Q=E(C),!Q.remove)if(Q.b){var u=oq(x,R,Q,b);u.adjust?(Q.remove=!0,h=!0):(x=R,R=Q)}else x=R,R=Q;if(!h)return I;var j=[];for(C=0;W>C;C++)I[C].remove||j.push(I[C]);return j},_12O:function(b,Y){var X,L,m,M,U,$=this;b.forEach(function(h){if(U=h.length,U>0)for(X={p:h[0],n:!0},M=1;U>M;M++)L=h[M],m=U-1>M?h[M+1]:N,$.addPoint(X,L,m,Y,h)})},addPoint:function(t,z,$,_,B){var q,j,d,v,A,p,e,X,H,S=this,D=t.p,O=t.f,m=t.b,F=S.s("shape3d.side")||vp,C=S.s("shape3d.start.angle"),n=S.s("shape3d.sweep.angle"),V=S.shapeModel,I=S.data.isClosePath();if(t.n&&(t.n=!1,O=I&&B.length>2?oq(B[B.length-2],D,z,_):oq(N,D,z,_),m=Op(D,O),V?V.top_vs&&S._10O(m,O,F,C,n,V.top_vs,V.top_uv):(q=S.left)&&(S.addV(q.vs,m,O),S._13O(q))),j=$?oq(D,z,$,_):I&&B.length>2?oq(D,z,B[1],_):oq(D,z,N,_),d=Op(z,j),V){var u,g,W=V.vs,r=V.uv,f=V.sum;for(r&&(u=V.len/f,V.len+=uk(D,z),g=V.len/f),p=S._9O(m,O,F,C,n),e=S._9O(d,j,F,C,n),X=0;F>X;X++)H=X+1,Cr(W,p[H]),Cr(W,e[X]),Cr(W,p[X]),Cr(W,e[X]),Cr(W,p[H]),Cr(W,e[H]),r&&(v=X/F,A=H/F,r.push(u,A,g,v,u,v,g,v,u,A,g,A));!$&&V.bottom_vs&&S._10O(d,j,F,C,n,V.bottom_vs,V.bottom_uv,!0)}else!$&&(q=S.right)&&(S.addV(q.vs,j,d),S._13O(q)),(q=S.front)&&S.addV(q.vs,O,j),(q=S.back)&&S.addV(q.vs,d,m),(q=S.top)&&S.addH(q.vs,O,j,d,m,!0),(q=S.bottom)&&S.addH(q.vs,m,d,j,O);t.p=z,t.f=j,t.b=d},_10O:function(e,w,W,H,n,C,A,U){var x,i,j=this,N=j.data,s=j._9O(e,w,W,H,n),f=(e.x+w.x)/2,F=(e.y+w.y)/2,T=N.getShapeElevation(),k=0;for(k=0;W>k;k++)U?(Cr(C,s[k]),Cr(C,s[k+1])):(Cr(C,s[k+1]),Cr(C,s[k])),Cr(C,[f,T,F]),A&&(U?(x=q*(k+1)/W+H,i=q*k/W+H):(x=q*k/W+H,i=q*(k+1)/W+H),A.push(.5-.5*E(i),.5-.5*R(i),.5-.5*E(x),.5-.5*R(x),.5,.5))},_9O:function(D,I,P,k,i){var Q,g,z=this,U=z.data,c=[],s=(D.x+I.x)/2,o=(D.y+I.y)/2,A=U.getTall()/2,r=U.getShapeElevation(),f=0;for(i=i||q;P>=f;f++)Q=i*f/P+k,g=E(Q),c.push([s+(D.x-s)*g,r+A*R(Q),o+(D.y-o)*g]);return c},addV:function(A,V,M){var S=V.x,w=V.y,g=M.x,l=M.y,t=this.data,c=t.getShapeElevation(),y=t.getTall()/2;A.push(S,c-y,w,g,c-y,l,g,c+y,l,g,c+y,l,S,c+y,w,S,c-y,w)},addH:function(A,z,p,C,Q,O){var c=this.data,k=c.getTall()/2,E=c.getShapeElevation()+(O?k:-k);A.push(z.x,E,z.y,p.x,E,p.y,C.x,E,C.y,C.x,E,C.y,Q.x,E,Q.y,z.x,E,z.y)},vf:function(B,$,V,v){var S,J=this,d=J.gv.getFaceVisible(J.data,B);return(V||d)&&(S=Gg(J,B,v),S.vs=[],S.tuv=d&&(S.texture||$)?[]:N,S.visible=d),S}});var en=function(b,K){Ho(en,this,[b,K])};Gd(en,Fk,{_25Q:1,validate:function(M){var v=this,L=v.data,s=v.s,k=L.getPoints(),I=k.size();if(v.shapeModel=v.info=N,I>1){var c=v.info={},j=L.getSegments(),h=L.getThickness(),C=Wm(k.get(0)),p=Wm(k.get(I-1)),D=I%2;0===D?(c.c1=Wm(k.get(I/2-1)),c.c2=Wm(k.get(I/2))):c.p3=Wm(k.get((I-D)/2)),c.s1=C,c.s2=Wm(k.get(1)),c.t1=Wm(k.get(I-2)),c.t2=p,c.list=s(Go)===gf?v.createTubeModel(k,j,h/2,M):v.createLineModel(k,j,h,"shape.border","shape.dash")}var x=L.p3(),W=v.mat=wp();Ze(W,x),Xq(W,L.r3(),L.getRotationMode());var E=L.getScale3d(),o=L._dynamicScale3d;o&&(E[0]*=o[0],E[1]*=o[1],E[2]*=o[2]),Ug(W,E),Ze(W,kc(x))},_80o:function(e,k,W){var P=this,L=P.shapeModel;if(L){var I=P.gv;yj(I,P.mat),db(I,P.data,L,P,P.getBodyColor(),W),Hg(I)}}});var Lb=M.graph3d.VR=function(t){var d=this;d.gv=t,d.controller=new bm(d),d.switch=new Tg(d),d._enable=!1,d._defaultCallLater=M.Default.callLater,"undefined"!=typeof X&&"VRFrameData"in X&&(d._frameData=new X.VRFrameData),d.measureOflength=1,d.eyesOffset=[0,0,0]};Gd(Lb,J,{_42:function(C,b,y,z){var e=this,W=e.gv,I=e._device;if(I){var Z=e._scaleFactor;if(I.depthNear=W.getNear()/Z,I.depthFar=W.getFar()/Z,I.isPresenting===!1)return W.iv(),!1;var M=e._frameData;I.getFrameData(M);var P=M.pose.position;if(P){var Z=e._scaleFactor,Q=e._eyesOffset;W.setEye([P[0]*Z+Q[0],P[1]*Z+Q[1],P[2]*Z+Q[2]])}return C.viewport(0,0,b/2,y),e._viewMatrix=e._copyViewMatrix(M.leftViewMatrix),e._projectMatrix=e._copyProjectMatrix(M.leftProjectionMatrix),z(),C.viewport(b/2,0,b/2,y),e._viewMatrix=e._copyViewMatrix(M.rightViewMatrix),e._projectMatrix=e._copyProjectMatrix(M.rightProjectionMatrix),z(),e._lastViewMatrix=e._viewMatrix,e._lastProjectMatrix=e._projectMatrix,e._viewMatrix=null,e._projectMatrix=null,e.submitFrame(),!0}},_copyViewMatrix:function(y){var q=this.dup(y),$=this._scaleFactor;q[12]*=$,q[13]*=$,q[14]*=$;var F=this._eyesOffset;if(F&&(F[0]||F[1]||F[2])){var w=F[0],x=F[1],r=F[2];q[12]-=q[0]*w+q[4]*x+q[8]*r,q[13]-=q[1]*w+q[5]*x+q[9]*r,q[14]-=q[2]*w+q[6]*x+q[10]*r}return q},shutdown:function(){var X=this._device;X&&X.isPresenting&&X.exitPresent()},isPresenting:function(){var g=this._device;return g&&g.isPresenting},_copyProjectMatrix:function(N){var g=this.dup(N),B=this._scaleFactor;return g[14]*=B,g},dup:function(T,H){for(var j=T.length,o=H||new Array(j);j--;)o[j]=T[j];return o},getViewMatrix:function(A){var Z=this._viewMatrix;return Z?this.dup(Z,A):void 0},getProjectMatrix:function(){var P=this._projectMatrix;return P?this.dup(P):void 0},submitFrame:function(){var e=this;if(e._enable&&e._deviceInAction){var H=e._device;H&&H.isPresenting&&(H.submitFrame(),e.gv.iv())}},setDevice:function(Q){var _=this;_._device=Q},_injectCallLaterFunc:function(u){var q=this;if(!u)return Ln=M.Default.callLater=q._defaultCallLater,void 0;var q=this;Ln=M.Default.callLater=function(k,I,w,M){var c=q._device;return c&&c.isPresenting?M?b(function(){Ln(k,I,w)},M):c.requestAnimationFrame(function(){q._deviceInAction=!0,k.apply(I,w),q._deviceInAction=!1}):(q._defaultCallLater(k,I,w,w),void 0)}}}),J.defineProperties(Lb.prototype,{enable:{get:function(){return this._enable},set:function(b){var I=this;I._enable!==b&&(I._enable=b,b?(I.switch.showButton(),I._injectCallLaterFunc(!0)):(I.shutdown(),I.switch.hideButton(),I._injectCallLaterFunc(!1)))}},measureOflength:{get:function(){return this._measureOflength},set:function(I){this._measureOflength=I,this._scaleFactor=1/I}},eyesOffset:{get:function(){return this._eyesOffset},set:function(T){this._eyesOffset=T}}});var bm=function(q){this.vr=q};Gd(bm,J,{}),J.defineProperties(bm.prototype,{});var Tg=function(b){this.vr=b,this._button=null};Gd(Tg,J,{showButton:function(){var V=this.assureButton();if(!V.parentNode){var y=this.vr.gv,s=y.getView();y._79O?s.insertBefore(V,y._79O):s.appendChild(V)}},hideButton:function(){var M=this._button;M&&M.parentNode&&M.parentNode.removeChild(M)},assureButton:function(){var $=this._button;return $?$:this._button=this.createButton(this.vr.gv)},createButton:function(d){function M(o,W){o.textContent=W&&W.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function o(s){m.style.display="",m.style.cursor="pointer",m.style.left="calc(50% - 50px)",m.style.width="100px",M(m,s),m.onmouseenter=function(){m.style.opacity="1.0"},m.onmouseleave=function(){m.style.opacity="0.5"},m.onclick=function(){s.isPresenting?s.exitPresent():s.requestPresent([{source:d.getCanvas()}])},d.vr.setDevice(s)}function C(){m.style.display="",m.style.cursor="auto",m.style.left="calc(50% - 75px)",m.style.width="150px",M(m,null),m.onmouseenter=null,m.onmouseleave=null,m.onclick=null,d.vr.setDevice(null)}function n(b){b.style.position="absolute",b.style.bottom="20px",b.style.padding="12px 6px",b.style.border="1px solid #fff",b.style.borderRadius="4px",b.style.color="#000",b.style.font="normal 13px sans-serif",b.style.textAlign="center",b.style.opacity="0.5",b.style.outline="none",b.style.zIndex="999"}if("getVRDisplays"in navigator){var m=this._button=K.createElement("button");return m.style.display="none",n(m),X.addEventListener("vrdisplayconnect",function(t){o(t.display)},!1),X.addEventListener("vrdisplaydisconnect",function(){C()},!1),X.addEventListener("vrdisplaypresentchange",function(O){M(m,O.display)},!1),navigator.getVRDisplays().then(function(b){b.length>0?o(b[0]):C()}),m}var k=K.createElement("a");return k.href="https://webvr.info",k.innerHTML="当前不支持 webvr",k.style.left="calc(50% - 90px)",k.style.width="180px",k.style.textDecoration="none",n(k),k}}),J.defineProperties(Tg.prototype,{}),Jc(Q,{accordionViewExpandIcon:ek(sm),accordionViewCollapseIcon:ek(sm,!0),accordionViewLabelColor:Yq,accordionViewLabelFont:xk,accordionViewTitleBackground:Pj,accordionViewSelectBackground:Kr,accordionViewSelectWidth:3,accordionViewSeparatorColor:d,splitViewDividerSize:1,splitViewDividerBackground:Pj,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:id,rect:[2,2,12,12],background:sm}]},propertyViewLabelColor:ro,propertyViewLabelSelectColor:Yq,propertyViewLabelFont:xk,propertyViewExpandIcon:ek(jm),propertyViewCollapseIcon:ek(jm,!0),propertyViewBackground:Nn,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Ld,propertyViewColumnLineColor:Ld,propertyViewSelectBackground:Kr,listViewLabelColor:ro,listViewLabelSelectColor:Yq,listViewLabelFont:xk,listViewRowLineVisible:!1,listViewRowLineColor:Ld,listViewSelectBackground:Kr,treeViewLabelColor:ro,treeViewLabelSelectColor:Yq,treeViewLabelFont:xk,treeViewExpandIcon:ek(Tr),treeViewCollapseIcon:ek(Tr,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Ld,treeViewSelectBackground:Kr,treeViewDoubleClickToToggle:!0,tableViewLabelColor:ro,tableViewLabelSelectColor:Yq,tableViewLabelFont:xk,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Ld,tableViewColumnLineColor:Ld,tableViewSelectBackground:Kr,treeTableViewLabelColor:ro,treeTableViewLabelSelectColor:Yq,treeTableViewLabelFont:xk,treeTableViewExpandIcon:ek(Tr),treeTableViewCollapseIcon:ek(Tr,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Ld,treeTableViewColumnLineColor:Ld,treeTableViewSelectBackground:Kr,tableHeaderLabelColor:ro,tableHeaderLabelFont:xk,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Ck,tableHeaderBackground:Nn,tableHeaderMoveBackground:xf,tableHeaderInsertColor:Kr,tableHeaderSortDescIcon:zm(jm,!0),tableHeaderSortAscIcon:zm(jm),tabViewTabGap:1,tabViewLabelColor:Yq,tabViewLabelFont:xk,tabViewTabBackground:Pj,tabViewSelectWidth:3,tabViewSelectBackground:Kr,tabViewMoveBackground:xf,tabViewInsertColor:Kr,toolbarLabelColor:ro,toolbarLabelSelectColor:Yq,toolbarLabelFont:xk,toolbarBackground:Nn,toolbarSelectBackground:Kr,toolbarItemGap:8,toolbarSeparatorColor:Yn},!0);var jr={translateX:1,sortColumn:1},nl={sortable:1,sortOrder:1,sortFunc:1},eg={focusData:1},Ob={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},mm={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Nm=function(N,r){r.add(N),N.hasChildren()&&N.eachChild(function(t){Nm(t,r)})},Jq=function(x,O,m,E,r,f,U,H,t,d,X){var o,J=m.getValueType(d),l=m.getAlign(d);if(m.getEnumValues(d)){var P=m.toEnumLabel(O,d),F=Em||0,Y=0,g=f,p=Q.getTextSize(E,P).width;return o=cd(m.toEnumIcon(O,d)),o&&(Y=f+Em/2,"center"===l?Y+=(H-(F+p))/2:"right"===l&&(Y=Y+H-(F+p)),Bh(x,o,Y,U+t/2,d,X),g=Y+Em/2),P!=N&&(o?Tn(x,P,E,r,g,U,H-(g-f),t):Tn(x,P,E,r,f,U,H,t,l)),void 0}return O=m.formatValue(O),O!=N?J===aq?(zs(x,f,U,H,t,O),void 0):J===Qf||!J&&mr(O)?(o=cd(O?dk:Gb),Bh(x,o,f+H/2,U+t/2,d,X),void 0):(Tn(x,O,E,r,f,U,H,t,l),void 0):void 0},sj=function(W,Q){var R=Q.view,$=ff(W),V=Q.column||Q.property;R.getDataModel().beginTransaction(),Q.editor=W,W.info=Q,R.setCurrentEditor(W),R.getView().insertBefore($,R._79O),Sf(W,Q.editorRect),W.setFocus?W.setFocus():Nc(W),W.commitValue=function(){W._17Q&&(W=W._17Q),R.setValue(Q.data,V,W.getValue?W.getValue():W.value),W.close&&W.close(),eq($)
},V.onEditorCreated&&V.onEditorCreated(Q)},Rb=function(X,$,G,L,D){var E=Zh(X,G),t=$.value,F=$.view,k=D.getValueType($.data);return E.onblur=E.onchange=function(){F.endEditing()},"input"===X?(t=D.formatValue(t),t!=N&&(E.value=t),E.onkeydown=function(G){bl(G)&&F.endEditing()},(k===Ag||k===zl)&&E.addEventListener(bk,Q.numberListener,!1)):X===Br&&L.forEach(function(H){var y=K.createElement("option");y.innerHTML=D.toEnumLabel(H),y.value=H,D.isEnumEqual(t,H)&&(y.selected=!0),kr(E,y)}),sj(E,$),E},br=M.widget={},Hb=function(i,e,d){Gd(B+".widget."+i,e,d)};Jc(sf,{ms_value:function(Y){Y.getValue=function(Z){var R=this.getItemById(Z),$=R.element;return Hq($)?$:$?$.getValue?$.getValue():$.value:R.selected},Y.setValue=function(V,i){var A=this.getItemById(V),l=A.element;l&&!Hq(l)?l.setValue?l.setValue(i):l.value=i:mr(i)?(A.selected=i,this.iv()):(A.element=i,this.iv())},Y.v=function(B,_){var x=this;if(2===arguments.length)x.setValue(B,_);else{if(!eh(B))return x.getValue(B);for(var $ in B)x.setValue($,B[$])}return x}},_46o:function(b){b._icon=N,b._accessType=N,b._valueType=N,b._editable=!1,b._batchEditable=!0,b._align=kj,b._nullable=!0,b._emptiable=!1,b.setParent=Sl,b.formatValue=function(K){var C=this,t=C._valueType;return C.getEnumValues()?C.toEnumLabel(K):t===Qf?!!K:K!=N&&t===Ag?s(K):K},b.setEnum=function(H,p,X,Y,K,B,Z){var P=this;H&&!Sg(H)&&H.values&&(Y=H.editable,X=H.icons,p=H.labels,K=H.strict,B=H.maxHeight,Z=H.dropDownWidth,H=H.values),xi(H)&&(H=H._as),xi(p)&&(p=p._as),xi(X)&&(X=X._as),P._enumValues=H,P._enumLabels=p,P._enumIcons=X,P._enumEditable=Y,P._enumStrict=K==N?!0:K,P._enumMaxHeight=B,P._enumDropDownWidth=Z,H&&H.length&&wf(H[0])&&(P._valueType=zl),P.fp("enum",!1,!0)},b.getEnumDropDownWidth=function(){return this._enumDropDownWidth},b.getEnumMaxHeight=function(){return this._enumMaxHeight},b.isEnumEditable=function(){return this._enumEditable},b.getEnumValues=function(){return this._enumValues},b.getEnumLabels=function(){return this._enumLabels},b.getEnumIcons=function(){return this._enumIcons},b.isEnumStrict=function(){return this._enumStrict},b.isEnumEqual=function(w,k){return this._enumStrict?w===k:w==k},b.toEnumLabel=function(b,Q){var D=this,k=D.getEnumValues(Q),W=D.getEnumLabels(Q);if(k&&W)for(var H=0;H<k.length;H++)if(D.isEnumEqual(b,k[H]))return W[H];return b},b.toEnumIcon=function(B,Z){var Y=this,f=Y.getEnumValues(Z),L=Y.getEnumIcons(Z);if(f&&L)for(var O=0;O<f.length;O++)if(Y.isEnumEqual(B,f[O]))return L[O];return d}},_45o:function(O){O._87o=function(V,Z,s,p,U,n){if(V){var e=this,Y=e._90I,b=ac(1);e._columnLineVisible&&(U-=1),e._rowLineVisible&&(n-=1),0>=U||0>=n||(e._90I||(Y=e._90I={}),Y[Z]||(Y[Z]=new Ol),Sf(b,e.tx()+s,e.ty()+p,U,n),kr(b,V),e._view.insertBefore(b,e._79O),V.onParentAdded&&V.onParentAdded(b),Y[Z].add(b))}},O._76o=function(){var f=this,W=f._90I;if(W){for(var h in W)W[h].each(function(B){eq(B)});delete f._90I}},O._77o=function(l){var R=this;if(R._90I){var Q=R._90I[l];Q&&(Q.each(function(F){eq(F)}),delete R._90I[l])}}},_47o:function(L){L.getValue=function(l,I){return I.getValue?I.getValue(l,I,this):Jj(l,I.getAccessType(),I.getName())},L.setValue=function(Y,z,o){if(z.isEmptiable(Y)||""!==o||(o=d),z.isNullable(Y)||o!=N){var R=this,F=z.getName(Y),g=z.getAccessType(Y),B=z.getValueType(Y);B===Ag&&Hq(o)?o=r(o):B===zl&&Hq(o)?o=parseFloat(o):B===Qf&&Hq(o)&&(o="true"===o),R._batchEditable&&z._batchEditable&&R.isSelected(Y)?R.sm().each(function(Y){z.setValue?z.setValue(Y,z,o,R):Hl(Y,g,F,o)}):z.setValue?z.setValue(Y,z,o,R):Hl(Y,g,F,o)}},L.setCurrentEditor=function(t){this.endEditing(),this._currentEditor=t,this.redraw()},L.isEditing=function(L,i){var f=this,$=f._currentEditor;if(!$)return!1;if(i){var t=$.info;return t?(t.column||t.property)===i&&t.data===L:!1}return!0},L.endEditing=function(){var e=this,h=e._currentEditor;h&&(delete e._currentEditor,h.commitValue&&h.commitValue(h.info),e.redraw(),e.getDataModel().endTransaction())},L.beginEditing=function(D){this.endEditing();var A=this,f=D.column||D.property;if(f.beginEditing)f.beginEditing(D);else{var U=D.data,u=D.value,g=A.getSelectBackground(U),C=f.getEnumValues(U),i=f.getSlider(U),F=f.getColorPicker(U);if(i){var l=Ik(br.Slider,i);return l.setValue(u),l.getView().onblur=function(){A.endEditing()},l.isInstant()&&(l.onValueChanged=function(){A.setValue(U,f,l.getValue())}),sj(l,D),void 0}if(F||f.getValueType(U)===aq){var J=Ik(br.ColorPicker,F);return J.setValue(u),J.onClosed=function(){A.endEditing()},J.isInstant()&&(J.onValueChanged=function(L,h){A.setValue(U,f,h)}),sj(J,D),J.open(),void 0}if(C){if(br.ComboBox){var p=new br.ComboBox;p.setValue(u),p.setValues(C),p.setLabels(f.getEnumLabels(U)),p.setIcons(f.getEnumIcons(U)),p.setEditable(f.isEnumEditable(U)),p.setStrict(f.isEnumStrict(U)),p.setMaxHeight(f.getEnumMaxHeight(U)),p.setDropDownWidth(f.getEnumDropDownWidth(U)),p.onClosed=function(){A.endEditing()},sj(p,D),p.open()}else Rb(Br,D,g,C,f);return}var $=f.getValueType(U);if($===Qf||mr(u))return A.setValue(U,f,!u),void 0;if(f.getItemEditor(U)){var X=Me(f.getItemEditor(U)),v=new X(U,f,A,D),b=v.getView();return b._17Q=v,v.setValue(u),dn(b),sj(b,D),v.editBeginning&&v.editBeginning(),void 0}Rb("input",D,g,N,f)}}},_44o:function(f){f.init=function(N){var M=this,g=M.th=new rh(N),A=M._view=nh(1,M);M.tv=M._tableView=N,kr(A,g.getView()),kr(A,N.getView()),g.mp(function(p){p.property===Ym&&M.iv()}),M.iv()},f.getTableView=function(){return this.tv},f.getTableHeader=function(){return this.th},f.getDataModel=function(){return this.tv.dm()},f.getColumnModel=function(){return this.tv.getColumnModel()},f.setColumns=function(l){this.tv.setColumns(l)},f.addColumns=function(Z){this.tv.addColumns(Z)},f.endEditing=function(){this.tv.endEditing()},f.validateImpl=function(){var p=this,O=p.th,T=Dk(O),m={x:0,y:0,width:p.getWidth(),height:T};Sf(O,m),m.y=T,m.height=t(0,p.getHeight()-T),Sf(p.tv,m)}},ms_vs:function(q){q._41o=function(){return this._29I.height<this._59I},q._43o=function(){var Y=this;Y._41o()&&(Y._58I||(b(function(){Y._94O()},Xk),Y.iv()),Y._58I=new Date)},q._94O=function(){var Q=this;if(Q._58I){var h=new Date;h.getTime()-Q._58I.getTime()>=Xk?(delete Q._58I,Q.iv()):b(function(){Q._94O()},Xk)}},q._93I=function(){var D=this,n=D._27I;if(D._58I||!D._autoHideScrollBar){n||kr(D._79O,n=D._27I=ac());var d=D._29I,y=d.height,R=D._59I,q=D.getScrollBarSize(),B=d.width-q-2,V=y*(-D.ty()/R),Q=y*(y/R),b=n.style;R>y?(Dj>Q&&(V=V+Q/2-Dj/2,0>V&&(V=0),V+Dj>y&&(V=y-Dj),Q=Dj),b.visibility=_k,b.background=D.getScrollBarColor(),b.borderRadius=q/2+Rn,Sf(n,B,V,q,Q)):b.visibility=cs}else n&&(n.style.visibility=cs)}},ms_hs:function(g){g._40o=function(){return this._29I.width<this._91I},g._42o=function(){var f=this;f._40o()&&(f._95O||(b(function(){f._94I()},Xk),f.iv()),f._95O=new Date)},g._94I=function(){var V=this;if(V._95O){var m=new Date;m.getTime()-V._95O.getTime()>=Xk?(delete V._95O,V.iv()):b(function(){V._94I()},Xk)}},g._92I=function(){var s=this,j=s._28I;if(s._95O||!s._autoHideScrollBar){j||kr(s._79O,j=s._28I=ac());var E=s._29I,w=E.width,p=s._91I,_=s.getScrollBarSize(),J=E.height-_-2,A=w*(-s.tx()/p),W=w*(w/p),q=j.style;p>w?(Dj>W&&(A=A+W/2-Dj/2,0>A&&(A=0),A+Dj>w&&(A=w-Dj),W=Dj),q.visibility=_k,q.background=s.getScrollBarColor(),q.borderRadius=_/2+Rn,Sf(j,A,J,W,_)):q.visibility=cs}else j&&(j.style.visibility=cs)}}}),vf(dk,Vm(16,16,[{type:cb,rect:[1,1,14,14],background:Kr},{type:Qh,rect:[1,1,14,14],width:1,color:gc},{type:gn,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),vf(Gb,Vm(16,16,{type:Qh,rect:[1,1,14,14],width:1,color:gc})),vf(pc,Vm(16,16,[{type:Mm,rect:[2,2,12,12],borderWidth:1,borderColor:gc,background:"#FFF"},{type:Mm,rect:[4,4,8,8],background:Kr}])),vf(kf,Vm(16,16,{type:Mm,rect:[2,2,12,12],borderWidth:1,borderColor:gc})),sf._15Q=function(D){D._29I=be,D._59I=0,D._91I=0,D._5o=function(l){var d=this;d._30I=new Ol,d._rows=new Ol,d._rowMap={},d._31I=0,d._14I=0,d._view=nh(1,d),d._canvas=Uq(d._view),kr(d._view,d._79O=ac()),d.dm(l?l:new Mf)},D.getCheckIcon=function(F){var T=this.sm(),G=T.co(F);return T.sg()?cd(G?pc:kf):cd(G?dk:Gb)},D.checkData=function(n){var o=this.sm(),W=o.co(n);o.sg()&&W||(this._32o=1,W?o.rs(n):o.as(n),delete this._32o)},D.getDataAt=function(W){W.target&&(W=this.lp(W));var r=y(W.y/this._rowHeight),c=this._rows;return 0>r||r>=c.size()?N:c.get(r)},D.onDataDoubleClicked=function(){},D.onDataClicked=function(){},D.adjustTranslateX=function(){return 0},D.adjustTranslateY=function(V){var Z=this.getHeight()-this._59I;return Z>V&&(V=Z),V>0?0:s(V)},D.onPropertyChanged=function(c){var t=this,x=c.property;Ob[x]?t.ivm():eg[x]||t.redraw(),x===bp?t._42o():x===Cc&&t._43o()},D.getLabel=function(H){return H.toLabel()},D.getLabelFont=function(){return this._labelFont},D.getLabelColor=function(g){var L=this;if(L.isCheckMode()){if(L._focusData===g)return L._labelSelectColor}else if(L.isSelected(g))return L._labelSelectColor;return L._labelColor},D.getStartRowIndex=function(){return this._31I},D.getEndRowIndex=function(){return this._14I},D.getRowDatas=function(){return this._rows},D.getRowIndex=function(q){return this._rowMap[q._id]},D.getRowSize=function(){return this._rows.size()},D.getViewRect=function(){return hg(this._29I)},D.isVisible=function(y){return this._visibleFunc?this._visibleFunc(y):!0},D.getCurrentSortFunc=function(){return this._sortFunc},D.setDataModel=function(w){var K=this,h=K._dataModel,y=K._selectionModel;h!==w&&(h&&(h.umm(K.handleDataModelChange,K),h.umd(K.handleDataPropertyChange,K),h.umh(K.handleHierarchyChange,K),y||h.sm().ums(K.handleSelectionChange,K)),K._dataModel=w,w.mm(K.handleDataModelChange,K),w.md(K.handleDataPropertyChange,K),w.mh(K.handleHierarchyChange,K),y?y._21I(w):w.sm().ms(K.handleSelectionChange,K),K.fp("dataModel",h,w))},D.validateModel=function(){var O=this;O._rows.clear(),O._rowMap={},O.buildChildren(O._dataModel._roots);var T=O._rows=O._rows.toList(O.isVisible,O),g=0,w=O.getCurrentSortFunc(),o=T.size();for(w&&T.sort(w);o>g;g++)O._rowMap[T.get(g)._id]=g},D.buildChildren=function(G){var q=this;G.each(function(K){q._rows.add(K),q.buildChildren(K._children)})},D.handleDataModelChange=function(){this.ivm()},D.handleDataPropertyChange=function(E){"parent"===E.property?this.ivm():this.invalidateData(E.data)},D.handleHierarchyChange=function(){this.ivm()},D.handleSelectionChange=function(g){g.datas.each(this.invalidateData,this),this.onSelectionChanged(g)},D.onSelectionChanged=function(L){var S=this,X=S.sm();!S.isAutoMakeVisible()||1!==X.size()||"set"!==L.kind&&"append"!==L.kind||S._32o||S.makeVisible(X.ld())},D.handleBackgroundClick=function(N){Fq(N)&&!this.isCheckMode()&&this.sm().cs()},D.makeVisible=function(y){y&&(this._23I=y,this.iv())},D.scrollToIndex=function(H){var W=this,$=W._29I,k=$.height,X=W._rowHeight,g=X*H;H>=0&&H<W._rows.size()&&k>0&&(g+X>$.y+k?W.ty(-g+k-X):g<$.y&&W.ty(-g))},D.autoScroll=function(L,A){var B=this,N=B._rowHeight,q=N,m=N/4,z=B._29I,E=B.lp(L),I={x:B.tx(),y:B.ty()};return N>0&&z&&(E.x-z.x<q?B.translate(m,0):z.x+z.width-E.x<q&&B.translate(-m,0),E.y-z.y<q?B.translate(0,m):z.y+z.height-E.y<q&&B.translate(0,-m)),I.x=B.tx()-I.x,I.y=B.ty()-I.y,A&&(A.x+=I.x,A.y+=I.y),I},D.getTopRowOrderSelection=function(){var Q=this.sm().getTopSelection(),Y={},R=new Ol;return Q.each(function(p){Y[p._id]=p}),this._rows.each(function(v){Y[v._id]&&R.add(v)}),R},D.getRowOrderSelection=function(){var u=new Ol;return this._rows.each(function(z){this.isSelected(z)&&u.add(z)},this),u},D.ivm=function(){this.invalidateModel()},D.invalidateModel=function(){var r=this;r._96I||(r._96I=1,r._32I=1,delete r._24I),r.iv()},D.redraw=function(){var n=this;n._32I||(n._32I=1,delete n._24I,n.iv())},D.invalidateData=function(Z){var j=this;a?j.redraw():j._32I||(j._24I||(j._24I={}),j._24I[Z._id]=Z,j.iv())},D.getFocusData=function(){return this._focusData},D.setFocusDataById=function(k){this.setFocusData(this.dm().getDataById(k))},D.setFocusData=function(E){var G=this,m=G._focusData;m!==E&&(G._focusData=E,G.fp("focusData",m,E),m&&G.invalidateData(m),E&&(G.invalidateData(E),G.isAutoMakeVisible()&&G.makeVisible(E)))},D.drawRowBackground=function(u,s,R,y,L,r,e){var a=this,i=a.isCheckMode();(s===a._focusData&&i||R&&!i)&&zs(u,y,L,r,e,a.getSelectBackground(s))},D.drawData=function(c,v,F){var T=this,E=T._rowHeight,u=E*F,S=T._29I,h=S.x,U=S.width;c.save(),c.beginPath(),c.rect(h,u,U,E),c.clip(),T._87o(T.drawRow(c,v,T.isSelected(v),h,u,U,E),F,h,u,U,E),c.restore(),T._rowLineVisible&&zs(c,h,u+E-1,U,1,T._rowLineColor)},D._12I=function(N){var J=this,b=J._31I,R=J._29I,X=R.x,d=R.y,F=R.width,o=R.height;for(N.beginPath(),N.rect(X,d,F,o),N.clip(),N.clearRect(X,d,F,o),J._76o(),J._93db(N);b<J._14I;b++)J.drawData(N,J._rows.get(b),b);J._92db(N)},D._13I=function(Z){for(var U,s=this,x=s._rowHeight,O=s._29I,t=O.x,r=O.width,p=s._31I,Q=s._30I;p<s._14I;p++)U=s._rows.get(p),s._24I[U._id]&&Q.add({data:U,index:p});Q.isEmpty()||(Z.beginPath(),Q.each(function(I){Z.rect(t,I.index*x,r,x)}),Z.clip(),Q.each(function(I){Z.clearRect(t,I.index*x,r,x)}),Q.each(function(H){s._77o(H.index)}),s._93db(Z),Q.each(function($){s.drawData(Z,$.data,$.index)}),s._92db(Z),Q.clear())},D.validateImpl=function(){var t=this,D=t._canvas,c=t.getWidth(),Z=t.getHeight(),u=t._rowHeight,m=t._32I;(c!==D.clientWidth||Z!==D.clientHeight)&&(pp(D,c,Z),m=1);var C=p&&!l;t._96I&&!C&&t.validateModel();var X=t._29I,f={x:-t.tx(),y:-t.ty(),width:c,height:Z},j=t._rows.size(),q=Ji(D),k=t._23I;m||wd(f,X)||(m=1),t._29I=f,t._59I=j*u,t._31I=y(f.y/u),t._14I=U((f.y+f.height)/u),t._31I<0&&(t._31I=0),t._14I>j&&(t._14I=j),t._99I&&m&&t._99I(),dg(q,t.tx(),t.ty(),1),m?t._12I(q):t._24I&&t._13I(q),t._93I(),t._92I(),q.restore(),t._32I=t._24I=t._96I=N,k&&(t.scrollToIndex(t.getRowIndex(k)),delete t._23I),t.tx(t.tx()),t.ty(t.ty())}},sf._48o=function(m){m._rootVisible=!0,m._rootData=N,m._35o=function(){this._expandMap={},this._levelMap={}},m.validateModel=function(){var V=this,G=V._rootData;V._rows.clear(),V._levelMap={},V._rowMap={},V._currentLevel=0,G?V._rootVisible?V.isVisible(G)&&V.buildData(G):V.buildChildren(G):V.buildChildren(),delete V._currentLevel},m.buildData=function(i){var F=this,m=i._id,r=F._rows;F._rowMap[m]=r.size(),r.add(i),F._levelMap[m]=F._currentLevel,F.isExpanded(i)&&(F._currentLevel++,F.buildChildren(i),F._currentLevel--)},m.buildChildren=function(e){var f=this,v=e?e._children:f._dataModel._roots,M=f.getCurrentSortFunc();M&&f.isChildrenSortable(e)?v.toList(f.isVisible,f).sort(M).each(f.buildData,f):v.each(function(o){f.isVisible(o)&&f.buildData(o)})},m.getLevel=function(n){return this._levelMap[n._id]},m.getToggleIcon=function(f){var _=this,b=_._loader,T=_._collapseIcon;return b&&!b.isLoaded(f)?T:f.hasChildren()?_.isExpanded(f)?_._expandIcon:T:N},m.isCheckMode=function(){return this._checkMode!=N},m.isChildrenSortable=function(){return!0},m.handleDataModelChange=function(U){var z=this;U.kind===Ek?delete z._expandMap[U.data._id]:U.kind===qf&&(z._expandMap={}),z.ivm()},m.toggle=function(F){var v=this;v.isExpanded(F)?v.collapse(F):v.expand(F)},m.isExpanded=function(t){return 1===this._expandMap[t._id]},m.expand=function(p){var B=this,x=B._loader;B.isExpanded(p)||(x&&!x.isLoaded(p)&&x.load(p),B._expandMap[p._id]=1,B.ivm(),B.onExpanded(p))},m.onExpanded=function(){},m.collapse=function(J){var z=this;z.isExpanded(J)&&(delete z._expandMap[J._id],z.ivm(),z.onCollapsed(J))},m.onCollapsed=function(){},m.expandAll=function(P){if(P)this.expand(P),P.eachChild(function(c){this.expandAll(c)},this);else{var E=this;E._dataModel.each(function(T){T.hasChildren()&&(E._expandMap[T._id]=1)}),E.ivm()}},m.collapseAll=function(){this._expandMap={},this.ivm()},m.makeVisible=function(D){if(D){var G=this;if(!G._rootData||D.isDescendantOf(G._rootData)){for(var z=D._parent;z;)G.expand(z),z=z._parent;G._23I=D,G.iv()}}},m.checkData=function(O){var y,z=this,k=z._checkMode,K=z.sm(),D=K.co(O);if(!K.sg()||!D){if(z._32o=1,k===Fd)D?K.rs(O):K.as(O);else if(k===Vl)y=new Ol(O),y.addAll(O._children);else if("descendant"===k)y=new Ol,Nm(O,y);else if("all"===k&&(y=new Ol,Nm(O,y),!D))for(var G=O._parent;G;)y.add(G),G=G._parent;y&&(D?K.rs(y):K.as(y)),delete z._32o}},m._97I=function(a,r,Z,j,F,C,f){var E=this,z=E._indent,n=E._levelMap[r._id],W=E.getIconWidth(r),I=cd(E.getToggleIcon(r));I?(j+=z*n,Bh(a,I,j+z/2,F+f/2,r,E),j+=z):j+=z*(n+1),E._checkMode&&(Bh(a,E.getCheckIcon(r),j+z/2,F+f/2,r,E),j+=z),E.drawIcon(a,r,j,F,W,f),E.drawLabel(a,r,j+W,F,f)}},sf._14Q=function(V){V.getIcon=function(Z){return Z.getIcon()},V.getIconWidth=function(c){return this.getIcon(c)?this._indent:0},V.drawIcon=function(D,v,T,X,G,O){if(G){var H=this,n=H.getBodyColor(v),l=cd(H.getIcon(v),n);l&&(O-=H.isRowLineVisible()?1:0,Nq(D,l,Ac,T,X,G,O,v,H,n),Qk(D,H.getBorderColor(v),T,X,G,O))}},V.drawLabel=function(L,z,F,f,p){var R=this;Tn(L,R.getLabel(z),R.getLabelFont(z),R.getLabelColor(z),F,f,0,p)}},sf._50o=function(M){M._98I=function(){var C=this,Y=C._39o=new Mf;C._60I=new Ol,Y.mm(C._17o,C),Y.md(C._18o,C),Y.mh(C._19o,C)},M.setColumns=function(k){this._39o.clear(),this.addColumns(k)},M.addColumns=function(V){var H=this._39o;V.forEach(function(n){if(!(n instanceof Jk)){var S=Me(n.className);n=Ik(S?S:Jk,n)}H.add(n)})},M.onColumnClicked=function(){},M.onCheckColumnClicked=function(){},M._3Q=function(s){for(var F,S=0,i=this._60I,m=i.size();m>S;S++)if(F=i.get(S),F.column===s)return F;return N},M.getColumnAt=function(J){var F=this._4Q(J);return F?F.column:N},M._4Q=function(j){for(var T=this,b=j.target?T.lp(j).x:j.x,p=T._60I,v=0;v<p.size();v++){var z=p.get(v),D=z.startX;if(b>=D&&b<D+z.column.getWidth())return z}return N},M.getToolTip=function(U){var y=this,i=y.getDataAt(U),r=y.getColumnAt(U);return i&&r?r.getToolTip(i,y):N},M.adjustTranslateX=function(D){var B=this.getWidth()-this._91I;return B>D&&(D=B),D>0?0:s(D)},M._99I=function(){var d=this,D=d._29I,t=d._60I;t.clear(),d._91I=0,d._39o._roots.each(function(c){if(c.isVisible()){var Q=d._91I+c.getWidth();d._91I<=D.x+D.width&&Q>=D.x&&t.add({column:c,startX:d._91I}),d._91I=Q}})},M.drawData=function(p,F,X){var L=this,T=L._rowHeight,e=T*X,J=L.isSelected(F),j=L._29I,O=j.x,b=j.width;L.drawRowBackground(p,F,J,O,e,b,T),L._60I.each(function(t){var K=t.column,u=t.startX,w=K.getWidth();w>0&&!L.isEditing(F,K)&&(p.save(),p.beginPath(),p.rect(u,e,w,T),p.clip(),L._87o(L.drawCell(p,F,J,K,u,e,w,T),X,u,e,w,T),L._columnLineVisible&&zs(p,u+w-1,e,1,T,L._columnLineColor),p.restore())}),L._rowLineVisible&&zs(p,O,e+T-1,b,1,L._rowLineColor)},M.drawCell=function(Q,l,s,C,a,R,$,k){var v=this;if(C.drawCell)return C.drawCell(Q,l,s,C,a,R,$,k,v);var O=v.getValue(l,C);Jq(Q,O,C,v.getLabelFont(l,C,O),v.getLabelColor(l,C,O),a,R,$,k,l,v)},M.getColumnModel=function(){return this._39o},M._17o=function(){this.redraw()},M._18o=function(V){var I=this;V.data===I._sortColumn&&nl[V.property]?I.ivm():(I._42o(),I.redraw())},M._19o=function(){this.redraw()},M.getCurrentSortFunc=function(){var P=this,J=P._sortColumn;if(J&&J.isSortable()){var Q=J.getSortFunc(),c=ch===J.getSortOrder()?1:-1;return Q||(Q=Hc),function(U,a){return Q.call(P,P.getValue(U,J),P.getValue(a,J),U,a)*c}}return P._sortFunc},M.isCellEditable=function(O,m,Z){return(!this.isCheckMode()&&this.isSelected(O)||this.isCheckMode()&&O===this._focusData)&&m.isEditable()&&this.isEditable()?m.isCellEditable?m.isCellEditable(O,m,Z,this):!0:!1},M._37O=function(A,z){if(Fq(z))for(var n=this,Z=n.lp(z),c=n._60I,D=n._rowHeight,g=n._29I,V=g.x,b=g.y,u=g.width,I=g.height,G=0;G<c.size();G++){var q=c.get(G),W=q.startX,U=q.column,Y=U.getWidth();if(U!==n._31o&&U!==n._4o&&Z.x>=W&&Z.x<W+Y&&n.isCellEditable(A,U,z)){var E={x:W,y:n.getRowIndex(A)*D,width:Y,height:D},M={x:E.x+n.tx(),y:E.y+n.ty(),width:E.width,height:E.height},m=0,_=0;return E.x<V?m=E.x-V:E.x+E.width>V+u&&(m=E.x+E.width-V-u),m&&(n.tx(n.tx()-m),M.x-=m),E.y<b?_=E.y-b:E.y+D>b+I&&(_=E.y+D-b-I),_&&(n.ty(n.ty()-_),M.y-=_),n.beginEditing({data:A,column:U,value:n.getValue(A,U),event:z,rect:E,editorRect:M,view:n}),void 0}}}},br.BaseItemEditor=function(I,Z,a,X){this._data=I,this._column=Z,this._master=a,this._editInfo=X},Hb("BaseItemEditor",J,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var ag=M.Tab=function(){Ho(ag,this)};Wj("Tab",sc,{ms_ac:["view","closable","disabled"],_icon:N,_closable:!1,_disabled:!1,setParent:Sl});var Jk=M.Column=function(){Ho(Jk,this)};Wj("Column",sc,{_46o:1,ms_ac:["accessType","valueType",_k,Ll,ns,cg,"align",aq,"sortOrder",xl,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:ch,_sortFunc:N,_sortable:!0,_clickable:!0,setWidth:function(p){16>p&&(p=16);var m=this._width;this._width=p,this.fp(cg,m,p)},getToolTip:function(z,K){return this.formatValue(K.getValue(z,this))}});var lp=M.Property=function(){Ho(lp,this)};Wj("Property",sc,{_46o:1,ms_ac:["accessType","valueType",Ll,ns,"categoryName",aq,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:N,getToolTip:function(s,S,k){var n=this;return S?n.formatValue(k.getValue(s,n)):k.getPropertyName(n)}}),br.AccordionView=function(){var r=this;r._20o={},r._21o=new Ol,r._10o=N,r._9o=N,r._11o=N,r._view=nh(0,r),r.iv()},Hb("AccordionView",J,{ms_v:1,ms_fire:1,ms_ac:[pf,Yj,"titleHeight",Do,Un,"titleBackground","selectWidth",ke,"orientation","separatorColor"],_expandIcon:Q.accordionViewExpandIcon,_collapseIcon:Q.accordionViewCollapseIcon,_titleHeight:Mo,_labelColor:Q.accordionViewLabelColor,_labelFont:Q.accordionViewLabelFont,_titleBackground:Q.accordionViewTitleBackground,_selectBackground:Q.accordionViewSelectBackground,_selectWidth:Q.accordionViewSelectWidth,_orientation:"v",_separatorColor:Q.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(A,o,U,m){var i=this,O=ac();if(i._20o[A])throw A+" already exists";O.onmousedown=zq,O.style.cursor=zf,O.addEventListener(Bq?Xf:mb,function(G){zq(G)},!1),O.addEventListener(Bq?mp:Fe,function(x){zq(x),Fq(x)&&(i._10o===A?i.collapse():i.expand(A))},!1),kr(i._view,O),i._20o[A]={content:o,div:O,canvas:Uq(O),icon:m},i._21o.add(A),U&&i.expand(A),i.iv()},remove:function(C){var B=this,i=B._20o[C];i&&(eq(i.div),delete B._20o[C],B._21o.remove(C),B.iv())},clear:function(){var M=this;M._20o={},M._21o.clear(),M.iv()},isExpanded:function(r){return this._10o===r},expand:function(N){var E=this;E._20o[N]&&E._10o!==N&&(E._10o=N,E.onExpanded(N),E.iv())},onExpanded:function(){},collapse:function(){var S=this;S._10o&&(S.onCollapsed(S._10o),delete S._10o,S.iv())},onCollapsed:function(){},initCanvas:function(o,a,i){pp(o,a,i);var h=Ji(o);return dg(h,0,0,1),h.clearRect(0,0,a,i),h},drawTitle:function(R,z,H,W,r){var K=this,Q=cd(r.icon),I=K.isExpanded(z),e=K._titleHeight,A=K._titleBackground,P=K._selectWidth,N=K._separatorColor,L=cd(I?K._expandIcon:K._collapseIcon),M=P+4;zs(R,0,0,H,W,A),I&&P&&zs(R,0,0,P,W,K._selectBackground),(I||K._21o.get(K._21o.size()-1)!==z)&&zs(R,0,W-1,H,1,N?N:gr(A)),Q&&(Bh(R,Q,M+pg(Q)/2,e/2),M+=pg(Q)+2),Tn(R,z,K.getLabelFont(z),K.getLabelColor(z),M,0,0,e),L&&Bh(R,L,H-pg(L)/2-4,e/2)},validateImpl:function(){var e=this,V=e._view,J=0,C=0,m=e.getWidth(),P=e.getHeight(),D=e._titleHeight,H=e._21o.size()*D,l=e._11o,d=e._9o;delete e._11o,delete e._9o,e._21o.each(function(G){var y,X,r=e._20o[G],n=r.content,I=e._10o===G;Sd(e)?(Sf(r.div,J,0,D,P),y=e.initCanvas(r.canvas,D,P),qo(y,0,P),Gm(y,-z),e.drawTitle(y,G,P,D,r),y.restore(),I?(X=t(0,m-H),n&&(e._11o=n,e._9o=ff(n),Sf(n,J+D,0,X,P)),J+=D+X):J+=D):(Sf(r.div,0,C,m,D),y=e.initCanvas(r.canvas,m,D),e.drawTitle(y,G,m,D,r),y.restore(),I?(X=t(0,P-H),n&&(e._11o=n,e._9o=ff(n),Sf(n,0,C+D,m,X)),C+=D+X):C+=D)});var y=e._9o;l&&l!==e._11o&&l.endEditing&&l.endEditing(),y&&y!==d&&kr(V,y),d&&d!==y&&eq(d)}}),br.SplitView=function(M,Y,p,T){var D=this,C=D._dividerDiv=ac(),S=D._60O=Uq(),W=D._61O=Uq(),O=S.style,u=W.style;D._view=nh(1,D),kr(D._view,C),O.msTouchAction=nd,O.pointerEvents=nd,O.cursor=zf,u.msTouchAction=nd,u.pointerEvents=nd,u.cursor=zf,M&&D.setLeftView(M),Y&&D.setRightView(Y),p&&D.setOrientation(p),T!=N&&D.setPosition(T),D.setStatus(Hh),new Mb(D)},Hb("SplitView",J,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:Q.splitViewDividerSize,_dividerBackground:Q.splitViewDividerBackground,_dragOpacity:Q.splitViewDragOpacity,_toggleIcon:Q.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(t,I){var $=this,X=$._position;isNaN(t)||(I||($._82O=0>t?-1:t>1?1:0),$._position=t,$.fp(Nh,X,t))},getLeftView:function(){return this._leftView},setLeftView:function(R){var $=this,h=$._leftView,u=$._view;if($._leftView!==R){if(h&&h!==$._rightView){var Q=ff(h);Q.parentNode===u&&eq(Q)}if($._leftView=R,R){var P=ff(R);P.parentNode!==u&&u.insertBefore(P,$._dividerDiv)}$.fp("leftView",h,R)}},getRightView:function(){return this._rightView},setRightView:function(i){var q=this,y=q._rightView,g=q._view;if(q._rightView!==i){if(y&&y!==q._leftView){var V=ff(y);V.parentNode===g&&eq(V)}if(q._rightView=i,i){var o=ff(i);o.parentNode!==g&&g.insertBefore(o,q._dividerDiv)}q.fp("rightView",y,i)}},validateImpl:function(){var T=this,S=T._draggable,c=T._position,C=T.getWidth(),N=T.getHeight(),E=T._dividerSize,e=T._dividerBackground,a=Bq?18:8,I=T._dividerDiv,k=T._82O,$=T._60O,X=T._61O,n=T._toggleIcon,J=T._status,r=I.style,y=null,d=Bq?20:4,R=n.comps[0];E>=a||0===E?T._coverDiv&&(eq(T._coverDiv),delete T._coverDiv):T._coverDiv||(T._coverDiv=ac(),Y&&(T._coverDiv.style.background=vg),kr(I,T._coverDiv)),T._togglable?$.parentNode||(kr(I,$),kr(I,X)):(eq($),eq(X));var x=T._coverDiv,o=T._leftView,G=T._rightView;if(Sd(T)){if(E>C&&(E=C),J===Hh)if(1===k)var g=O(c,C),f=t(0,C-E-g);else-1===k?(f=O(-c,C),g=t(0,C-E-f)):(g=s((C-E)*c),f=t(0,C-E-g));else"cl"===J?(g=0,f=t(0,C-E)):"cr"===J&&(f=0,g=t(0,C-E));o&&Sf(o,0,0,g,N),G&&Sf(G,g+E,0,f,N),Sf(I,g,0,E,N),T._22o=g,x&&(Sf(x,E/2-a/2,0,a,N),x.style.cursor=S?cn:""),I.style.cursor=S?cn:"";var D=I.clientHeight/2,p=I.clientWidth;pp($,p,p),Sf($,0,D-p-d,p,p),y=Ji($),dg(y,0,0,1),R.rotation=-z,tg(y,n,0,0,p,p),y.restore(),pp(X,p,p),Sf(X,0,D+d,p,p),y=Ji(X),dg(y,0,0,1),R.rotation=z,tg(y,n,0,0,p,p),y.restore()}else{if(E>N&&(E=N),J===Hh)if(1===k)var K=O(c,N),B=t(0,N-E-K);else-1===k?(B=O(-c,N),K=t(0,N-E-B)):(K=s((N-E)*c),B=t(0,N-E-K));else"cl"===J?(K=0,B=t(0,N-E)):"cr"===J&&(B=0,K=t(0,N-E));o&&Sf(o,0,0,C,K),G&&Sf(G,0,K+E,C,B),Sf(I,0,K,C,E),T._22o=K,x&&(Sf(x,0,E/2-a/2,C,a),x.style.cursor=S?lc:""),r.cursor=S?lc:"";var w=I.clientWidth/2,p=I.clientHeight;pp($,p,p),Sf($,w-p-d,0,p,p),y=Ji($),dg(y,0,0,1),R.rotation=0,tg(y,n,0,0,p,p),y.restore(),pp(X,p,p),Sf(X,w+d,0,p,p),y=Ji(X),dg(y,0,0,1),R.rotation=H,tg(y,n,0,0,p,p),y.restore()}r.background=e}});var Mb=function(r){this.sv=r,this.addListeners()};Gd(Mb,J,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(N){var $=this,W=$.sv,v=W._dividerDiv,P=W._60O,j=W._61O,g=W._status,J=N.target;if(J===P)g===Hh?W.setStatus("cl"):"cr"===g&&W.setStatus(Hh);else if(J===j)g===Hh?W.setStatus("cr"):"cl"===g&&W.setStatus(Hh);else if(Uk(N)&&(J===v||J===W._coverDiv)&&(zq(N),W.isDraggable())){W.getLeftView(),W.getRightView();var U=$.maskDiv=ac();if(U.style.left=0,U.style.top=0,U.style.width=W.getWidth()+"px",U.style.height=W.getHeight()+"px",W.getView().appendChild(U),!W.isContinuousLayout()){var q=$.resizeDiv=ac();q.style.left=v.style.left,q.style.top=v.style.top,q.style.width=v.style.width,q.style.height=v.style.height,q.style.opacity=W.getDragOpacity(),q.style.background=W.getDividerBackground(),kr($.getView(),q)}$._lastAbsPosition=W._22o,$._86o=Sd(W)?zc(N).x:zc(N).y,ds($,N)}},handleWindowTouchMove:function(M){Uk(M)&&this.update(M,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(R){var t=this;t.update(R,!0),t.sv.setStatus(Hh),t.maskDiv&&eq(t.maskDiv),t.resizeDiv&&eq(t.resizeDiv),t.maskDiv=t.resizeDiv=N},handle_mousedown:function(h){Fq(h)&&this.handle_touchstart(h)},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowMouseUp:function(D){this.handleWindowTouchEnd(D)},update:function(I,p){var G=this,r=G.sv,Q=Sd(r)?r.getWidth():r.getHeight(),w=r._dividerSize,V=G._lastAbsPosition-G._86o;Sd(r)?(V+=zc(I).x,V>Q-w&&(V=Q-w),0>V&&(V=0),G.resizeDiv&&(G.resizeDiv.style.left=V+Rn)):(V+=zc(I).y,V>Q-w&&(V=Q-w),0>V&&(V=0),G.resizeDiv&&(G.resizeDiv.style.top=V+Rn)),p&&Q!==w&&(1===r._82O?r.setPosition(V,1):-1===r._82O?r.setPosition(V-Q+w,1):r.setPosition(V/(Q-w),1))}}),br.TabView=function(){var K=this,l=K._view=nh(1,K),u=K._91O=ac(1),W=K._tabModel=new Mf,a=W.sm(),i=K.invalidate;K._7o=new Ol,K._canvas=Uq(u),kr(l,u),kr(l,K._92O=ac(1)),a.setSelectionMode(ws),a.ms(i,K),W.mm(i,K),W.md(i,K),W.mh(i,K),new kb(K),K.iv()},Hb("TabView",J,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Do,Un,"tabBackground","selectWidth",ke,"moveBackground","insertColor"],_tabPosition:Kf,_tabHeight:Mo,_tabGap:Q.tabViewTabGap,_labelColor:Q.tabViewLabelColor,_labelFont:Q.tabViewLabelFont,_tabBackground:Q.tabViewTabBackground,_selectWidth:Q.tabViewSelectWidth,_selectBackground:Q.tabViewSelectBackground,_moveBackground:Q.tabViewMoveBackground,_insertColor:Q.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(m,L,U){var n=new ag,X=this._tabModel;return n.setName(m),n.setView(L),X.add(n),U&&X.sm().ss(n),n},getLabel:function(L){return L.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(L){this._23o=L,this.iv()},get:function(f){var y=this,q=y._tabModel;if(wf(f))return q._roots.get(f);if(Hq(f)){var V;return q.each(function(a){f===y.getLabel(a)&&(V=a)}),V}return f instanceof ag?f:N},select:function(S){this._tabModel.sm().ss(this.get(S))},remove:function(O){var u=this;if(O=u.get(O)){var d=u._tabModel,o=d._roots.indexOf(O);u._tabModel.remove(O),u._12Q(--o)}},getCurrentTab:function(){return this._8o},hideTabView:function(u,o){o.parentNode===this._92O&&(Fb(o)?(o.style.display=Jg,o._tab_=u):eq(o),Od())},showTabView:function(p,K){Fb(K)&&(K.style.display="block",K._tab_=p),K.parentNode!==this._92O&&(kr(this._92O,K),Od())},_24o:function(){var i,H=this,J=H._8o,_=H._9o,m=H._tabModel.sm().ld();m&&(i=ff(m.getView())),i!==_&&(_&&(J.getView()&&J.getView().endEditing&&J.getView().endEditing(),H.hideTabView(J,_)),i&&H.showTabView(m,i)),H._8o=m,H._9o=i,J!==m&&H.onTabChanged(J,m)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(d,T){this._12Q(--T)},_12Q:function(q){var j=this,B=j._tabModel,A=B.size();if(A&&!B.sm().ld()){q==N&&(q=0),q>=A&&(q=A-1),0>q&&(q=0);for(var w=q;w>=0;w--){var f=j.get(w);if(!f.isDisabled())return j.select(f),f}for(w=q+1;A>w;w++)if(f=j.get(w),!f.isDisabled())return j.select(f),f}},getTabWidth:function(S){var $=4,g=cd(S.getIcon());g&&($+=pg(g,S)+4);var M=this.getLabel(S);return M&&($+=sl(this.getLabelFont(S),M).width+4),S.isClosable()&&($+=10),$},drawTab:function(c,g,h,t,I,Q,W){var E,M=this,x=M._tabPosition,N=h+4,u=M._selectWidth,$=cd(g.getIcon()),T=g.isDisabled(),y=M.getLabelColor(g),D=M.getLabelFont(g),O=M.getLabel(g),Z=M._selectBackground,e=x===kj+"-vertical",F=x===Lj+"-vertical";(e||F)&&(N=t+4),T&&(c.globalAlpha=Am),zs(c,h,t,I,Q,W),g===M._8o&&u&&(x===Kf?zs(c,h,t+Q-u,I,u,Z):x===kj?zs(c,h+I-u,t,u,Q,Z):x===Lj?zs(c,h,t,u,Q,Z):e?zs(c,h+I-u,t,u,Q,Z):F?zs(c,h,t,u,Q,Z):zs(c,h,t,I,u,Z));var p=I/2;if(e&&(qo(c,p,t+Q/2),Gm(c,H),qo(c,-p,-t-Q/2)),$){var A=gh($,g),C=pg($,g);if(e||F){var G=h+I/2,L=N+A/2;qo(c,G,L),Gm(c,z),qo(c,-G,-L),Bh(c,$,h+I/2,N+A/2,g,M),qo(c,G,L),Gm(c,-z),qo(c,-G,-L),N+=A+4}else Bh(c,$,N+C/2,t+Q/2,g,M),N+=C+4}return e||F?(qo(c,I/2,N+I/2),Gm(c,z),qo(c,-I/2,-N-I/2),Tn(c,O,D,y,h,N,Q,I),qo(c,I/2,N+I/2),Gm(c,-z),qo(c,-I/2,-N-I/2)):Tn(c,O,D,y,N,t,I,Q),e&&(qo(c,p,t+Q/2),Gm(c,-H),qo(c,-p,-t-Q/2)),g.isClosable()&&(E=F?{x:h+I-12,y:t+Q-12,width:12,height:12}:{x:h+I-12,y:t+2,width:12,height:12},this.drawCloseIcon(g,c,y,E)),T&&(c.globalAlpha=1),E
},drawCloseIcon:function(c,L,R,V){var M=V.x,Q=V.y;L.strokeStyle=R,L.lineWidth=1,L.beginPath(),L.moveTo(M+2,Q+8),L.lineTo(M+8,Q+2),L.moveTo(M+8,Q+8),L.lineTo(M+2,Q+2),L.stroke()},validateImpl:function(){var g=this;g._24o();var F,G=g._canvas,O=g._tabPosition,n=g._91O,w=g._92O,S=g._tabModel,z=g.getWidth(),e=g.getHeight(),C=g._tabHeight,m=g._7o,d=g._tabGap,i=O===Kf,q=O===kj,D=O===Lj,c=O===kj+"-vertical",J=O===Lj+"-vertical",y=g._23o,Y=0;if((q||D)&&S._roots.each(function($){Y=t(g.getTabWidth($),Y)}),i?(Sf(n,0,0,z,C),F={x:0,y:C,width:z,height:t(0,e-C)}):q?(Sf(n,0,0,Y,e),F={x:Y,y:0,width:t(0,z-Y),height:e}):D?(Sf(n,z-Y,0,Y,e),F={x:0,y:0,width:t(0,z-Y),height:e}):c?(Sf(n,0,0,C,e),F={x:C,y:0,width:t(0,z-C),height:e}):J?(Sf(n,z-C,0,C,e),F={x:0,y:0,width:t(0,z-C),height:e}):(Sf(n,0,e-C,z,C),F={x:0,y:0,width:z,height:t(0,e-C)}),Sf(w,F),c||J){g._9o&&(F.x=0,Sf(g._8o.getView(),F)),pp(G,C,e);var s=Ji(G),l=0;if(dg(s,0,g.ty(),1),s.clearRect(0,0,C,e),m.clear(),S._roots.each(function(Y){var Q,N=g.getTabWidth(Y);y&&y.tab===Y||(Q=g.drawTab(s,Y,0,l,C,N,g._tabBackground)),m.add({_75o:Q,tab:Y,startY:l,endY:l+N,height:N}),l+=N+d}),g._23Q=t(0,l-d),y){var B=y.position;g.drawTab(s,y.tab,0,y.startY,C,y.height,g._moveBackground),zs(s,0,B,C,1,g._insertColor)}s.restore(),g.ty(g.ty())}else if(q||D){g._9o&&(F.x=0,Sf(g._8o.getView(),F)),pp(G,Y,e);var s=Ji(G),l=0;if(dg(s,0,g.ty(),1),s.clearRect(0,0,Y,e),m.clear(),S._roots.each(function(U){var X;y&&y.tab===U||(X=g.drawTab(s,U,0,l,Y,C,g._tabBackground)),m.add({_75o:X,tab:U,startY:l,endY:l+C,height:C}),l+=C+d}),g._23Q=t(0,l-d),y){var B=y.position;g.drawTab(s,y.tab,0,y.startY,Y,y.height,g._moveBackground),zs(s,0,B,Y,1,g._insertColor)}s.restore(),g.ty(g.ty())}else{g._9o&&(F.y=0,Sf(g._8o.getView(),F)),pp(G,z,C);var s=Ji(G),r=0;if(dg(s,g.tx(),0,1),s.clearRect(0,0,z,C),m.clear(),S._roots.each(function(V){var U,v=g.getTabWidth(V);y&&y.tab===V||(U=g.drawTab(s,V,r,0,v,C,g._tabBackground)),m.add({_75o:U,tab:V,startX:r,endX:r+v,width:v}),r+=v+d}),g._64I=t(0,r-d),y){var B=y.position;g.drawTab(s,y.tab,y.startX,0,y.width,C,g._moveBackground),Uh(s,g._insertColor,B,0,C)}s.restore(),g.tx(g.tx())}for(var X=[],T=w.children,K=0;K<T.length;K++){var x=T[K],v=x._tab_;v&&!S.contains(v)&&X.push(x)}X.forEach(function(p){w.removeChild(p)})}});var kb=function(q){this.tv=q,this.addListeners()};Gd(kb,J,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(z){this.handleScroll(z,10*(z.wheelDelta/40))},handle_DOMMouseScroll:function(N){this.handleScroll(N,10*-N.detail)},handleScroll:function(r,F){zq(r);var K=this.tv,J=K._tabPosition;!K._40o()||J!==Kf&&J!==si||K.tx(this.tv.tx()+F),!K._41o()||J!==kj&&J!==Lj&&J!==kj+"-vertical"&&J!==Lj+"-vertical"||K.ty(this.tv.ty()+F)},_8Q:function(b){var h,g,i=this.tv,X=i._tabPosition,H=i._7o;if(X===Kf||X===si){var U=i.lp(b).x;for(h=0;h<H.size();h++)if(g=H.get(h),g.startX<=U&&U<=g.endX)return g}else if(X===kj||X===Lj||X===kj+"-vertical"||X===Lj+"-vertical"){var C=i.lp(b).y;for(h=0;h<H.size();h++)if(g=H.get(h),g.startY<=C&&C<=g.endY)return g}return N},isClickable:function(a){var Z=this.tv,O=Z._tabPosition,X=this._73o=this._8Q(a);return!Z._40o()||O!==Kf&&O!==si?!Z._41o()||O!==kj&&O!==Lj&&O!==kj+"-vertical"&&O!==Lj+"-vertical"?X&&(!X.tab.isDisabled()||Z.isMovable()):!0:!0},handle_mousemove:function(R){var w=this;Ki?w._74o=w._8Q(R):w.getView().style.cursor=w.isClickable(R)?zf:""},handle_mousedown:function(p){this.handle_mousemove(p),this.handle_touchstart(p)},handle_touchstart:function(K){var c=this,k=c.tv,M=k._tabPosition;zq(K),Fq(K)&&c.isClickable(K)&&(M===Kf||M===si?(c.x=zc(K).x,c.lp=k.lp(K),c.tx=k.tx()):(c.y=zc(K).y,c.lp=k.lp(K),c.ty=k.ty()),ds(c,K))},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(z){var u,X=this,G=X.tv,o=G._tabPosition,s=X._73o;if(o===Kf||o===si){if(u=zc(z).x-X.x,!X._25o&&!X.moving&&A(u)>2&&(G._40o()&&!op(z)?X._25o=1:s&&G.isMovable()&&(X.moving=1)),X._25o)G.tx(X.tx+u);else if(X.moving){var y=X.lp.x+u,Z=G._tabGap/2;G._7o.each(function(e){var T=e.endX,v=y-e.startX<T-y;y>=e.startX&&T>=y&&G._7Q({tab:s.tab,startX:s.startX+u,width:s.width,front:v,insertTab:e.tab,position:v?t(0,e.startX-Z):O(G._64I,T+Z)})})}}else if(u=zc(z).y-X.y,!X._25o&&!X.moving&&A(u)>2&&(G._41o()&&!op(z)?X._25o=1:s&&G.isMovable()&&(X.moving=1)),X._25o)G.ty(X.ty+u);else if(X.moving){var $=X.lp.y+u,Z=G._tabGap/2;G._7o.each(function(c){var b=c.endY,d=$-c.startY<b-$;$>=c.startY&&b>=$&&G._7Q({tab:s.tab,startY:s.startY+u,height:s.height,front:d,insertTab:c.tab,position:d?t(0,c.startY-Z):O(G._23Q,b+Z)})})}},handleWindowMouseUp:function(_){this.handleWindowTouchEnd(_)},handleWindowTouchEnd:function(){var t=this,P=t.tv,A=P._tabPosition,W=P.getTabModel(),q=W._roots,x=t._73o;if(t.moving){var v=P._23o;if(v&&v.insertTab!==v.tab){var M=v.tab,D=q.remove(M),k=q.indexOf(v.insertTab);k>=0&&(v.front||k++,k<=q.size()&&(q.add(M,k),W._38I(M,D,k)))}P._7Q(N),delete t.moving}else if(!t._25o&&x){M=x.tab;var T=t._74o;if(!T||T.tab===M)if(!M.isDisabled()&&Ah(x._75o,t.lp)){var i=function(){var G=q.indexOf(M);W.remove(M),P.onTabClosed(M,G)};P.onTabClosing(M,i)&&i()}else M.isDisabled()||P._8o===M||W.sm().ss(M)}t._25o=t._73o=t._74o=A===Kf||A===si?t.x=t.lp=t.tx=N:t.y=t.lp=t.ty=N}}),br.PropertyView=function(b){var d=this;d._view=nh(1,d),d._canvas=Uq(d._view),kr(d._view,d._79O=ac()),d._rows=new Ol,d._28o=new Ol,d._26o={},d._26Q={};var B=d._propertyModel=new Mf,m=d.ivm;B.mm(m,d),B.md(m,d),B.mh(m,d),d.dm(b?b:new Mf),new yi(d)},Hb("PropertyView",J,{ms_ac:[Do,eo,Un,Ll,ns,"categorizable",tc,xl,Jh,pf,Yj,Df,jf,Ig,"selectRowIndex",ke,"background",Mc,$d,xb,Qd,Eb],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:be,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Em,_background:Q.propertyViewBackground,_expandIcon:Q.propertyViewExpandIcon,_collapseIcon:Q.propertyViewCollapseIcon,_scrollBarColor:$n,_scrollBarSize:ss,_autoHideScrollBar:qe,_selectBackground:Q.propertyViewSelectBackground,_rowHeight:Qi,_rowLineVisible:Q.propertyViewRowLineVisible,_rowLineColor:Q.propertyViewRowLineColor,_10I:.5,_columnLineVisible:Q.propertyViewColumnLineVisible,_columnLineColor:Q.propertyViewColumnLineColor,_labelColor:Q.propertyViewLabelColor,_labelSelectColor:Q.propertyViewLabelSelectColor,_labelFont:Q.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(j){0>j&&(j=0),j>1&&(j=1);var G=this,_=G._10I;G._10I=j,G.fp("columnPosition",_,j)},getPropertyName:function(B){return B.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(I,R,x){return x===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(z,E){return E===this._selectRowIndex?this._labelSelectColor:z.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(l){var t=this.getHeight()-this._59I;return t>l&&(l=t),l>0?0:s(l)},isExpanded:function(a){if(!a)return!0;var o=this._26o[a];return o?o.isExpanded:!(this._26Q[a]===!1)},toggle:function(N){var x=this;x.isExpanded(N)?x.collapse(N):x.expand(N)},expandAll:function(){this.validate();for(var G in this._26o)this.expand(G)},expand:function(K){if(K&&K!==Jg){var X=this,N=X._26o[K];N&&!N.isExpanded&&(N.isExpanded=!0,X.onExpanded(K),X.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var B in this._26o)this.collapse(B)},collapse:function(n){if(n&&n!==Jg){var j=this,Z=j._26o[n];Z&&Z.isExpanded&&(Z.isExpanded=!1,j.onCollapsed(n),j.ivm())}},onCollapsed:function(){},getCategoryName:function(U){if(!this.isCategorizable())return Jg;var m=U.getCategoryName();return m?m:Jg},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(e){var w=this,b=w._dataModel;b!==e&&(b&&(b.umd(w.handlePropertyChange,w),w._selectionModel||b.sm().ums(w.handleSelectionChange,w)),w._dataModel=e,e.md(w.handlePropertyChange,w),w._selectionModel?w._selectionModel._21I(e):e.sm().ms(w.handleSelectionChange,w),w.fp(Fr,b,e))},isVisible:function(Z){return this._visibleFunc?this._visibleFunc(Z):!0},onPropertyChanged:function(t){var l=this,C=t.property;mm[C]?l.ivm():l.iv(),C===Cc&&l._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:np},handlePropertyChange:function(L){this._27o===L.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var K=this;K._96I||(K.setSelectRowIndex(-1),K._96I=1,K.iv())},redraw:function(){this.iv()},validateModel:function(){var A=this,G=A._rows,v=A._28o,D={},Z=new Ol,y=A._27o;A.updateCurrentData(),y!==A._27o&&A.endEditing(),G.clear(),v.clear(),A.getRawProperties().each(function(k){if(A.isVisible(k)){Z.add(k);var m=A.getCategoryName(k);D[m]||(v.add(m,m===Jg?0:d),D[m]={isExpanded:A.isExpanded(m),properties:new Ol})}}),A._sortFunc&&Z.sort(A._sortFunc);for(var r in A._26o)A._26Q[r]=A.isExpanded(r);A._26o=D,v.each(function(t){t!==Jg&&G.add(t);var o=D[t];o.isExpanded&&Z.each(function(q){A.getCategoryName(q)===t&&(o.properties.add(q),G.add({property:q,data:A._27o}))},A)})},validateImpl:function(){var g=this;g._76o(),g._96I&&(g.validateModel(),delete g._96I);var H=g._canvas,$=g.getWidth(),M=g.getHeight(),v=-g.ty(),S=g._rowHeight,r=g._indent,E=$-r,X=g._rows,A=X.size(),K=g._9I=r+E*g._10I,T=g._59I=A*S;pp(H,$,M),g._29I={x:0,y:v,width:$,height:M},g._31I=y(v/S),g._14I=U((v+M)/S),g._31I<0&&(g._31I=0),g._14I>A&&(g._14I=A);var x,f=Ji(H),l=g._background;dg(f,0,-v,1),f.beginPath(),f.rect(0,v,$,M),f.clip(),f.clearRect(0,v,$,M),g._93db(f),l&&zs(f,0,0,r,T,l);for(var c=g._31I;c<g._14I;c++){var u=X.get(c),v=S*c;if(Hq(u))l&&zs(f,r,v,E,S,l),x=cd(g.isExpanded(u)?g._expandIcon:g._collapseIcon),x&&Nq(f,x,Ac,0,v,r,S),f.save(),f.beginPath(),f.rect(r,v,E,S),f.clip(),g.drawCategoryName(f,u,c,r,v,E,S),f.restore();else{var o=u.property,e=u.data,x=cd(o.getIcon()),k=g._selectRowIndex===c?g.getSelectBackground():N;if(x&&Nq(f,x,Ac,0,v,r,S),k&&zs(f,r,v,E,S,k),f.save(),f.beginPath(),f.rect(r,v,K-r,S),f.clip(),g.drawPropertyName(f,o,c,r,v,K-r,S),f.restore(),!g.isEditing(e,o)){var F=K+1,n=$-K-1;f.save(),f.beginPath(),f.rect(F,v,n,S),f.clip(),g._87o(g.drawPropertyValue(f,o,g.getValue(e,o),c,F,v,n,S,e),c,F,v,n,S),f.restore()}}g._rowLineVisible&&zs(f,r,v+S-1,E,1,g._rowLineColor)}g._columnLineVisible&&(zs(f,K,0,1,T,g._columnLineColor),zs(f,$-1,0,1,T)),g._92db(f),g._93I(),f.restore(),g.ty(g.ty())},drawCategoryName:function(d,N,J,l,V,R,t){Tn(d,N,this.getCategoryFont(N),this.getCategoryColor(N),l,V,R,t)},drawPropertyName:function(Z,d,x,l,P,E,p){return d.drawPropertyName?(d.drawPropertyName(Z,d,x,l,P,E,p,this),void 0):(Tn(Z,this.getPropertyName(d),this.getPropertyFont(d,x),this.getPropertyColor(d,x),l,P,E,p),void 0)},drawPropertyValue:function(R,S,G,w,t,d,E,F,i){return S.drawPropertyValue?S.drawPropertyValue(R,S,G,w,t,d,E,F,i,this):(Jq(R,G,S,this.getLabelFont(S,G,w),this.getLabelColor(S,G,w),t,d,E,F,i,this),void 0)},isPropertyEditable:function(O){return O.isEditable()&&this.isEditable()},setProperties:function(b){this._propertyModel.clear(),this.addProperties(b)},addProperties:function(O){if(O){var b=this._propertyModel;O.forEach(function(j){if(!(j instanceof lp)){var K=Me(j.className);j=Ik(K?K:lp,j)}b.add(j)})}},getRowIndexAt:function(V){var M=this,A=y(M.lp(V).y/M._rowHeight);return A>=0&&A<M._rows.size()?A:-1},getPropertyAt:function(y){var d=this,c=d.getRowIndexAt(y);return c>=0?d._rows.get(c).property:N},getToolTip:function(x){var P=this,K=P.getPropertyAt(x),U=P._27o;return K&&U?K.getToolTip(U,P._9I<P.lp(x).x,P):N}});var yi=function(E){this.pv=E,this.addListeners()};Gd(yi,J,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(C){this.getView().style.cursor=C},clear:function(){var U=this;U._62O=U.cp=U.ty=U.p=N,U.setCursor(Fd)},handle_mousedown:function(t){this.handle_touchstart(t)},handle_touchstart:function(d){var h=this,Y=h.pv;zq(d),Y.setFocus(d)&&(Fq(d)?(h.cp=zc(d),h.ty=Y.ty(),h.p=Y.getColumnPosition(),h.handle_touchmove(d)):Y.setSelectRowIndex(Y.getRowIndexAt(d)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(r){this.handle_touchend(r)},handle_touchend:function(d){var x=this;if(x.cp&&!x._62O){var F=x.pv,t=F.lp(d),E=t.x,s=t.y,h=F._indent,A=F.getRowIndexAt(d),B=F._9I;if(A>=0){var J=F._rowHeight,m=J*A,e=F._rows.get(A),X=e.property;if(Hq(e))cd(F.isExpanded(e)?F._expandIcon:F._collapseIcon)&&E>=0&&h>=E&&s>=m&&m+J>=s?F.toggle(e):hn(d)&&F.toggle(e);else if(E>B&&F.isPropertyEditable(X,d)){var y={x:B+1,y:m,width:F.getWidth()-B-1,height:J},R={x:y.x+F.tx(),y:y.y+F.ty(),width:y.width,height:y.height},i=0,v=F._29I;y.y<v.y?i=y.y-v.y:y.y+J>v.y+v.height&&(i=y.y+J-v.y-v.height),i&&(F.ty(F.ty()-i),R.y-=i),F.beginEditing({data:e.data,property:X,value:F.getValue(e.data,X),event:d,rect:y,editorRect:R,view:F})}}F.setSelectRowIndex(A)}x.clear()},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(h){var o=this,z=o.pv,A=o.ty,f=o.cp,F=zc(h),R=o._62O;if("p"===R)z.setTranslateY(A+F.y-f.y);else if("c"===R){var U=z.getWidth()-z._indent;if(U>16){var q=o.p-(f.x-F.x)/U,W=16/U;W>q&&(q=W),q>1-W&&(q=1-W),z.setColumnPosition(q)}}else"s"===R&&z.setTranslateY(A+(f.y-F.y)*z._59I/z._29I.height)},handle_mousemove:function(y){this.handle_touchmove(y)},handle_touchmove:function(g){if(!Ki&&Fq(g)){var C=this,W=C.pv,p=A(W.lp(g).x-W._9I)<=(Bq?8:3);C.cp?C._62O||(p?(C._62O="c",ds(C)):A(zc(g).y-C.cp.y)>=2&&(C._62O=C.isV(g)?"s":"p",ds(C))):(p?C.setCursor(cn):C.setCursor(Fd),C.isV(g)&&W._43o())}},isV:function(f){var N=this.pv,V=N._29I;return N._41o()&&V.x+V.width-N.lp(f).x<ip},handle_mousewheel:function(G){this.handleScroll(G,G.wheelDelta/40)},handle_DOMMouseScroll:function(Y){2===Y.axis&&this.handleScroll(Y,-Y.detail)},handleScroll:function($,o){var P=this.pv;zq($),P.endEditing(),P.translate(0,o*P.getRowHeight())},handle_keydown:function(Y){var q=this.pv,R=q._rows.size(),z=q._selectRowIndex+(_b(Y)?-1:1);(_b(Y)||Wo(Y))&&(0>z&&(z=0),z>=R&&(z=R-1),q.setSelectRowIndex(z))}}),br.ListView=function(q){this._5o(q),new kp(this)},Hb("ListView",J,{ms_ac:[Do,eo,Un,Mc,tc,$d,xb,xl,Jh,Df,jf,Ig,ob,ke],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Em,_rowHeight:Qi,_rowLineVisible:Q.listViewRowLineVisible,_rowLineColor:Q.listViewRowLineColor,_scrollBarColor:$n,_scrollBarSize:ss,_autoMakeVisible:rk,_autoHideScrollBar:qe,_selectBackground:Q.listViewSelectBackground,_labelColor:Q.listViewLabelColor,_labelSelectColor:Q.listViewLabelSelectColor,_labelFont:Q.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(F){var Q=this,A=Q._checkMode;Q._checkMode=F,Q.fp(nk,A,F)},drawRow:function(o,q,y,e,C,A,l){var k=this,L=0,t=k._indent,E=k.getIconWidth(q);k.drawRowBackground(o,q,y,e,C,A,l),k._checkMode&&(Bh(o,cd(k.getCheckIcon(q)),L+t/2,C+l/2,q,k),L+=t),k.drawIcon(o,q,L,C,E,l),k.drawLabel(o,q,L+E,C,l)}});var kp=function(f){this.list=f,this._lastSelectDataTime=Le(),this.addListeners()};Gd(kp,J,{ms_listener:1,getView:function(){return this.list._view},clear:function(c){var W=this,s=W.list;c&&"d"===W._62O&&!W.dragCancel&&s.handleDragAndDrop(c,"end"),s.draggingData&&(s.draggingData=null,s.redraw()),W.dragCancel=W._62O=W._isV=W._isH=W.cp=W.tx=W.ty=N},handle_mousedown:function(K){this.handle_touchstart(K)},handle_touchstart:function(Z){var U=this,V=U.list;if(zq(Z),V.setFocus(Z)){var b=V.getDataAt(Z);U.cp=zc(Z),U.tx=V.tx(),U.ty=V.ty(),Fq(Z)?b&&V.handleDragAndDrop&&!U.isV(Z)&&!U.isH(Z)&&(V.draggingData=b,V.redraw(),V.handleDragAndDrop(Z,"prepare")):(b&&U._33o(Z,b),U.clear(Z))}},handleWindowMouseUp:function(g){this.clear(g)},handleWindowTouchEnd:function(Z){this.clear(Z)},handle_mouseup:function(f){this.handle_touchend(f)},handle_touchend:function(o){var G=this,S=G.list;if(!G._isV&&!G._isH&&G.cp&&!G._62O){var s=S.getDataAt(o);s?(S.isCheckMode()?G._34o(o,s):G._33o(o,s),hn(o)?S.onDataDoubleClicked(s,o):S.onDataClicked(s,o)):S.handleBackgroundClick(o)}G.clear(o)},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowTouchMove:function(h){var A=this,_=A.list,P=A._62O,S=A.tx,R=A.ty,U=A.cp,C=zc(h),O=_._29I;"p"===P?_.setTranslate(S+C.x-U.x,R+C.y-U.y):"v"===P?_.ty(R+(U.y-C.y)*_._59I/O.height):"h"===P?_.tx(S+(U.x-C.x)*_._91I/O.width):"d"===P&&(A.dragCancel||_.handleDragAndDrop(h,"between"))},handle_mousemove:function(S){this.handle_touchmove(S)},handle_touchmove:function(E){if(!Ki&&Fq(E)){var h=this,u=h.list;if(h._isV=h.isV(E),h._isH=h.isH(E),h.cp){if(!h._62O){if(uk(zc(E),h.cp)<2)return;h._isV?h._62O="v":h._isH?h._62O="h":u.draggingData&&!this.dragCancel?(h._62O="d",u.handleDragAndDrop(E,"begin")):h._62O="p",h._62O&&"d"!==h._62O&&u.draggingData&&(u.draggingData=null,u.redraw()),ds(h)}}else h._isV&&u._43o(),h._isH&&u._42o()}},isV:function(B){var r=this.list,K=r._29I;return r._41o()&&K.x+K.width-r.lp(B).x<ip},isH:function(T){var j=this.list,v=j._29I;return j._40o()&&v.y+v.height-j.lp(T).y<ip},handle_mousewheel:function(f){this.handleScroll(f,f.wheelDelta/40,f.wheelDelta!==f.wheelDeltaX)},handle_DOMMouseScroll:function(X){this.handleScroll(X,-X.detail,1)},handleScroll:function(H,c,S){var Q=this.list;zq(H),Q.endEditing&&Q.endEditing(),S&&Q._41o()?Q.translate(0,c*Q.getRowHeight()):Q._40o()&&Q.translate(10*c,0)},handle_keydown:function(c){if(!Q.isInput(c.target)){var q,K=this.list,i=K.sm(),z=K._rows,D=z.size();if(xd(c))K.selectAll();else if(Mq(c))K.handleDelete&&K.handleDelete(c);else if(oj(c))"d"!==this._62O||this.dragCancel||(K.handleDragAndDrop(c,"cancel"),this.dragCancel=!0);else if(Qr(c))K.isCheckMode()&&(q=K.getFocusData(),q&&K.checkData(q));else if(_b(c)||Wo(c)){var J=K.isCheckMode();if(q=J?K.getFocusData():i.ld()){var O=K.getRowIndex(q);O>=0&&(_b(c)?0!==O&&(q=z.get(O-1),J?K.setFocusData(q):i.ss(q)):O!==D-1&&(q=z.get(O+1),J?K.setFocusData(q):i.ss(q)))}else D>0&&(q=z.get(0),J?K.setFocusData(q):i.ss(q))}}},_34o:function(v,L){var u=this.list,A=u.lp(v).x;return A>=0&&A<=u._indent?(u.checkData(L),void 0):(u.setFocusData(L),void 0)},_33o:function(J,p){var d=this.list,r=d.sm(),K=r.ld();if(op(J))d.isSelected(p)?r.rs(p):r.as(p);else if(of(J))if(K)for(var e=d.getRowIndex(K),U=d.getRowIndex(p);e!==U;)e+=U>e?1:-1,r.as(d._rows.get(e));else r.ss(p);else if(Fq(J)){var y=Le();if(r.contains(p)){var I=y-this._lastSelectDataTime;d.handleDataDoubleSelect&&I>500&&1500>I&&d.handleDataDoubleSelect(J,p)}r.ss(p),this._lastSelectDataTime=y}else r.contains(p)||r.ss(p)}}),br.TreeView=function(D){var w=this;w._35o(),w._5o(D),new yr(w)},Hb("TreeView",J,{ms_ac:[Do,eo,Un,"rootVisible",nk,"rootData",xl,Jh,Df,jf,Ig,tc,Mc,$d,xb,pf,Yj,ob,ke,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:N,_indent:Em,_rowHeight:Qi,_rowLineVisible:Q.treeViewRowLineVisible,_rowLineColor:Q.treeViewRowLineColor,_scrollBarColor:$n,_scrollBarSize:ss,_autoHideScrollBar:qe,_expandIcon:Q.treeViewExpandIcon,_collapseIcon:Q.treeViewCollapseIcon,_autoMakeVisible:rk,_selectBackground:Q.treeViewSelectBackground,_labelColor:Q.treeViewLabelColor,_labelSelectColor:Q.treeViewLabelSelectColor,_labelFont:Q.treeViewLabelFont,_doubleClickToToggle:Q.treeViewDoubleClickToToggle,drawRow:function(H,i,J,Q,z,K,d){var V=this;V.drawRowBackground(H,i,J,Q,z,K,d),V._97I(H,i,J,0,z,K,d)},isOnToggleIcon:function(q){var h=this.getDataAt(q);if(h){var O=this.getIndent(),b=this.lp(q).x;if(cd(this.getToggleIcon(h))){var L=O*this.getLevel(h);if(b>=L&&L+O>=b)return!0}}return!1}});var yr=function(K){Ho(yr,this,[K])};Gd(yr,kp,{toggle:function(X,Y,L,_){var m=this.list,l=m.lp(X).x;if(cd(m.getToggleIcon(Y))){var G=L*_;if(l>=G&&G+L>=l)return m.toggle(Y),!0}return m.isDoubleClickToToggle()&&hn(X)?(m.toggle(Y),!0):!1},_34o:function(Q,J){var L=this.list,w=L.lp(Q).x,j=L._levelMap[J._id],$=L._indent,e=$*(j+1);return w>=e&&e+$>=w?(L.checkData(J),void 0):(this.toggle(Q,J,$,j)||L.setFocusData(J),void 0)},_33o:function(H,M){var r=this,m=r.list;r.toggle(H,M,m._indent,m.getLevel(M))||yr.superClass._33o.call(r,H,M)},handle_keydown:function(I){if(Pd(I)||bi(I)){var a=this.list,w=a._rows,C=a.isCheckMode(),x=a.sm(),n=C?a.getFocusData():x.ld();n?n.hasChildren()&&(Pd(I)?a.collapse(n):a.expand(n)):w.size()>0&&(n=w.get(0),C?a.setFocusData(n):x.ss(n))}else yr.superClass.handle_keydown.call(this,I)}});var sd=br.TableView=function(V){this._98I(),this._5o(V),new Ao(this)};Hb("TableView",J,{ms_ac:[Do,eo,Un,"sortMode",Ll,ns,Mc,$d,xb,Qd,Eb,"sortColumn",xl,Jh,Df,jf,Ig,ob,ke],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:hs,_editable:!0,_batchEditable:!1,_rowHeight:Qi,_rowLineVisible:Q.tableViewRowLineVisible,_rowLineColor:Q.tableViewRowLineColor,_columnLineVisible:Q.tableViewColumnLineVisible,_columnLineColor:Q.tableViewColumnLineColor,_scrollBarColor:$n,_scrollBarSize:ss,_autoHideScrollBar:qe,_autoMakeVisible:rk,_selectBackground:Q.tableViewSelectBackground,_labelColor:Q.tableViewLabelColor,_labelSelectColor:Q.tableViewLabelSelectColor,_labelFont:Q.tableViewLabelFont,getCheckColumn:function(){var h=this;if(!h._31o){var s=h._31o=new Jk;s.setEditable(!0),s.setWidth(40),s.getValue=h.getCheckColumValue,s.drawCell=h.drawCheckColumnCell}return h._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(W){var o=this,U=o._39o,B=o.getCheckColumn();W!==o.isCheckMode()&&(W?U.add(B,0):U.remove(B),o.fp(nk,!W,W))},getCheckColumValue:function(t,P,d){return d.isSelected(t)},drawCheckColumnCell:function(h,n,R,B,p,y,j,W,o){Bh(h,o.getCheckIcon(n),p+j/2,y+W/2,n,o)}});var Ao=function(R){Ho(Ao,this,[R])};Gd(Ao,kp,{_34o:function(b,U){var h=this.list,W=h._31o;if(h.isCellEditable(U,W,b)){var j=h._3Q(W),T=h.lp(b).x;if(j&&T>=j.startX&&T<j.startX+W.getWidth())return h.checkData(U),void 0}h._37O(U,b),h.setFocusData(U)},_33o:function(r,j){this.list._37O(j,r),Ao.superClass._33o.apply(this,arguments)}});var bg=br.TreeTableView=function(r){var G=this,B=G._4o=new Jk;G._35o(),G._98I(),G._5o(r),B.setDisplayName("Name"),B.setEditable(!0),B.setWidth(180),B.drawCell=Vg,B.getValue=qg,G._39o.add(B),new Bn(G)},Vg=function(c,j,o,r,G,N,k,q,T){T._97I(c,j,o,G,N,k,q)},qg=function(b,H,V){return V.getLabel(b)};Hb("TreeTableView",J,{ms_ac:[Do,eo,Un,"sortMode",Ll,ns,tc,nk,"rootData","rootVisible",xl,Jh,"sortColumn",pf,Yj,Df,jf,Ig,ob,xb,Mc,$d,Qd,Eb,ke,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:hs,_checkMode:N,_editable:!0,_batchEditable:!1,_indent:Em,_rowHeight:Qi,_rowLineVisible:Q.treeTableViewRowLineVisible,_rowLineColor:Q.treeTableViewRowLineColor,_columnLineVisible:Q.treeTableViewColumnLineVisible,_columnLineColor:Q.treeTableViewColumnLineColor,_expandIcon:Q.treeTableViewExpandIcon,_collapseIcon:Q.treeTableViewCollapseIcon,_scrollBarColor:$n,_scrollBarSize:ss,_autoHideScrollBar:qe,_autoMakeVisible:rk,_selectBackground:Q.treeTableViewSelectBackground,_labelColor:Q.treeTableViewLabelColor,_labelSelectColor:Q.treeTableViewLabelSelectColor,_labelFont:Q.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Bn=function(r){Ho(Bn,this,[r])};Gd(Bn,kp,{_34o:function(T,l){var k=this.list,U=k._4o,Y=k._3Q(U),O=k.lp(T).x;if(Y){var K=k._indent,q=Y.startX+K*k.getLevel(l);if(cd(k.getToggleIcon(l))&&O>=q&&q+K>=O)return k.toggle(l),void 0;if(k.isCellEditable(l,U)&&(q+=K,O>=q&&q+K>=O))return k.checkData(l),void 0}k._37O(l,T),k.setFocusData(l)},_33o:function(z,m){var L=this.list,e=L.lp(z).x;if(cd(L.getToggleIcon(m))){var t=L._3Q(L._4o);if(t){var X=L._indent,s=t.startX+X*L.getLevel(m);if(e>=s&&s+X>=e)return L.toggle(m),void 0}}L._37O(m,z),Bn.superClass._33o.apply(this,arguments)}});var rh=br.TableHeader=function(H){var B=this,W=B._view=nh(1,B),I=B._39o=H.getColumnModel(),y=B.iv;B.tv=B._tableView=H,B._60I=new Ol,B._canvas=Uq(W),W.style.background=Q.tableHeaderBackground||"",W.style.height=Rj+Rn,I.mm(y,B),I.md(y,B),I.mh(y,B),H.mp(function(K){jr[K.property]&&B.iv()},B),new Cq(B),B.iv()};Hb("TableHeader",J,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Do,Un,tc,"moveBackground","insertColor",Qd,Eb,"resizable","movable"],_checkIcon:Gb,_movable:!0,_resizable:!0,_labelColor:Q.tableHeaderLabelColor,_labelFont:Q.tableHeaderLabelFont,_columnLineColor:Q.tableHeaderColumnLineColor,_columnLineVisible:Q.tableHeaderColumnLineVisible,_sortDescIcon:Q.tableHeaderSortDescIcon,_sortAscIcon:Q.tableHeaderSortAscIcon,_moveBackground:Q.tableHeaderMoveBackground,_insertColor:Q.tableHeaderInsertColor,_indent:Em,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(B){return B.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(x){return x.getColor()||this._labelColor},getLabelAlign:function(g){return g._align},onPropertyChanged:function(){this.iv()},_5Q:function(z){this._61I=z,this.iv()},getLogicalPoint:function(y){return ar(y,this._canvas,this.tv.tx())},validateImpl:function(){var z=this,R=z._canvas,f=z.getWidth(),H=z.getHeight(),c=z.tv,F=z._60I,h=z._61I,v=-c.tx(),e=0;(f!==R.clientWidth||H!==R.clientHeight)&&pp(R,f,H),F.clear(),z._39o._roots.each(function(H){if(H.isVisible()){var m=e+H.getWidth();v+f>=e&&m>=v&&F.add({column:H,startX:e}),e=m}});var A=Ji(R);if(dg(A,-v,0,1),A.beginPath(),A.rect(v,0,f,H),A.clip(),A.clearRect(v,0,f,H),F.each(function(C){var $=C.column,c=C.startX,e=$.getWidth();e>0&&(A.save(),A.beginPath(),A.rect(c,0,e,H),A.clip(),h&&h.column===$||z.drawColumn(A,$,c,0,e,H),z._columnLineVisible&&zs(A,c+e-1,0,1,H,z._columnLineColor),A.restore())}),h){var U=h.column,e=h.startX,b=h.position,V=U.getWidth();A.save(),A.beginPath(),A.rect(e,0,V,H),A.clip(),A.fillStyle=z._moveBackground,A.fill(),z.drawColumn(A,U,e,0,V,H),A.restore(),Uh(A,z._insertColor,b,0,H)}A.restore()},_6Q:function(v){var t=this.tv;return t._31o===v&&t.sm().getSelectionMode()===um},drawColumn:function(G,Q,B,h,w,g){var N=this,l=N.tv,K=cd(Q.getIcon()),f=N.getLabelAlign(Q);if(N._6Q(Q)){var C=cd(N._checkIcon);Bh(G,C,B+w/2,h+g/2,Q,N)}else{var J=N.getLabel(Q),e=N.getLabelFont(Q),D=N.getLabelColor(Q),t=sl(e,J).width,m=K?N._indent:0;f===kj?(K&&Nq(G,K,Ac,B,h,m,g),Tn(G,J,e,D,B+m,h,w,g,kj)):f===Lj?(K&&Nq(G,K,Ac,B+w-t-m,h,m,g),Tn(G,J,e,D,B,h,w,g,Lj)):(K&&Nq(G,K,Ac,B+(w-t-m)/2,h,m,g),Tn(G,J,e,D,B+(w-t+m)/2,h,0,g,kj))}if(Q.isSortable()&&l.getSortColumn()===Q&&(K=cd(Q.getSortOrder()===ch?N._sortAscIcon:N._sortDescIcon))){var u=pg(K,Q)/2+2;Bh(G,K,f===Lj?B+u:B+w-u,h+g/2,Q,l)}}});var Cq=function(x){var q=this;q.th=x,q.tv=x._tableView,q.addListeners()};Gd(Cq,J,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(Q){this.getView().style.cursor=Q},handle_mousemove:function(F){if(!Ki){var h=this;delete h._29o,h.setCursor(Fd);for(var J=h.th,L=J._60I,j=J.lp(F).x,K=L.size()-1;K>=0;K--){var u=L.get(K),z=u.column,B=u.startX+z.getWidth();if(J.isResizable()&&A(B-j)<=(Bq?10:3))return h._29o=u,h.setCursor(cn),void 0;j>u.startX&&B>j&&(h._29o=u),(z.isClickable()||z.isSortable()||J.isMovable()||h.tv.getCheckColumn&&z===h.tv.getCheckColumn())&&j>u.startX&&B>j&&h.setCursor(zf)}}},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(E){var Y=this;zq(E),Y.tv.endEditing(),Y.handle_mousemove(E),Y._29o&&(Y.x=zc(E).x,Y.lx=Y.th.lp(E).x,Y.w=Y._29o.column.getWidth(),ds(Y,E))},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(O){var R=this,Q=R.th,o=R.getView().style.cursor,e=R._29o,D=zc(O).x-R.x;if(R.resizing||R.moving||(o===cn?R.resizing=1:Q.isMovable()&&o===zf&&A(D)>2&&(R.moving=1)),R.resizing)e.column.setWidth(R.w+D);else if(R.moving){var m=R.lx+D;Q._60I.each(function(E){var o=E.startX,j=o+E.column.getWidth();if(m>=o&&j>=m){var F={column:e.column,startX:e.startX+D,front:j-m>m-o,insertColumn:E.column};F.position=F.front?o:j,Q._5Q(F)}})}},_16Q:function(s,E){var w=this,Y=w.tv,R=w.th,u=R._checkIcon;if(R._6Q(s)){var b=cd(u),D=w.lx,l=s.getWidth(),i=pg(b,s);if(D>=E+l/2-i&&E+l/2+i>=D){R.setCheckIcon(u===dk?Gb:dk);var d=Y.sm(),r=Y._rows;return u===dk?d.rs(r):d.ss(r),Y.onCheckColumnClicked(s),!0}}return!1},handleWindowMouseUp:function(_){this.handleWindowTouchEnd(_)},handleWindowTouchEnd:function(U){var V=this,Y=V.tv,I=V.th,R=V._29o;if(V.moving){var K=I._61I;if(K&&K.insertColumn!==K.column){var k=K.column,h=Y.getColumnModel()._roots,D=h.remove(k),X=h.indexOf(K.insertColumn);X>=0&&(K.front||X++,X<=h.size()&&(h.add(k,X),Y.getColumnModel()._38I(k,D,X)))}I._5Q(N),delete V.moving}else if(!V.resizing&&R){k=R.column;var m=I.lp(U).x,A=R.startX,B=!0;if(I.onColumnClicked){var W=I.onColumnClicked(k,U,A);W===!1&&(B=!1)}if(B&&m>=A&&m<=A+k.getWidth()&&!V._16Q(k,A)){if(k.isSortable()){var F=Y.getSortMode(),o=k.getSortOrder();F===hs?Y.getSortColumn()===k?(o===pj&&Y.setSortColumn(N),k.setSortOrder(o===ch?pj:ch)):Y.setSortColumn(k):"bistate"===F&&(Y.getSortColumn()===k?k.setSortOrder(o===ch?pj:ch):Y.setSortColumn(k))}Y.onColumnClicked(k,U,A)}}V._29o=V.resizing=V.x=V.lx=V.w=N}}),br.TablePane=function(w){this.init(new sd(w))},Hb("TablePane",J,{ms_v:1,_44o:1}),br.TreeTablePane=function(C){this.init(new bg(C))},Hb("TreeTablePane",J,{ms_v:1,_44o:1}),br.Toolbar=function(j){var f=this,m=f._view=nh(1,f),U=m.style;U.background=Q.toolbarBackground||"",U.height=Mo+Rn,f._canvas=Uq(m),f._30o=new Ol,f._90I=new Ol,f.setItems(j||[]),m.handleGroupSelectedChanged=function(c){if(c.isSelected()){var z=c.getGroupId();null!=z&&f._items.forEach(function(C){var r=C.element;r&&r!==c&&r.setSelected&&r.getGroupId&&r.getGroupId()===z&&r.setSelected(!1)})}},new Ci(f)},Hb("Toolbar",J,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[xn,Do,Un,eo,ke,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:Q.toolbarLabelColor,_labelSelectColor:Q.toolbarLabelSelectColor,_labelFont:Q.toolbarLabelFont,_selectBackground:Q.toolbarSelectBackground,_itemGap:Q.toolbarItemGap,_separatorColor:Q.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(p){var e=this.getItemInfoAt(p);return e?e.item.toolTip:N},getLabelColor:function(J){return J&&J.selected&&J.type!==dk&&J.type!==yc?this._labelSelectColor:this._labelColor},onPropertyChanged:function(L){this.iv(),L.property===xn&&this._items.forEach(function(P){_i(P)})},redraw:function(){this.iv()},addItem:function(U,S){var O=this._items;S==N?O.push(U):O.splice(S,0,U),this.fp(xn,N,O)},removeItem:function(J){if(J)for(var G=this._items,m=0;m<G.length;m++)J===G[m]&&(G.splice(m,1),this.fp(xn,N,G))},removeItemById:function(s){if(s!=N)for(var L=this._items,Q=0;Q<L.length;Q++)if(s===L[Q].id){var T=L.splice(Q,1)[0];return this.fp(xn,N,L),T}},getItemById:function(F){if(F!=N)for(var $=this._items,V=0;V<$.length;V++){var R=$[V];if(F===R.id)return R}},setItemVisible:function(V,d){var k=this.getItemById(V);k&&(k.visible=d)},getItemInfos:function(){return this._30o},getItemInfoAt:function(_){var f=this,i=0,s=f._30o,S=f.lp(_),r=S.x,X=S.y;if(X>=0&&X<=f.getHeight())for(;i<s.size();i++){var q=s.get(i);if(q.startX<=r&&r<=q.endX)return q}return N},drawItem:function(P,X,Y,O,x){if(X.visible===!1)return 0;if(ri(X.visible)&&!X.visible())return 0;var r=this,$=X.disabled;$&&(P.globalAlpha=Am);var j=r.drawItemImpl(P,X,Y,O,x),g=r._itemGap;return $&&(P.globalAlpha=1),this._currentItem!==X||"separator"===X||X.separator===!0||X.unfocusable||Qk(P,r._separatorColor,Y-g/2,0,j+g,O),j},drawItemImpl:function(b,H,J,x,D){var M=this,n=M._view,V=M._itemGap,d=x/2,g=H.type,e=H.element,z=H.label;Hq(e)&&(z=e,e=N);var X,r=M.getLabelFont(H),R=M.getLabelColor(H),l=H.selected,a=cd(H.icon),$=pg(a,H),Z=0,U=$+(z?sl(r,z).width:0);if("separator"===H||H.separator===!0)return Uh(b,M._separatorColor,J,x/4,d),1;
if(e){a&&Bh(b,a,J+$/2,d,H,M),Tn(b,z,r,R,J+$,0,0,x);var G=ff(e);D||M._90I.add(G),G.parentNode!==n&&kr(n,G),e.iv&&e.iv(),e.validate&&e.validate();var j=G.getBoundingClientRect(),Q=j.width,K=G.style;return dn(G),K.left=M.tx()+J+U+Rn,K.top=(x-j.height)/2+Rn,U+Q}return g===yc?X=cd(l?pc:kf):g===dk&&(X=cd(l?dk:Gb)),X?(Z=pg(X,H),Bh(b,X,J+Z/2,d,H,M),J+=Z,U+=Z):l&&zs(b,J-V/2,0,U+V,x,M.getSelectBackground(H)),a&&Bh(b,a,J+$/2,d,H,M),Tn(b,z,r,R,J+$,0,0,x),U},validateImpl:function(){var T=this,H=T._canvas,F=T.getWidth(),C=T.getHeight(),o=T._30o,W=T._items;pp(H,F,C);var z=Ji(H),c=T._itemGap,E=c/2;dg(z,T.tx(),0,1),z.clearRect(0,0,F,C);var v=T._90I;T._90I=new Ol,o.clear(),W.forEach(function(s){var M=T.drawItem(z,s,E,C);o.add({item:s,startX:E,endX:E+M,width:M}),M&&(E+=M+c)}),v.each(function(X){T._90I.contains(X)||eq(X)});var m=T._64I;T._64I=t(0,E),z.restore(),T._stickToRight?(T._65O=0,z=Ji(H),E=F-T._64I+c,dg(z,0,0,1),z.clearRect(0,0,F,C),o.clear(),W.forEach(function(r){var f=T.drawItem(z,r,E,C,!0);o.add({item:r,startX:E,endX:E+f,width:f}),f&&(E+=f+c)}),z.restore()):T.tx(T.tx()),m!==T._64I&&T.onSumWidthChanged(m,T._64I)},onSumWidthChanged:function(){},handleClick:function(f,i){var k=this,H=f.type,l=f.action,P=f.groupId,n=f.selected;f.disabled||(P!=N?n||(f.selected=!0,this._items.forEach(function(t){t.groupId===P&&f!==t&&(t.selected=!1)}),l&&f.action(f,k,i)):H===dk||"toggle"===H?(f.selected=!n,l&&f.action(f,k,i)):l&&f.action(f,k,i)),Od(),k.iv()}});var Ci=function(s){this.tb=s,this.addListeners()};Gd(Ci,J,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(k){this.handleScroll(k,10*(k.wheelDelta/40))},handle_DOMMouseScroll:function(B){this.handleScroll(B,10*-B.detail)},handleScroll:function(t,v){zq(t);var E=this.tb;E.isScrollable()&&!E._stickToRight&&(E.tx(E.tx()+v),mj())},handle_mousemove:function(E){var K=this;Ki||K.setItem(E)},handle_mouseout:function(t){var h=this;t.target===h.getView()?h.tb.setCurrentItem(N):h.handle_mousemove(t)},handle_mousedown:function(H){this.handle_mousemove(H),this.handle_touchstart(H)},handle_touchstart:function(A){var G=this,w=G.tb,U=A.target;Fq(A)&&(U===G.getView()||U===w._canvas)&&(zq(A),w.setFocus(A)&&(this.setItem(A,!0),(w.isScrollable()||G.info&&!G.info.item.disabled)&&(G.x=zc(A).x,G.tx=w.tx(),ds(G,A))))},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowTouchMove:function(H){var w=this,z=w.tb;if(!z._stickToRight){var s=zc(H).x-w.x;!w._25o&&A(s)>2&&z.isScrollable()&&(w._25o=1),w._25o&&z.tx(w.tx+s)}},handleWindowMouseUp:function(u){this.handleWindowTouchEnd(u)},handleWindowTouchEnd:function(X){var v=this,L=v.tb,$=v.info,A=v.tb.getItemInfoAt(X);if(!v._25o&&$){var f=$.item;A&&A.item===f&&L.handleClick(f,X)}v._25o=v.x=v.tx=N,v.setItem()},setItem:function(t,Q){var Y=this,z=Y.tb,p=Y.info=t?z.getItemInfoAt(t):N,x=p?p.item:N;z.setCurrentItem(x),Q&&x&&ri(x.onDown)&&x.onDown(t)}}),br.BorderPane=function(){this._view=nh(1,this),this.iv()},Hb("BorderPane",J,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(O,K){this._12o("leftView",O),K!=N&&this.setLeftWidth(K)},getRightView:function(){return this._rightView},setRightView:function(Q,K){this._12o("rightView",Q),K!=N&&this.setRightWidth(K)},getTopView:function(){return this._topView},setTopView:function(J,r){this._12o("topView",J),r!=N&&this.setTopHeight(r)},getBottomView:function(){return this._bottomView},setBottomView:function(j,T){this._12o("bottomView",j),T!=N&&this.setBottomHeight(T)},getCenterView:function(){return this._centerView},setCenterView:function(M){this._12o("centerView",M)},_12o:function(Y,M){var a=this,B="_"+Y,N=a._view,y=a[B];y!==M&&(y&&(y.getView?eq(y.getView()):eq(y)),a[B]=M,M&&(M.getView?kr(N,M.getView(),1):kr(N,M,1)),a.fp(Y,y,M))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var b=this,s=b._topView,E=b._bottomView,B=b._leftView,r=b._rightView,k=b._centerView,i=b.getWidth(),d=b.getHeight(),D=0,Y=0,e=i,c=d,I=0,_=0,X=0,A=0;s&&(I=b._topHeight==N?Dk(s):b._topHeight,Y=I),E&&(_=b._bottomHeight==N?Dk(E):b._bottomHeight,c=d-_),B&&(X=b._leftWidth==N?yp(B):b._leftWidth,D=X),r&&(A=b._rightWidth==N?yp(r):b._rightWidth,e=i-A);var T=t(0,e-D),K=t(0,c-Y);s&&Sf(s,0,0,i,I),E&&Sf(E,0,c,i,_),B&&Sf(B,0,Y,X,K),r&&Sf(r,e,Y,A,K),k&&Sf(k,D,Y,T,K)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);